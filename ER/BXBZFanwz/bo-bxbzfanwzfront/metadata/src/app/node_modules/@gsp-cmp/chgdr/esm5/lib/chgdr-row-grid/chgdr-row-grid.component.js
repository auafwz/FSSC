/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Injector, Input, ViewChild } from '@angular/core';
import { DatagridComponent } from '@farris/ui-datagrid';
import { ChgdrTreeNode } from '../chgdr-data-viewer/chgdr-tree-builder';
import { OperateType } from '../model/operate-type';
var ChgdrRowGridComponent = /** @class */ (function () {
    function ChgdrRowGridComponent(injector) {
        this.injector = injector;
    }
    /**
     * @return {?}
     */
    ChgdrRowGridComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.columns = [
            { field: 'fieldName', width: 130, title: '字段名' },
            { field: 'oldValue', width: 130, title: '原值', showTips: true },
            { field: 'newValue', width: 130, title: '变更值', showTips: true }
        ];
        /** @type {?} */
        var oldValueField = this.columns[1];
        /** @type {?} */
        var newValueField = this.columns[2];
        if (!!this.chgdrTreeNode) {
            //根据初始的变更类型更改显示列的信息
            //此处不能直接调用DataGrid组件的方法更改，因为此处尚未创建DataGrid
            /** @type {?} */
            var type = this.chgdrTreeNode.chgdrRow.operateType;
            if (type == OperateType.ADD) {
                oldValueField.visible = false;
                newValueField.title = "值";
            }
            else if (type == OperateType.DELETE) {
                newValueField.visible = false;
                oldValueField.title = "值";
            }
        }
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    ChgdrRowGridComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        //原来变更行类型
        /** @type {?} */
        var oldType;
        if (!changes.chgdrTreeNode) {
            oldType = null;
        }
        else if (!changes.chgdrTreeNode.previousValue) {
            oldType = null;
        }
        else {
            oldType = changes.chgdrTreeNode.previousValue.chgdrRow.operateType;
        }
        //现在变更行类型
        /** @type {?} */
        var newType;
        if (!changes.chgdrTreeNode) {
            newType = null;
        }
        else if (!changes.chgdrTreeNode.currentValue) {
            newType = null;
        }
        else {
            newType = changes.chgdrTreeNode.currentValue.chgdrRow.operateType;
        }
        if (oldType == newType || !this.dataGrid || !this.dataGrid.columns) {
            //如果新老类型一致(或DataGrid尚未创建)，则不变动
            //do nothing
        }
        else if (newType == OperateType.ADD) {
            this.dataGrid.showColumn("newValue");
            this.dataGrid.hideColumn("oldValue");
            this.dataGrid.setColumnTitle("newValue", "值");
        }
        else if (newType == OperateType.DELETE) {
            this.dataGrid.showColumn("oldValue");
            this.dataGrid.hideColumn("newValue");
            this.dataGrid.setColumnTitle("oldValue", "值");
        }
        else {
            this.dataGrid.showColumn("oldValue");
            this.dataGrid.showColumn("newValue");
            this.dataGrid.setColumnTitle("oldValue", "原值");
            this.dataGrid.setColumnTitle("newValue", "变更值");
        }
        if (changes.chgdrTreeNode && changes.chgdrTreeNode.currentValue) {
            this.data = changes.chgdrTreeNode.currentValue.chgdrRow.changes;
        }
    };
    ChgdrRowGridComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-chgdr-row-grid',
                    template: "<farris-datagrid \r\n   #chgdrRowGrid \r\n   idField=\"fieldLabel\" \r\n   [columns]=\"columns\" \r\n   [data]=\"data\" \r\n   [fit]=\"true\"\r\n   [fitColumns]=\"true\"\r\n   [pagination]=\"false\" \r\n>",
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ChgdrRowGridComponent.ctorParameters = function () { return [
        { type: Injector }
    ]; };
    ChgdrRowGridComponent.propDecorators = {
        chgdrTreeNode: [{ type: Input }],
        dataGrid: [{ type: ViewChild, args: ["chgdrRowGrid",] }]
    };
    return ChgdrRowGridComponent;
}());
export { ChgdrRowGridComponent };
if (false) {
    /** @type {?} */
    ChgdrRowGridComponent.prototype.chgdrTreeNode;
    /** @type {?} */
    ChgdrRowGridComponent.prototype.dataGrid;
    /** @type {?} */
    ChgdrRowGridComponent.prototype.columns;
    /** @type {?} */
    ChgdrRowGridComponent.prototype.data;
    /**
     * @type {?}
     * @private
     */
    ChgdrRowGridComponent.prototype.injector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hnZHItcm93LWdyaWQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC1jbXAvY2hnZHIvIiwic291cmNlcyI6WyJsaWIvY2hnZHItcm93LWdyaWQvY2hnZHItcm93LWdyaWQuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQW9DLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN4RyxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUV4RCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0seUNBQXlDLENBQUM7QUFDeEUsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBRXBEO0lBY0UsK0JBQW9CLFFBQWtCO1FBQWxCLGFBQVEsR0FBUixRQUFRLENBQVU7SUFBSSxDQUFDOzs7O0lBRTNDLHdDQUFROzs7SUFBUjtRQUNFLElBQUksQ0FBQyxPQUFPLEdBQUc7WUFDYixFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFO1lBQ2hELEVBQUUsS0FBSyxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRTtZQUM5RCxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUU7U0FDaEUsQ0FBQzs7WUFDRSxhQUFhLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7O1lBQy9CLGFBQWEsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztRQUVuQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFOzs7O2dCQUdwQixJQUFJLEdBQWdC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Q0FZekIsS0FBSzsyQkFFTCxTQUFTLFNBQUMsY0FBYzs7SUEyRTNCLDRCQUFDO0NBQUEsQUFuRkQsSUFtRkM7U0E5RVkscUJBQXFCOzs7SUFDaEMsOENBQzZCOztJQUM3Qix5Q0FDNEI7O0lBRTVCLHdDQUFlOztJQUNmLHFDQUF5Qjs7Ozs7SUFFYix5Q0FBMEIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEluamVjdG9yLCBJbnB1dCwgT25DaGFuZ2VzLCBPbkluaXQsIFNpbXBsZUNoYW5nZXMsIFZpZXdDaGlsZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBEYXRhZ3JpZENvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktZGF0YWdyaWQnO1xyXG5pbXBvcnQgeyBDaGFuZ2VDb2x1bW5JdGVtLCBDaGdkckRhdGFSb3dOb2RlIH0gZnJvbSAnLi4vY2hnZHItZGF0YS12aWV3ZXIvY2hnZHItZGF0YSc7XHJcbmltcG9ydCB7IENoZ2RyVHJlZU5vZGUgfSBmcm9tICcuLi9jaGdkci1kYXRhLXZpZXdlci9jaGdkci10cmVlLWJ1aWxkZXInO1xyXG5pbXBvcnQgeyBPcGVyYXRlVHlwZSB9IGZyb20gJy4uL21vZGVsL29wZXJhdGUtdHlwZSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2xpYi1jaGdkci1yb3ctZ3JpZCcsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL2NoZ2RyLXJvdy1ncmlkLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi9jaGdkci1yb3ctZ3JpZC5jb21wb25lbnQuY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIENoZ2RyUm93R3JpZENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzIHtcclxuICBASW5wdXQoKVxyXG4gIGNoZ2RyVHJlZU5vZGU6IENoZ2RyVHJlZU5vZGU7XHJcbiAgQFZpZXdDaGlsZChcImNoZ2RyUm93R3JpZFwiKVxyXG4gIGRhdGFHcmlkOiBEYXRhZ3JpZENvbXBvbmVudDtcclxuXHJcbiAgY29sdW1uczogYW55W107XHJcbiAgZGF0YTogQ2hhbmdlQ29sdW1uSXRlbVtdO1xyXG5cclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGluamVjdG9yOiBJbmplY3RvcikgeyB9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gICAgdGhpcy5jb2x1bW5zID0gW1xyXG4gICAgICB7IGZpZWxkOiAnZmllbGROYW1lJywgd2lkdGg6IDEzMCwgdGl0bGU6ICflrZfmrrXlkI0nIH0sXHJcbiAgICAgIHsgZmllbGQ6ICdvbGRWYWx1ZScsIHdpZHRoOiAxMzAsIHRpdGxlOiAn5Y6f5YC8Jywgc2hvd1RpcHM6IHRydWUgfSxcclxuICAgICAgeyBmaWVsZDogJ25ld1ZhbHVlJywgd2lkdGg6IDEzMCwgdGl0bGU6ICflj5jmm7TlgLwnLCBzaG93VGlwczogdHJ1ZSB9XHJcbiAgICBdO1xyXG4gICAgbGV0IG9sZFZhbHVlRmllbGQgPSB0aGlzLmNvbHVtbnNbMV07XHJcbiAgICBsZXQgbmV3VmFsdWVGaWVsZCA9IHRoaXMuY29sdW1uc1syXTtcclxuXHJcbiAgICBpZiAoISF0aGlzLmNoZ2RyVHJlZU5vZGUpIHtcclxuICAgICAgLy/moLnmja7liJ3lp4vnmoTlj5jmm7Tnsbvlnovmm7TmlLnmmL7npLrliJfnmoTkv6Hmga9cclxuICAgICAgLy/mraTlpITkuI3og73nm7TmjqXosIPnlKhEYXRhR3JpZOe7hOS7tueahOaWueazleabtOaUue+8jOWboOS4uuatpOWkhOWwmuacquWIm+W7ukRhdGFHcmlkXHJcbiAgICAgIGxldCB0eXBlOiBPcGVyYXRlVHlwZSA9IHRoaXMuY2hnZHJUcmVlTm9kZS5jaGdkclJvdy5vcGVyYXRlVHlwZTtcclxuICAgICAgaWYgKHR5cGUgPT0gT3BlcmF0ZVR5cGUuQUREKSB7XHJcbiAgICAgICAgb2xkVmFsdWVGaWVsZC52aXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgbmV3VmFsdWVGaWVsZC50aXRsZSA9IFwi5YC8XCI7XHJcbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSBPcGVyYXRlVHlwZS5ERUxFVEUpIHtcclxuICAgICAgICBuZXdWYWx1ZUZpZWxkLnZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICBvbGRWYWx1ZUZpZWxkLnRpdGxlID0gXCLlgLxcIjtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xyXG4gICAgLy/ljp/mnaXlj5jmm7TooYznsbvlnotcclxuICAgIGxldCBvbGRUeXBlOiBPcGVyYXRlVHlwZTtcclxuICAgIGlmICghY2hhbmdlcy5jaGdkclRyZWVOb2RlKSB7XHJcbiAgICAgIG9sZFR5cGUgPSBudWxsO1xyXG4gICAgfSBlbHNlIGlmICghY2hhbmdlcy5jaGdkclRyZWVOb2RlLnByZXZpb3VzVmFsdWUpIHtcclxuICAgICAgb2xkVHlwZSA9IG51bGw7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBvbGRUeXBlID0gY2hhbmdlcy5jaGdkclRyZWVOb2RlLnByZXZpb3VzVmFsdWUuY2hnZHJSb3cub3BlcmF0ZVR5cGU7XHJcbiAgICB9XHJcblxyXG4gICAgLy/njrDlnKjlj5jmm7TooYznsbvlnotcclxuICAgIGxldCBuZXdUeXBlOiBPcGVyYXRlVHlwZTtcclxuICAgIGlmICghY2hhbmdlcy5jaGdkclRyZWVOb2RlKSB7XHJcbiAgICAgIG5ld1R5cGUgPSBudWxsO1xyXG4gICAgfSBlbHNlIGlmICghY2hhbmdlcy5jaGdkclRyZWVOb2RlLmN1cnJlbnRWYWx1ZSkge1xyXG4gICAgICBuZXdUeXBlID0gbnVsbDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIG5ld1R5cGUgPSBjaGFuZ2VzLmNoZ2RyVHJlZU5vZGUuY3VycmVudFZhbHVlLmNoZ2RyUm93Lm9wZXJhdGVUeXBlO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChvbGRUeXBlID09IG5ld1R5cGUgfHwgIXRoaXMuZGF0YUdyaWQgfHwgIXRoaXMuZGF0YUdyaWQuY29sdW1ucykge1xyXG4gICAgICAvL+WmguaenOaWsOiAgeexu+Wei+S4gOiHtCjmiJZEYXRhR3JpZOWwmuacquWIm+W7uinvvIzliJnkuI3lj5jliqhcclxuICAgICAgLy9kbyBub3RoaW5nXHJcbiAgICB9IGVsc2UgaWYgKG5ld1R5cGUgPT0gT3BlcmF0ZVR5cGUuQUREKSB7XHJcbiAgICAgIHRoaXMuZGF0YUdyaWQuc2hvd0NvbHVtbihcIm5ld1ZhbHVlXCIpO1xyXG4gICAgICB0aGlzLmRhdGFHcmlkLmhpZGVDb2x1bW4oXCJvbGRWYWx1ZVwiKTtcclxuICAgICAgdGhpcy5kYXRhR3JpZC5zZXRDb2x1bW5UaXRsZShcIm5ld1ZhbHVlXCIsIFwi5YC8XCIpO1xyXG4gICAgfSBlbHNlIGlmIChuZXdUeXBlID09IE9wZXJhdGVUeXBlLkRFTEVURSkge1xyXG4gICAgICB0aGlzLmRhdGFHcmlkLnNob3dDb2x1bW4oXCJvbGRWYWx1ZVwiKTtcclxuICAgICAgdGhpcy5kYXRhR3JpZC5oaWRlQ29sdW1uKFwibmV3VmFsdWVcIik7XHJcbiAgICAgIHRoaXMuZGF0YUdyaWQuc2V0Q29sdW1uVGl0bGUoXCJvbGRWYWx1ZVwiLCBcIuWAvFwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuZGF0YUdyaWQuc2hvd0NvbHVtbihcIm9sZFZhbHVlXCIpO1xyXG4gICAgICB0aGlzLmRhdGFHcmlkLnNob3dDb2x1bW4oXCJuZXdWYWx1ZVwiKTtcclxuICAgICAgdGhpcy5kYXRhR3JpZC5zZXRDb2x1bW5UaXRsZShcIm9sZFZhbHVlXCIsIFwi5Y6f5YC8XCIpO1xyXG4gICAgICB0aGlzLmRhdGFHcmlkLnNldENvbHVtblRpdGxlKFwibmV3VmFsdWVcIiwgXCLlj5jmm7TlgLxcIik7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGNoYW5nZXMuY2hnZHJUcmVlTm9kZSAmJiBjaGFuZ2VzLmNoZ2RyVHJlZU5vZGUuY3VycmVudFZhbHVlKSB7XHJcbiAgICAgIHRoaXMuZGF0YSA9IGNoYW5nZXMuY2hnZHJUcmVlTm9kZS5jdXJyZW50VmFsdWUuY2hnZHJSb3cuY2hhbmdlcztcclxuICAgIH1cclxuICB9XHJcblxyXG59XHJcbiJdfQ==