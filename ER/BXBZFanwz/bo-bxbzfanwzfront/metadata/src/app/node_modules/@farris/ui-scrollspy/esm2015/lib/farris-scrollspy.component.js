/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, ElementRef, Directive, TemplateRef, ContentChild, ViewChild, ChangeDetectorRef } from '@angular/core';
import { FarrisScrollSpyService } from './farris-scrollspy.service';
import { getUuid } from './utils';
export class ScrollspyItemTemplateDirective {
    /**
     * @param {?} template
     */
    constructor(template) {
        this.template = template;
    }
}
ScrollspyItemTemplateDirective.decorators = [
    { type: Directive, args: [{
                selector: '[scrollspyItem]'
            },] }
];
/** @nocollapse */
ScrollspyItemTemplateDirective.ctorParameters = () => [
    { type: TemplateRef }
];
if (false) {
    /** @type {?} */
    ScrollspyItemTemplateDirective.prototype.template;
}
/**
 * @record
 */
export function scrollspyData() { }
if (false) {
    /** @type {?} */
    scrollspyData.prototype.id;
    /** @type {?} */
    scrollspyData.prototype.title;
    /** @type {?|undefined} */
    scrollspyData.prototype.visible;
}
/**
 * @record
 */
function SpyListFollowTypeChange() { }
if (false) {
    /** @type {?} */
    SpyListFollowTypeChange.prototype.prev;
    /** @type {?} */
    SpyListFollowTypeChange.prototype.next;
}
export class ScrollspyComponent {
    /**
     * @param {?} elementRef
     * @param {?} scrollSpy
     * @param {?} changeDetector
     */
    constructor(elementRef, scrollSpy, changeDetector) {
        this.elementRef = elementRef;
        this.scrollSpy = scrollSpy;
        this.changeDetector = changeDetector;
        /**
         * 当前滚动所有group
         */
        this.scrollGroupId = getUuid();
        /**
         * 当前滚动显示样式，默认 side 可选参数 tab、fixedTab
         */
        this._followType = 'side';
        // 记录状态改变
        this._emitFollowType = null;
        this.sidetabWidth = 145;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set fFollowType(value) {
        if (value !== this._followType) {
            this._emitFollowType = {
                prev: this._followType,
                next: value
            };
            this.changeFollowType();
            this._followType = value;
        }
    }
    /**
     * @return {?}
     */
    get fFollowType() {
        return this._followType;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set scrollspyData(value) {
        if (value) {
            this._scrollspyData = value.filter((/**
             * @param {?} item
             * @return {?}
             */
            (item) => {
                if (item.hasOwnProperty('visible') && !item.visible) {
                    return false;
                }
                else {
                    return true;
                }
            }));
            if (this._scrollspyData && this._scrollspyData.length && !this.currentSectionId) {
                this.currentSectionId = this._scrollspyData[0].id;
            }
            this.scrollSpy.setCurrentSectionIdObj(this.scrollGroupId, this.currentSectionId);
            // console.log(this._scrollspyData);
        }
    }
    /**
     * @return {?}
     */
    get scrollspyData() {
        return this._scrollspyData;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        // if(this.scrollspyData && this.scrollspyData.length && !this.currentSectionId ){
        //   this.currentSectionId = this.scrollspyData[0].id;
        // }
        // this.scrollSpy.setCurrentSectionIdObj(this.scrollGroupId, this.currentSectionId);
        // console.log(this.scrollGroupId);
        this.scrollSpy.setGroupId(this.scrollGroupId);
        this.changeFollowType();
        // 获取当前Section的Id
        this.scrollSpy.getCurrentSectionId(this.scrollGroupId).subscribe((/**
         * @param {?} currentId
         * @return {?}
         */
        (currentId) => {
            this.currentSectionId = currentId;
            this.scrollSpy.updateScrollSpiesActiveClsName(this.scrollGroupId, currentId);
            //console.log(this.scrollGroupId,this.currentSectionId);
        }));
        // 获取对应Container区域，在滚动时的当前Section的变化
        this.scrollSpy.updateScrollGroup(this.scrollGroupId).subscribe((/**
         * @param {?} currentSection
         * @return {?}
         */
        (currentSection) => {
            //console.log('111',currentSection);
            this.scrollSpy.setCurrentSectionId(this.scrollGroupId, currentSection);
            //this.changeDetector.markForCheck();
        }));
    }
    // 改变FollowType时
    /**
     * @return {?}
     */
    changeFollowType() {
        if (this.scrollGroupId && this._emitFollowType) {
            this.scrollSpy.changeGroupIdFollowType(this.scrollGroupId, this._emitFollowType);
            this._emitFollowType = null;
        }
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        /**
         * 当滚动位置为side时，该组件最近父节点添加relative定位
         * @type {?}
         */
        const parent = this.elementRef.nativeElement.parentElement;
        if (!parent.style.position && parent.style.position !== 'relative' && this.fFollowType === 'side') {
            parent.style.position = 'relative';
        }
        // if(this.scrollspyData && this.scrollspyData.length && this.currentSectionId){
        //   if(this.currentSectionId !== this.scrollspyData[0].id){
        //     console.log(222);
        //     const element = this.scrollyspyListEl.nativeElement.querySelector("#scrollspy-"+this.currentSectionId);
        //     const follow = {
        //       element: element,
        //       id: this.currentSectionId
        //     };
        //     const groupId = this.scrollGroupId ? this.scrollGroupId: 'default';
        //     this.scrollSpy.fScrollFollowClick(groupId,follow);
        //   }
        // }
    }
}
ScrollspyComponent.decorators = [
    { type: Component, args: [{
                selector: 'farris-scrollspy',
                template: "<div class=\"f-scrollspy\" [ngClass]=\"{'f-scrollspy-sidetabs': fFollowType === 'side' && !scrollspyTemplate,'f-scrollspy-tabs': fFollowType === 'tab' ||fFollowType === 'fixedTab' && !scrollspyTemplate,'f-scrollspy-fixedTab':fFollowType === 'fixedTab'}\">\r\n    <ng-container *ngIf=\"fFollowType === 'side' && !scrollspyTemplate\">\r\n        <div class=\"f-scrollspy-sidetabs-inner\" [ngStyle]=\"{'width': (fFollowType === 'side' && !scrollspyTemplate)? sidetabWidth/16 + 'rem': '','transform': (fFollowType === 'side' && !scrollspyTemplate)? 'translateX('+(sidetabWidth/16 + 'rem') +')' : ''}\">\r\n            <ng-container [ngTemplateOutlet]=\"scrollspyListTemplate\"></ng-container>\r\n        </div>\r\n        <div class=\"f-scrollspy-monitor-tip\">\r\n            <div class=\"f-scrollspy-monitor-tip-inner\">\r\n                <span class=\"f-icon f-icon-navigation\"></span>\r\n                <span class=\"f-scrollspy-monitor-tip-text\">{{ 'scrollspy.guide' | locale }}</span>\r\n                <span class=\"f-scrollspy-monitor-tip-img\">\r\n                </span>\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-container *ngIf=\"fFollowType === 'tab'||fFollowType === 'fixedTab' || scrollspyTemplate\">\r\n        <ng-container [ngTemplateOutlet]=\"scrollspyListTemplate\"></ng-container>\r\n    </ng-container>\r\n</div>\r\n\r\n\r\n<ng-template #scrollspyListTemplate>\r\n    <ul #scrollyspyList class=\"f-scrollspy-monitor-list\">\r\n        <li class=\"f-scrollspy-monitor-btn\" \r\n        *ngFor=\"let tab of scrollspyData;let i = index;let first = first;let last = last;\"\r\n        [class.active]=\"tab['id'] === currentSectionId\" \r\n        [fScrollFollowElement]=\"tab['id']\"\r\n        [fScrollElement]=\"scrollGroupId\"\r\n        [id]=\"'scrollspy-'+tab['id']\"\r\n        [title]=\"tab.title\">\r\n            <ng-container *ngIf=\"!scrollspyTemplate;else scrollElement\">\r\n                <span class=\"f-scrollspy-monitor-title\">{{tab.title}}</span>\r\n            </ng-container>\r\n            <ng-template #scrollElement>\r\n                <ng-container [ngTemplateOutlet]=\"scrollspyTemplate\" [ngTemplateOutletContext]=\"{scrollItem:tab,first:first,last:last,index:i}\"></ng-container>\r\n            </ng-template>\r\n        </li>\r\n    </ul>\r\n</ng-template>",
                styles: [".f-scrollspy .f-scrollspy-monitor-btn{display:inline-block}.f-scrollspy-sidetabs{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-align:center;align-items:center;position:absolute;top:0;right:0;z-index:999;overflow:hidden;width:1.75rem;-webkit-transition:width .5s;transition:width .5s}.f-scrollspy-sidetabs .f-scrollspy-sidetabs-inner{-webkit-transition:.5s;transition:.5s;min-height:115px;background:#fff;box-shadow:0 2px 6px 0 rgba(57,66,100,.14);border-radius:4px 0 0 4px;overflow:hidden}.f-scrollspy-sidetabs:hover{width:auto}.f-scrollspy-sidetabs:hover .f-scrollspy-sidetabs-inner{-webkit-transform:translateX(0)!important;transform:translateX(0)!important}.f-scrollspy-sidetabs:hover .f-scrollspy-monitor-tip{border-radius:0}.f-scrollspy-sidetabs .f-scrollspy-monitor-btn{position:relative;width:100%;height:1.3125rem;padding-left:1.1875rem;margin-bottom:.75rem}.f-scrollspy-sidetabs .f-scrollspy-monitor-btn::before{content:\"\";position:absolute;left:0;top:1rem;height:2rem;width:1px;border-left:1px dashed #e9e9e9;background-color:transparent;border-radius:.5px;z-index:8}.f-scrollspy-sidetabs .f-scrollspy-monitor-btn:last-child{margin-bottom:0}.f-scrollspy-sidetabs .f-scrollspy-monitor-btn:last-child::before{display:none}.f-scrollspy-sidetabs .f-scrollspy-monitor-btn::after{content:\"\";position:absolute;left:-.4375rem;top:.1875rem;width:.9375rem;height:.9375rem;border-radius:100%;z-index:9}.f-scrollspy-sidetabs .f-scrollspy-monitor-btn .f-scrollspy-monitor-title{display:inline-block;font-size:.875rem;color:rgba(0,0,0,.55);line-height:1.3125rem;cursor:pointer;width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.f-scrollspy-sidetabs .f-scrollspy-monitor-btn.active .f-scrollspy-monitor-title{color:rgba(0,0,0,.65);font-weight:600}.f-scrollspy-sidetabs .f-scrollspy-monitor-tip{position:absolute;right:0;top:0;bottom:0;width:1.75rem;border-radius:4px 0 0 4px}.f-scrollspy-sidetabs .f-scrollspy-monitor-tip-inner{position:relative;width:100%;height:100%;padding-top:.625rem}.f-scrollspy-sidetabs .f-scrollspy-monitor-tip-inner .f-scrollspy-monitor-tip-img{position:absolute;left:0;bottom:0;width:1.75rem;height:2.9375rem;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAABeCAYAAAB2K9dZAAAABGdBTUEAALGPC/xhBQAABC5JREFUeAHtm2tT1DAUhlnviooiIKDAAjri+NH//3tERERQRBTX99lpdnZLgZLTNOlOzsyZtKXJnidvm2uZGQwGs/JbM1Nqd8S1A5sgT5WcyH/Kj3q9HuedNwCdPdABPs8FAZ8pOZZ/xwX8T2nnbBywHPw9XXhR+LmAD3V8ID8W7EBpJ+wqwHGA2zpxsGeC3dP5vkDPx29K8binYD96BsYjuy/fE+hvzzKCZ6urYFUgtLxL8kVV0helnwT6t+rGmNcsgC7ung4AXRDortLPAk2mQWqy/6OsVfkHgc4pTcKaBHRAtL5vBLkpv+suxkpDADoW+lPUfOYuxEhDAsJD97ItyDV56N+qrL+2fpRG6J0g71dGEfBiW4AgPJK/F+STgDwXim4TkB/nkX0rSEZFrVjbgEDRb/YFSZcS3GIAOqgVQa65k1BpTECYlkJDxgZ0kOvTqqDjYsAe5J1MQUEHyTvZeOuaEiCgG4J86oibSFMDpAvZEmRjI57UABGNwQAzEWDNliIgULPy12Y6FZAqIGz0keaJc8qAQG4IkkfW21IHZEXglTedMqYOCBuDgMe+kF0AhG1dkF6talcAHwrSa5TTxLqo79Nz03yrUvGgzpqr7kO45/K5LgHS4LC2w+JypRVgC/rjsny4ZNklQKCWBcFeyMTKeQG2WIBNME2cUELiRp+IQuxuDU1wvJ9bcvY2L1hXGpnxwBnhDFtUpcDuyCvhyISCK3K2q38VqZKkjZnGvOCYVg13o6+KFkDGe27Mx84toPixPNV9+r5iq2XldxDpWaDF6XfY2PwmP5JPvNg674SVActB8zjQ5L6UA/lVzscJnbHrAB0IyrpHmQ8R2LruhKI+rSgv9nYBrCRt8wGEiP6I1rcvj77JqRguNV9AVyD9z6acJYYkzQoIFGWwx3Btn8TNbVsTgC5mBsLMvmmQkrEmAYFic7OR1bCmaqhpQOLifTStozQFRzkhACkXJRkgRLdQgIDx+QjvZVQLCQgYLav3ilgTNRMakBgZEJgWby2gbQC6UY8lTu+8bQASHI+pm3N6B+uTse5swqfsch6mXEyi68xCUJ2P+khdjHxdzPeo+B95LXOZa91svImnhUaHqVaVMa6le6EfvXSNpcgI5I/C+S+BS78hbxOQ2ABkPjmuIqtiLB7dZMBO3HRDOLBU2qH8grUNOK4ixwwGrHvyMFAOlbcrP5GPrK1GZvSDOiAQVOvLrXAqYmS8s+tyVB1ZDEB+c0NOQCEMNUfDxBiAIaDKZaLiELLtd7AcSMhzIE+nVUFXccvTDhhsPuhqMHqaFYwugTGArKCxAqNnzwpGl8AYQFbQWIHRs2cFo0tgDCAraKzA6NmzgtElMAaQFTRWYPTsWcHoEhgDyAoaKzB69qxgdAmMAWQFjRUYPXtWMLoExgCygsYKjJ596hX8D3/gzAAeM1fWAAAAAElFTkSuQmCC);background-size:100%}.f-scrollspy-sidetabs .f-scrollspy-monitor-tip-inner .f-icon{display:block;margin:0 auto .625rem;font-size:.875rem;color:#fff}.f-scrollspy-sidetabs .f-scrollspy-monitor-tip-inner .f-scrollspy-monitor-tip-text{display:block;width:.75rem;margin:0 auto;font-size:.875rem;line-height:1.25rem;color:#fff;text-align:center;text-shadow:0 1px 4px rgba(0,0,0,.06);word-wrap:break-word}.f-scrollspy-sidetabs .f-scrollspy-sidetabs-inner .f-scrollspy-monitor-list{padding:.75rem 3rem .875rem 1.25rem;-webkit-transition:.5s;transition:.5s}.f-scrollspy-tabs{flex-shrink:0;background-color:#fff;box-shadow:0 1px 5px 0 rgba(0,28,64,.06);border-radius:2px;padding:0 .125rem}.f-scrollspy-tabs .f-scrollspy-monitor-btn{position:relative;display:-webkit-inline-box;display:inline-flex;height:2.75rem;line-height:2.75rem;padding:0 .875rem;cursor:pointer;min-width:5.75rem;white-space:nowrap;-webkit-box-pack:center;justify-content:center}.f-scrollspy-tabs .f-scrollspy-monitor-btn .f-scrollspy-monitor-title{white-space:nowrap;font-size:1rem}.f-scrollspy-tabs .f-scrollspy-monitor-btn::after{content:\"\";position:absolute;left:50%;margin-left:-.625rem;bottom:.3125rem;width:1.25rem;height:.1875rem;border-radius:7.125rem}"]
            }] }
];
/** @nocollapse */
ScrollspyComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: FarrisScrollSpyService },
    { type: ChangeDetectorRef }
];
ScrollspyComponent.propDecorators = {
    scrollspyTemplate: [{ type: ContentChild, args: [ScrollspyItemTemplateDirective, { read: TemplateRef },] }],
    currentSectionId: [{ type: Input }],
    scrollGroupId: [{ type: Input }],
    fFollowType: [{ type: Input }],
    sidetabWidth: [{ type: Input }],
    scrollyspyListEl: [{ type: ViewChild, args: ["scrollyspyList",] }],
    scrollspyData: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    ScrollspyComponent.prototype.scrollspyTemplate;
    /**
     * 当前active部分id
     * @type {?}
     */
    ScrollspyComponent.prototype.currentSectionId;
    /**
     * 当前滚动所有group
     * @type {?}
     */
    ScrollspyComponent.prototype.scrollGroupId;
    /**
     * 当前滚动显示样式，默认 side 可选参数 tab、fixedTab
     * @type {?}
     * @private
     */
    ScrollspyComponent.prototype._followType;
    /**
     * @type {?}
     * @private
     */
    ScrollspyComponent.prototype._emitFollowType;
    /** @type {?} */
    ScrollspyComponent.prototype.sidetabWidth;
    /** @type {?} */
    ScrollspyComponent.prototype.scrollyspyListEl;
    /** @type {?} */
    ScrollspyComponent.prototype._scrollspyData;
    /**
     * @type {?}
     * @private
     */
    ScrollspyComponent.prototype.elementRef;
    /**
     * @type {?}
     * @private
     */
    ScrollspyComponent.prototype.scrollSpy;
    /**
     * @type {?}
     * @private
     */
    ScrollspyComponent.prototype.changeDetector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmFycmlzLXNjcm9sbHNweS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLXNjcm9sbHNweS8iLCJzb3VyY2VzIjpbImxpYi9mYXJyaXMtc2Nyb2xsc3B5LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxLQUFLLEVBQUUsVUFBVSxFQUE0QixTQUFTLEVBQUUsV0FBVyxFQUFFLFlBQVksRUFBRSxTQUFTLEVBQUUsaUJBQWlCLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDbEssT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFFcEUsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLFNBQVMsQ0FBQztBQUtoQyxNQUFNLE9BQU8sOEJBQThCOzs7O0lBQ3pDLFlBQW1CLFFBQTBCO1FBQTFCLGFBQVEsR0FBUixRQUFRLENBQWtCO0lBQUcsQ0FBQzs7O1lBSnBELFNBQVMsU0FBQztnQkFDUCxRQUFRLEVBQUUsaUJBQWlCO2FBQzVCOzs7O1lBUGlGLFdBQVc7Ozs7SUFTL0Usa0RBQWlDOzs7OztBQUdqRCxtQ0FJRzs7O0lBSEMsMkJBQWE7O0lBQ2IsOEJBQWdCOztJQUNoQixnQ0FBbUI7Ozs7O0FBR3ZCLHNDQUdDOzs7SUFGQyx1Q0FBWTs7SUFDWix1Q0FBVzs7QUFVYixNQUFNLE9BQU8sa0JBQWtCOzs7Ozs7SUF5RDNCLFlBQXFCLFVBQXNCLEVBQVUsU0FBaUMsRUFBUyxjQUFpQztRQUEzRyxlQUFVLEdBQVYsVUFBVSxDQUFZO1FBQVUsY0FBUyxHQUFULFNBQVMsQ0FBd0I7UUFBUyxtQkFBYyxHQUFkLGNBQWMsQ0FBbUI7Ozs7UUFqRHZILGtCQUFhLEdBQVUsT0FBTyxFQUFFLENBQUM7Ozs7UUFFbEMsZ0JBQVcsR0FBQyxNQUFNLENBQUM7O1FBRW5CLG9CQUFlLEdBQXlCLElBQUksQ0FBQztRQWdCNUMsaUJBQVksR0FBVSxHQUFHLENBQUM7SUE2Qm1H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Y0FFTCxNQUFNLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxhQUFhLENBQUMsYUFBYTtRQUMxRCxJQUFHLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxRQUFRLElBQUksTUFBTSxDQUFDLEtBQUssQ0FBQyxRQUFRLEtBQUssVUFBVSxJQUFJLElBQUksQ0FBQyxXQUFXLEtBQUssTUFBTSxFQUFDO1lBQzdGLE1BQU0sQ0FBQyxLQUFLLENBQUMsUUFBUSxHQUFHLFVBQVUsQ0FBQztTQUN0QztRQUNELGdGQUFnRjtRQUNoRiw0REFBNEQ7UUFDNUQsd0JBQXdCO1FBQ3hCLDhHQUE4RztRQUM5Ryx1QkFBdUI7UUFDdkIsMEJBQTBCO1FBQzFCLGtDQUFrQztRQUNsQyxTQUFTO1FBQ1QsMEVBQTBFO1FBQzFFLHlEQUF5RDtRQUN6RCxNQUFNO1FBQ04sSUFBSTtJQUVSLENBQUM7OztZQW5ISixTQUFTLFNBQUM7Z0JBQ1QsUUFBUSxFQUFFLGtCQUFrQjtnQkFDNUIsNHlFQUErQzs7YUFJaEQ7Ozs7WUE3QmtDLFVBQVU7WUFDcEMsc0JBQXNCO1lBRDJGLGlCQUFpQjs7O2dDQWdDdEksWUFBWSxTQUFDLDhCQUE4QixFQUFFLEVBQUMsSUFBSSxFQUFFLFdBQVcsRUFBQzsrQkFJaEUsS0FBSzs0QkFFTCxLQUFLOzBCQUtMLEtBQUs7MkJBZUwsS0FBSzsrQkFFTCxTQUFTLFNBQUMsZ0JBQWdCOzRCQUkxQixLQUFLOzs7O0lBaENOLCtDQUF1Rzs7Ozs7SUFJdkcsOENBQWlDOzs7OztJQUVqQywyQ0FBMEM7Ozs7OztJQUUxQyx5Q0FBMkI7Ozs7O0lBRTNCLDZDQUFxRDs7SUFnQnJELDBDQUFtQzs7SUFFbkMsOENBQThDOztJQUU5Qyw0Q0FBK0I7Ozs7O0lBeUJsQix3Q0FBOEI7Ozs7O0lBQUUsdUNBQXlDOzs7OztJQUFDLDRDQUF5QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgRWxlbWVudFJlZiwgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95LCBEaXJlY3RpdmUsIFRlbXBsYXRlUmVmLCBDb250ZW50Q2hpbGQsIFZpZXdDaGlsZCwgQ2hhbmdlRGV0ZWN0b3JSZWZ9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBGYXJyaXNTY3JvbGxTcHlTZXJ2aWNlIH0gZnJvbSAnLi9mYXJyaXMtc2Nyb2xsc3B5LnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IGdldFV1aWQgfSBmcm9tICcuL3V0aWxzJztcclxuXHJcbkBEaXJlY3RpdmUoe1xyXG4gICAgc2VsZWN0b3I6ICdbc2Nyb2xsc3B5SXRlbV0nXHJcbiAgfSlcclxuICBleHBvcnQgY2xhc3MgU2Nyb2xsc3B5SXRlbVRlbXBsYXRlRGlyZWN0aXZlIHtcclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyB0ZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55Pikge31cclxuICB9XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIHNjcm9sbHNweURhdGEge1xyXG4gICAgXCJpZFwiOiBzdHJpbmcsXHJcbiAgICBcInRpdGxlXCI6IHN0cmluZyxcclxuICAgIFwidmlzaWJsZVwiPzogYm9vbGVhblxyXG4gIH1cclxuLy8g5rua5Yqo55uR5ZCs5YiX6KGo77yM5pi+56S65qih5byP5pS55Y+Y77yM5oqb5Ye65LqL5Lu257uT5p6EXHJcbmludGVyZmFjZSBTcHlMaXN0Rm9sbG93VHlwZUNoYW5nZXtcclxuICBwcmV2OnN0cmluZyxcclxuICBuZXh0OnN0cmluZ1xyXG59XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2ZhcnJpcy1zY3JvbGxzcHknLFxyXG4gIHRlbXBsYXRlVXJsOicuL2ZhcnJpcy1zY3JvbGxzcHkuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczpbXHJcbiAgICAnLi9mYXJyaXMtc2Nyb2xsc3B5LmNvbXBvbmVudC5zY3NzJ1xyXG4gIF1cclxufSlcclxuZXhwb3J0IGNsYXNzIFNjcm9sbHNweUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCxBZnRlclZpZXdJbml0IHtcclxuXHJcbiAgICBAQ29udGVudENoaWxkKFNjcm9sbHNweUl0ZW1UZW1wbGF0ZURpcmVjdGl2ZSwge3JlYWQ6IFRlbXBsYXRlUmVmfSkgc2Nyb2xsc3B5VGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgICAvKirmu5rliqjmlbDmja7liJfooaggKi9cclxuICAgIC8vIEBJbnB1dCgpIHNjcm9sbHNweURhdGE6c2Nyb2xsc3B5RGF0YVtdO1xyXG4gICAgLyoq5b2T5YmNYWN0aXZl6YOo5YiGaWQgKi9cclxuICAgIEBJbnB1dCgpIGN1cnJlbnRTZWN0aW9uSWQ6c3RyaW5nO1xyXG4gICAgLyoq5b2T5YmN5rua5Yqo5omA5pyJZ3JvdXAgKi9cclxuICAgIEBJbnB1dCgpIHNjcm9sbEdyb3VwSWQ6c3RyaW5nID0gZ2V0VXVpZCgpO1xyXG4gICAgLyoq5b2T5YmN5rua5Yqo5pi+56S65qC35byP77yM6buY6K6kIHNpZGUg5Y+v6YCJ5Y+C5pWwIHRhYuOAgWZpeGVkVGFiICovXHJcbiAgICBwcml2YXRlIF9mb2xsb3dUeXBlPSdzaWRlJztcclxuICAgIC8vIOiusOW9leeKtuaAgeaUueWPmFxyXG4gICAgcHJpdmF0ZSBfZW1pdEZvbGxvd1R5cGU6U3B5TGlzdEZvbGxvd1R5cGVDaGFuZ2U9bnVsbDtcclxuICAgIEBJbnB1dCgpIFxyXG4gICAgc2V0IGZGb2xsb3dUeXBlKHZhbHVlOnN0cmluZyl7XHJcbiAgICAgIGlmKHZhbHVlIT09dGhpcy5fZm9sbG93VHlwZSl7XHJcbiAgICAgICAgdGhpcy5fZW1pdEZvbGxvd1R5cGU9e1xyXG4gICAgICAgICAgcHJldjp0aGlzLl9mb2xsb3dUeXBlLFxyXG4gICAgICAgICAgbmV4dDp2YWx1ZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VGb2xsb3dUeXBlKCk7XHJcbiAgICAgICAgdGhpcy5fZm9sbG93VHlwZT12YWx1ZTtcclxuICAgICAgfVxyXG4gICAgfSAgICBcclxuICAgIGdldCBmRm9sbG93VHlwZSgpOnN0cmluZ3tcclxuICAgICAgcmV0dXJuIHRoaXMuX2ZvbGxvd1R5cGU7XHJcbiAgICB9XHJcblxyXG4gICAgQElucHV0KCkgc2lkZXRhYldpZHRoOm51bWJlciA9IDE0NTtcclxuXHJcbiAgICBAVmlld0NoaWxkKFwic2Nyb2xseXNweUxpc3RcIikgc2Nyb2xseXNweUxpc3RFbDtcclxuXHJcbiAgICBfc2Nyb2xsc3B5RGF0YTpzY3JvbGxzcHlEYXRhW107XHJcblxyXG4gICAgQElucHV0KClcclxuICAgIHNldCBzY3JvbGxzcHlEYXRhKHZhbHVlKXtcclxuICAgICAgaWYodmFsdWUpe1xyXG4gICAgICAgIHRoaXMuX3Njcm9sbHNweURhdGEgPSB2YWx1ZS5maWx0ZXIoKGl0ZW0pID0+e1xyXG4gICAgICAgICAgaWYoaXRlbS5oYXNPd25Qcm9wZXJ0eSgndmlzaWJsZScpICYmICFpdGVtLnZpc2libGUpe1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmKHRoaXMuX3Njcm9sbHNweURhdGEgJiYgdGhpcy5fc2Nyb2xsc3B5RGF0YS5sZW5ndGggJiYgIXRoaXMuY3VycmVudFNlY3Rpb25JZCApe1xyXG4gICAgICAgICAgdGhpcy5jdXJyZW50U2VjdGlvbklkID0gdGhpcy5fc2Nyb2xsc3B5RGF0YVswXS5pZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zY3JvbGxTcHkuc2V0Q3VycmVudFNlY3Rpb25JZE9iaih0aGlzLnNjcm9sbEdyb3VwSWQsIHRoaXMuY3VycmVudFNlY3Rpb25JZCk7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5fc2Nyb2xsc3B5RGF0YSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGdldCBzY3JvbGxzcHlEYXRhKCl7XHJcbiAgICAgIHJldHVybiB0aGlzLl9zY3JvbGxzcHlEYXRhO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBjb25zdHJ1Y3RvciggcHJpdmF0ZSBlbGVtZW50UmVmOiBFbGVtZW50UmVmLCBwcml2YXRlIHNjcm9sbFNweTogRmFycmlzU2Nyb2xsU3B5U2VydmljZSxwcml2YXRlIGNoYW5nZURldGVjdG9yOiBDaGFuZ2VEZXRlY3RvclJlZiwgKSB7IH1cclxuXHJcbiAgICBuZ09uSW5pdCgpIHtcclxuICAgICAgLy8gaWYodGhpcy5zY3JvbGxzcHlEYXRhICYmIHRoaXMuc2Nyb2xsc3B5RGF0YS5sZW5ndGggJiYgIXRoaXMuY3VycmVudFNlY3Rpb25JZCApe1xyXG4gICAgICAvLyAgIHRoaXMuY3VycmVudFNlY3Rpb25JZCA9IHRoaXMuc2Nyb2xsc3B5RGF0YVswXS5pZDtcclxuICAgICAgLy8gfVxyXG4gICAgICAvLyB0aGlzLnNjcm9sbFNweS5zZXRDdXJyZW50U2VjdGlvbklkT2JqKHRoaXMuc2Nyb2xsR3JvdXBJZCwgdGhpcy5jdXJyZW50U2VjdGlvbklkKTtcclxuICAgICAgLy8gY29uc29sZS5sb2codGhpcy5zY3JvbGxHcm91cElkKTtcclxuICAgICAgdGhpcy5zY3JvbGxTcHkuc2V0R3JvdXBJZCh0aGlzLnNjcm9sbEdyb3VwSWQpO1xyXG4gICAgICB0aGlzLmNoYW5nZUZvbGxvd1R5cGUoKTtcclxuICAgICAgLy8g6I635Y+W5b2T5YmNU2VjdGlvbueahElkXHJcbiAgICAgIHRoaXMuc2Nyb2xsU3B5LmdldEN1cnJlbnRTZWN0aW9uSWQodGhpcy5zY3JvbGxHcm91cElkKS5zdWJzY3JpYmUoKGN1cnJlbnRJZCk9PntcclxuICAgICAgICB0aGlzLmN1cnJlbnRTZWN0aW9uSWQgPSBjdXJyZW50SWQ7XHJcbiAgICAgICAgdGhpcy5zY3JvbGxTcHkudXBkYXRlU2Nyb2xsU3BpZXNBY3RpdmVDbHNOYW1lKHRoaXMuc2Nyb2xsR3JvdXBJZCxjdXJyZW50SWQpO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2codGhpcy5zY3JvbGxHcm91cElkLHRoaXMuY3VycmVudFNlY3Rpb25JZCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8g6I635Y+W5a+55bqUQ29udGFpbmVy5Yy65Z+f77yM5Zyo5rua5Yqo5pe255qE5b2T5YmNU2VjdGlvbueahOWPmOWMllxyXG4gICAgICB0aGlzLnNjcm9sbFNweS51cGRhdGVTY3JvbGxHcm91cCh0aGlzLnNjcm9sbEdyb3VwSWQpLnN1YnNjcmliZSgoY3VycmVudFNlY3Rpb246IHN0cmluZyk6IHZvaWQgPT4ge1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coJzExMScsY3VycmVudFNlY3Rpb24pO1xyXG4gICAgICAgICAgdGhpcy5zY3JvbGxTcHkuc2V0Q3VycmVudFNlY3Rpb25JZCh0aGlzLnNjcm9sbEdyb3VwSWQsY3VycmVudFNlY3Rpb24pO1xyXG5cclxuICAgICAgICAgIC8vdGhpcy5jaGFuZ2VEZXRlY3Rvci5tYXJrRm9yQ2hlY2soKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8vIOaUueWPmEZvbGxvd1R5cGXml7ZcclxuICAgIGNoYW5nZUZvbGxvd1R5cGUoKXtcclxuICAgICAgaWYodGhpcy5zY3JvbGxHcm91cElkJiZ0aGlzLl9lbWl0Rm9sbG93VHlwZSl7XHJcbiAgICAgICAgdGhpcy5zY3JvbGxTcHkuY2hhbmdlR3JvdXBJZEZvbGxvd1R5cGUodGhpcy5zY3JvbGxHcm91cElkLHRoaXMuX2VtaXRGb2xsb3dUeXBlKTtcclxuICAgICAgICB0aGlzLl9lbWl0Rm9sbG93VHlwZT1udWxsO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBuZ0FmdGVyVmlld0luaXQoKTogdm9pZCB7XHJcbiAgICAgICAgLyoq5b2T5rua5Yqo5L2N572u5Li6c2lkZeaXtu+8jOivpee7hOS7tuacgOi/keeItuiKgueCuea3u+WKoHJlbGF0aXZl5a6a5L2NICovXHJcbiAgICAgICAgY29uc3QgcGFyZW50ID0gdGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQucGFyZW50RWxlbWVudDtcclxuICAgICAgICBpZighcGFyZW50LnN0eWxlLnBvc2l0aW9uICYmIHBhcmVudC5zdHlsZS5wb3NpdGlvbiAhPT0gJ3JlbGF0aXZlJyAmJiB0aGlzLmZGb2xsb3dUeXBlID09PSAnc2lkZScpe1xyXG4gICAgICAgICAgICBwYXJlbnQuc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBpZih0aGlzLnNjcm9sbHNweURhdGEgJiYgdGhpcy5zY3JvbGxzcHlEYXRhLmxlbmd0aCAmJiB0aGlzLmN1cnJlbnRTZWN0aW9uSWQpe1xyXG4gICAgICAgIC8vICAgaWYodGhpcy5jdXJyZW50U2VjdGlvbklkICE9PSB0aGlzLnNjcm9sbHNweURhdGFbMF0uaWQpe1xyXG4gICAgICAgIC8vICAgICBjb25zb2xlLmxvZygyMjIpO1xyXG4gICAgICAgIC8vICAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5zY3JvbGx5c3B5TGlzdEVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNzY3JvbGxzcHktXCIrdGhpcy5jdXJyZW50U2VjdGlvbklkKTtcclxuICAgICAgICAvLyAgICAgY29uc3QgZm9sbG93ID0ge1xyXG4gICAgICAgIC8vICAgICAgIGVsZW1lbnQ6IGVsZW1lbnQsXHJcbiAgICAgICAgLy8gICAgICAgaWQ6IHRoaXMuY3VycmVudFNlY3Rpb25JZFxyXG4gICAgICAgIC8vICAgICB9O1xyXG4gICAgICAgIC8vICAgICBjb25zdCBncm91cElkID0gdGhpcy5zY3JvbGxHcm91cElkID8gdGhpcy5zY3JvbGxHcm91cElkOiAnZGVmYXVsdCc7XHJcbiAgICAgICAgLy8gICAgIHRoaXMuc2Nyb2xsU3B5LmZTY3JvbGxGb2xsb3dDbGljayhncm91cElkLGZvbGxvdyk7XHJcbiAgICAgICAgLy8gICB9XHJcbiAgICAgICAgLy8gfVxyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxufSJdfQ==