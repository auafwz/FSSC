/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, TemplateRef, ElementRef, ViewChild, ViewContainerRef, ViewEncapsulation, Renderer2 } from '@angular/core';
export class TooltipComponent {
    /**
     * @param {?} el
     * @param {?} render
     */
    constructor(el, render) {
        this.el = el;
        this.render = render;
        this.contentIsString = true;
        this._tipWidth = '';
        this._tipCls = '';
        /* 位置 */
        this.placement = 'top';
        /* 位置样式 */
        this.positionStyle = {};
    }
    /* 普通文本内容 */
    /**
     * @param {?} value
     * @return {?}
     */
    set content(value) {
        if (value instanceof TemplateRef) {
            this.contentIsString = false;
            this.contentViewf.createEmbeddedView(value);
        }
        else {
            this.contentIsString = true;
            this.nfContent = value;
        }
    }
    /**
     * @return {?}
     */
    get content() {
        return this.nfContent;
    }
    /**
     * 因为表单生成没有排除factory,不能使用模板
     * @param {?} value
     * @return {?}
     */
    set tipWidth(value) {
        if (value != this._tipWidth) {
            if (value) {
                this.render.setStyle(this.innerNode.nativeElement, 'width', value);
                this.render.setStyle(this.innerNode.nativeElement, 'max-width', 'none');
            }
            else {
                this.render.removeStyle(this.innerNode.nativeElement, 'width');
                this.render.removeStyle(this.innerNode.nativeElement, 'max-width');
            }
            this._tipWidth = value;
        }
    }
    /**
     * @return {?}
     */
    get tipWidth() {
        return this._tipWidth;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set tipCls(value) {
        if (value != this._tipCls) {
            //移除旧样式
            this._tipCls && this.render.removeClass(this.el.nativeElement, this._tipCls);
            //追加新样式
            value && this.render.addClass(this.el.nativeElement, value);
            this._tipCls = value;
        }
    }
    /**
     * @return {?}
     */
    get tipCls() {
        return this._tipCls;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        if (this.hostBoundingClientRect) {
            this.judgeWidth();
            this.calculatePosition(this.hostBoundingClientRect);
        }
    }
    /**
     * 规则判断默认样式下出现滚动条，尺寸从默认变成大号
     * @return {?}
     */
    judgeWidth() {
        if (this.innerNode.nativeElement.scrollHeight > this.innerNode.nativeElement.clientHeight) {
            this.render.addClass(this.innerNode.nativeElement, 'tooltip-inner-lg');
        }
    }
    /* 计算tooltip最新位置 */
    /**
     * @param {?} hostPosition
     * @return {?}
     */
    calculatePosition(hostPosition) {
        /** @type {?} */
        let top = 0;
        /** @type {?} */
        let left = 0;
        /** @type {?} */
        const tooltipSize = this.tooltipNode.nativeElement.getBoundingClientRect();
        /** @type {?} */
        const arrowSize = this.arrowNode.nativeElement.getBoundingClientRect();
        if (this.placement === 'top') {
            top = hostPosition.top - tooltipSize.height - 2;
            left = hostPosition.left + (hostPosition.width - tooltipSize.width) / 2;
        }
        else if (this.placement === 'left') {
            top = hostPosition.top + (hostPosition.height - tooltipSize.height) / 2;
            left = hostPosition.left - tooltipSize.width - 2;
        }
        else if (this.placement === 'right') {
            top = hostPosition.top + (hostPosition.height - tooltipSize.height) / 2;
            left = hostPosition.right + 2;
        }
        else if (this.placement === 'bottom') {
            top = hostPosition.bottom + arrowSize.height + 2;
            left = hostPosition.left + (hostPosition.width - tooltipSize.width) / 2;
        }
        else if (this.placement === 'top-left') {
            top = hostPosition.top - tooltipSize.height - 2;
            left = hostPosition.left;
            this.arrowNode.nativeElement.style.left = '10%';
        }
        else if (this.placement === 'top-right') {
            top = hostPosition.top - tooltipSize.height - 2;
            left = hostPosition.right - tooltipSize.width;
            this.arrowNode.nativeElement.style.right = '10%';
        }
        else if (this.placement === 'right-top') {
            top = hostPosition.top;
            left = hostPosition.right + 2;
            this.arrowNode.nativeElement.style.top = '10%';
        }
        else if (this.placement === 'right-bottom') {
            top = hostPosition.bottom - tooltipSize.height;
            left = hostPosition.right + 2;
            this.arrowNode.nativeElement.style.bottom = '10%';
        }
        else if (this.placement === 'bottom-left') {
            top = hostPosition.bottom + arrowSize.height + 2;
            left = hostPosition.left;
            this.arrowNode.nativeElement.style.left = '10%';
        }
        else if (this.placement === 'bottom-right') {
            top = hostPosition.bottom + arrowSize.height + 2;
            left = hostPosition.right - tooltipSize.width;
            this.arrowNode.nativeElement.style.right = '10%';
        }
        else if (this.placement === 'left-top') {
            top = hostPosition.top;
            left = hostPosition.left - tooltipSize.width - 2;
            this.arrowNode.nativeElement.style.top = '10%';
        }
        else if (this.placement === 'left-bottom') {
            top = hostPosition.bottom - tooltipSize.height;
            left = hostPosition.left - tooltipSize.width - 2;
            this.arrowNode.nativeElement.style.bottom = '10%';
        }
        this.tooltipNode.nativeElement.style.top = top + 'px';
        this.tooltipNode.nativeElement.style.left = left + 'px';
    }
    /*
        *12个位置名解析
        * 因表单生成没有排除factory,而且使用了[class],只能在此处变更
        */
    /**
     * @return {?}
     */
    offsetDirection() {
        /** @type {?} */
        const placement = this.placement;
        if (placement.indexOf('-') !== -1) {
            /** @type {?} */
            const index = placement.indexOf('-');
            return placement.substring(0, index);
        }
        return placement;
    }
}
TooltipComponent.decorators = [
    { type: Component, args: [{
                selector: 'farris-tooltip',
                template: "<div #tooltipEle [class]=\"('bs-tooltip-'+offsetDirection())+' tooltip show'\">\r\n    <div #arrowEle class=\"arrow\"></div>\r\n    <div #innerEle class=\"tooltip-inner\">\r\n        <div #contentViewf class=\"tooltip-tmpl\">\r\n            <div *ngIf=\"contentIsString\" class=\"tooltip-text\" [innerHtml]=\"nfContent|tooltipHtml\"></div>\r\n            <ng-container *ngIf=\"!contentIsString\"> {{nfContent}}</ng-container>\r\n        </div>       \r\n    </div>\r\n</div>",
                encapsulation: ViewEncapsulation.None,
                styles: [".bs-tooltip-bottom .arrow,.bs-tooltip-top .arrow{left:50%}.bs-tooltip-left .arrow,.bs-tooltip-right .arrow{top:25%}"]
            }] }
];
/** @nocollapse */
TooltipComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: Renderer2 }
];
TooltipComponent.propDecorators = {
    contentViewf: [{ type: ViewChild, args: ['contentViewf', { read: ViewContainerRef },] }],
    tooltipNode: [{ type: ViewChild, args: ['tooltipEle', { read: ElementRef },] }],
    arrowNode: [{ type: ViewChild, args: ['arrowEle', { read: ElementRef },] }],
    innerNode: [{ type: ViewChild, args: ['innerEle', { read: ElementRef },] }],
    content: [{ type: Input }],
    tipWidth: [{ type: Input }],
    tipCls: [{ type: Input }],
    placement: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    TooltipComponent.prototype.contentViewf;
    /** @type {?} */
    TooltipComponent.prototype.tooltipNode;
    /** @type {?} */
    TooltipComponent.prototype.arrowNode;
    /** @type {?} */
    TooltipComponent.prototype.innerNode;
    /** @type {?} */
    TooltipComponent.prototype.contentIsString;
    /**
     * @type {?}
     * @private
     */
    TooltipComponent.prototype._tipWidth;
    /**
     * @type {?}
     * @private
     */
    TooltipComponent.prototype._tipCls;
    /** @type {?} */
    TooltipComponent.prototype.placement;
    /** @type {?} */
    TooltipComponent.prototype.hostBoundingClientRect;
    /** @type {?} */
    TooltipComponent.prototype.nfContent;
    /** @type {?} */
    TooltipComponent.prototype.positionStyle;
    /** @type {?} */
    TooltipComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    TooltipComponent.prototype.render;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9vbHRpcC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLXRvb2x0aXAvIiwic291cmNlcyI6WyJsaWIvdG9vbHRpcC1jb21wb25lbnQvdG9vbHRpcC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFDSCxTQUFTLEVBQUUsS0FBSyxFQUFFLFdBQVcsRUFBRSxVQUFVLEVBQ3pDLFNBQVMsRUFBRSxnQkFBZ0IsRUFBZSxpQkFBaUIsRUFBaUIsU0FBUyxFQUN4RixNQUFNLGVBQWUsQ0FBQztBQVN2QixNQUFNLE9BQU8sZ0JBQWdCOzs7OztJQWlFekIsWUFDVyxFQUFjLEVBQ2IsTUFBaUI7UUFEbEIsT0FBRSxHQUFGLEVBQUUsQ0FBWTtRQUNiLFdBQU0sR0FBTixNQUFNLENBQVc7UUEzRDdCLG9CQUFlLEdBQUcsSUFBSSxDQUFDO1FBZWYsY0FBUyxHQUFHLEVBQUUsQ0FBQztRQWtCZixZQUFPLEdBQUcsRUFBRSxDQUFDOztRQWVaLGNBQVMsR0FBRyxLQUFLLENBQUM7O1FBTzNCLGtCQUFhLEdBQUcsRUFBRSxDQUFDO0lBTW5CLENBQUM7Ozs7OztJQTNERCxJQUNJLE9BQU8sQ0FBQyxLQUFnQztRQUN4QyxJQUFJLEtBQUssWUFBWSxXQUFXLEVBQUU7WUFDOUIsSUFBSSxDQUFDLGVBQWUsR0FBRyxLQUFLLENBQUM7WUFDN0IsSUFBSSxDQUFDLFlBQVksQ0FBQyxrQkFBa0IsQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUMvQzthQUFNO1lBQ0gsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLENBQUM7WUFDNUIsSUFBSSxDQUFDLFNBQVMsR0FBRyxLQUFLLENBQUM7U0FDMUI7SUFDTCxDQUFDOzs7O0lBQ0QsSUFBSSxPQUFPO1FBQ1AsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDO0lBQzFCLENBQUM7Ozs7OztJQUdELElBQ0ksUUFBUSxDQUFDLEtBQUs7UUFDZCxJQUFJLEtBQUssSUFBSSxJQUFJLENBQUMsU0FBUyxFQUFFO1lBQ3pCLElBQUksS0FBSyxFQUFFO2dCQUNQLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxFQUFFLE9BQU8sRUFBRSxLQUFLLENBQUMsQ0FBQztnQkFDbkUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLEVBQUUsV0FBVyxFQUFFLE1BQU0sQ0FBQyxDQUFDO2FBQzNFO2lCQUFJO2dCQUNELElBQUksQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxFQUFFLE9BQU8sQ0FBQyxDQUFDO2dCQUMvRCxJQUFJLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsRUFBRSxXQUFXLENBQUMsQ0FBQzthQUN0RTtZQUNELElBQUksQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDO1NBQzFCO0lBQ0wsQ0FBQzs7OztJQUNELElBQUksUUFBUTtRQUNSLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQztJQUMxQixDQUFDOzs7OztJQUVELElBQ0ksTUFBTSxDQUFDLEtBQUs7UUFDWixJQUFJLEtBQUssSUFBSSxJQUFJLENBQUMsT0FBTyxFQUFFO1lBQ3ZCLE9BQU87WUFDUCxJQUFJLENBQUMsT0FBTyxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsYUFBYSxFQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUM3RSxPQUFPO1lBQ1AsS0FBSyxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsYUFBYSxFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQzVELElBQUksQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDO1NBQ3hCO0lBQ0wsQ0FBQzs7OztJQUNELElBQUksTUFBTTtRQUNOLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQztJQUN4QixDQUFDOzs7O0lBaUJELFFBQVE7SUFDUixDQUFDOzs7O0lBQ0QsZUFBZTtRQUNYLElBQUksSUFBSSxDQUFDLHNCQUFzQixFQUFFO1lBQzdCLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQztZQUNsQixJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLHNCQUFzQixDQUFDLENBQUM7U0FDdkQ7SUFDTCxDQUFDOzs7OztJQUlELFVBQVU7UUFDTixJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxZQUFZLEVBQUU7WUFDdkYsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLEVBQUUsa0JBQWtCLENBQUMsQ0FBQztTQUMxRTtJQUNMLENBQUM7Ozs7OztJQUVELGlCQUFpQixDQUFDLFlBQWlCOztZQUMzQixHQUFHLEdBQUcsQ0FBQzs7WUFDUCxJQUFJLEdBQUcsQ0FBQzs7Y0FDTixXQUFXLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxhQUFhLENBQUMscUJBQXFCLEVBQUU7O2NBQ3BFLFNBQVMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxxQkFBcUIsRUFBRTtRQUN0RSxJQUFJLElBQUksQ0FBQyxTQUFTLEtBQUssS0FBSyxFQUFFO1lBQzFCLEdBQUcsR0FBRyxZQUFZLENBQUMsR0FBRyxHQUFHLFdBQVcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO1lBQ2hELElBQUksR0FBRyxZQUFZLENBQUMsSUFBSSxHQUFHLENBQUMsWUFBWSxDQUFDLEtBQUssR0FBRyxXQUFXLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQzNFO2FBQU0sSUFBSSxJQUFJLENBQUMsU0FBUyxLQUFLLE1BQU0sRUFBRTtZQUNsQyxHQUFHLEdBQUcsWUFBWSxDQUFDLEdBQUcsR0FBRyxDQUFDLFlBQVksQ0FBQyxNQUFNLEdBQUcsV0FBVyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUN4RSxJQUFJLEdBQUcsWUFBWSxDQUFDLElBQUksR0FBRyxXQUFXLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQztTQUNwRDthQUFNLElBQUksSUFBSSxDQUFDLFNBQVMsS0FBSyxPQUFPLEVBQUU7WUFDbkMsR0FBRyxHQUFHLFlBQVksQ0FBQyxHQUFHLEdBQUcsQ0FBQyxZQUFZLENBQUMsTUFBTSxHQUFHLFdBQVcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDeEUsSUFBSSxHQUFHLFlBQVksQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDO1NBQ2pDO2FBQU0sSUFBSSxJQUFJLENBQUMsU0FBUyxLQUFLLFFBQVEsRUFBRTtZQUNwQyxHQUFHLEdBQUcsWUFBWSxDQUFDLE1BQU0sR0FBRyxTQUFTLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztZQUNqRCxJQUFJLEdBQUcsWUFBWSxDQUFDLElBQUksR0FBRyxDQUFDLFlBQVksQ0FBQyxLQUFLLEdBQUcsV0FBVyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztTQUMzRTthQUFNLElBQUksSUFBSSxDQUFDLFNBQVMsS0FBSyxVQUFVLEVBQUU7WUFDdEMsR0FBRyxHQUFHLFlBQVksQ0FBQyxHQUFHLEdBQUcsV0FBVyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUM7WUFDaEQsSUFBSSxHQUFHLFlBQVksQ0FBQyxJQUFJLENBQUM7WUFDekIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLElBQUksR0FBRyxLQUFLLENBQUM7U0FDbkQ7YUFBTSxJQUFJLElBQUksQ0FBQyxTQUFTLEtBQUssV0FBVyxFQUFFO1lBQ3ZDLEdBQUcsR0FBRyxZQUFZLENBQUMsR0FBRyxHQUFHLFdBQVcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO1lBQ2hELElBQUksR0FBRyxZQUFZLENBQUMsS0FBSyxHQUFHLFdBQVcsQ0FBQyxLQUFLLENBQUM7WUFDOUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7U0FDcEQ7YUFBTSxJQUFJLElBQUksQ0FBQyxTQUFTLEtBQUssV0FBVyxFQUFFO1lBQ3ZDLEdBQUcsR0FBRyxZQUFZLENBQUMsR0FBRyxDQUFDO1lBQ3ZCLElBQUksR0FBRyxZQUFZLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQztZQUM5QixJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsR0FBRyxHQUFHLEtBQUssQ0FBQztTQUNsRDthQUFNLElBQUksSUFBSSxDQUFDLFNBQVMsS0FBSyxjQUFjLEVBQUU7WUFDMUMsR0FBRyxHQUFHLFlBQVksQ0FBQyxNQUFNLEdBQUcsV0FBVyxDQUFDLE1BQU0sQ0FBQztZQUMvQyxJQUFJLEdBQUcsWUFBWSxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUM7WUFDOUIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLE1BQU0sR0FBRyxLQUFLLENBQUM7U0FDckQ7YUFBTSxJQUFJLElBQUksQ0FBQyxTQUFTLEtBQUssYUFBYSxFQUFFO1lBQ3pDLEdBQUcsR0FBRyxZQUFZLENBQUMsTUFBTSxHQUFHLFNBQVMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO1lBQ2pELElBQUksR0FBRyxZQUFZLENBQUMsSUFBSSxDQUFDO1lBQ3pCLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxJQUFJLEdBQUcsS0FBSyxDQUFDO1NBQ25EO2FBQU0sSUFBSSxJQUFJLENBQUMsU0FBUyxLQUFLLGNBQWMsRUFBRTtZQUMxQyxHQUFHLEdBQUcsWUFBWSxDQUFDLE1BQU0sR0FBRyxTQUFTLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztZQUNqRCxJQUFJLEdBQUcsWUFBWSxDQUFDLEtBQUssR0FBRyxXQUFXLENBQUMsS0FBSyxDQUFDO1lBQzlDLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO1NBQ3BEO2FBQU0sSUFBSSxJQUFJLENBQUMsU0FBUyxLQUFLLFVBQVUsRUFBRTtZQUN0QyxHQUFHLEdBQUcsWUFBWSxDQUFDLEdBQUcsQ0FBQztZQUN2QixJQUFJLEdBQUcsWUFBWSxDQUFDLElBQUksR0FBRyxXQUFXLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQztZQUNqRCxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsR0FBRyxHQUFHLEtBQUssQ0FBQztTQUNsRDthQUFNLElBQUksSUFBSSxDQUFDLFNBQVMsS0FBSyxhQUFhLEVBQUU7WUFDekMsR0FBRyxHQUFHLFlBQVksQ0FBQyxNQUFNLEdBQUcsV0FBVyxDQUFDLE1BQU0sQ0FBQztZQUMvQyxJQUFJLEdBQUcsWUFBWSxDQUFDLElBQUksR0FBRyxXQUFXLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQztZQUNqRCxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQztTQUNyRDtRQUNELElBQUksQ0FBQyxXQUFXLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxHQUFHLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQztRQUN0RCxJQUFJLENBQUMsV0FBVyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsSUFBSSxHQUFHLElBQUksR0FBRyxJQUFJLENBQUM7SUFDNUQsQ0FBQzs7Ozs7Ozs7SUFNRCxlQUFlOztjQUNMLFNBQVMsR0FBRyxJQUFJLENBQUMsU0FBUztRQUNoQyxJQUFJLFNBQVMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUU7O2tCQUN6QixLQUFLLEdBQUcsU0FBUyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUM7WUFDcEMsT0FBTyxTQUFTLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQztTQUN4QztRQUNELE9BQU8sU0FBUyxDQUFDO0lBQ3JCLENBQUM7OztZQWhLSixTQUFTLFNBQUM7Z0JBQ1AsUUFBUSxFQUFFLGdCQUFnQjtnQkFDMUIsc2VBQXVDO2dCQUV2QyxhQUFhLEVBQUUsaUJBQWlCLENBQUMsSUFBSTs7YUFDeEM7Ozs7WUFUa0MsVUFBVTtZQUNtQyxTQUFTOzs7MkJBWXBGLFNBQVMsU0FBQyxjQUFjLEVBQUUsRUFBRSxJQUFJLEVBQUUsZ0JBQWdCLEVBQUU7MEJBRXBELFNBQVMsU0FBQyxZQUFZLEVBQUUsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFO3dCQUM1QyxTQUFTLFNBQUMsVUFBVSxFQUFFLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRTt3QkFDMUMsU0FBUyxTQUFDLFVBQVUsRUFBRSxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUU7c0JBSTFDLEtBQUs7dUJBZUwsS0FBSztxQkFpQkwsS0FBSzt3QkFjTCxLQUFLOzs7O0lBdEROLHdDQUFzRjs7SUFFdEYsdUNBQXVFOztJQUN2RSxxQ0FBbUU7O0lBQ25FLHFDQUFtRTs7SUFFbkUsMkNBQXVCOzs7OztJQWV2QixxQ0FBdUI7Ozs7O0lBa0J2QixtQ0FBcUI7O0lBZXJCLHFDQUEyQjs7SUFFM0Isa0RBQTRCOztJQUU1QixxQ0FBcUM7O0lBR3JDLHlDQUFtQjs7SUFHZiw4QkFBcUI7Ozs7O0lBQ3JCLGtDQUF5QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgICBDb21wb25lbnQsIElucHV0LCBUZW1wbGF0ZVJlZiwgRWxlbWVudFJlZiwgT25Jbml0LFxyXG4gICAgVmlld0NoaWxkLCBWaWV3Q29udGFpbmVyUmVmLCBIb3N0QmluZGluZywgVmlld0VuY2Fwc3VsYXRpb24sIFNpbXBsZUNoYW5nZXMsIFJlbmRlcmVyMiwgTmdab25lXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEFmdGVyVmlld0luaXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2ZhcnJpcy10b29sdGlwJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi90b29sdGlwLmNvbXBvbmVudC5odG1sJyxcclxuICAgIHN0eWxlVXJsczogWycuL3Rvb2x0aXAuY29tcG9uZW50LnNjc3MnXSxcclxuICAgIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmVcclxufSlcclxuXHJcbmV4cG9ydCBjbGFzcyBUb29sdGlwQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBBZnRlclZpZXdJbml0IHtcclxuXHJcbiAgICBAVmlld0NoaWxkKCdjb250ZW50Vmlld2YnLCB7IHJlYWQ6IFZpZXdDb250YWluZXJSZWYgfSkgY29udGVudFZpZXdmOiBWaWV3Q29udGFpbmVyUmVmO1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ3Rvb2x0aXBFbGUnLCB7IHJlYWQ6IEVsZW1lbnRSZWYgfSkgdG9vbHRpcE5vZGU6IEVsZW1lbnRSZWY7XHJcbiAgICBAVmlld0NoaWxkKCdhcnJvd0VsZScsIHsgcmVhZDogRWxlbWVudFJlZiB9KSBhcnJvd05vZGU6IEVsZW1lbnRSZWY7XHJcbiAgICBAVmlld0NoaWxkKCdpbm5lckVsZScsIHsgcmVhZDogRWxlbWVudFJlZiB9KSBpbm5lck5vZGU6IEVsZW1lbnRSZWY7XHJcblxyXG4gICAgY29udGVudElzU3RyaW5nID0gdHJ1ZTtcclxuICAgIC8qIOaZrumAmuaWh+acrOWGheWuuSAqL1xyXG4gICAgQElucHV0KClcclxuICAgIHNldCBjb250ZW50KHZhbHVlOiBzdHJpbmcgfCBUZW1wbGF0ZVJlZjxhbnk+KSB7XHJcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgVGVtcGxhdGVSZWYpIHtcclxuICAgICAgICAgICAgdGhpcy5jb250ZW50SXNTdHJpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5jb250ZW50Vmlld2YuY3JlYXRlRW1iZWRkZWRWaWV3KHZhbHVlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRJc1N0cmluZyA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMubmZDb250ZW50ID0gdmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ2V0IGNvbnRlbnQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubmZDb250ZW50O1xyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSBfdGlwV2lkdGggPSAnJztcclxuICAgIC8qKuWboOS4uuihqOWNleeUn+aIkOayoeacieaOkumZpGZhY3Rvcnks5LiN6IO95L2/55So5qih5p2/ICovXHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IHRpcFdpZHRoKHZhbHVlKSB7XHJcbiAgICAgICAgaWYgKHZhbHVlICE9IHRoaXMuX3RpcFdpZHRoKSB7XHJcbiAgICAgICAgICAgIGlmICh2YWx1ZSkgeyBcclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyLnNldFN0eWxlKHRoaXMuaW5uZXJOb2RlLm5hdGl2ZUVsZW1lbnQsICd3aWR0aCcsIHZhbHVlKTsgXHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlci5zZXRTdHlsZSh0aGlzLmlubmVyTm9kZS5uYXRpdmVFbGVtZW50LCAnbWF4LXdpZHRoJywgJ25vbmUnKTsgXHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIucmVtb3ZlU3R5bGUodGhpcy5pbm5lck5vZGUubmF0aXZlRWxlbWVudCwgJ3dpZHRoJyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlci5yZW1vdmVTdHlsZSh0aGlzLmlubmVyTm9kZS5uYXRpdmVFbGVtZW50LCAnbWF4LXdpZHRoJyk7IFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuX3RpcFdpZHRoID0gdmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ2V0IHRpcFdpZHRoKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl90aXBXaWR0aDtcclxuICAgIH1cclxuICAgIHByaXZhdGUgX3RpcENscyA9ICcnO1xyXG4gICAgQElucHV0KClcclxuICAgIHNldCB0aXBDbHModmFsdWUpIHtcclxuICAgICAgICBpZiAodmFsdWUgIT0gdGhpcy5fdGlwQ2xzKSB7XHJcbiAgICAgICAgICAgIC8v56e76Zmk5pen5qC35byPXHJcbiAgICAgICAgICAgIHRoaXMuX3RpcENscyAmJiB0aGlzLnJlbmRlci5yZW1vdmVDbGFzcyh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsIHRoaXMuX3RpcENscyk7XHJcbiAgICAgICAgICAgIC8v6L+95Yqg5paw5qC35byPXHJcbiAgICAgICAgICAgIHZhbHVlICYmIHRoaXMucmVuZGVyLmFkZENsYXNzKHRoaXMuZWwubmF0aXZlRWxlbWVudCwgdmFsdWUpO1xyXG4gICAgICAgICAgICB0aGlzLl90aXBDbHMgPSB2YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXQgdGlwQ2xzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl90aXBDbHM7XHJcbiAgICB9XHJcbiAgICAvKiDkvY3nva4gKi9cclxuICAgIEBJbnB1dCgpIHBsYWNlbWVudCA9ICd0b3AnO1xyXG5cclxuICAgIGhvc3RCb3VuZGluZ0NsaWVudFJlY3Q6IGFueTtcclxuXHJcbiAgICBuZkNvbnRlbnQ6IHN0cmluZyB8IFRlbXBsYXRlUmVmPGFueT47XHJcblxyXG4gICAgLyog5L2N572u5qC35byPICovXHJcbiAgICBwb3NpdGlvblN0eWxlID0ge307XHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHVibGljIGVsOiBFbGVtZW50UmVmLFxyXG4gICAgICAgIHByaXZhdGUgcmVuZGVyOiBSZW5kZXJlcjJcclxuICAgICkge1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCkge1xyXG4gICAgfVxyXG4gICAgbmdBZnRlclZpZXdJbml0KCkge1xyXG4gICAgICAgIGlmICh0aGlzLmhvc3RCb3VuZGluZ0NsaWVudFJlY3QpIHtcclxuICAgICAgICAgICAgdGhpcy5qdWRnZVdpZHRoKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlUG9zaXRpb24odGhpcy5ob3N0Qm91bmRpbmdDbGllbnRSZWN0KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOinhOWImeWIpOaWrem7mOiupOagt+W8j+S4i+WHuueOsOa7muWKqOadoe+8jOWwuuWvuOS7jum7mOiupOWPmOaIkOWkp+WPt1xyXG4gICAgICovXHJcbiAgICBqdWRnZVdpZHRoKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmlubmVyTm9kZS5uYXRpdmVFbGVtZW50LnNjcm9sbEhlaWdodCA+IHRoaXMuaW5uZXJOb2RlLm5hdGl2ZUVsZW1lbnQuY2xpZW50SGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyLmFkZENsYXNzKHRoaXMuaW5uZXJOb2RlLm5hdGl2ZUVsZW1lbnQsICd0b29sdGlwLWlubmVyLWxnJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyog6K6h566XdG9vbHRpcOacgOaWsOS9jee9riAqL1xyXG4gICAgY2FsY3VsYXRlUG9zaXRpb24oaG9zdFBvc2l0aW9uOiBhbnkpIHtcclxuICAgICAgICBsZXQgdG9wID0gMDtcclxuICAgICAgICBsZXQgbGVmdCA9IDA7XHJcbiAgICAgICAgY29uc3QgdG9vbHRpcFNpemUgPSB0aGlzLnRvb2x0aXBOb2RlLm5hdGl2ZUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgY29uc3QgYXJyb3dTaXplID0gdGhpcy5hcnJvd05vZGUubmF0aXZlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICBpZiAodGhpcy5wbGFjZW1lbnQgPT09ICd0b3AnKSB7XHJcbiAgICAgICAgICAgIHRvcCA9IGhvc3RQb3NpdGlvbi50b3AgLSB0b29sdGlwU2l6ZS5oZWlnaHQgLSAyO1xyXG4gICAgICAgICAgICBsZWZ0ID0gaG9zdFBvc2l0aW9uLmxlZnQgKyAoaG9zdFBvc2l0aW9uLndpZHRoIC0gdG9vbHRpcFNpemUud2lkdGgpIC8gMjtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMucGxhY2VtZW50ID09PSAnbGVmdCcpIHtcclxuICAgICAgICAgICAgdG9wID0gaG9zdFBvc2l0aW9uLnRvcCArIChob3N0UG9zaXRpb24uaGVpZ2h0IC0gdG9vbHRpcFNpemUuaGVpZ2h0KSAvIDI7XHJcbiAgICAgICAgICAgIGxlZnQgPSBob3N0UG9zaXRpb24ubGVmdCAtIHRvb2x0aXBTaXplLndpZHRoIC0gMjtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMucGxhY2VtZW50ID09PSAncmlnaHQnKSB7XHJcbiAgICAgICAgICAgIHRvcCA9IGhvc3RQb3NpdGlvbi50b3AgKyAoaG9zdFBvc2l0aW9uLmhlaWdodCAtIHRvb2x0aXBTaXplLmhlaWdodCkgLyAyO1xyXG4gICAgICAgICAgICBsZWZ0ID0gaG9zdFBvc2l0aW9uLnJpZ2h0ICsgMjtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMucGxhY2VtZW50ID09PSAnYm90dG9tJykge1xyXG4gICAgICAgICAgICB0b3AgPSBob3N0UG9zaXRpb24uYm90dG9tICsgYXJyb3dTaXplLmhlaWdodCArIDI7XHJcbiAgICAgICAgICAgIGxlZnQgPSBob3N0UG9zaXRpb24ubGVmdCArIChob3N0UG9zaXRpb24ud2lkdGggLSB0b29sdGlwU2l6ZS53aWR0aCkgLyAyO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5wbGFjZW1lbnQgPT09ICd0b3AtbGVmdCcpIHtcclxuICAgICAgICAgICAgdG9wID0gaG9zdFBvc2l0aW9uLnRvcCAtIHRvb2x0aXBTaXplLmhlaWdodCAtIDI7XHJcbiAgICAgICAgICAgIGxlZnQgPSBob3N0UG9zaXRpb24ubGVmdDtcclxuICAgICAgICAgICAgdGhpcy5hcnJvd05vZGUubmF0aXZlRWxlbWVudC5zdHlsZS5sZWZ0ID0gJzEwJSc7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnBsYWNlbWVudCA9PT0gJ3RvcC1yaWdodCcpIHtcclxuICAgICAgICAgICAgdG9wID0gaG9zdFBvc2l0aW9uLnRvcCAtIHRvb2x0aXBTaXplLmhlaWdodCAtIDI7XHJcbiAgICAgICAgICAgIGxlZnQgPSBob3N0UG9zaXRpb24ucmlnaHQgLSB0b29sdGlwU2l6ZS53aWR0aDtcclxuICAgICAgICAgICAgdGhpcy5hcnJvd05vZGUubmF0aXZlRWxlbWVudC5zdHlsZS5yaWdodCA9ICcxMCUnO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5wbGFjZW1lbnQgPT09ICdyaWdodC10b3AnKSB7XHJcbiAgICAgICAgICAgIHRvcCA9IGhvc3RQb3NpdGlvbi50b3A7XHJcbiAgICAgICAgICAgIGxlZnQgPSBob3N0UG9zaXRpb24ucmlnaHQgKyAyO1xyXG4gICAgICAgICAgICB0aGlzLmFycm93Tm9kZS5uYXRpdmVFbGVtZW50LnN0eWxlLnRvcCA9ICcxMCUnO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5wbGFjZW1lbnQgPT09ICdyaWdodC1ib3R0b20nKSB7XHJcbiAgICAgICAgICAgIHRvcCA9IGhvc3RQb3NpdGlvbi5ib3R0b20gLSB0b29sdGlwU2l6ZS5oZWlnaHQ7XHJcbiAgICAgICAgICAgIGxlZnQgPSBob3N0UG9zaXRpb24ucmlnaHQgKyAyO1xyXG4gICAgICAgICAgICB0aGlzLmFycm93Tm9kZS5uYXRpdmVFbGVtZW50LnN0eWxlLmJvdHRvbSA9ICcxMCUnO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5wbGFjZW1lbnQgPT09ICdib3R0b20tbGVmdCcpIHtcclxuICAgICAgICAgICAgdG9wID0gaG9zdFBvc2l0aW9uLmJvdHRvbSArIGFycm93U2l6ZS5oZWlnaHQgKyAyO1xyXG4gICAgICAgICAgICBsZWZ0ID0gaG9zdFBvc2l0aW9uLmxlZnQ7XHJcbiAgICAgICAgICAgIHRoaXMuYXJyb3dOb2RlLm5hdGl2ZUVsZW1lbnQuc3R5bGUubGVmdCA9ICcxMCUnO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5wbGFjZW1lbnQgPT09ICdib3R0b20tcmlnaHQnKSB7XHJcbiAgICAgICAgICAgIHRvcCA9IGhvc3RQb3NpdGlvbi5ib3R0b20gKyBhcnJvd1NpemUuaGVpZ2h0ICsgMjtcclxuICAgICAgICAgICAgbGVmdCA9IGhvc3RQb3NpdGlvbi5yaWdodCAtIHRvb2x0aXBTaXplLndpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLmFycm93Tm9kZS5uYXRpdmVFbGVtZW50LnN0eWxlLnJpZ2h0ID0gJzEwJSc7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnBsYWNlbWVudCA9PT0gJ2xlZnQtdG9wJykge1xyXG4gICAgICAgICAgICB0b3AgPSBob3N0UG9zaXRpb24udG9wO1xyXG4gICAgICAgICAgICBsZWZ0ID0gaG9zdFBvc2l0aW9uLmxlZnQgLSB0b29sdGlwU2l6ZS53aWR0aCAtIDI7XHJcbiAgICAgICAgICAgIHRoaXMuYXJyb3dOb2RlLm5hdGl2ZUVsZW1lbnQuc3R5bGUudG9wID0gJzEwJSc7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnBsYWNlbWVudCA9PT0gJ2xlZnQtYm90dG9tJykge1xyXG4gICAgICAgICAgICB0b3AgPSBob3N0UG9zaXRpb24uYm90dG9tIC0gdG9vbHRpcFNpemUuaGVpZ2h0O1xyXG4gICAgICAgICAgICBsZWZ0ID0gaG9zdFBvc2l0aW9uLmxlZnQgLSB0b29sdGlwU2l6ZS53aWR0aCAtIDI7XHJcbiAgICAgICAgICAgIHRoaXMuYXJyb3dOb2RlLm5hdGl2ZUVsZW1lbnQuc3R5bGUuYm90dG9tID0gJzEwJSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudG9vbHRpcE5vZGUubmF0aXZlRWxlbWVudC5zdHlsZS50b3AgPSB0b3AgKyAncHgnO1xyXG4gICAgICAgIHRoaXMudG9vbHRpcE5vZGUubmF0aXZlRWxlbWVudC5zdHlsZS5sZWZ0ID0gbGVmdCArICdweCc7XHJcbiAgICB9XHJcblxyXG4gICAgLyogXHJcbiAgICAqMTLkuKrkvY3nva7lkI3op6PmnpAgXHJcbiAgICAqIOWboOihqOWNleeUn+aIkOayoeacieaOkumZpGZhY3Rvcnks6ICM5LiU5L2/55So5LqGW2NsYXNzXSzlj6rog73lnKjmraTlpITlj5jmm7RcclxuICAgICovXHJcbiAgICBvZmZzZXREaXJlY3Rpb24oKSB7XHJcbiAgICAgICAgY29uc3QgcGxhY2VtZW50ID0gdGhpcy5wbGFjZW1lbnQ7XHJcbiAgICAgICAgaWYgKHBsYWNlbWVudC5pbmRleE9mKCctJykgIT09IC0xKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gcGxhY2VtZW50LmluZGV4T2YoJy0nKTtcclxuICAgICAgICAgICAgcmV0dXJuIHBsYWNlbWVudC5zdWJzdHJpbmcoMCwgaW5kZXgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcGxhY2VtZW50O1xyXG4gICAgfVxyXG59XHJcbiJdfQ==