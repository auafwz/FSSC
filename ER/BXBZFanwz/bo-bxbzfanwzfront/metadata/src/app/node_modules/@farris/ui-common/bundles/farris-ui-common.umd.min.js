!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("resize-observer-polyfill"),require("@farris/ui-common/column"),require("@angular/platform-browser"),require("lodash-es"),require("rxjs"),require("rxjs/operators"),require("@angular/core")):"function"==typeof define&&define.amd?define("@farris/ui-common",["exports","resize-observer-polyfill","@farris/ui-common/column","@angular/platform-browser","lodash-es","rxjs","rxjs/operators","@angular/core"],e):e((t.farris=t.farris||{},t.farris["ui-common"]={}),t.ResizeObserver,t.farris["ui-common"].column,t.ng.platformBrowser,t.lodashEs,t.rxjs,t.rxjs.operators,t.ng.core)}(this,function(t,e,r,n,o,i,a,s){"use strict";e=e&&e.hasOwnProperty("default")?e["default"]:e;var u=(c.prototype.getType=function(){return this.name},c.decorators=[{type:s.Directive,args:[{selector:"[farrisTemplate]"}]}],c.ctorParameters=function(){return[{type:s.TemplateRef}]},c.propDecorators={type:[{type:s.Input}],name:[{type:s.Input,args:["farrisTemplate"]}]},c);function c(t){this.template=t}var l=function(){return(l=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function p(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}var f=new WeakMap,d=new e(function(t){var e,r;try{for(var n=p(t),o=n.next();!o.done;o=n.next()){var i=o.value;if(f.has(i.target))f.get(i.target)._resizeCallback(i)}}catch(a){e={error:a}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(e)throw e.error}}}),h=(m.prototype._resizeCallback=function(t){t.bindintClientRect=t.target.getBoundingClientRect(),this.resize.emit(t)},m.prototype.ngOnInit=function(){var t=this.target?this.target.nativeElement:this.el.nativeElement;f.set(t,this),d.observe(t)},m.prototype.ngOnDestroy=function(){var t=this.el.nativeElement;d.unobserve(t),f["delete"](t)},m.decorators=[{type:s.Directive,args:[{selector:"[resizeObserver]"}]}],m.ctorParameters=function(){return[{type:s.ElementRef}]},m.propDecorators={target:[{type:s.Input,args:["resizeObserver"]}],resize:[{type:s.Output}]},m);function m(t){this.el=t,this.resize=new s.EventEmitter}var y=(v.prototype.getValue=function(t,e,r){if(void 0===r&&(r=!1),!e)return"";var n="";return n=-1===t.indexOf(".")&&e.hasOwnProperty(t)?e[t]:t.split(".").reduce(function(t,e){return t?t[e]:null},e),r?this.formatterValue(n):n},v.prototype.setValue=function(t,e,r,n){if(void 0===n&&(n=!0),e)if(-1<e.indexOf(".")&&n){var o=null,i=e.split(".");i.reduce(function(t,e){return(o=t)[e]},t),o&&(o[i.pop()]=r)}else t[e]=r},v.prototype.getEnumItem=function(e,t,r){return t.find(function(t){return t[r]==e})},v.prototype._getEnumTitleFromColumn=function(t,e){var r=e.formatter;return r&&"object"==typeof r&&"enum"===r.type&&r.options?this.getEnumTitleFromColumnOptions(t,r.options):t},v.prototype.getEnumTitle=function(t,e){var r=this.getValue(t.field,e);return this._getEnumTitleFromColumn(r,t)},v.prototype.getEnumTitleFromColumnOptions=function(t,e){var r=e.data,n=e.valueField,o=e.textField,i=this.getEnumItem(t,r,n);return i?i[o]:t},v.prototype.escapeHtml=function(t){return null===t||t===undefined?"":t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#39;").replace(/\//g,"&#x2F;")},v.prototype.unescapeHtml=function(t){return null===t||t===undefined?"":t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&#x2F;/g,"/")},v.prototype.formatterValue=function(t){return null===t||t===undefined||""===t?"":"string"==typeof t?this.escapeHtml(t):t},v.prototype.getTextWidth=function(t,e){var r=document.createElement("canvas").getContext("2d");r.font=e;var n=r.measureText(t);return Math.round(n.width)},v.prototype.removeStyleSheet=function(t){var e=document.querySelector("#"+t);e&&e.remove()},v.prototype.createStyleSheet=function(t){var e=document.querySelector("head"),r=t,n=null;return document.querySelector("#"+r)?(n=document.querySelector("#"+r)).innerText="":((n=document.createElement("style")).id=r,e.appendChild(n)),n},v.prototype.getStyleSheet=function(t){var e,r,n=document.styleSheets,o=null;try{for(var i=p(n),a=i.next();!a.done;a=i.next()){var s=a.value;if((s.ownerNode||s.owningElement).id===t){o=s;break}}}catch(u){e={error:u}}finally{try{a&&!a.done&&(r=i["return"])&&r.call(i)}finally{if(e)throw e.error}}return o},v.prototype.appendCssRules=function(t,e){var r,n;try{for(var o=p(t),i=o.next();!i.done;i=o.next()){var a=i.value,s=a.slice(0,a.indexOf("{")),u=this.removeCssRule(s,e);if(e.addRule){var c="";u&&(c+=u.cssText.slice(u.cssText.indexOf("{")+1,u.cssText.indexOf("}"))),c+=a.slice(a.indexOf("{")+1,a.indexOf("}")).replace(/"/g,"").replace(/,/g,";")+";",e.addRule(s,c,0)}else e.insertRule(a,0)}}catch(l){r={error:l}}finally{try{i&&!i.done&&(n=o["return"])&&n.call(o)}finally{if(r)throw r.error}}},v.prototype.getCssRule=function(t,e){var r,n,o=e.cssRules||e.rules,i=null;try{for(var a=p(o),s=a.next();!s.done;s=a.next()){var u=s.value;u.selectorText==t&&(i=u)}}catch(c){r={error:c}}finally{try{s&&!s.done&&(n=a["return"])&&n.call(a)}finally{if(r)throw r.error}}return i},v.prototype.removeCssRule=function(t,e){var r=e.cssRules||e.rules,n=0,o=!1;do{if((o=r[n])&&o.selectorText.toLowerCase()==t.toLowerCase())return e.cssRules?e.deleteRule(n):e.removeRule(n),o;n++}while(o)},v.prototype.isNullOrUndefined=function(t){return null===t||t===undefined},v.prototype.isIE=function(){var t=window.navigator.userAgent;return/msie\s|trident\/|edge\//i.test(t)&&!!("uniqueID"in document||"documentMode"in document||"ActiveXObject"in window||"MSInputMethodContext"in window)},v.prototype.buildSortString=function(t){return this.cfs.buildSortString(t)},v.prototype.buildSqlWhere=function(t){return this.cfs.buildSqlWhere(t)},v.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],v.ctorParameters=function(){return[]},v.ngInjectableDef=s.defineInjectable({factory:function(){return new v},token:v,providedIn:"root"}),v);function v(){this.cfs=null,this.cfs||(this.cfs=new r.ColumnFormatService(null,null))}var g=(w.prototype.transform=function(t,e){switch(e){case"html":return this.sanitizer.bypassSecurityTrustHtml(t);case"style":return this.sanitizer.bypassSecurityTrustStyle(t);case"script":return this.sanitizer.bypassSecurityTrustScript(t);case"url":return this.sanitizer.bypassSecurityTrustUrl(t);case"resourceUrl":return this.sanitizer.bypassSecurityTrustResourceUrl(t);default:throw new Error("Invalid safe type specified: "+e)}},w.decorators=[{type:s.Pipe,args:[{name:"safe"}]}],w.ctorParameters=function(){return[{type:n.DomSanitizer}]},w);function w(t){this.sanitizer=t}var S="",b=8;function x(t,e){return void 0===e&&(e="hex"),"hex"===e?function o(t){for(var e="0123456789abcdef",r="",n=0;n<4*t.length;n++)r+=e.charAt(t[n>>2]>>n%4*8+4&15)+e.charAt(t[n>>2]>>n%4*8&15);return r}(_(A(t),t.length*b)):"b64"===e?function i(t){for(var e="",r=0;r<4*t.length;r+=3)for(var n=(t[r>>2]>>r%4*8&255)<<16|(t[r+1>>2]>>(r+1)%4*8&255)<<8|t[r+2>>2]>>(r+2)%4*8&255,o=0;o<4;o++)8*r+6*o>32*t.length?e+=S:e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(n>>6*(3-o)&63);return e}(_(A(t),t.length*b)):function a(t){for(var e="",r=(1<<b)-1,n=0;n<32*t.length;n+=b)e+=String.fromCharCode(t[n>>5]>>>n%32&r);return e}(_(A(t),t.length*b))}function _(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var r=1732584193,n=-271733879,o=-1732584194,i=271733878,a=0;a<t.length;a+=16){var s=r,u=n,c=o,l=i;r=I(r,n,o,i,t[a+0],7,-680876936),i=I(i,r,n,o,t[a+1],12,-389564586),o=I(o,i,r,n,t[a+2],17,606105819),n=I(n,o,i,r,t[a+3],22,-1044525330),r=I(r,n,o,i,t[a+4],7,-176418897),i=I(i,r,n,o,t[a+5],12,1200080426),o=I(o,i,r,n,t[a+6],17,-1473231341),n=I(n,o,i,r,t[a+7],22,-45705983),r=I(r,n,o,i,t[a+8],7,1770035416),i=I(i,r,n,o,t[a+9],12,-1958414417),o=I(o,i,r,n,t[a+10],17,-42063),n=I(n,o,i,r,t[a+11],22,-1990404162),r=I(r,n,o,i,t[a+12],7,1804603682),i=I(i,r,n,o,t[a+13],12,-40341101),o=I(o,i,r,n,t[a+14],17,-1502002290),r=C(r,n=I(n,o,i,r,t[a+15],22,1236535329),o,i,t[a+1],5,-165796510),i=C(i,r,n,o,t[a+6],9,-1069501632),o=C(o,i,r,n,t[a+11],14,643717713),n=C(n,o,i,r,t[a+0],20,-373897302),r=C(r,n,o,i,t[a+5],5,-701558691),i=C(i,r,n,o,t[a+10],9,38016083),o=C(o,i,r,n,t[a+15],14,-660478335),n=C(n,o,i,r,t[a+4],20,-405537848),r=C(r,n,o,i,t[a+9],5,568446438),i=C(i,r,n,o,t[a+14],9,-1019803690),o=C(o,i,r,n,t[a+3],14,-187363961),n=C(n,o,i,r,t[a+8],20,1163531501),r=C(r,n,o,i,t[a+13],5,-1444681467),i=C(i,r,n,o,t[a+2],9,-51403784),o=C(o,i,r,n,t[a+7],14,1735328473),r=j(r,n=C(n,o,i,r,t[a+12],20,-1926607734),o,i,t[a+5],4,-378558),i=j(i,r,n,o,t[a+8],11,-2022574463),o=j(o,i,r,n,t[a+11],16,1839030562),n=j(n,o,i,r,t[a+14],23,-35309556),r=j(r,n,o,i,t[a+1],4,-1530992060),i=j(i,r,n,o,t[a+4],11,1272893353),o=j(o,i,r,n,t[a+7],16,-155497632),n=j(n,o,i,r,t[a+10],23,-1094730640),r=j(r,n,o,i,t[a+13],4,681279174),i=j(i,r,n,o,t[a+0],11,-358537222),o=j(o,i,r,n,t[a+3],16,-722521979),n=j(n,o,i,r,t[a+6],23,76029189),r=j(r,n,o,i,t[a+9],4,-640364487),i=j(i,r,n,o,t[a+12],11,-421815835),o=j(o,i,r,n,t[a+15],16,530742520),r=O(r,n=j(n,o,i,r,t[a+2],23,-995338651),o,i,t[a+0],6,-198630844),i=O(i,r,n,o,t[a+7],10,1126891415),o=O(o,i,r,n,t[a+14],15,-1416354905),n=O(n,o,i,r,t[a+5],21,-57434055),r=O(r,n,o,i,t[a+12],6,1700485571),i=O(i,r,n,o,t[a+3],10,-1894986606),o=O(o,i,r,n,t[a+10],15,-1051523),n=O(n,o,i,r,t[a+1],21,-2054922799),r=O(r,n,o,i,t[a+8],6,1873313359),i=O(i,r,n,o,t[a+15],10,-30611744),o=O(o,i,r,n,t[a+6],15,-1560198380),n=O(n,o,i,r,t[a+13],21,1309151649),r=O(r,n,o,i,t[a+4],6,-145523070),i=O(i,r,n,o,t[a+11],10,-1120210379),o=O(o,i,r,n,t[a+2],15,718787259),n=O(n,o,i,r,t[a+9],21,-343485551),r=R(r,s),n=R(n,u),o=R(o,c),i=R(i,l)}return Array(r,n,o,i)}function F(t,e,r,n,o,i){return R(function a(t,e){return t<<e|t>>>32-e}(R(R(e,t),R(n,i)),o),r)}function I(t,e,r,n,o,i,a){return F(e&r|~e&n,t,e,o,i,a)}function C(t,e,r,n,o,i,a){return F(e&n|r&~n,t,e,o,i,a)}function j(t,e,r,n,o,i,a){return F(e^r^n,t,e,o,i,a)}function O(t,e,r,n,o,i,a){return F(r^(e|~n),t,e,o,i,a)}function R(t,e){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}function A(t){for(var e=Array(),r=(1<<b)-1,n=0;n<t.length*b;n+=b)e[n>>5]|=(t.charCodeAt(n/b)&r)<<n%32;return e}var T=(q.prototype.generate=function(){return this.guid()},q.prototype.encrypt=function(t,e){return void 0===e&&(e="hex"),x(t,e)},q.prototype.guid=function(){var e=window.crypto?crypto:window.msCrypto;return e?([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(t){return(t^e.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}):this.uuid()},q.prototype.uuid=function(){var t=Date.now().valueOf();return(q.previous=q.previous<t?t:q.previous+100).toString(16)},q.previous=0,q.decorators=[{type:s.Injectable}],q);function q(){}var E=(z.prototype.transform=function(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return t.forEach(function(t,e){r=r.replace("{"+e+"}",t)}),r},z.decorators=[{type:s.Pipe,args:[{name:"replaceX"}]}],z);function z(){}var D={form:{},model:{}},P=(k.prototype.setValue=function(t){t&&(this._state=o.merge(this._state,t),this.stateSubject.next(this._state))},k.prototype.getValue=function(t){return this.utils.getValue(t,this._state)},k.prototype.setLookupInstance=function(t){this.setValue({form:{lookup:{instance:t}}})},k.prototype.updateFormState=function(t){this.setValue({form:t})},k.prototype.getFormState=function(t){return this.getValue("form."+t)},k.prototype.eventPath=function(t){var e=t.composedPath&&t.composedPath()||t.path,r=t.target;if(null!=e)return e.indexOf(window)<0?e.concat(window):e;if(r===window)return[window];var n=function(t,e){void 0===e&&(e=undefined),e=e||[];var r=t.parentNode;return r?n(r,e.concat(r)):e};return[r].concat(n(r),window)},k.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],k.ctorParameters=function(){return[{type:y}]},k.ngInjectableDef=s.defineInjectable({factory:function(){return new k(s.inject(y))},token:k,providedIn:"root"}),k);function k(t){this.utils=t,this.stateSubject=new i.BehaviorSubject({}),this.state$=this.stateSubject.asObservable(),this.form$=this.state$.pipe(a.map(function(t){return t.form})),this.lookupIsPending$=this.form$.pipe(a.map(function(t){return t.lookup.pending})),this._state=D,this._formState=this._state.form,this._lookupState=this._formState.lookup}var V=(M.forRoot=function(){return{ngModule:M,providers:[y,P,T]}},M.decorators=[{type:s.NgModule,args:[{declarations:[g,u,h,E],imports:[],exports:[g,u,h,E]}]}],M);function M(){}var $=(U.prototype.initData=function(t){var e=this;return t.map(function(t){return{id:t[e._state.idField],data:t,disabled:!!e.disableExpress&&e.disableExpress(t)}})},U.prototype.updateState=function(t){var e=l({},this._state,t);this.store.next(this._state=e)},U.prototype.initState=function(t){this.updateState(t)},U.prototype.isSelect=function(e){var r=this;return!(!this._state.selections||!this._state.selections.length)&&this._state.selections.find(function(t){return!!t&&t[r._state.idField]==e})!==undefined},U.prototype.loadData=function(t,e,r){var n=this;if(void 0===e&&(e=""),void 0===r&&(r=","),t){if(e){var o=e.split(r).map(function(e){return t.find(function(t){return t[n._state.valueField]+""==e})});this._state.selections=o.filter(function(t){return!!t})}else this._state.selections=[];var i=this.initData(t);this.updateState(l({},this._state,{data:i}))}else this.updateState({data:[],selections:[]})},U.prototype.getSelections=function(){return this._state.selections},U.prototype.setSelections=function(e,t){var r=this;if(void 0===t&&(t=","),e){var n=[];n=this._state.multiSelect?e.split(t).map(function(e){return r._state.data.find(function(t){return t.data[r._state.valueField]+""==e})}).map(function(t){return t?t.data:""}).filter(function(t){return t}):[this._state.data.find(function(t){return t.data[r._state.valueField]+""==e})],this.updateState({selections:n})}},U.prototype.selectAll=function(){this.updateState({selections:this._state.data.map(function(t){return t.data})})},U.prototype.unSelectAll=function(){this.clearSelections()},U.prototype.selectItem=function(t,e){var r=this._state.idField,n=this.getSelections(),o=t[r];this._state.multiSelect?this.isSelect(o)||n.push(t):this.isSelect(o)||(n=[t]);var i=this.cloneArray(n);this.updateState({selections:i})},U.prototype.unSelectItem=function(t){var e=this._state.idField,r=this.getSelections(),n=t[e];r=this._state.multiSelect?r.filter(function(t){return t[e]!=n}):[];var o=this.cloneArray(r);this.updateState({selections:o})},U.prototype.clearSelections=function(){this.updateState({selections:[]})},U.prototype.cloneArray=function(t){return t&&t.length?t.map(function(t){return t}):t},U);function U(t){this._initState=t,this._state=this._initState,this.store=new i.BehaviorSubject(this._state),this.state$=this.store.asObservable(),this.data$=this.state$.pipe(a.map(function(t){return t.data}))}var B=(W.prototype.add=function(t,e){this._state.set(t,e)},W.prototype.get=function(t){return this._state.get(t)},W.prototype.destroy=function(t){this._state["delete"](t)},W.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],W.ctorParameters=function(){return[]},W.ngInjectableDef=s.defineInjectable({factory:function(){return new W},token:W,providedIn:"root"}),W);function W(){this._state=new WeakMap}var H=["moz","ms","webkit"];var N=function L(){if("undefined"==typeof window)return function(){return 0};if(window.requestAnimationFrame)return window.requestAnimationFrame.bind(window);var t=H.filter(function(t){return t+"RequestAnimationFrame"in window})[0];return t?window[t+"RequestAnimationFrame"]:function e(){var o=0;return function(t){var e=(new Date).getTime(),r=Math.max(0,16-(e-o)),n=setTimeout(function(){t(e+r)},r);return o=e+r,n}}()}();t.FarrisTemplateDirective=u,t.ResizeObserverDirective=h,t.CommonUtils=y,t.FarrisSafePipe=g,t.FarrisCommonModule=V,t.IdService=T,t.BaseDataFacadeService=$,t.RuntimeStateService=P,t.FarrisComponentInstanceService=B,t.FarrisReplaceXPipe=E,t.cancelRequestAnimationFrame=function X(t){if("undefined"==typeof window)return null;if(window.cancelAnimationFrame)return window.cancelAnimationFrame(t);var e=H.filter(function(t){return t+"CancelAnimationFrame"in window||t+"CancelRequestAnimationFrame"in window})[0];return e?(window[e+"CancelAnimationFrame"]||window[e+"CancelRequestAnimationFrame"]).call(this,t):clearTimeout(t)},t.reqAnimFrame=N,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=farris-ui-common.umd.min.js.map