import { Injectable } from "@angular/core";
export class WorkFlowMessageService {
    constructor() { }
    /**
     * 监听工作流消息
     * @param callback 回调
     */
    listen(callback) {
        window.addEventListener('message', function (event) {
            var message = event.data;
            if (message) {
                message.sender = event.source;
            }
            if (typeof callback === 'function') {
                callback(message);
            }
        });
    }
    /**
     * 给工作流表单发送消息
     * @param message
     */
    send(message) {
        if (!message) {
            return;
        }
        let win = window;
        if (message.target) {
            win = message.target || window;
            delete message.target;
        }
        if (win) {
            win.postMessage(message, '*');
        }
    }
}
WorkFlowMessageService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
WorkFlowMessageService.ctorParameters = () => [];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid29yay1mbG93LW1lc3NhZ2Uuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvY29tbWFuZC1zZXJ2aWNlcy8iLCJzb3VyY2VzIjpbImxpYi93b3JrLWZsb3cvd29yay1mbG93LW1lc3NhZ2Uuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBSTNDLE1BQU0sT0FBTyxzQkFBc0I7SUFDakMsZ0JBQWdCLENBQUM7SUFDakI7OztPQUdHO0lBQ0ksTUFBTSxDQUFDLFFBQXdDO1FBQ3BELE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxTQUFTLEVBQUUsVUFBVSxLQUFLO1lBQ2hELElBQUksT0FBTyxHQUFHLEtBQUssQ0FBQyxJQUF5QixDQUFDO1lBQzlDLElBQUksT0FBTyxFQUFFO2dCQUNYLE9BQU8sQ0FBQyxNQUFNLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQzthQUMvQjtZQUNELElBQUksT0FBTyxRQUFRLEtBQUssVUFBVSxFQUFFO2dCQUNsQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUM7YUFDbkI7UUFDSCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFDRDs7O09BR0c7SUFDSSxJQUFJLENBQUMsT0FBMEI7UUFDcEMsSUFBSSxDQUFDLE9BQU8sRUFBRTtZQUNaLE9BQU87U0FDUjtRQUNELElBQUksR0FBRyxHQUFXLE1BQU0sQ0FBQztRQUN6QixJQUFJLE9BQU8sQ0FBQyxNQUFNLEVBQUU7WUFDbEIsR0FBRyxHQUFHLE9BQU8sQ0FBQyxNQUFnQixJQUFJLE1BQU0sQ0FBQztZQUN6QyxPQUFPLE9BQU8sQ0FBQyxNQUFNLENBQUM7U0FDdkI7UUFDRCxJQUFJLEdBQUcsRUFBRTtZQUNQLEdBQUcsQ0FBQyxXQUFXLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1NBQy9CO0lBQ0gsQ0FBQzs7O1lBbENGLFVBQVUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuaW1wb3J0IHsgV29ya0Zsb3cgfSBmcm9tIFwiLi90eXBlc1wiO1xyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgV29ya0Zsb3dNZXNzYWdlU2VydmljZSB7XHJcbiAgY29uc3RydWN0b3IoKSB7IH1cclxuICAvKipcclxuICAgKiDnm5HlkKzlt6XkvZzmtYHmtojmga9cclxuICAgKiBAcGFyYW0gY2FsbGJhY2sg5Zue6LCDXHJcbiAgICovXHJcbiAgcHVibGljIGxpc3RlbihjYWxsYmFjazogKGU6IFdvcmtGbG93LklNZXNzYWdlKSA9PiB2b2lkKSB7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICB2YXIgbWVzc2FnZSA9IGV2ZW50LmRhdGEgYXMgV29ya0Zsb3cuSU1lc3NhZ2U7XHJcbiAgICAgIGlmIChtZXNzYWdlKSB7XHJcbiAgICAgICAgbWVzc2FnZS5zZW5kZXIgPSBldmVudC5zb3VyY2U7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgIGNhbGxiYWNrKG1lc3NhZ2UpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog57uZ5bel5L2c5rWB6KGo5Y2V5Y+R6YCB5raI5oGvXHJcbiAgICogQHBhcmFtIG1lc3NhZ2UgXHJcbiAgICovXHJcbiAgcHVibGljIHNlbmQobWVzc2FnZTogV29ya0Zsb3cuSU1lc3NhZ2UpOiB2b2lkIHtcclxuICAgIGlmICghbWVzc2FnZSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBsZXQgd2luOiBXaW5kb3cgPSB3aW5kb3c7XHJcbiAgICBpZiAobWVzc2FnZS50YXJnZXQpIHtcclxuICAgICAgd2luID0gbWVzc2FnZS50YXJnZXQgYXMgV2luZG93IHx8IHdpbmRvdztcclxuICAgICAgZGVsZXRlIG1lc3NhZ2UudGFyZ2V0O1xyXG4gICAgfVxyXG4gICAgaWYgKHdpbikge1xyXG4gICAgICB3aW4ucG9zdE1lc3NhZ2UobWVzc2FnZSwgJyonKTtcclxuICAgIH1cclxuICB9XHJcbn0iXX0=