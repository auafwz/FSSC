/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { delay, debounceTime } from 'rxjs/operators';
import { of } from 'rxjs';
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-08-12 07:47:12
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-11-26 10:21:25
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
import { Component, Input, ViewChild, Renderer2, ElementRef, ChangeDetectorRef, ChangeDetectionStrategy, NgZone, Injector, Optional, ApplicationRef, Output, EventEmitter } from '@angular/core';
import { DatagridFacadeService } from '../../services/datagrid-facade.service';
import { ScrollbarDirective } from '../../scrollbar/scrollbar.directive';
import { SCROLL_X_ACTION, SCROLL_Y_ACTION, SCROLL_X_REACH_START_ACTION, TR_PREFIX } from '../../types/constant';
import { DatagridService } from '../../services/datagrid.service';
import { DatagridComponent } from '../../datagrid.component';
import { FormatCellDataPipe } from '../../utils/format-cell-data.pipe';
import { ColumnFormatService } from '@farris/ui-common/column';
export class DatagridBodyComponent {
    /**
     * @param {?} injector
     * @param {?} app
     * @param {?} dg
     * @param {?} cd
     * @param {?} el
     */
    constructor(injector, app, dg, cd, el) {
        this.injector = injector;
        this.app = app;
        this.dg = dg;
        this.cd = cd;
        this.el = el;
        // 自动高度时，禁用纵向滚动条
        this.psConfig = { swipeEasing: false, minScrollbarLength: 15, handlers: ['click-rail', 'drag-thumb', 'wheel', 'touch'], suppressScrollY: this.dg.autoHeight };
        this.scrollTop = 0;
        this.scrollLeft = 0;
        this.deltaTopHeight = 0;
        // wheelHeight = 0;
        this.wheelWidth = 0;
        this._fixedRightScrollLeft = 0;
        this.maxScrollLeft = 0;
        this.showRightShadow = false;
        this.footerHeight = 0;
        // 虚拟加载
        this.topHideHeight = 0;
        this.bottomHideHeight = 0;
        this.startRowIndex = 0;
        this.dataChange = new EventEmitter();
        this.scrollBarMode = 'auto';
        this.checkedRows = [];
        this.visibleContextMenus = [];
        this.currentRowId = undefined;
        this._hoverRowIndex = -1;
        this.subscriptions = [];
        this.minRowBuffer = 3;
        this.vScrollDir = 1;
        this.rowsCache = {};
        this.lastRenderedScrollTop = 0;
        this.lastRenderedScrollLeft = 0;
        this.prevScrollTop = 0;
        this.prevScrollLeft = 0;
        this.rows = [];
        this.blankTopHeight = 0;
        this.blankBottomHeight = 0;
        this.cellContentFormatter = null;
        // 当启用多选且允许多选中，列表不能编辑时，取选中后禁止触发body 的click 事件
        this.__triggerBodyClickEvent = true;
        this.onBeforeShowContextMenu = (/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            // row_1_fixedleft  row_1  row_1_fixedright
            const { contextMenuDom, event } = e;
            if (event.target.closest('.datagrid-editor')) {
                return of({ show: false });
            }
            /** @type {?} */
            let rowID = event.target.id;
            if (contextMenuDom) {
                // 排除分组行、分组合计行
                if (contextMenuDom.className.indexOf('f-datagrid-group-row') === -1 && contextMenuDom.className.indexOf('f-datagrid-group-footer') === -1) {
                    rowID = contextMenuDom.id.replace('row_', '').replace('_fixedleft', '').replace('_fixedright', '');
                    /** @type {?} */
                    const rowData = this.dfs.findRow(rowID);
                    /** @type {?} */
                    const focusTargetWidth = this.viewportW > this.totalWidth ? this.totalWidth : this.viewportW;
                    return of({ show: true, data: { data: rowData.data, grid: this.dg }, focusTargetWidth });
                }
            }
            return of({ show: false });
        });
        this.dfs = this.injector.get(DatagridFacadeService);
        this.dgs = this.injector.get(DatagridService);
        this.ngZone = this.injector.get(NgZone);
        this.render = this.injector.get(Renderer2);
        /** @type {?} */
        const columnFormatService = this.injector.get(ColumnFormatService);
        this.cellContentFormatter = new FormatCellDataPipe(columnFormatService, this.injector);
    }
    /**
     * @return {?}
     */
    get fixedRightScrollLeft() {
        return this._fixedRightScrollLeft;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set fixedRightScrollLeft(val) {
        // this._fixedRightScrollLeft = this.dg.scrollBarShowMode === 'allways' ?  val - 18 : val;
        this._fixedRightScrollLeft = val;
    }
    /**
     * @return {?}
     */
    get hoverRowIndex() {
        return this._hoverRowIndex;
    }
    /**
     * @param {?} rowIdx
     * @return {?}
     */
    set hoverRowIndex(rowIdx) {
        this._hoverRowIndex = rowIdx;
        this.cd.detectChanges();
    }
    /**
     * @return {?}
     */
    get selectedRows() {
        return this.dg.selections;
    }
    //////////////////////////////////////////////////////////////////////////
    /**
     * @return {?}
     */
    get scrollbarXHeight() {
        if (this.dg && this.ps && this.ps.instance) {
            /** @type {?} */
            const h = this.dg.scrollBarShowMode === 'allways' && this.ps.instance['scrollbarXActive'] ? 22 : 0;
            if (this.ps.instance['scrollbarYActive'] && h) {
                return h + 18;
            }
        }
    }
    /**
     * @return {?}
     */
    get scrollbarYWidth() {
        if (this.dg && this.ps && this.ps.instance) {
            return this.dg.scrollBarShowMode === 'allways' && this.ps.instance['scrollbarYActive'] && this.showRightShadow ? 18 : 0;
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.listenSubjects();
        this.dg.scrollInstance = this.ps;
        /** @type {?} */
        const s1 = this.dgs.showGridHeader.subscribe((/**
         * @param {?} headerHeight
         * @return {?}
         */
        headerHeight => {
            this.updateContainerSize(headerHeight);
        }));
        this.subscriptions.push(s1);
        /** @type {?} */
        const s10 = this.dgs.footerPositionChanged.subscribe((/**
         * @return {?}
         */
        () => {
            this.updateContainerSize();
        }));
        this.subscriptions.push(s10);
        /** @type {?} */
        const s2 = this.dgs.rowHeightChanged.subscribe((/**
         * @return {?}
         */
        () => {
            this.cd.detectChanges();
        }));
        this.subscriptions.push(s2);
        /** @type {?} */
        const s3 = this.dfs.clientSort$.subscribe((/**
         * @return {?}
         */
        () => {
            this.checkScrollbarPosition(true);
            this.cd.detectChanges();
            // this.dg.columnSorted.emit();
        }));
        this.subscriptions.push(s3);
        /** @type {?} */
        const s5 = this.dg.dgs.columnsChanged.pipe(delay(100)).subscribe((/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            if (e && e.scrollToLeft) {
                this.ps.elementRef.nativeElement.scrollTo(0, 0);
                this.ps.scrollToLeft(0, 100);
            }
        }));
        this.subscriptions.push(s5);
        this.viewScrollContainer.nativeElement.addEventListener('click', this.onMouseClick.bind(this));
    }
    /**
     * @private
     * @param {?=} headerHeight
     * @return {?}
     */
    updateContainerSize(headerHeight) {
        /** @type {?} */
        const hh = headerHeight || this.dg.realHeaderHeight;
        this.setPositionTop(hh);
        this.height = this.dg.height - this.top;
        this.bodyStyle = this.getBodyStyle();
        this.cd.detectChanges();
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes.data && !changes.data.isFirstChange()) {
            this.bodyStyle = this.getBodyStyle();
            this.dfs.setCurrentPageData(changes.data.currentValue);
            this.onDataChanged();
        }
        if (changes.footerHeight !== undefined && !changes.footerHeight.isFirstChange()) {
            this.bodyStyle = this.getBodyStyle();
        }
        if (changes.scrollBarMode !== undefined && !changes.scrollBarMode.isFirstChange()) {
            if (this.ps && this.ps.instance && this.scrollBarMode === 'allways' && this.ps.instance.scrollbarYActive) {
                this.rightFixedWidth += this.showRightShadow ? 18 : 0;
            }
            else {
                this.rightFixedWidth = this.columnsGroup.rightFixedWidth;
            }
        }
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.destroySubscriptions();
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
    }
    /**
     * @return {?}
     */
    ngAfterViewChecked() {
    }
    /**
     * @private
     * @param {?} headerHeight
     * @return {?}
     */
    setPositionTop(headerHeight) {
        this.top = headerHeight;
        if ((this.dg.enableFilterRow || this.dg.enableSmartFilter) && this.dg.showFilterBar) {
            this.top += this.dg.filterBarHeight;
        }
        if (this.dg.showRowGroupPanel) {
            this.top += this.dg.rowGroupPanelHeight;
        }
        if (this.dg.showFooter && (this.dg.footerPosition === 'top' || this.dg.footerPosition === 'both')) {
            this.top += this.dg.footerHeight;
        }
    }
    /**
     * @private
     * @param {?=} toTop
     * @return {?}
     */
    checkScrollbarPosition(toTop = false) {
        if (!this.dg.data || !this.dg.data.length) {
            return;
        }
        /** @type {?} */
        const scrollBar = this.ps.instance;
        /** @type {?} */
        const scrollElRef = this.ps.elementRef.nativeElement;
        // scrollBar.update();
        /** @type {?} */
        const lastScrollLeft = scrollBar ? scrollBar.lastScrollLeft : 0;
        /** @type {?} */
        const lastScrollTop = scrollBar ? scrollBar.lastScrollTop : 0;
        // const lastScrollLeft = this.scrollLeft;
        // const lastScrollTop = this.scrollTop;
        /** @type {?} */
        const scrollTop = scrollElRef.scrollTop;
        /** @type {?} */
        const scrollLeft = scrollElRef.scrollLeft;
        if (!toTop) {
            if (scrollTop != lastScrollTop) {
                this.ps.scrollToTop(lastScrollTop);
                this.dgs.onScrollMove(lastScrollTop, SCROLL_Y_ACTION);
            }
        }
        else {
            this.ps.scrollToTop();
            this.dgs.onScrollMove(lastScrollTop, SCROLL_Y_ACTION);
        }
        this.scrollLeft = lastScrollLeft;
        if (scrollLeft != lastScrollLeft) {
            this.ps.scrollToX(lastScrollLeft);
            this.dgs.onScrollMove(lastScrollLeft, SCROLL_X_ACTION);
        }
        else {
            if (lastScrollLeft) {
                this.dgs.onScrollMove(lastScrollLeft, SCROLL_X_ACTION);
            }
        }
    }
    /**
     * 数据发生变化，重新加载数据时执行
     * 重置滚动条位置
     * @private
     * @return {?}
     */
    onDataChanged() {
        this.dg.setPagerHeight();
        this.viewportH = this.getViewPortHeight();
        this.bodyStyle = this.getBodyStyle();
        /**
         * update:
         * node_modules\perfect-scrollbar\types\perfect-scrollbar.d.ts
         * lastScrollTop: number
         */
        if (this.ps && this.ps.instance && !this.dg.isEditing() && !this.dg.clientFilterChanged && !this.dg.autoHeight) {
            this.scrollTop = 0;
            this.lastRenderedScrollTop = 0;
            this.ps.scrollToTop();
            this.scrollLeft = 0;
            this.ps.scrollToLeft();
        }
        this.rowsCache = {};
        /** @type {?} */
        const keepscrollPos = (/**
         * @return {?}
         */
        () => {
            /** @type {?} */
            const scrollInfo = this.dg.dfs.getState().scrollInfo;
            if (scrollInfo) {
                if (scrollInfo.y) {
                    this.scrollTop = scrollInfo.y;
                    this.dg.scrollInstance.scrollToY(scrollInfo.y);
                    this.dgs.onScrollMove(scrollInfo.y, SCROLL_Y_ACTION);
                }
                if (scrollInfo.x) {
                    this.scrollLeft = scrollInfo.x;
                    this.dg.scrollInstance.scrollToX(scrollInfo.x);
                    this.dg.dgs.onScrollMove(scrollInfo.x, SCROLL_X_ACTION);
                }
            }
        });
        if (!this.dg.nowrap || this.dg.autoHeight) {
            this.renderData(false);
            setTimeout((/**
             * @return {?}
             */
            () => {
                this.updateRowHeight();
            }), 100);
        }
        else {
            keepscrollPos();
            this.renderData(false);
            this.ps.update();
        }
        this.dg.initSelectOrChecked();
        this.dg.clientFilterChanged = false;
        this.dataChange.emit(this.data);
    }
    /**
     * @private
     * @return {?}
     */
    destroySubscriptions() {
        if (this.subscriptions && this.subscriptions.length) {
            this.subscriptions.forEach((/**
             * @param {?} sub
             * @return {?}
             */
            (sub) => {
                if (sub) {
                    sub.unsubscribe();
                    sub = null;
                }
            }));
            this.subscriptions = [];
        }
    }
    /**
     * @private
     * @return {?}
     */
    listenSubjects() {
        this.destroySubscriptions();
        this.gridSizeSubscribe = this.dfs.gridSize$.pipe(debounceTime(50)).subscribe((/**
         * @param {?} state
         * @return {?}
         */
        state => {
            if (state) {
                this.dg.setPagerHeight();
                /** @type {?} */
                const hh = this.dg.setHeaderHeight();
                this.setPositionTop(hh);
                this.height = state.height - this.top;
                this.width = Math.floor(state.width);
                this.rowHeight = state.rowHeight;
                if (this.dg.showBorder) {
                    this.width -= 2;
                }
                this.viewportW = this.width;
                this.viewportH = this.getViewPortHeight();
                this.canvasHeight = this.getCanvasHeight();
                this.ngZone.runOutsideAngular((/**
                 * @return {?}
                 */
                () => {
                    this.checkScrollbarPosition();
                    this.updateColumnSize(state.columnsGroup);
                    this.cd.detectChanges();
                    this.scrollLeft = this.ps.elementRef.nativeElement.scrollLeft;
                    this.maxScrollLeft = this.colsWidth + this.leftFixedWidth;
                    // grid 容器宽度
                    /** @type {?} */
                    const dgContainerWidth = this.dg.dgContainer.nativeElement.offsetWidth;
                    // 所有列宽之和
                    /** @type {?} */
                    const allColsWidth = Math.floor(this.columnsGroup.totalWidth);
                    // 右侧固定列的位置
                    this.fixedRightScrollLeft = this.width - this.rightFixedWidth + this.scrollLeft;
                    this.bodyStyle = this.getBodyStyle();
                    if (dgContainerWidth > allColsWidth || dgContainerWidth === allColsWidth) {
                        this.showRightShadow = false;
                        this.fixedRightScrollLeft = this.maxScrollLeft;
                    }
                    else {
                        this.showRightShadow = true;
                    }
                    this.renderData(false);
                    if (!this.dg.nowrap || this.dg.autoHeight) {
                        /** @type {?} */
                        let _timer = null;
                        if (_timer) {
                            _timer.clearTimeout();
                        }
                        _timer = setTimeout((/**
                         * @return {?}
                         */
                        () => {
                            this.updateRowHeight();
                            this.ps.update();
                        }), 100);
                    }
                    else {
                        if (!this.cd['destroyed']) {
                            this.ps.update();
                            this.cd.detectChanges();
                        }
                    }
                    // this.ps.update();
                    this.dgs.showFixedShadow.emit({ showRightShadow: this.showRightShadow, x: this.fixedRightScrollLeft });
                }));
                if (this.scrollBarMode === 'allways') {
                    setTimeout((/**
                     * @return {?}
                     */
                    () => {
                        this.updateColumnSize(this.columnsGroup);
                        this.dgs.scrollbarUpdate.emit({ scrollbarRef: this.ps.instance });
                    }), 50);
                }
            }
        }));
        this.subscriptions.push(this.gridSizeSubscribe);
        this.columnResizeSubscribe = this.dfs.columnResize$.subscribe((/**
         * @param {?} cg
         * @return {?}
         */
        (cg) => {
            this.updateColumnSize(cg);
            this.cd.detectChanges();
        }));
        this.subscriptions.push(this.columnResizeSubscribe);
        this.dgs.setSelecedRow.subscribe((/**
         * @param {?} r
         * @return {?}
         */
        (r) => {
            if (r && r.selected) {
                this.currentRowId = r.id;
            }
            else {
                this.currentRowId = undefined;
            }
        }));
        this.selectRowSubscribe = this.dfs.selectRow$.subscribe((/**
         * @param {?} row
         * @return {?}
         */
        (row) => {
            if (row) {
                this.currentRowId = row.id;
                // 20210817 方向键移动后刷新视图状态
                this.cd.detectChanges();
            }
        }));
        this.subscriptions.push(this.selectRowSubscribe);
        this.unselectRowSubscribe = this.dfs.unSelectRow$.subscribe((/**
         * @param {?} prevRow
         * @return {?}
         */
        (prevRow) => {
            if (prevRow && prevRow.id === this.currentRowId) {
                this.currentRowId = undefined;
                this.dg.selectedRow = null;
            }
            if (!this.dg.editable && this.dg.multiSelect) {
                this.__triggerBodyClickEvent = this.dg.selectionMode === 'default';
            }
            this.cd.detectChanges();
        }));
        this.subscriptions.push(this.unselectRowSubscribe);
        this.selectAllSubscribe = this.dfs.selectAll$.subscribe((/**
         * @param {?} rows
         * @return {?}
         */
        (rows) => {
            this.dg.selectAll.emit(rows);
            this.cd.detectChanges();
        }));
        this.subscriptions.push(this.selectAllSubscribe);
        this.checkRowSubscribe = this.dfs.checkRow$.subscribe((/**
         * @param {?} row
         * @return {?}
         */
        (row) => {
            this.dg.checked.emit(row);
            this.checkedRowsChanged();
            // this.cd.detectChanges();
        }));
        this.subscriptions.push(this.checkRowSubscribe);
        this.clearSelectionsSubscribe = this.dfs.clearSelections$.subscribe((/**
         * @return {?}
         */
        () => {
            this.currentRowId = undefined;
            if (this.dg.checkOnSelect) {
                this.checkedRowsChanged();
            }
            this.dg.unSelectAll.emit();
        }));
        this.subscriptions.push(this.clearSelectionsSubscribe);
        this.uncheckRowSubscribe = this.dfs.unCheckRow$.subscribe((/**
         * @param {?} prevRow
         * @return {?}
         */
        (prevRow) => {
            this.dg.unChecked.emit(prevRow);
            this.checkedRowsChanged();
            // this.cd.detectChanges();
        }));
        this.subscriptions.push(this.uncheckRowSubscribe);
        this.checkAllSubscribe = this.dfs.checkAll$.subscribe((/**
         * @param {?} rows
         * @return {?}
         */
        (rows) => {
            this.dg.checkAll.emit(rows);
            this.checkedRowsChanged();
            // this.cd.detectChanges();
        }));
        this.subscriptions.push(this.checkAllSubscribe);
        this.clearCheckedsSubscribe = this.dfs.clearCheckeds$.subscribe((/**
         * @param {?} rows
         * @return {?}
         */
        (rows) => {
            if (this.dg.selectOnCheck) {
                this.currentRowId = undefined;
            }
            this.dg.unCheckAll.emit(rows);
            this.checkedRowsChanged();
            this.cd.detectChanges();
        }));
        this.subscriptions.push(this.clearCheckedsSubscribe);
        this.subscriptions.push(this.dgs.setScrollbarPosition.subscribe((/**
         * @return {?}
         */
        () => {
            this.checkScrollbarPosition();
            this.updateScrollPosition(this.scrollLeft);
        })));
        this.dgs.columnResized.pipe(delay(100)).subscribe((/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            if (!this.dg.nowrap ||
                (this.dg.currentCell && this.dg.currentCell.isEditing && this.dg.currentCell.column &&
                    this.dg.currentCell.column.editor && this.dg.currentCell.column.editor.type === 'textarea')) {
                /** @type {?} */
                const trdoms = this.dg.dgContainer.nativeElement.querySelectorAll('.f-datagrid-body-row:not(f-datagrid-footer-row)');
                trdoms.forEach((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => n.style.height = 'auto'));
                /** @type {?} */
                let trID = '';
                if (e) {
                    /** @type {?} */
                    const rowId = e.id;
                    trID = TR_PREFIX + rowId;
                }
                this.updateRowHeight(trID);
                // trdoms.forEach(n => n.style.height = '');
            }
            if (this.dg.headerWrap) {
                this.dg.setHeaderHeight();
                this.dfs.columnResizeEnd();
            }
        }));
        this.dgs.cellContentWrapChanged.pipe(delay(100)).subscribe((/**
         * @return {?}
         */
        () => {
            this.updateRowHeight();
        }));
        this.dg.dfs.rowUpdate$.subscribe((/**
         * @param {?} row
         * @return {?}
         */
        (row) => {
            if (row && row.data) {
                this.buildCustomCellStyle(row);
            }
        }));
    }
    /**
     * @private
     * @param {?} row
     * @return {?}
     */
    buildCustomCellStyle(row) {
        /** @type {?} */
        let rightTrs = [];
        /** @type {?} */
        let leftTrs = [];
        if (this.fixedRightEl) {
            rightTrs = this.fixedRightEl.nativeElement.querySelectorAll('tr');
        }
        if (this.fixedLeftEl) {
            leftTrs = this.fixedLeftEl.nativeElement.querySelectorAll('.fixed-left-row');
        }
        /** @type {?} */
        const trs = this.mainArea.nativeElement.querySelectorAll('tr.f-datagrid-body-row');
        /** @type {?} */
        const updateCellStyle = (/**
         * @param {?} arr
         * @param {?} col
         * @param {?} style
         * @return {?}
         */
        (arr, col, style) => {
            if (arr.length) {
                /** @type {?} */
                const td = arr[row.index].querySelector(`[field="${col.field}"]`);
                if (td) {
                    this.dg.renderCustomStyle(style, td);
                }
            }
        });
        this.dg.flatColumns.forEach((/**
         * @param {?} col
         * @return {?}
         */
        col => {
            if (col.styler) {
                /** @type {?} */
                const _rd = row.data;
                /** @type {?} */
                const cs = col.styler(_rd[col.field], _rd, row.index);
                if (cs && Object.keys(cs).length) {
                    updateCellStyle(leftTrs, col, cs);
                    updateCellStyle(rightTrs, col, cs);
                    updateCellStyle(trs, col, cs);
                }
            }
        }));
    }
    /**
     * @private
     * @return {?}
     */
    checkedRowsChanged() {
        this.dgs.onCheckedRowsCountChange();
        /** @type {?} */
        const checkedRows = this.dg.checkeds;
        this.dg.checkValues = checkedRows.map((/**
         * @param {?} r
         * @return {?}
         */
        r => r.id));
        this.dg.checkValuesChange.emit(this.dg.checkValues);
        this.dg.checkedChange.emit(checkedRows);
    }
    /**
     * @private
     * @return {?}
     */
    getTrDomHeight() {
        /** @type {?} */
        const list = [];
        /** @type {?} */
        let rightTrs = [];
        /** @type {?} */
        let leftTrs = [];
        /** @type {?} */
        let trdoms = [];
        if (this.fixedRightEl) {
            rightTrs = this.fixedRightEl.nativeElement.querySelectorAll('tr');
        }
        if (this.fixedLeftEl) {
            leftTrs = this.fixedLeftEl.nativeElement.querySelectorAll('.fixed-left-row');
        }
        if (this.mainArea) {
            trdoms = this.mainArea.nativeElement.querySelectorAll('tr.f-datagrid-body-row');
        }
        trdoms.forEach((/**
         * @param {?} tr
         * @param {?} i
         * @return {?}
         */
        (tr, i) => {
            /** @type {?} */
            let t1 = 0;
            /** @type {?} */
            const t2 = Math.ceil(tr.offsetHeight);
            /** @type {?} */
            let t3 = 0;
            if (leftTrs && leftTrs.length) {
                t1 = Math.ceil(leftTrs[i].offsetHeight);
            }
            if (rightTrs && rightTrs.length) {
                t3 = Math.ceil(rightTrs[i].offsetHeight);
            }
            /** @type {?} */
            const _h = Math.max(t1, t2, t3, this.dg.rowHeight);
            list.push(_h);
        }));
        return list;
    }
    /**
     * 允许数据折行时，计算行号的行高
     * @param {?=} trDomId
     * @return {?}
     */
    updateRowHeight(trDomId = null) {
        if (!this.mainArea) {
            return;
        }
        /** @type {?} */
        const dgBody = this.el.nativeElement.querySelector('div.f-datagrid-body');
        if (dgBody) {
            if (!this.dg.nowrap || this.dg.autoHeight) {
                this.render.addClass(dgBody, 'data-wrap');
            }
            else {
                this.render.removeClass(dgBody, 'data-wrap');
            }
        }
        /** @type {?} */
        let cssTextArr = [];
        if (!trDomId) {
            this.rows.forEach((/**
             * @param {?} r
             * @param {?} i
             * @return {?}
             */
            (r, i) => {
                /** @type {?} */
                const rowId = this.dfs.primaryId(r);
                /** @type {?} */
                const trID = TR_PREFIX + rowId;
                /** @type {?} */
                const leftTrId = trID + '_fixedleft';
                /** @type {?} */
                const rightTrId = trID + '_fixedright';
                if (!this.dg.nowrap || this.dg.autoHeight) {
                    /** @type {?} */
                    const list = this.getTrDomHeight();
                    /** @type {?} */
                    const h = list[i];
                    cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body.data-wrap #${leftTrId}{ height: ${h}px }`);
                    cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body.data-wrap #${trID}{ height: ${h}px }`);
                    cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body.data-wrap #${rightTrId}{ height: ${h}px }`);
                }
                else {
                    // cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body #${leftTrId}{ height: ${list[i]}px }`);
                    // cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body #${trID}{ height: ${list[i]}px }`);
                    // cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body #${rightTrId}{ height: ${list[i]}px }`);
                    /** @type {?} */
                    const key1 = `${this.dg.customStyleKey()} .f-datagrid-body #${leftTrId}`;
                    /** @type {?} */
                    const key2 = `${this.dg.customStyleKey()} .f-datagrid-body #${trID}`;
                    /** @type {?} */
                    const key3 = `${this.dg.customStyleKey()} .f-datagrid-body #${rightTrId}`;
                    this.dgs.removeCssRule(key1);
                    this.dgs.removeCssRule(key2);
                    this.dgs.removeCssRule(key3);
                }
            }));
            this.dgs.appendCssRules(cssTextArr);
        }
        else {
            cssTextArr = [];
            /** @type {?} */
            const domSel = '#' + trDomId;
            /** @type {?} */
            const _arr = [];
            if (this.fixedRightEl) {
                /** @type {?} */
                const rtr = this.fixedRightEl.nativeElement.querySelector(domSel);
                if (rtr) {
                    _arr.push(Math.ceil(rtr.offsetHeight));
                }
            }
            if (this.fixedLeftEl) {
                /** @type {?} */
                const ltr = this.fixedLeftEl.nativeElement.querySelector(domSel);
                if (ltr) {
                    _arr.push(Math.ceil(ltr.offsetHeight));
                }
            }
            if (this.mainArea) {
                /** @type {?} */
                const tr = this.mainArea.nativeElement.querySelector(domSel);
                if (tr) {
                    _arr.push(Math.ceil(tr.offsetHeight));
                }
            }
            /** @type {?} */
            const _h = Math.max(..._arr);
            /** @type {?} */
            const leftTrId = trDomId + '_fixedleft';
            /** @type {?} */
            const rightTrId = trDomId + '_fixedright';
            if (!this.dg.nowrap || this.dg.autoHeight) {
                cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body.data-wrap #${leftTrId}{ height: ${_h}px;}`);
                cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body.data-wrap #${trDomId}{ height: ${_h}px;}`);
                cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body.data-wrap #${rightTrId}{ height: ${_h}px;}`);
            }
            else {
                cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body #${leftTrId}{ height: ${_h}px }`);
                cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body #${trDomId}{ height: ${_h}px }`);
                cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body #${rightTrId}{ height: ${_h}px }`);
            }
            this.dgs.appendCssRules(cssTextArr);
        }
        this.updateCanvasHeight();
        // 移除height: auto
        /** @type {?} */
        const trdoms = this.dg.dgContainer.nativeElement.querySelectorAll('.f-datagrid-body-row:not(f-datagrid-footer-row)');
        trdoms.forEach((/**
         * @param {?} n
         * @return {?}
         */
        n => n.style.height = ''));
        if (!this.cd['destroyed']) {
            this.cd.detectChanges();
        }
    }
    /**
     * @private
     * @param {?} cg
     * @return {?}
     */
    updateColumnSize(cg) {
        if (cg) {
            this.columnsGroup = cg;
            this.leftFixedWidth = this.columnsGroup.leftFixedWidth;
            this.rightFixedWidth = this.columnsGroup.rightFixedWidth;
            if (this.ps && this.ps.instance && this.dg.scrollBarShowMode === 'allways' && this.ps.instance.scrollbarYActive) {
                this.rightFixedWidth += this.showRightShadow ? 18 : 0;
            }
            this.colsWidth = this.columnsGroup.normalWidth; // + (this.showRightShadow ? 18 : 0);
            this.totalWidth = this.columnsGroup.totalWidth;
            if (this.scrollBarMode === 'allways' && !this.rightRowsCmp && !this.dg.useControlPanel) {
                this.totalWidth += 18;
            }
        }
    }
    /**
     * @private
     * @return {?}
     */
    getBodyStyle() {
        /** @type {?} */
        let h = this.getViewPortHeight();
        if (!this.data.length) {
            if (this.dg.autoHeight) {
                h = this.dg.emptyDataHeight;
            }
            if (this.dg.footerData && this.dg.showFooter) {
                /** @type {?} */
                let fd = this.dg.footerData;
                if (this.dg.footerData.subscribe) {
                    fd = this.dg.footerData['value'];
                }
                if (fd && Array.isArray(fd) && fd.length) {
                    h = h - this.dg.footerHeight;
                }
            }
        }
        else {
            if (this.dg.showFooter && this.dg.footerPosition === 'both') {
                h = h - this.dg.footerHeight;
            }
        }
        return {
            height: `${Math.floor(h)}px`
        };
    }
    /**
     * @private
     * @param {?} scrollLeft
     * @return {?}
     */
    updateScrollPosition(scrollLeft) {
        this.scrollLeft = scrollLeft;
        this.fixedRightScrollLeft = this.scrollLeft + this.width - this.rightFixedWidth;
        if (this.fixedRightScrollLeft === this.maxScrollLeft || this.fixedRightScrollLeft > this.maxScrollLeft) {
            this.fixedRightScrollLeft = this.maxScrollLeft;
            this.showRightShadow = false;
        }
        else {
            this.showRightShadow = true;
        }
        if (this.fixedLeftEl) {
            this.render.setStyle(this.fixedLeftEl.nativeElement, 'transform', `translate3d(${this.scrollLeft}px, 0px, 0px)`);
        }
        if (this.fixedRightEl) {
            this.render.setStyle(this.fixedRightEl.nativeElement, 'transform', `translate3d(${this.fixedRightScrollLeft}px, 0px, 0px)`);
        }
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onScrollToX($event) {
        /** @type {?} */
        const x = $event.target.scrollLeft;
        this.updateScrollPosition(x);
        // this.cd.detectChanges();
        this.dgs.onScrollMove(x, SCROLL_X_ACTION);
        this.dgs.showFixedShadow.emit({ showRightShadow: this.showRightShadow, x: this.fixedRightScrollLeft });
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onScrollToY($event) {
        /** @type {?} */
        const y = $event.target.scrollTop;
        if (this.dg.virtualized) {
            this.handleScroll();
        }
        this.scrollTop = y;
        this.dg.scrollY.emit(y);
        this.dgs.onScrollMove(y, SCROLL_Y_ACTION);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onPsXReachStart($event) {
        /** @type {?} */
        const x = $event.target.scrollLeft;
        this.updateScrollPosition(x);
        this.dgs.onScrollMove(x, SCROLL_X_REACH_START_ACTION);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onPsXReachEnd($event) {
        this.showRightShadow = false;
        // const x = $event.target.scrollLeft;
        // this.updateScrollPosition(x);
        // this.cd.detectChanges();
        // // this.dgs.onShowFixedShadow(this.showRightShadow);
        // this.dgs.onScrollMove(x, SCROLL_X_REACH_END_ACTION);
    }
    /**
     * @param {?} rowData
     * @return {?}
     */
    isChecked(rowData) {
        if (rowData) {
            return this.dfs.isRowChecked(rowData[this.dg.idField]);
        }
        else {
            return false;
        }
    }
    /**
     * @param {?} rowData
     * @return {?}
     */
    isSelected(rowData) {
        if (rowData) {
            return this.dfs.isRowSelected(rowData[this.dg.idField]);
        }
        return false;
    }
    /**
     * @param {?} row
     * @param {?=} open
     * @return {?}
     */
    toggleGroupRow(row, open = true) {
        row.expanded = open;
        this.ps.update();
    }
    /** =================================== 分 ====== 隔 ====== 线 =================================== */
    /**
     * 获取可视区域高度
     * @private
     * @return {?}
     */
    getViewPortHeight() {
        /** @type {?} */
        let viewPortHeight = this.dg.height;
        if (this.dg.showHeader) {
            viewPortHeight = viewPortHeight - this.dg.realHeaderHeight;
        }
        if ((this.dg.enableFilterRow || this.dg.enableSmartFilter) && this.dg.showFilterBar) {
            viewPortHeight -= this.dg.filterBarHeight;
        }
        if (this.dg.showRowGroupPanel) {
            viewPortHeight -= this.dg.rowGroupPanelHeight;
        }
        if (this.dg.showFooter && this.data.length) {
            viewPortHeight = viewPortHeight - this.dg.footerHeight;
        }
        if (this.dg.pagination) {
            viewPortHeight = viewPortHeight - this.dg.pagerHeight - 2;
        }
        if (this.dg.showBorder) {
            viewPortHeight -= 2;
        }
        this.viewportH = viewPortHeight;
        return viewPortHeight;
    }
    // 不折行时，所有数据的高度
    /**
     * @private
     * @return {?}
     */
    allRowsHeight() {
        /** @type {?} */
        const rowHeightpatch = 1;
        // this.dg.autoHeight ? 2 : 1;
        /** @type {?} */
        const rowHeight = this.dg.rowHeight + rowHeightpatch;
        /** @type {?} */
        let itemsCount = 0;
        if (this.dg.groupSummaryPosition === 'inGroupRow') {
            itemsCount = this.data.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => !n['__group_footer__'])).length;
        }
        else {
            itemsCount = this.data.length;
        }
        /** @type {?} */
        let h = itemsCount * rowHeight;
        if (this.dg.autoHeight) {
            h += itemsCount;
        }
        else {
            h += 2;
        }
        return h;
    }
    /**
     * @private
     * @return {?}
     */
    getCanvasHeight() {
        /** @type {?} */
        let canvasHeight = 0;
        if (!this.data || !this.data.length) {
            this.canvasHeight = 0;
            return 0;
        }
        if (this.dg.nowrap) {
            canvasHeight = this.allRowsHeight();
        }
        else {
            canvasHeight = this.getTrDomHeight().reduce((/**
             * @param {?} r
             * @param {?} c
             * @return {?}
             */
            (r, c) => r + c), 0);
        }
        if (!canvasHeight) {
            canvasHeight = this.viewportH;
        }
        this.canvasHeight = canvasHeight;
        return canvasHeight;
    }
    /**
     * @return {?}
     */
    updateCanvasHeight() {
        this.canvasHeight = this.getCanvasHeight();
    }
    /**
     * @private
     * @param {?} y
     * @return {?}
     */
    getRowFromPosition(y) {
        return Math.floor(y / (this.dg.rowHeight + 1));
    }
    /**
     * @param {?=} viewportTop
     * @param {?=} viewportLeft
     * @return {?}
     */
    getVisibleRange(viewportTop, viewportLeft) {
        if (viewportTop == null) {
            viewportTop = this.scrollTop;
        }
        if (viewportLeft == null) {
            viewportLeft = this.scrollLeft;
        }
        return {
            top: this.getRowFromPosition(viewportTop),
            bottom: this.getRowFromPosition(viewportTop + this.viewportH) + 1,
            leftPx: viewportLeft,
            rightPx: viewportLeft + this.viewportW
        };
    }
    /**
     * @private
     * @param {?=} viewportTop
     * @param {?=} viewportLeft
     * @return {?}
     */
    getRenderedRange(viewportTop, viewportLeft) {
        /** @type {?} */
        const range = this.getVisibleRange(viewportTop, viewportLeft);
        /** @type {?} */
        const buffer = Math.round(this.viewportH / (this.dg.rowHeight + 1));
        /** @type {?} */
        const minBuffer = this.minRowBuffer;
        if (this.vScrollDir == -1) {
            range.top -= buffer;
            range.bottom += minBuffer;
        }
        else if (this.vScrollDir == 1) {
            range.top -= minBuffer;
            range.bottom += buffer;
        }
        else {
            range.top -= minBuffer;
            range.bottom += minBuffer;
        }
        range.top = Math.max(0, range.top);
        range.bottom = Math.min(this.data.length - 1, range.bottom);
        range.leftPx -= this.viewportW;
        range.rightPx += this.viewportW;
        range.leftPx = Math.max(0, range.leftPx);
        range.rightPx = Math.min(this.canvasWidth, range.rightPx);
        return range;
    }
    /**
     * @private
     * @param {?} range
     * @return {?}
     */
    renderRows(range) {
        /** @type {?} */
        const rows = [];
        /** @type {?} */
        const dataLength = this.data.length;
        for (let i = range.top; i <= range.bottom; i++) {
            if (this.rowsCache[i] || (i == dataLength)) {
                continue;
            }
            rows.push(i);
            // Create an entry right away so that appendRowHtml() can
            // start populatating it.
            this.rowsCache[i] = {
                rowNode: null,
                // ColSpans of rendered cells (by column idx).
                // Can also be used for checking whether a cell has been rendered.
                cellColSpans: [],
                // Cell nodes (by column idx).  Lazy-populated by ensureCellNodesInRowsCache().
                cellNodesByColumnIdx: [],
                // Column indices of cell nodes that have been rendered, but not yet indexed in
                // cellNodesByColumnIdx.  These are in the same order as cell nodes added at the
                // end of the row.
                cellRenderQueue: []
            };
        }
        for (let i = 0, ii = rows.length; i < ii; i++) {
            this.rowsCache[rows[i]].rowNode = this.data[rows[i]];
        }
        return Object.keys(this.rowsCache).map((/**
         * @param {?} n
         * @return {?}
         */
        n => this.rowsCache[n].rowNode));
    }
    /**
     * @private
     * @param {?} row
     * @return {?}
     */
    removeRowFromCache(row) {
        /** @type {?} */
        const cacheEntry = this.rowsCache[row];
        if (!cacheEntry) {
            return;
        }
        delete this.rowsCache[row];
    }
    /**
     * @private
     * @param {?} rangeToKeep
     * @return {?}
     */
    cleanupRows(rangeToKeep) {
        for (const i in this.rowsCache) {
            if (i < rangeToKeep.top || i > rangeToKeep.bottom) {
                this.removeRowFromCache(i);
            }
        }
    }
    /**
     * @private
     * @param {?=} detectchanges
     * @return {?}
     */
    renderData(detectchanges = true) {
        this.canvasHeight = this.getCanvasHeight();
        if (!this.dg.virtualized || this.dg.autoHeight) {
            this.rows = this.data;
        }
        else {
            /** @type {?} */
            const visible = this.getVisibleRange();
            /** @type {?} */
            const rendered = this.getRenderedRange();
            // remove rows no longer in the viewport
            this.cleanupRows(rendered);
            // render missing rows
            this.rows = this.renderRows(rendered);
            this.startRowIndex = rendered.top;
            this.blankTopHeight = this.startRowIndex * (this.dg.rowHeight + 1);
            this.blankBottomHeight = this.canvasHeight - this.blankTopHeight - (this.rows.length * (this.dg.rowHeight + 1));
            this.lastRenderedScrollTop = this.scrollTop;
            this.lastRenderedScrollLeft = this.scrollLeft;
            if (detectchanges) {
                this.cd.detectChanges();
            }
        }
    }
    /**
     * @private
     * @return {?}
     */
    handleScroll() {
        this.scrollTop = this.ps.elementRef.nativeElement.scrollTop;
        this.scrollLeft = this.ps.elementRef.nativeElement.scrollLeft;
        return this._handleScroll();
    }
    /**
     * @private
     * @return {?}
     */
    _handleScroll() {
        /** @type {?} */
        const viewportContainer = this.viewScrollContainer.nativeElement;
        /** @type {?} */
        let maxScrollDistanceY = viewportContainer.scrollHeight - viewportContainer.clientHeight;
        /** @type {?} */
        let maxScrollDistanceX = viewportContainer.scrollWidth - viewportContainer.clientWidth;
        // Protect against erroneous clientHeight/Width greater than scrollHeight/Width.
        // Sometimes seen in Chrome.
        maxScrollDistanceY = Math.max(0, maxScrollDistanceY);
        maxScrollDistanceX = Math.max(0, maxScrollDistanceX);
        // Ceiling the max scroll values
        if (this.scrollTop > maxScrollDistanceY) {
            this.scrollTop = maxScrollDistanceY;
        }
        if (this.scrollLeft > maxScrollDistanceX) {
            this.scrollLeft = maxScrollDistanceX;
        }
        /** @type {?} */
        const vScrollDist = Math.abs(this.scrollTop - this.prevScrollTop);
        /** @type {?} */
        const hScrollDist = Math.abs(this.scrollLeft - this.prevScrollLeft);
        if (hScrollDist) {
            this.prevScrollLeft = this.scrollLeft;
            // $viewportScrollContainerX[0].scrollLeft = scrollLeft;
            // if (hasFrozenColumns()) {
            //     if (hasFrozenRows) {
            //         $viewportTopR[0].scrollLeft = scrollLeft;
            //     }
            // } else {
            //     if (hasFrozenRows) {
            //         $viewportTopL[0].scrollLeft = scrollLeft;
            //     }
            // }
        }
        if (vScrollDist) {
            this.vScrollDir = this.prevScrollTop < this.scrollTop ? 1 : -1;
            this.prevScrollTop = this.scrollTop;
            // if (hasFrozenColumns()) {
            //     if (hasFrozenRows && !options.frozenBottom) {
            //         $viewportBottomL[0].scrollTop = scrollTop;
            //     } else {
            //         $viewportTopL[0].scrollTop = scrollTop;
            //     }
            // }
            // switch virtual pages if needed
            if (vScrollDist < this.viewportH) {
                this._scrollTo(this.scrollTop);
            }
        }
        if (hScrollDist || vScrollDist) {
            /** @type {?} */
            const dx = Math.abs(this.lastRenderedScrollLeft - this.scrollLeft);
            /** @type {?} */
            const dy = Math.abs(this.lastRenderedScrollTop - this.scrollTop);
            if (dx > 20 || dy > 20) {
                // if rendering is forced or scrolling is small enough to be "easy", just render
                if (dy < this.viewportH && dx < this.viewportW) {
                    this.renderData();
                }
                else {
                    this.renderData();
                }
            }
        }
        if (hScrollDist || vScrollDist) {
            return true;
        }
        return false;
    }
    /**
     * @private
     * @param {?} y
     * @return {?}
     */
    _scrollTo(y) {
        /** @type {?} */
        const $viewportScrollContainerY = this.viewScrollContainer.nativeElement;
        y = Math.max(y, 0);
        y = Math.min(y, this.canvasHeight - this.viewportH);
        /** @type {?} */
        const newScrollTop = y;
        if (this.prevScrollTop != newScrollTop) {
            this.vScrollDir = (this.prevScrollTop < newScrollTop) ? 1 : -1;
            this.lastRenderedScrollTop = (this.scrollTop = this.prevScrollTop = newScrollTop);
            // if (hasFrozenColumns()) {
            //     $viewportTopL[0].scrollTop = newScrollTop;
            // }
            // if (hasFrozenRows) {
            //     $viewportBottomL[0].scrollTop = $viewportBottomR[0].scrollTop = newScrollTop;
            // }
            // $viewportScrollContainerY.scrollTop = newScrollTop;
        }
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onMouseClick($event) {
        // document.body.click();
        /** @type {?} */
        const target = (/** @type {?} */ ($event.target));
        if (target.nodeName === 'TEXTAREA' || target.nodeName === 'INPUT') {
            return;
        }
        /** @type {?} */
        let td = target;
        if (target.nodeName !== 'TD') {
            td = target.closest('TD');
        }
        if (!this.dg.editable && this.__triggerBodyClickEvent) {
            // 解决超链点击事件，要先执行选中行
            if (td && td.selectCell) {
                $event.stopPropagation();
                td.selectCell($event, td); // 按理说可以删除的，但不敢动哦o(≧口≦)o
            }
            return;
        }
        if (this.dg.editMode === 'row') {
            return;
        }
        if (td) {
            // 行禁用时
            if (this.dg.disableRow && td.gridCellData) {
                const { rowData, rowIndex } = td.gridCellData;
                if (this.dg.disableRow(rowData, rowIndex)) {
                    return;
                }
            }
            if (this.dg.editable && this.dg.editMode === 'cell' && td.edit) {
                td.edit($event);
            }
            else {
                if (td.selectCell) {
                    $event.stopPropagation();
                    td.closeEdit();
                    td.selectCell($event, td);
                }
            }
        }
    }
}
DatagridBodyComponent.decorators = [
    { type: Component, args: [{
                selector: 'datagrid-body',
                template: "<!--\r\n * @Author: \u75AF\u72C2\u79C0\u624D(Lucas Huang)\r\n * @Date: 2019-08-06 07:43:07\r\n * @LastEditors: \u75AF\u72C2\u79C0\u624D(Lucas Huang)\r\n * @LastEditTime: 2019-11-26 08:20:46\r\n * @QQ: 1055818239\r\n * @Version: v0.0.1\r\n -->\r\n\r\n<ng-container  *ngIf=\"!data || !data.length\">\r\n    <div *ngIf=\"!dg.emptyTemplate\" class=\"d-flex flex-column f-datagrid-norecords\" style=\"position:absolute; margin:0;left: 0; z-index: 1;justify-content: center; align-items: center;\" [ngStyle]=\"bodyStyle\" [style.top.px]=\"top\" [style.width.px]=\"viewportW\" >\r\n        <div class=\"f-datagrid-norecords-content\" style=\"margin: 0;width: 100%;position: relative; top: 0\">\r\n            {{ 'datagrid.emptyMessage' | locale }}\r\n        </div>\r\n    </div>\r\n    <div class=\"f-datagrid-body\" [ngStyle]=\"bodyStyle\" [style.top.px]=\"top\" [style.width.px]=\"viewportW\" style=\"z-index: 1;\"  *ngIf=\"dg.emptyTemplate\">\r\n        <ng-container #emptyTemplate [ngTemplateOutlet]=\"dg.emptyTemplate\" ></ng-container>\r\n    </div>\r\n</ng-container>\r\n<div  class=\"f-datagrid-body\" [ngStyle]=\"bodyStyle\" [style.top.px]=\"top\" [style.width.px]=\"viewportW\" \r\n[farris-context-menus]=\"contextMenuItems\" [disabled]=\"!dg.enableContextMenu\" [activeDomName]=\"'tr'\" [beforeShowContextMenu]=\"onBeforeShowContextMenu\"\r\n[menuClass]=\"'f-datagrid-context-menu'\">\r\n\r\n    <div #viewScrollContainer [scrollbar]=\"psConfig\" #ps=\"ngxScrollbar\"\r\n        class=\"ps f-datagrid-body-wheel-area\" \r\n        [ngStyle]=\"bodyStyle\" style=\"width: 100%;\"\r\n        (psXReachEnd)=\"onPsXReachEnd($event)\"\r\n        (psScrollY)=\"onScrollToY($event)\"\r\n        (psScrollX)=\"onScrollToX($event)\" (psXReachStart)=\"onPsXReachStart($event)\"\r\n        [style.paddingBottom.px]=\"scrollbarXHeight\"\r\n        [style.paddingRight.px]=\"scrollbarYWidth\">\r\n       \r\n        <div class=\"f-datagrid-norecords\"  [auto-height]=\"dg.autoHeight\" [wheelHeight]=\"dg.emptyDataHeight || 240\" style=\"height: 100%\" [style.width.px]=\"canvasWidth - 2\"  *ngIf=\"!data || !data.length\">\r\n            <!-- <div *ngIf=\"!dg.emptyTemplate\" class=\"f-datagrid-norecords-content\" style=\"width: 100%\" >{{ 'datagrid.emptyMessage' | locale }}</div>\r\n            <ng-container #emptyTemplate *ngIf=\"dg.emptyTemplate\" [ngTemplateOutlet]=\"dg.emptyTemplate\" ></ng-container> -->\r\n        </div>\r\n\r\n        <div [style.display]=\"dg.flatColumns?.length ? '': 'none'\"  *ngIf=\"data && data.length\"\r\n            class=\"f-datagrid-bg\" [auto-height]=\"dg.autoHeight\" [wheelHeight]=\"canvasHeight\"\r\n            [style.height.px]=\"canvasHeight\" [style.width.px]=\"totalWidth\" >\r\n            \r\n                <div #blankTop hidefocus style=\"width: 100%\" [style.height.px]=\"blankTopHeight\"></div>\r\n                \r\n                <div #fixedLeft class=\"f-datagrid-table f-datagrid-body-fixed-left\"  [class.f-datagrid-fixed-left-shadow]=\"!!scrollLeft && !dg.groupRows\"\r\n                    *ngIf=\"dg.showLineNumber || dg.showCheckbox || (columnsGroup?.leftFixed && columnsGroup?.leftFixed.length)\"  [style.width.px]=\"leftFixedWidth\" \r\n                    [style.transform]=\"'translate3d('+ scrollLeft +'px, 0px, 0px)'\">\r\n\r\n                    <fixed-left-rows [columns]=\"columnsGroup?.leftFixed\" [checkedRows]=\"checkedRows\" [selectedRows]=\"selectedRows\" [data]=\"rows\"></fixed-left-rows>\r\n                </div>\r\n\r\n                <div #fixedRight class=\"f-datagrid-table f-datagrid-body-fixed-right\" [style.width.px]=\"rightFixedWidth\" \r\n                    *ngIf=\"columnsGroup?.rightFixed && columnsGroup?.rightFixed.length\"\r\n                    [class.f-datagrid-fixed-right-shadow]=\"showRightShadow\" \r\n                    style=\"border: 0\"\r\n                    [style.transform]=\"'translate3d('+ fixedRightScrollLeft +'px, 0px, 0px)'\">\r\n                    \r\n                    <datagrid-rows #rightRows [fixedRight]=\"true\" [startRowIndex]=\"startRowIndex\" [columns]=\"columnsGroup?.rightFixed\" [data]=\"rows\"></datagrid-rows>\r\n                </div>\r\n\r\n                <div #main [style.width.px]=\"colsWidth\" style=\"position: relative;\" [style.left.px]=\"leftFixedWidth\" class=\"f-datagrid-table f-datagrid-body-center\">\r\n                    <datagrid-rows #mainRows  [startRowIndex]=\"startRowIndex\" [columns]=\"columnsGroup?.normalColumns\" [data]=\"rows\"></datagrid-rows>\r\n                </div>\r\n\r\n                <div hidefocus style=\"width: 100%\" [style.height.px]=\"blankBottomHeight\"></div>\r\n\r\n        </div>\r\n\r\n    </div>\r\n</div>",
                changeDetection: ChangeDetectionStrategy.OnPush
            }] }
];
/** @nocollapse */
DatagridBodyComponent.ctorParameters = () => [
    { type: Injector },
    { type: ApplicationRef },
    { type: DatagridComponent, decorators: [{ type: Optional }] },
    { type: ChangeDetectorRef },
    { type: ElementRef }
];
DatagridBodyComponent.propDecorators = {
    footerHeight: [{ type: Input }],
    canvasWidth: [{ type: Input }],
    columnsGroup: [{ type: Input }],
    topHideHeight: [{ type: Input }],
    bottomHideHeight: [{ type: Input }],
    startRowIndex: [{ type: Input }],
    data: [{ type: Input }],
    dataChange: [{ type: Output }],
    scrollBarMode: [{ type: Input }],
    contextMenuItems: [{ type: Input }],
    checkedRows: [{ type: Input }],
    ps: [{ type: ViewChild, args: ['ps',] }],
    tableRowsCmp: [{ type: ViewChild, args: ['mainRows',] }],
    rightRowsCmp: [{ type: ViewChild, args: ['rightRows',] }],
    fixedLeftEl: [{ type: ViewChild, args: ['fixedLeft',] }],
    fixedRightEl: [{ type: ViewChild, args: ['fixedRight',] }],
    mainArea: [{ type: ViewChild, args: ['main',] }],
    viewScrollContainer: [{ type: ViewChild, args: ['viewScrollContainer',] }]
};
if (false) {
    /** @type {?} */
    DatagridBodyComponent.prototype.psConfig;
    /** @type {?} */
    DatagridBodyComponent.prototype.top;
    /** @type {?} */
    DatagridBodyComponent.prototype.height;
    /** @type {?} */
    DatagridBodyComponent.prototype.width;
    /** @type {?} */
    DatagridBodyComponent.prototype.colsWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.totalWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.leftFixedWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.rightFixedWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.rowHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.bodyStyle;
    /** @type {?} */
    DatagridBodyComponent.prototype.scrollTop;
    /** @type {?} */
    DatagridBodyComponent.prototype.scrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.deltaTopHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.wheelWidth;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._fixedRightScrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.maxScrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.showRightShadow;
    /** @type {?} */
    DatagridBodyComponent.prototype.footerHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.canvasWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.columnsGroup;
    /** @type {?} */
    DatagridBodyComponent.prototype.topHideHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.bottomHideHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.startRowIndex;
    /** @type {?} */
    DatagridBodyComponent.prototype.data;
    /** @type {?} */
    DatagridBodyComponent.prototype.dataChange;
    /** @type {?} */
    DatagridBodyComponent.prototype.scrollBarMode;
    /** @type {?} */
    DatagridBodyComponent.prototype.contextMenuItems;
    /** @type {?} */
    DatagridBodyComponent.prototype.checkedRows;
    /** @type {?} */
    DatagridBodyComponent.prototype.ps;
    /** @type {?} */
    DatagridBodyComponent.prototype.tableRowsCmp;
    /** @type {?} */
    DatagridBodyComponent.prototype.rightRowsCmp;
    /** @type {?} */
    DatagridBodyComponent.prototype.fixedLeftEl;
    /** @type {?} */
    DatagridBodyComponent.prototype.fixedRightEl;
    /** @type {?} */
    DatagridBodyComponent.prototype.mainArea;
    /** @type {?} */
    DatagridBodyComponent.prototype.viewScrollContainer;
    /** @type {?} */
    DatagridBodyComponent.prototype.visibleContextMenus;
    /** @type {?} */
    DatagridBodyComponent.prototype.currentRowId;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._hoverRowIndex;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.gridSizeSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.columnResizeSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.onDataSourceChangeSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.selectRowSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.unselectRowSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.selectAllSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.checkRowSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.clearSelectionsSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.checkAllSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.uncheckRowSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.clearCheckedsSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.subscriptions;
    /** @type {?} */
    DatagridBodyComponent.prototype.dfs;
    /** @type {?} */
    DatagridBodyComponent.prototype.dgs;
    /** @type {?} */
    DatagridBodyComponent.prototype.ngZone;
    /** @type {?} */
    DatagridBodyComponent.prototype.render;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.viewportH;
    /** @type {?} */
    DatagridBodyComponent.prototype.viewportW;
    /** @type {?} */
    DatagridBodyComponent.prototype.canvasHeight;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.minRowBuffer;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.vScrollDir;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.rowsCache;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.lastRenderedScrollTop;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.lastRenderedScrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.prevScrollTop;
    /** @type {?} */
    DatagridBodyComponent.prototype.prevScrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.rows;
    /** @type {?} */
    DatagridBodyComponent.prototype.blankTopHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.blankBottomHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.cellContentFormatter;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.__triggerBodyClickEvent;
    /** @type {?} */
    DatagridBodyComponent.prototype.onBeforeShowContextMenu;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.app;
    /** @type {?} */
    DatagridBodyComponent.prototype.dg;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.cd;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.el;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWdyaWQtYm9keS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLWRhdGFncmlkLyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvYm9keS9kYXRhZ3JpZC1ib2R5LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQ0EsT0FBTyxFQUFvQixLQUFLLEVBQUUsWUFBWSxFQUFPLE1BQU0sZ0JBQWdCLENBQUM7QUFDNUUsT0FBTyxFQUEwQixFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7Ozs7Ozs7OztBQVNsRCxPQUFPLEVBQ0gsU0FBUyxFQUFVLEtBQUssRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUM5QyxVQUFVLEVBQWEsaUJBQWlCLEVBQ2QsdUJBQXVCLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBc0IsUUFBUSxFQUFFLGNBQWMsRUFBZ0IsTUFBTSxFQUFFLFlBQVksRUFDeEosTUFBTSxlQUFlLENBQUM7QUFFdkIsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sd0NBQXdDLENBQUM7QUFDL0UsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0scUNBQXFDLENBQUM7QUFHekUsT0FBTyxFQUFFLGVBQWUsRUFBRSxlQUFlLEVBQUUsMkJBQTJCLEVBQTZCLFNBQVMsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQzNJLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUNsRSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUM3RCxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUN2RSxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQU8vRCxNQUFNLE9BQU8scUJBQXFCOzs7Ozs7OztJQTZIOUIsWUFDWSxRQUFrQixFQUNsQixHQUFtQixFQUNSLEVBQXFCLEVBQ2hDLEVBQXFCLEVBQVUsRUFBYztRQUg3QyxhQUFRLEdB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bURBQXlDOzs7OztJQUN6QyxrREFBd0M7Ozs7O0lBQ3hDLHlEQUErQzs7Ozs7SUFDL0Msa0RBQXdDOzs7OztJQUN4QyxvREFBMEM7Ozs7O0lBQzFDLHVEQUE2Qzs7Ozs7SUFFN0MsOENBQTJCOztJQUUzQixvQ0FBa0M7O0lBQ2xDLG9DQUE0Qjs7SUFDNUIsdUNBQXNCOztJQUN0Qix1Q0FBeUI7Ozs7O0lBR3pCLDBDQUFrQjs7SUFDbEIsMENBQVU7O0lBQ1YsNkNBQWE7Ozs7O0lBQ2IsNkNBQXlCOzs7OztJQUN6QiwyQ0FBdUI7Ozs7O0lBQ3ZCLDBDQUF1Qjs7Ozs7SUFDdkIsc0RBQWtDOzs7OztJQUNsQyx1REFBbUM7O0lBQ25DLDhDQUFrQjs7SUFDbEIsK0NBQW1COztJQUNuQixxQ0FBVTs7SUFDViwrQ0FBbUI7O0lBQ25CLGtEQUFzQjs7SUFpQnRCLHFEQUFnRDs7Ozs7SUFHaEQsd0RBQXVDOztJQTJqQ3ZDLHdEQXFCQzs7Ozs7SUE3a0NHLHlDQUEwQjs7Ozs7SUFDMUIsb0NBQTJCOztJQUMzQixtQ0FBd0M7Ozs7O0lBQ3hDLG1DQUE2Qjs7Ozs7SUFBRSxtQ0FBc0IiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuaW1wb3J0IHsgZmlyc3QsIHN3aXRjaE1hcCwgZGVsYXksIGRlYm91bmNlVGltZSwgdGFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBTdWJzY3JpcHRpb24sIGludGVydmFsLCBvZiB9IGZyb20gJ3J4anMnO1xyXG4vKlxyXG4gKiBAQXV0aG9yOiDnlq/ni4Lnp4DmiY0oTHVjYXMgSHVhbmcpXHJcbiAqIEBEYXRlOiAyMDE5LTA4LTEyIDA3OjQ3OjEyXHJcbiAqIEBMYXN0RWRpdG9yczog55av54uC56eA5omNKEx1Y2FzIEh1YW5nKVxyXG4gKiBATGFzdEVkaXRUaW1lOiAyMDE5LTExLTI2IDEwOjIxOjI1XHJcbiAqIEBRUTogMTA1NTgxODIzOVxyXG4gKiBAVmVyc2lvbjogdjAuMC4xXHJcbiAqL1xyXG5pbXBvcnQge1xyXG4gICAgQ29tcG9uZW50LCBPbkluaXQsIElucHV0LCBWaWV3Q2hpbGQsIFJlbmRlcmVyMixcclxuICAgIEVsZW1lbnRSZWYsIE9uRGVzdHJveSwgQ2hhbmdlRGV0ZWN0b3JSZWYsIEFmdGVyVmlld0luaXQsIEFmdGVyVmlld0NoZWNrZWQsXHJcbiAgICBPbkNoYW5nZXMsIFNpbXBsZUNoYW5nZXMsIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LCBOZ1pvbmUsIEluamVjdG9yLCBmb3J3YXJkUmVmLCBJbmplY3QsIE9wdGlvbmFsLCBBcHBsaWNhdGlvblJlZiwgSG9zdExpc3RlbmVyLCBPdXRwdXQsIEV2ZW50RW1pdHRlclxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5cclxuaW1wb3J0IHsgRGF0YWdyaWRGYWNhZGVTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvZGF0YWdyaWQtZmFjYWRlLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBTY3JvbGxiYXJEaXJlY3RpdmUgfSBmcm9tICcuLi8uLi9zY3JvbGxiYXIvc2Nyb2xsYmFyLmRpcmVjdGl2ZSc7XHJcbmltcG9ydCB7IENvbHVtbkdyb3VwIH0gZnJvbSAnLi4vLi4vdHlwZXMnO1xyXG5pbXBvcnQgeyBTZWxlY3RlZFJvdywgRGF0YVJlc3VsdCwgUk9XX0lOREVYX0ZJRUxELCBJU19HUk9VUF9ST1dfRklFTEQsIEdST1VQX1JPV19GSUVMRCwgSVNfR1JPVVBfRk9PVEVSX1JPV19GSUVMRCB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL3N0YXRlJztcclxuaW1wb3J0IHsgU0NST0xMX1hfQUNUSU9OLCBTQ1JPTExfWV9BQ1RJT04sIFNDUk9MTF9YX1JFQUNIX1NUQVJUX0FDVElPTiwgU0NST0xMX1hfUkVBQ0hfRU5EX0FDVElPTiwgVFJfUFJFRklYIH0gZnJvbSAnLi4vLi4vdHlwZXMvY29uc3RhbnQnO1xyXG5pbXBvcnQgeyBEYXRhZ3JpZFNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9kYXRhZ3JpZC5zZXJ2aWNlJztcclxuaW1wb3J0IHsgRGF0YWdyaWRDb21wb25lbnQgfSBmcm9tICcuLi8uLi9kYXRhZ3JpZC5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBGb3JtYXRDZWxsRGF0YVBpcGUgfSBmcm9tICcuLi8uLi91dGlscy9mb3JtYXQtY2VsbC1kYXRhLnBpcGUnO1xyXG5pbXBvcnQgeyBDb2x1bW5Gb3JtYXRTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1jb21tb24vY29sdW1uJztcclxuaW1wb3J0IHsgQ29udGV4dE1lbnVJdGVtIH0gZnJvbSAnQGZhcnJpcy91aS1jb250ZXh0LW1lbnUnO1xyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnZGF0YWdyaWQtYm9keScsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vYm9keS5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaFxyXG59KVxyXG5leHBvcnQgY2xhc3MgRGF0YWdyaWRCb2R5Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3ksIE9uQ2hhbmdlcywgQWZ0ZXJWaWV3SW5pdCwgQWZ0ZXJWaWV3Q2hlY2tlZCB7XHJcbiAgICAvLyDoh6rliqjpq5jluqbml7bvvIznpoHnlKjnurXlkJHmu5rliqjmnaFcclxuICAgIHBzQ29uZmlnID0geyBzd2lwZUVhc2luZzogZmFsc2UsIG1pblNjcm9sbGJhckxlbmd0aDogMTUsIGhhbmRsZXJzOiBbJ2NsaWNrLXJhaWwnLCAnZHJhZy10aHVtYicsICd3aGVlbCcsICd0b3VjaCddLCBzdXBwcmVzc1Njcm9sbFk6IHRoaXMuZGcuYXV0b0hlaWdodCB9O1xyXG5cclxuICAgIHRvcDogbnVtYmVyO1xyXG4gICAgaGVpZ2h0OiBudW1iZXI7XHJcbiAgICB3aWR0aDogbnVtYmVyO1xyXG4gICAgY29sc1dpZHRoOiBudW1iZXI7XHJcbiAgICB0b3RhbFdpZHRoOiBudW1iZXI7XHJcbiAgICBsZWZ0Rml4ZWRXaWR0aDogbnVtYmVyO1xyXG4gICAgcmlnaHRGaXhlZFdpZHRoOiBudW1iZXI7XHJcbiAgICByb3dIZWlnaHQ6IG51bWJlcjtcclxuICAgIGJvZHlTdHlsZTogYW55O1xyXG4gICAgc2Nyb2xsVG9wID0gMDtcclxuICAgIHNjcm9sbExlZnQgPSAwO1xyXG4gICAgZGVsdGFUb3BIZWlnaHQgPSAwO1xyXG4gICAgLy8gd2hlZWxIZWlnaHQgPSAwO1xyXG4gICAgd2hlZWxXaWR0aCA9IDA7XHJcbiAgICBwcml2YXRlIF9maXhlZFJpZ2h0U2Nyb2xsTGVmdCA9IDA7XHJcbiAgICBnZXQgZml4ZWRSaWdodFNjcm9sbExlZnQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZpeGVkUmlnaHRTY3JvbGxMZWZ0O1xyXG4gICAgfVxyXG4gICAgc2V0IGZpeGVkUmlnaHRTY3JvbGxMZWZ0KHZhbCkge1xyXG4gICAgICAgIC8vIHRoaXMuX2ZpeGVkUmlnaHRTY3JvbGxMZWZ0ID0gdGhpcy5kZy5zY3JvbGxCYXJTaG93TW9kZSA9PT0gJ2FsbHdheXMnID8gIHZhbCAtIDE4IDogdmFsO1xyXG4gICAgICAgIHRoaXMuX2ZpeGVkUmlnaHRTY3JvbGxMZWZ0ID0gdmFsO1xyXG4gICAgfVxyXG5cclxuICAgIG1heFNjcm9sbExlZnQgPSAwO1xyXG4gICAgc2hvd1JpZ2h0U2hhZG93ID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBmb290ZXJIZWlnaHQgPSAwO1xyXG4gICAgQElucHV0KCkgY2FudmFzV2lkdGg7XHJcbiAgICBASW5wdXQoKSBjb2x1bW5zR3JvdXA6IENvbHVtbkdyb3VwO1xyXG4gICAgLy8g6Jma5ouf5Yqg6L29XHJcbiAgICBASW5wdXQoKSB0b3BIaWRlSGVpZ2h0ID0gMDtcclxuICAgIEBJbnB1dCgpIGJvdHRvbUhpZGVIZWlnaHQgPSAwO1xyXG5cclxuICAgIEBJbnB1dCgpIHN0YXJ0Um93SW5kZXggPSAwO1xyXG4gICAgQElucHV0KCkgZGF0YTogYW55O1xyXG5cclxuICAgIEBPdXRwdXQoKSBkYXRhQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIEBJbnB1dCgpIHNjcm9sbEJhck1vZGUgPSAnYXV0byc7XHJcbiAgICBASW5wdXQoKSBjb250ZXh0TWVudUl0ZW1zOiBDb250ZXh0TWVudUl0ZW1bXTtcclxuXHJcbiAgICBASW5wdXQoKSBjaGVja2VkUm93cyA9IFtdO1xyXG4gICAgQFZpZXdDaGlsZCgncHMnKSBwcz86IFNjcm9sbGJhckRpcmVjdGl2ZTtcclxuICAgIEBWaWV3Q2hpbGQoJ21haW5Sb3dzJykgdGFibGVSb3dzQ21wOiBhbnk7XHJcbiAgICBAVmlld0NoaWxkKCdyaWdodFJvd3MnKSByaWdodFJvd3NDbXA6IGFueTtcclxuICAgIEBWaWV3Q2hpbGQoJ2ZpeGVkTGVmdCcpIGZpeGVkTGVmdEVsOiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgnZml4ZWRSaWdodCcpIGZpeGVkUmlnaHRFbDogRWxlbWVudFJlZjtcclxuICAgIEBWaWV3Q2hpbGQoJ21haW4nKSBtYWluQXJlYTogRWxlbWVudFJlZjtcclxuICAgIEBWaWV3Q2hpbGQoJ3ZpZXdTY3JvbGxDb250YWluZXInKSB2aWV3U2Nyb2xsQ29udGFpbmVyOiBFbGVtZW50UmVmO1xyXG5cclxuXHJcbiAgICB2aXNpYmxlQ29udGV4dE1lbnVzID0gW107XHJcblxyXG4gICAgY3VycmVudFJvd0lkID0gdW5kZWZpbmVkO1xyXG5cclxuICAgIHByaXZhdGUgX2hvdmVyUm93SW5kZXggPSAtMTtcclxuICAgIGdldCBob3ZlclJvd0luZGV4KCk6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2hvdmVyUm93SW5kZXg7XHJcbiAgICB9XHJcbiAgICBzZXQgaG92ZXJSb3dJbmRleChyb3dJZHg6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMuX2hvdmVyUm93SW5kZXggPSByb3dJZHg7XHJcbiAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHNlbGVjdGVkUm93cygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kZy5zZWxlY3Rpb25zO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ3JpZFNpemVTdWJzY3JpYmU6IFN1YnNjcmlwdGlvbjtcclxuICAgIHByaXZhdGUgY29sdW1uUmVzaXplU3Vic2NyaWJlOiBTdWJzY3JpcHRpb247XHJcbiAgICBwcml2YXRlIG9uRGF0YVNvdXJjZUNoYW5nZVN1YnNjcmliZTogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSBzZWxlY3RSb3dTdWJzY3JpYmU6IFN1YnNjcmlwdGlvbjtcclxuICAgIHByaXZhdGUgdW5zZWxlY3RSb3dTdWJzY3JpYmU6IFN1YnNjcmlwdGlvbjtcclxuICAgIHByaXZhdGUgc2VsZWN0QWxsU3Vic2NyaWJlOiBTdWJzY3JpcHRpb247XHJcbiAgICBwcml2YXRlIGNoZWNrUm93U3Vic2NyaWJlOiBTdWJzY3JpcHRpb247XHJcbiAgICBwcml2YXRlIGNsZWFyU2VsZWN0aW9uc1N1YnNjcmliZTogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSBjaGVja0FsbFN1YnNjcmliZTogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSB1bmNoZWNrUm93U3Vic2NyaWJlOiBTdWJzY3JpcHRpb247XHJcbiAgICBwcml2YXRlIGNsZWFyQ2hlY2tlZHNTdWJzY3JpYmU6IFN1YnNjcmlwdGlvbjtcclxuXHJcbiAgICBwcml2YXRlIHN1YnNjcmlwdGlvbnMgPSBbXTtcclxuXHJcbiAgICBwdWJsaWMgZGZzOiBEYXRhZ3JpZEZhY2FkZVNlcnZpY2U7XHJcbiAgICBwdWJsaWMgZGdzOiBEYXRhZ3JpZFNlcnZpY2U7XHJcbiAgICBwdWJsaWMgbmdab25lOiBOZ1pvbmU7XHJcbiAgICBwdWJsaWMgcmVuZGVyOiBSZW5kZXJlcjI7XHJcblxyXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbiAgICBwcml2YXRlIHZpZXdwb3J0SDtcclxuICAgIHZpZXdwb3J0VztcclxuICAgIGNhbnZhc0hlaWdodDtcclxuICAgIHByaXZhdGUgbWluUm93QnVmZmVyID0gMztcclxuICAgIHByaXZhdGUgdlNjcm9sbERpciA9IDE7XHJcbiAgICBwcml2YXRlIHJvd3NDYWNoZSA9IHt9O1xyXG4gICAgcHJpdmF0ZSBsYXN0UmVuZGVyZWRTY3JvbGxUb3AgPSAwO1xyXG4gICAgcHJpdmF0ZSBsYXN0UmVuZGVyZWRTY3JvbGxMZWZ0ID0gMDtcclxuICAgIHByZXZTY3JvbGxUb3AgPSAwO1xyXG4gICAgcHJldlNjcm9sbExlZnQgPSAwO1xyXG4gICAgcm93cyA9IFtdO1xyXG4gICAgYmxhbmtUb3BIZWlnaHQgPSAwO1xyXG4gICAgYmxhbmtCb3R0b21IZWlnaHQgPSAwO1xyXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbiAgICBnZXQgc2Nyb2xsYmFyWEhlaWdodCgpIHtcclxuICAgICAgICBpZiAodGhpcy5kZyAmJiB0aGlzLnBzICYmIHRoaXMucHMuaW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgY29uc3QgaCA9IHRoaXMuZGcuc2Nyb2xsQmFyU2hvd01vZGUgPT09ICdhbGx3YXlzJyAmJiB0aGlzLnBzLmluc3RhbmNlWydzY3JvbGxiYXJYQWN0aXZlJ10gPyAyMiA6IDA7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBzLmluc3RhbmNlWydzY3JvbGxiYXJZQWN0aXZlJ10gJiYgaCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGggKyAxODtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldCBzY3JvbGxiYXJZV2lkdGgoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZGcgJiYgdGhpcy5wcyAmJiB0aGlzLnBzLmluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRnLnNjcm9sbEJhclNob3dNb2RlID09PSAnYWxsd2F5cycgJiYgdGhpcy5wcy5pbnN0YW5jZVsnc2Nyb2xsYmFyWUFjdGl2ZSddICYmIHRoaXMuc2hvd1JpZ2h0U2hhZG93ID8gMTggOiAwO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjZWxsQ29udGVudEZvcm1hdHRlcjogRm9ybWF0Q2VsbERhdGFQaXBlID0gbnVsbDtcclxuXHJcbiAgICAvLyDlvZPlkK/nlKjlpJrpgInkuJTlhYHorrjlpJrpgInkuK3vvIzliJfooajkuI3og73nvJbovpHml7bvvIzlj5bpgInkuK3lkI7npoHmraLop6blj5Fib2R5IOeahGNsaWNrIOS6i+S7tlxyXG4gICAgcHJpdmF0ZSBfX3RyaWdnZXJCb2R5Q2xpY2tFdmVudCA9IHRydWU7XHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXHJcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcGxpY2F0aW9uUmVmLFxyXG4gICAgICAgIEBPcHRpb25hbCgpIHB1YmxpYyBkZzogRGF0YWdyaWRDb21wb25lbnQsXHJcbiAgICAgICAgcHJpdmF0ZSBjZDogQ2hhbmdlRGV0ZWN0b3JSZWYsIHByaXZhdGUgZWw6IEVsZW1lbnRSZWZcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMuZGZzID0gdGhpcy5pbmplY3Rvci5nZXQoRGF0YWdyaWRGYWNhZGVTZXJ2aWNlKTtcclxuICAgICAgICB0aGlzLmRncyA9IHRoaXMuaW5qZWN0b3IuZ2V0KERhdGFncmlkU2VydmljZSk7XHJcbiAgICAgICAgdGhpcy5uZ1pvbmUgPSB0aGlzLmluamVjdG9yLmdldChOZ1pvbmUpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyID0gdGhpcy5pbmplY3Rvci5nZXQoUmVuZGVyZXIyKTtcclxuXHJcbiAgICAgICAgY29uc3QgY29sdW1uRm9ybWF0U2VydmljZSA9IHRoaXMuaW5qZWN0b3IuZ2V0KENvbHVtbkZvcm1hdFNlcnZpY2UpO1xyXG4gICAgICAgIHRoaXMuY2VsbENvbnRlbnRGb3JtYXR0ZXIgPSBuZXcgRm9ybWF0Q2VsbERhdGFQaXBlKGNvbHVtbkZvcm1hdFNlcnZpY2UsIHRoaXMuaW5qZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG5cclxuICAgICAgICB0aGlzLmxpc3RlblN1YmplY3RzKCk7XHJcbiAgICAgICAgdGhpcy5kZy5zY3JvbGxJbnN0YW5jZSA9IHRoaXMucHM7XHJcbiAgICAgICAgY29uc3QgczEgPSB0aGlzLmRncy5zaG93R3JpZEhlYWRlci5zdWJzY3JpYmUoaGVhZGVySGVpZ2h0ID0+IHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVDb250YWluZXJTaXplKGhlYWRlckhlaWdodCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goczEpO1xyXG5cclxuICAgICAgICBjb25zdCBzMTAgPSB0aGlzLmRncy5mb290ZXJQb3NpdGlvbkNoYW5nZWQuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVDb250YWluZXJTaXplKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goczEwKTtcclxuXHJcbiAgICAgICAgY29uc3QgczIgPSB0aGlzLmRncy5yb3dIZWlnaHRDaGFuZ2VkLnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHMyKTtcclxuXHJcbiAgICAgICAgY29uc3QgczMgPSB0aGlzLmRmcy5jbGllbnRTb3J0JC5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrU2Nyb2xsYmFyUG9zaXRpb24odHJ1ZSk7XHJcbiAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICAvLyB0aGlzLmRnLmNvbHVtblNvcnRlZC5lbWl0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goczMpO1xyXG5cclxuICAgICAgICBjb25zdCBzNSA9IHRoaXMuZGcuZGdzLmNvbHVtbnNDaGFuZ2VkLnBpcGUoXHJcbiAgICAgICAgICAgIGRlbGF5KDEwMClcclxuICAgICAgICApLnN1YnNjcmliZSgoZTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlICYmIGUuc2Nyb2xsVG9MZWZ0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxUbygwLCAwKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucHMuc2Nyb2xsVG9MZWZ0KDAsIDEwMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaChzNSk7XHJcbiAgICAgICAgdGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9uTW91c2VDbGljay5iaW5kKHRoaXMpKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZUNvbnRhaW5lclNpemUoaGVhZGVySGVpZ2h0PzogYW55KSB7XHJcbiAgICAgICAgY29uc3QgaGggPSBoZWFkZXJIZWlnaHQgfHwgdGhpcy5kZy5yZWFsSGVhZGVySGVpZ2h0O1xyXG4gICAgICAgIHRoaXMuc2V0UG9zaXRpb25Ub3AoaGgpO1xyXG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gdGhpcy5kZy5oZWlnaHQgLSB0aGlzLnRvcDtcclxuICAgICAgICB0aGlzLmJvZHlTdHlsZSA9IHRoaXMuZ2V0Qm9keVN0eWxlKCk7XHJcbiAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgICAgIGlmIChjaGFuZ2VzLmRhdGEgJiYgIWNoYW5nZXMuZGF0YS5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5ib2R5U3R5bGUgPSB0aGlzLmdldEJvZHlTdHlsZSgpO1xyXG4gICAgICAgICAgICB0aGlzLmRmcy5zZXRDdXJyZW50UGFnZURhdGEoY2hhbmdlcy5kYXRhLmN1cnJlbnRWYWx1ZSk7XHJcbiAgICAgICAgICAgIHRoaXMub25EYXRhQ2hhbmdlZCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGNoYW5nZXMuZm9vdGVySGVpZ2h0ICE9PSB1bmRlZmluZWQgJiYgIWNoYW5nZXMuZm9vdGVySGVpZ2h0LmlzRmlyc3RDaGFuZ2UoKSkge1xyXG4gICAgICAgICAgICB0aGlzLmJvZHlTdHlsZSA9IHRoaXMuZ2V0Qm9keVN0eWxlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY2hhbmdlcy5zY3JvbGxCYXJNb2RlICE9PSB1bmRlZmluZWQgJiYgIWNoYW5nZXMuc2Nyb2xsQmFyTW9kZS5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMucHMgJiYgdGhpcy5wcy5pbnN0YW5jZSAmJiB0aGlzLnNjcm9sbEJhck1vZGUgPT09ICdhbGx3YXlzJyAmJiB0aGlzLnBzLmluc3RhbmNlLnNjcm9sbGJhcllBY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmlnaHRGaXhlZFdpZHRoICs9IHRoaXMuc2hvd1JpZ2h0U2hhZG93ID8gMTggOiAwO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yaWdodEZpeGVkV2lkdGggPSB0aGlzLmNvbHVtbnNHcm91cC5yaWdodEZpeGVkV2lkdGg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkRlc3Ryb3koKSB7XHJcbiAgICAgICAgdGhpcy5kZXN0cm95U3Vic2NyaXB0aW9ucygpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyVmlld0NoZWNrZWQoKSB7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzZXRQb3NpdGlvblRvcChoZWFkZXJIZWlnaHQ6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMudG9wID0gaGVhZGVySGVpZ2h0O1xyXG4gICAgICAgIGlmICgodGhpcy5kZy5lbmFibGVGaWx0ZXJSb3cgfHwgdGhpcy5kZy5lbmFibGVTbWFydEZpbHRlcikgJiYgdGhpcy5kZy5zaG93RmlsdGVyQmFyKSB7XHJcbiAgICAgICAgICAgIHRoaXMudG9wICs9IHRoaXMuZGcuZmlsdGVyQmFySGVpZ2h0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZGcuc2hvd1Jvd0dyb3VwUGFuZWwpIHtcclxuICAgICAgICAgICAgdGhpcy50b3AgKz0gdGhpcy5kZy5yb3dHcm91cFBhbmVsSGVpZ2h0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZGcuc2hvd0Zvb3RlciAmJiAodGhpcy5kZy5mb290ZXJQb3NpdGlvbiA9PT0gJ3RvcCcgfHwgdGhpcy5kZy5mb290ZXJQb3NpdGlvbiA9PT0gJ2JvdGgnKSkge1xyXG4gICAgICAgICAgICB0aGlzLnRvcCArPSB0aGlzLmRnLmZvb3RlckhlaWdodDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjaGVja1Njcm9sbGJhclBvc2l0aW9uKHRvVG9wID0gZmFsc2UpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZGcuZGF0YSB8fCAhdGhpcy5kZy5kYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHNjcm9sbEJhcjogYW55ID0gdGhpcy5wcy5pbnN0YW5jZTtcclxuICAgICAgICBjb25zdCBzY3JvbGxFbFJlZiA9IHRoaXMucHMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50O1xyXG4gICAgICAgIC8vIHNjcm9sbEJhci51cGRhdGUoKTtcclxuICAgICAgICBjb25zdCBsYXN0U2Nyb2xsTGVmdCA9IHNjcm9sbEJhciA/IHNjcm9sbEJhci5sYXN0U2Nyb2xsTGVmdCA6IDA7XHJcbiAgICAgICAgY29uc3QgbGFzdFNjcm9sbFRvcCA9IHNjcm9sbEJhciA/IHNjcm9sbEJhci5sYXN0U2Nyb2xsVG9wIDogMDtcclxuXHJcbiAgICAgICAgLy8gY29uc3QgbGFzdFNjcm9sbExlZnQgPSB0aGlzLnNjcm9sbExlZnQ7XHJcbiAgICAgICAgLy8gY29uc3QgbGFzdFNjcm9sbFRvcCA9IHRoaXMuc2Nyb2xsVG9wO1xyXG5cclxuICAgICAgICBjb25zdCBzY3JvbGxUb3AgPSBzY3JvbGxFbFJlZi5zY3JvbGxUb3A7XHJcbiAgICAgICAgY29uc3Qgc2Nyb2xsTGVmdCA9IHNjcm9sbEVsUmVmLnNjcm9sbExlZnQ7XHJcblxyXG4gICAgICAgIGlmICghdG9Ub3ApIHtcclxuICAgICAgICAgICAgaWYgKHNjcm9sbFRvcCAhPSBsYXN0U2Nyb2xsVG9wKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBzLnNjcm9sbFRvVG9wKGxhc3RTY3JvbGxUb3ApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZ3Mub25TY3JvbGxNb3ZlKGxhc3RTY3JvbGxUb3AsIFNDUk9MTF9ZX0FDVElPTik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnBzLnNjcm9sbFRvVG9wKCk7XHJcbiAgICAgICAgICAgIHRoaXMuZGdzLm9uU2Nyb2xsTW92ZShsYXN0U2Nyb2xsVG9wLCBTQ1JPTExfWV9BQ1RJT04pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zY3JvbGxMZWZ0ID0gbGFzdFNjcm9sbExlZnQ7XHJcbiAgICAgICAgaWYgKHNjcm9sbExlZnQgIT0gbGFzdFNjcm9sbExlZnQpIHtcclxuICAgICAgICAgICAgdGhpcy5wcy5zY3JvbGxUb1gobGFzdFNjcm9sbExlZnQpO1xyXG4gICAgICAgICAgICB0aGlzLmRncy5vblNjcm9sbE1vdmUobGFzdFNjcm9sbExlZnQsIFNDUk9MTF9YX0FDVElPTik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKGxhc3RTY3JvbGxMZWZ0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRncy5vblNjcm9sbE1vdmUobGFzdFNjcm9sbExlZnQsIFNDUk9MTF9YX0FDVElPTik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmlbDmja7lj5HnlJ/lj5jljJbvvIzph43mlrDliqDovb3mlbDmja7ml7bmiafooYxcclxuICAgICAqIOmHjee9rua7muWKqOadoeS9jee9rlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIG9uRGF0YUNoYW5nZWQoKSB7XHJcbiAgICAgICAgdGhpcy5kZy5zZXRQYWdlckhlaWdodCgpO1xyXG4gICAgICAgIHRoaXMudmlld3BvcnRIID0gdGhpcy5nZXRWaWV3UG9ydEhlaWdodCgpO1xyXG4gICAgICAgIHRoaXMuYm9keVN0eWxlID0gdGhpcy5nZXRCb2R5U3R5bGUoKTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogdXBkYXRlOlxyXG4gICAgICAgICAqIG5vZGVfbW9kdWxlc1xccGVyZmVjdC1zY3JvbGxiYXJcXHR5cGVzXFxwZXJmZWN0LXNjcm9sbGJhci5kLnRzXHJcbiAgICAgICAgICogbGFzdFNjcm9sbFRvcDogbnVtYmVyXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaWYgKHRoaXMucHMgJiYgdGhpcy5wcy5pbnN0YW5jZSAmJiAhdGhpcy5kZy5pc0VkaXRpbmcoKSAmJiAhdGhpcy5kZy5jbGllbnRGaWx0ZXJDaGFuZ2VkICYmICF0aGlzLmRnLmF1dG9IZWlnaHQpIHtcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxUb3AgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLmxhc3RSZW5kZXJlZFNjcm9sbFRvcCA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMucHMuc2Nyb2xsVG9Ub3AoKTtcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxMZWZ0ID0gMDtcclxuICAgICAgICAgICAgdGhpcy5wcy5zY3JvbGxUb0xlZnQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucm93c0NhY2hlID0ge307XHJcbiAgICAgICAgY29uc3Qga2VlcHNjcm9sbFBvcyA9ICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgc2Nyb2xsSW5mbyA9IHRoaXMuZGcuZGZzLmdldFN0YXRlKCkuc2Nyb2xsSW5mbztcclxuICAgICAgICAgICAgaWYgKHNjcm9sbEluZm8pIHtcclxuICAgICAgICAgICAgICAgIGlmIChzY3JvbGxJbmZvLnkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbFRvcCA9IHNjcm9sbEluZm8ueTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLnNjcm9sbEluc3RhbmNlLnNjcm9sbFRvWShzY3JvbGxJbmZvLnkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGdzLm9uU2Nyb2xsTW92ZShzY3JvbGxJbmZvLnksIFNDUk9MTF9ZX0FDVElPTik7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHNjcm9sbEluZm8ueCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsTGVmdCA9IHNjcm9sbEluZm8ueDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLnNjcm9sbEluc3RhbmNlLnNjcm9sbFRvWChzY3JvbGxJbmZvLngpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGcuZGdzLm9uU2Nyb2xsTW92ZShzY3JvbGxJbmZvLngsIFNDUk9MTF9YX0FDVElPTik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpZiAoIXRoaXMuZGcubm93cmFwIHx8IHRoaXMuZGcuYXV0b0hlaWdodCkge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlckRhdGEoZmFsc2UpO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUm93SGVpZ2h0KCk7XHJcbiAgICAgICAgICAgIH0sIDEwMCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAga2VlcHNjcm9sbFBvcygpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlckRhdGEoZmFsc2UpO1xyXG4gICAgICAgICAgICB0aGlzLnBzLnVwZGF0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmRnLmluaXRTZWxlY3RPckNoZWNrZWQoKTtcclxuICAgICAgICB0aGlzLmRnLmNsaWVudEZpbHRlckNoYW5nZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmRhdGFDaGFuZ2UuZW1pdCh0aGlzLmRhdGEpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZGVzdHJveVN1YnNjcmlwdGlvbnMoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc3Vic2NyaXB0aW9ucyAmJiB0aGlzLnN1YnNjcmlwdGlvbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5mb3JFYWNoKChzdWI6IFN1YnNjcmlwdGlvbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHN1Yikge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1Yi51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHN1YiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zID0gW107XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgbGlzdGVuU3ViamVjdHMoKSB7XHJcbiAgICAgICAgdGhpcy5kZXN0cm95U3Vic2NyaXB0aW9ucygpO1xyXG5cclxuICAgICAgICB0aGlzLmdyaWRTaXplU3Vic2NyaWJlID0gdGhpcy5kZnMuZ3JpZFNpemUkLnBpcGUoXHJcbiAgICAgICAgICAgIGRlYm91bmNlVGltZSg1MClcclxuICAgICAgICApLnN1YnNjcmliZShzdGF0ZSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChzdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZy5zZXRQYWdlckhlaWdodCgpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaGggPSB0aGlzLmRnLnNldEhlYWRlckhlaWdodCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRQb3NpdGlvblRvcChoaCk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSBzdGF0ZS5oZWlnaHQgLSB0aGlzLnRvcDtcclxuICAgICAgICAgICAgICAgIHRoaXMud2lkdGggPSBNYXRoLmZsb29yKHN0YXRlLndpZHRoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucm93SGVpZ2h0ID0gc3RhdGUucm93SGVpZ2h0O1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRnLnNob3dCb3JkZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLndpZHRoIC09IDI7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy52aWV3cG9ydFcgPSB0aGlzLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgdGhpcy52aWV3cG9ydEggPSB0aGlzLmdldFZpZXdQb3J0SGVpZ2h0KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhbnZhc0hlaWdodCA9IHRoaXMuZ2V0Q2FudmFzSGVpZ2h0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrU2Nyb2xsYmFyUG9zaXRpb24oKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDb2x1bW5TaXplKHN0YXRlLmNvbHVtbnNHcm91cCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsTGVmdCA9IHRoaXMucHMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnNjcm9sbExlZnQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWF4U2Nyb2xsTGVmdCA9IHRoaXMuY29sc1dpZHRoICsgdGhpcy5sZWZ0Rml4ZWRXaWR0aDtcclxuICAgICAgICAgICAgICAgICAgICAvLyBncmlkIOWuueWZqOWuveW6plxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRnQ29udGFpbmVyV2lkdGggPSB0aGlzLmRnLmRnQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5omA5pyJ5YiX5a695LmL5ZKMXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWxsQ29sc1dpZHRoID0gTWF0aC5mbG9vcih0aGlzLmNvbHVtbnNHcm91cC50b3RhbFdpZHRoKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDlj7Pkvqflm7rlrprliJfnmoTkvY3nva5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0ID0gdGhpcy53aWR0aCAtIHRoaXMucmlnaHRGaXhlZFdpZHRoICsgdGhpcy5zY3JvbGxMZWZ0O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJvZHlTdHlsZSA9IHRoaXMuZ2V0Qm9keVN0eWxlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRnQ29udGFpbmVyV2lkdGggPiBhbGxDb2xzV2lkdGggfHwgZGdDb250YWluZXJXaWR0aCA9PT0gYWxsQ29sc1dpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd1JpZ2h0U2hhZG93ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZml4ZWRSaWdodFNjcm9sbExlZnQgPSB0aGlzLm1heFNjcm9sbExlZnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93UmlnaHRTaGFkb3cgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJEYXRhKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZGcubm93cmFwIHx8IHRoaXMuZGcuYXV0b0hlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgX3RpbWVyID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aW1lcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RpbWVyLmNsZWFyVGltZW91dCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUm93SGVpZ2h0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBzLnVwZGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5jZFsnZGVzdHJveWVkJ10pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHMudXBkYXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLnBzLnVwZGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGdzLnNob3dGaXhlZFNoYWRvdy5lbWl0KHsgc2hvd1JpZ2h0U2hhZG93OiB0aGlzLnNob3dSaWdodFNoYWRvdywgeDogdGhpcy5maXhlZFJpZ2h0U2Nyb2xsTGVmdCB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNjcm9sbEJhck1vZGUgPT09ICdhbGx3YXlzJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbHVtblNpemUodGhpcy5jb2x1bW5zR3JvdXApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRncy5zY3JvbGxiYXJVcGRhdGUuZW1pdCh7IHNjcm9sbGJhclJlZjogdGhpcy5wcy5pbnN0YW5jZSB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9LCA1MCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2godGhpcy5ncmlkU2l6ZVN1YnNjcmliZSk7XHJcblxyXG4gICAgICAgIHRoaXMuY29sdW1uUmVzaXplU3Vic2NyaWJlID0gdGhpcy5kZnMuY29sdW1uUmVzaXplJC5zdWJzY3JpYmUoKGNnOiBDb2x1bW5Hcm91cCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbHVtblNpemUoY2cpO1xyXG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaCh0aGlzLmNvbHVtblJlc2l6ZVN1YnNjcmliZSk7XHJcblxyXG4gICAgICAgIHRoaXMuZGdzLnNldFNlbGVjZWRSb3cuc3Vic2NyaWJlKChyOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgci5zZWxlY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50Um93SWQgPSByLmlkO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50Um93SWQgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnNlbGVjdFJvd1N1YnNjcmliZSA9IHRoaXMuZGZzLnNlbGVjdFJvdyQuc3Vic2NyaWJlKChyb3c6IFNlbGVjdGVkUm93KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyb3cpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFJvd0lkID0gcm93LmlkO1xyXG4gICAgICAgICAgICAgICAgLy8gMjAyMTA4MTcg5pa55ZCR6ZSu56e75Yqo5ZCO5Yi35paw6KeG5Zu+54q25oCBXHJcbiAgICAgICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMuc2VsZWN0Um93U3Vic2NyaWJlKTtcclxuXHJcbiAgICAgICAgdGhpcy51bnNlbGVjdFJvd1N1YnNjcmliZSA9IHRoaXMuZGZzLnVuU2VsZWN0Um93JC5zdWJzY3JpYmUoKHByZXZSb3c6IFNlbGVjdGVkUm93KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChwcmV2Um93ICYmIHByZXZSb3cuaWQgPT09IHRoaXMuY3VycmVudFJvd0lkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRSb3dJZCA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGcuc2VsZWN0ZWRSb3cgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZGcuZWRpdGFibGUgJiYgdGhpcy5kZy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fX3RyaWdnZXJCb2R5Q2xpY2tFdmVudCA9IHRoaXMuZGcuc2VsZWN0aW9uTW9kZSA9PT0gJ2RlZmF1bHQnO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaCh0aGlzLnVuc2VsZWN0Um93U3Vic2NyaWJlKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZWxlY3RBbGxTdWJzY3JpYmUgPSB0aGlzLmRmcy5zZWxlY3RBbGwkLnN1YnNjcmliZSgocm93czogU2VsZWN0ZWRSb3dbXSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmRnLnNlbGVjdEFsbC5lbWl0KHJvd3MpO1xyXG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaCh0aGlzLnNlbGVjdEFsbFN1YnNjcmliZSk7XHJcblxyXG4gICAgICAgIHRoaXMuY2hlY2tSb3dTdWJzY3JpYmUgPSB0aGlzLmRmcy5jaGVja1JvdyQuc3Vic2NyaWJlKChyb3c6IFNlbGVjdGVkUm93KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZGcuY2hlY2tlZC5lbWl0KHJvdyk7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tlZFJvd3NDaGFuZ2VkKCk7XHJcbiAgICAgICAgICAgIC8vIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMuY2hlY2tSb3dTdWJzY3JpYmUpO1xyXG5cclxuICAgICAgICB0aGlzLmNsZWFyU2VsZWN0aW9uc1N1YnNjcmliZSA9IHRoaXMuZGZzLmNsZWFyU2VsZWN0aW9ucyQuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50Um93SWQgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLmNoZWNrT25TZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tlZFJvd3NDaGFuZ2VkKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5kZy51blNlbGVjdEFsbC5lbWl0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2godGhpcy5jbGVhclNlbGVjdGlvbnNTdWJzY3JpYmUpO1xyXG5cclxuICAgICAgICB0aGlzLnVuY2hlY2tSb3dTdWJzY3JpYmUgPSB0aGlzLmRmcy51bkNoZWNrUm93JC5zdWJzY3JpYmUoKHByZXZSb3c6IFNlbGVjdGVkUm93KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZGcudW5DaGVja2VkLmVtaXQocHJldlJvdyk7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tlZFJvd3NDaGFuZ2VkKCk7XHJcbiAgICAgICAgICAgIC8vIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMudW5jaGVja1Jvd1N1YnNjcmliZSk7XHJcblxyXG4gICAgICAgIHRoaXMuY2hlY2tBbGxTdWJzY3JpYmUgPSB0aGlzLmRmcy5jaGVja0FsbCQuc3Vic2NyaWJlKChyb3dzOiBTZWxlY3RlZFJvd1tdKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZGcuY2hlY2tBbGwuZW1pdChyb3dzKTtcclxuICAgICAgICAgICAgdGhpcy5jaGVja2VkUm93c0NoYW5nZWQoKTtcclxuICAgICAgICAgICAgLy8gdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2godGhpcy5jaGVja0FsbFN1YnNjcmliZSk7XHJcblxyXG4gICAgICAgIHRoaXMuY2xlYXJDaGVja2Vkc1N1YnNjcmliZSA9IHRoaXMuZGZzLmNsZWFyQ2hlY2tlZHMkLnN1YnNjcmliZSgocm93czogU2VsZWN0ZWRSb3dbXSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kZy5zZWxlY3RPbkNoZWNrKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRSb3dJZCA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmRnLnVuQ2hlY2tBbGwuZW1pdChyb3dzKTtcclxuICAgICAgICAgICAgdGhpcy5jaGVja2VkUm93c0NoYW5nZWQoKTtcclxuICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2godGhpcy5jbGVhckNoZWNrZWRzU3Vic2NyaWJlKTtcclxuXHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2godGhpcy5kZ3Muc2V0U2Nyb2xsYmFyUG9zaXRpb24uc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jaGVja1Njcm9sbGJhclBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU2Nyb2xsUG9zaXRpb24odGhpcy5zY3JvbGxMZWZ0KTtcclxuICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgIHRoaXMuZGdzLmNvbHVtblJlc2l6ZWQucGlwZShcclxuICAgICAgICAgICAgZGVsYXkoMTAwKVxyXG4gICAgICAgICkuc3Vic2NyaWJlKChlOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmRnLm5vd3JhcCB8fFxyXG4gICAgICAgICAgICAgICAgKHRoaXMuZGcuY3VycmVudENlbGwgJiYgdGhpcy5kZy5jdXJyZW50Q2VsbC5pc0VkaXRpbmcgJiYgdGhpcy5kZy5jdXJyZW50Q2VsbC5jb2x1bW4gJiZcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLmN1cnJlbnRDZWxsLmNvbHVtbi5lZGl0b3IgJiYgdGhpcy5kZy5jdXJyZW50Q2VsbC5jb2x1bW4uZWRpdG9yLnR5cGUgPT09ICd0ZXh0YXJlYScpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0cmRvbXMgPSB0aGlzLmRnLmRnQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmYtZGF0YWdyaWQtYm9keS1yb3c6bm90KGYtZGF0YWdyaWQtZm9vdGVyLXJvdyknKTtcclxuICAgICAgICAgICAgICAgIHRyZG9tcy5mb3JFYWNoKG4gPT4gbi5zdHlsZS5oZWlnaHQgPSAnYXV0bycpO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCB0cklEID0gJyc7XHJcbiAgICAgICAgICAgICAgICBpZiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJvd0lkID0gZS5pZDtcclxuICAgICAgICAgICAgICAgICAgICB0cklEID0gVFJfUFJFRklYICsgcm93SWQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVSb3dIZWlnaHQodHJJRCk7XHJcbiAgICAgICAgICAgICAgICAvLyB0cmRvbXMuZm9yRWFjaChuID0+IG4uc3R5bGUuaGVpZ2h0ID0gJycpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5kZy5oZWFkZXJXcmFwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRnLnNldEhlYWRlckhlaWdodCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZnMuY29sdW1uUmVzaXplRW5kKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuZGdzLmNlbGxDb250ZW50V3JhcENoYW5nZWQucGlwZShcclxuICAgICAgICAgICAgZGVsYXkoMTAwKVxyXG4gICAgICAgICkuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVSb3dIZWlnaHQoKTtcclxuICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgICAgIHRoaXMuZGcuZGZzLnJvd1VwZGF0ZSQuc3Vic2NyaWJlKChyb3c6IHsgaW5kZXg6IG51bWJlciwgZGF0YTogYW55IH0pID0+IHtcclxuICAgICAgICAgICAgaWYgKHJvdyAmJiByb3cuZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5idWlsZEN1c3RvbUNlbGxTdHlsZShyb3cpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBidWlsZEN1c3RvbUNlbGxTdHlsZShyb3c6IHsgaW5kZXg6IG51bWJlciwgZGF0YTogYW55IH0pIHtcclxuXHJcbiAgICAgICAgbGV0IHJpZ2h0VHJzID0gW107XHJcbiAgICAgICAgbGV0IGxlZnRUcnMgPSBbXTtcclxuICAgICAgICBpZiAodGhpcy5maXhlZFJpZ2h0RWwpIHtcclxuICAgICAgICAgICAgcmlnaHRUcnMgPSB0aGlzLmZpeGVkUmlnaHRFbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RyJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5maXhlZExlZnRFbCkge1xyXG4gICAgICAgICAgICBsZWZ0VHJzID0gdGhpcy5maXhlZExlZnRFbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5maXhlZC1sZWZ0LXJvdycpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgdHJzID0gdGhpcy5tYWluQXJlYS5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RyLmYtZGF0YWdyaWQtYm9keS1yb3cnKTtcclxuXHJcbiAgICAgICAgY29uc3QgdXBkYXRlQ2VsbFN0eWxlID0gKGFyciwgY29sLCBzdHlsZSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoYXJyLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdGQgPSBhcnJbcm93LmluZGV4XS5xdWVyeVNlbGVjdG9yKGBbZmllbGQ9XCIke2NvbC5maWVsZH1cIl1gKTtcclxuICAgICAgICAgICAgICAgIGlmICh0ZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGcucmVuZGVyQ3VzdG9tU3R5bGUoc3R5bGUsIHRkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuZGcuZmxhdENvbHVtbnMuZm9yRWFjaChjb2wgPT4ge1xyXG4gICAgICAgICAgICBpZiAoY29sLnN0eWxlcikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgX3JkID0gcm93LmRhdGE7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjcyA9IGNvbC5zdHlsZXIoX3JkW2NvbC5maWVsZF0sIF9yZCwgcm93LmluZGV4KTtcclxuICAgICAgICAgICAgICAgIGlmIChjcyAmJiBPYmplY3Qua2V5cyhjcykubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlQ2VsbFN0eWxlKGxlZnRUcnMsIGNvbCwgY3MpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZUNlbGxTdHlsZShyaWdodFRycywgY29sLCBjcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlQ2VsbFN0eWxlKHRycywgY29sLCBjcyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNoZWNrZWRSb3dzQ2hhbmdlZCgpIHtcclxuICAgICAgICB0aGlzLmRncy5vbkNoZWNrZWRSb3dzQ291bnRDaGFuZ2UoKTtcclxuICAgICAgICBjb25zdCBjaGVja2VkUm93cyA9IHRoaXMuZGcuY2hlY2tlZHM7XHJcbiAgICAgICAgdGhpcy5kZy5jaGVja1ZhbHVlcyA9IGNoZWNrZWRSb3dzLm1hcChyID0+IHIuaWQpO1xyXG4gICAgICAgIHRoaXMuZGcuY2hlY2tWYWx1ZXNDaGFuZ2UuZW1pdCh0aGlzLmRnLmNoZWNrVmFsdWVzKTtcclxuICAgICAgICB0aGlzLmRnLmNoZWNrZWRDaGFuZ2UuZW1pdChjaGVja2VkUm93cyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRUckRvbUhlaWdodCgpIHtcclxuICAgICAgICBjb25zdCBsaXN0ID0gW107XHJcbiAgICAgICAgbGV0IHJpZ2h0VHJzID0gW107XHJcbiAgICAgICAgbGV0IGxlZnRUcnMgPSBbXTtcclxuICAgICAgICBsZXQgdHJkb21zID0gW107XHJcbiAgICAgICAgaWYgKHRoaXMuZml4ZWRSaWdodEVsKSB7XHJcbiAgICAgICAgICAgIHJpZ2h0VHJzID0gdGhpcy5maXhlZFJpZ2h0RWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCd0cicpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZml4ZWRMZWZ0RWwpIHtcclxuICAgICAgICAgICAgbGVmdFRycyA9IHRoaXMuZml4ZWRMZWZ0RWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZml4ZWQtbGVmdC1yb3cnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLm1haW5BcmVhKSB7XHJcbiAgICAgICAgICAgIHRyZG9tcyA9IHRoaXMubWFpbkFyZWEubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCd0ci5mLWRhdGFncmlkLWJvZHktcm93Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRyZG9tcy5mb3JFYWNoKCh0ciwgaSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgdDEgPSAwO1xyXG4gICAgICAgICAgICBjb25zdCB0MiA9IE1hdGguY2VpbCh0ci5vZmZzZXRIZWlnaHQpO1xyXG4gICAgICAgICAgICBsZXQgdDMgPSAwO1xyXG4gICAgICAgICAgICBpZiAobGVmdFRycyAmJiBsZWZ0VHJzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdDEgPSBNYXRoLmNlaWwobGVmdFRyc1tpXS5vZmZzZXRIZWlnaHQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAocmlnaHRUcnMgJiYgcmlnaHRUcnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0MyA9IE1hdGguY2VpbChyaWdodFRyc1tpXS5vZmZzZXRIZWlnaHQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBfaCA9IE1hdGgubWF4KHQxLCB0MiwgdDMsIHRoaXMuZGcucm93SGVpZ2h0KTtcclxuICAgICAgICAgICAgbGlzdC5wdXNoKF9oKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gbGlzdDtcclxuICAgIH1cclxuICAgIC8qKiDlhYHorrjmlbDmja7mipjooYzml7bvvIzorqHnrpfooYzlj7fnmoTooYzpq5ggKi9cclxuICAgIHVwZGF0ZVJvd0hlaWdodCh0ckRvbUlkID0gbnVsbCkge1xyXG4gICAgICAgIGlmICghdGhpcy5tYWluQXJlYSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBkZ0JvZHkgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignZGl2LmYtZGF0YWdyaWQtYm9keScpO1xyXG4gICAgICAgIGlmIChkZ0JvZHkpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmRnLm5vd3JhcCB8fCB0aGlzLmRnLmF1dG9IZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyLmFkZENsYXNzKGRnQm9keSwgJ2RhdGEtd3JhcCcpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIucmVtb3ZlQ2xhc3MoZGdCb2R5LCAnZGF0YS13cmFwJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBjc3NUZXh0QXJyID0gW107XHJcblxyXG4gICAgICAgIGlmICghdHJEb21JZCkge1xyXG4gICAgICAgICAgICB0aGlzLnJvd3MuZm9yRWFjaCgociwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgcm93SWQgPSB0aGlzLmRmcy5wcmltYXJ5SWQocik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0cklEID0gVFJfUFJFRklYICsgcm93SWQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsZWZ0VHJJZCA9IHRySUQgKyAnX2ZpeGVkbGVmdCc7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByaWdodFRySWQgPSB0cklEICsgJ19maXhlZHJpZ2h0JztcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZGcubm93cmFwIHx8IHRoaXMuZGcuYXV0b0hlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpc3QgPSB0aGlzLmdldFRyRG9tSGVpZ2h0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaCA9IGxpc3RbaV07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNzc1RleHRBcnIucHVzaChgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9IC5mLWRhdGFncmlkLWJvZHkuZGF0YS13cmFwICMke2xlZnRUcklkfXsgaGVpZ2h0OiAke2h9cHggfWApO1xyXG4gICAgICAgICAgICAgICAgICAgIGNzc1RleHRBcnIucHVzaChgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9IC5mLWRhdGFncmlkLWJvZHkuZGF0YS13cmFwICMke3RySUR9eyBoZWlnaHQ6ICR7aH1weCB9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3NzVGV4dEFyci5wdXNoKGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keS5kYXRhLXdyYXAgIyR7cmlnaHRUcklkfXsgaGVpZ2h0OiAke2h9cHggfWApO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjc3NUZXh0QXJyLnB1c2goYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1ib2R5ICMke2xlZnRUcklkfXsgaGVpZ2h0OiAke2xpc3RbaV19cHggfWApO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNzc1RleHRBcnIucHVzaChgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9IC5mLWRhdGFncmlkLWJvZHkgIyR7dHJJRH17IGhlaWdodDogJHtsaXN0W2ldfXB4IH1gKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjc3NUZXh0QXJyLnB1c2goYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1ib2R5ICMke3JpZ2h0VHJJZH17IGhlaWdodDogJHtsaXN0W2ldfXB4IH1gKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBrZXkxID0gYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1ib2R5ICMke2xlZnRUcklkfWA7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5MiA9IGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keSAjJHt0cklEfWA7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5MyA9IGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keSAjJHtyaWdodFRySWR9YDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZ3MucmVtb3ZlQ3NzUnVsZShrZXkxKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRncy5yZW1vdmVDc3NSdWxlKGtleTIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGdzLnJlbW92ZUNzc1J1bGUoa2V5Myk7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZGdzLmFwcGVuZENzc1J1bGVzKGNzc1RleHRBcnIpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNzc1RleHRBcnIgPSBbXTtcclxuICAgICAgICAgICAgY29uc3QgZG9tU2VsID0gJyMnICsgdHJEb21JZDtcclxuICAgICAgICAgICAgY29uc3QgX2FyciA9IFtdO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5maXhlZFJpZ2h0RWwpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJ0ciA9IHRoaXMuZml4ZWRSaWdodEVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3Rvcihkb21TZWwpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJ0cikge1xyXG4gICAgICAgICAgICAgICAgICAgIF9hcnIucHVzaChNYXRoLmNlaWwocnRyLm9mZnNldEhlaWdodCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5maXhlZExlZnRFbCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbHRyID0gdGhpcy5maXhlZExlZnRFbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoZG9tU2VsKTtcclxuICAgICAgICAgICAgICAgIGlmIChsdHIpIHtcclxuICAgICAgICAgICAgICAgICAgICBfYXJyLnB1c2goTWF0aC5jZWlsKGx0ci5vZmZzZXRIZWlnaHQpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMubWFpbkFyZWEpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRyID0gdGhpcy5tYWluQXJlYS5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoZG9tU2VsKTtcclxuICAgICAgICAgICAgICAgIGlmICh0cikge1xyXG4gICAgICAgICAgICAgICAgICAgIF9hcnIucHVzaChNYXRoLmNlaWwodHIub2Zmc2V0SGVpZ2h0KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IF9oID0gTWF0aC5tYXgoLi4uX2Fycik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBsZWZ0VHJJZCA9IHRyRG9tSWQgKyAnX2ZpeGVkbGVmdCc7XHJcbiAgICAgICAgICAgIGNvbnN0IHJpZ2h0VHJJZCA9IHRyRG9tSWQgKyAnX2ZpeGVkcmlnaHQnO1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZGcubm93cmFwIHx8IHRoaXMuZGcuYXV0b0hlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgY3NzVGV4dEFyci5wdXNoKGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keS5kYXRhLXdyYXAgIyR7bGVmdFRySWR9eyBoZWlnaHQ6ICR7X2h9cHg7fWApO1xyXG4gICAgICAgICAgICAgICAgY3NzVGV4dEFyci5wdXNoKGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keS5kYXRhLXdyYXAgIyR7dHJEb21JZH17IGhlaWdodDogJHtfaH1weDt9YCk7XHJcbiAgICAgICAgICAgICAgICBjc3NUZXh0QXJyLnB1c2goYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1ib2R5LmRhdGEtd3JhcCAjJHtyaWdodFRySWR9eyBoZWlnaHQ6ICR7X2h9cHg7fWApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY3NzVGV4dEFyci5wdXNoKGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keSAjJHtsZWZ0VHJJZH17IGhlaWdodDogJHtfaH1weCB9YCk7XHJcbiAgICAgICAgICAgICAgICBjc3NUZXh0QXJyLnB1c2goYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1ib2R5ICMke3RyRG9tSWR9eyBoZWlnaHQ6ICR7X2h9cHggfWApO1xyXG4gICAgICAgICAgICAgICAgY3NzVGV4dEFyci5wdXNoKGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keSAjJHtyaWdodFRySWR9eyBoZWlnaHQ6ICR7X2h9cHggfWApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLmRncy5hcHBlbmRDc3NSdWxlcyhjc3NUZXh0QXJyKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMudXBkYXRlQ2FudmFzSGVpZ2h0KCk7XHJcblxyXG4gICAgICAgIC8vIOenu+mZpGhlaWdodDogYXV0b1xyXG4gICAgICAgIGNvbnN0IHRyZG9tcyA9IHRoaXMuZGcuZGdDb250YWluZXIubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZi1kYXRhZ3JpZC1ib2R5LXJvdzpub3QoZi1kYXRhZ3JpZC1mb290ZXItcm93KScpO1xyXG4gICAgICAgIHRyZG9tcy5mb3JFYWNoKG4gPT4gbi5zdHlsZS5oZWlnaHQgPSAnJyk7XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5jZFsnZGVzdHJveWVkJ10pIHtcclxuICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZUNvbHVtblNpemUoY2c6IENvbHVtbkdyb3VwKSB7XHJcbiAgICAgICAgaWYgKGNnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29sdW1uc0dyb3VwID0gY2c7XHJcbiAgICAgICAgICAgIHRoaXMubGVmdEZpeGVkV2lkdGggPSB0aGlzLmNvbHVtbnNHcm91cC5sZWZ0Rml4ZWRXaWR0aDtcclxuICAgICAgICAgICAgdGhpcy5yaWdodEZpeGVkV2lkdGggPSB0aGlzLmNvbHVtbnNHcm91cC5yaWdodEZpeGVkV2lkdGg7XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5wcyAmJiB0aGlzLnBzLmluc3RhbmNlICYmIHRoaXMuZGcuc2Nyb2xsQmFyU2hvd01vZGUgPT09ICdhbGx3YXlzJyAmJiB0aGlzLnBzLmluc3RhbmNlLnNjcm9sbGJhcllBY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmlnaHRGaXhlZFdpZHRoICs9IHRoaXMuc2hvd1JpZ2h0U2hhZG93ID8gMTggOiAwO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLmNvbHNXaWR0aCA9IHRoaXMuY29sdW1uc0dyb3VwLm5vcm1hbFdpZHRoOyAvLyArICh0aGlzLnNob3dSaWdodFNoYWRvdyA/IDE4IDogMCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnRvdGFsV2lkdGggPSB0aGlzLmNvbHVtbnNHcm91cC50b3RhbFdpZHRoO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zY3JvbGxCYXJNb2RlID09PSAnYWxsd2F5cycgJiYgIXRoaXMucmlnaHRSb3dzQ21wICYmICF0aGlzLmRnLnVzZUNvbnRyb2xQYW5lbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b3RhbFdpZHRoICs9IDE4O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0Qm9keVN0eWxlKCkge1xyXG4gICAgICAgIGxldCBoID0gdGhpcy5nZXRWaWV3UG9ydEhlaWdodCgpO1xyXG4gICAgICAgIGlmICghdGhpcy5kYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kZy5hdXRvSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICBoID0gdGhpcy5kZy5lbXB0eURhdGFIZWlnaHQ7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLmZvb3RlckRhdGEgJiYgdGhpcy5kZy5zaG93Rm9vdGVyKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZmQgPSB0aGlzLmRnLmZvb3RlckRhdGE7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kZy5mb290ZXJEYXRhLnN1YnNjcmliZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZkID0gdGhpcy5kZy5mb290ZXJEYXRhWyd2YWx1ZSddO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChmZCAmJiBBcnJheS5pc0FycmF5KGZkKSAmJiBmZC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBoID0gaCAtIHRoaXMuZGcuZm9vdGVySGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuc2hvd0Zvb3RlciAmJiB0aGlzLmRnLmZvb3RlclBvc2l0aW9uID09PSAnYm90aCcpIHtcclxuICAgICAgICAgICAgICAgIGggPSBoIC0gdGhpcy5kZy5mb290ZXJIZWlnaHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaGVpZ2h0OiBgJHtNYXRoLmZsb29yKGgpfXB4YFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB1cGRhdGVTY3JvbGxQb3NpdGlvbihzY3JvbGxMZWZ0OiBhbnkpIHtcclxuICAgICAgICB0aGlzLnNjcm9sbExlZnQgPSBzY3JvbGxMZWZ0O1xyXG5cclxuICAgICAgICB0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0ID0gdGhpcy5zY3JvbGxMZWZ0ICsgdGhpcy53aWR0aCAtIHRoaXMucmlnaHRGaXhlZFdpZHRoO1xyXG4gICAgICAgIGlmICh0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0ID09PSB0aGlzLm1heFNjcm9sbExlZnQgfHwgdGhpcy5maXhlZFJpZ2h0U2Nyb2xsTGVmdCA+IHRoaXMubWF4U2Nyb2xsTGVmdCkge1xyXG4gICAgICAgICAgICB0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0ID0gdGhpcy5tYXhTY3JvbGxMZWZ0O1xyXG4gICAgICAgICAgICB0aGlzLnNob3dSaWdodFNoYWRvdyA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd1JpZ2h0U2hhZG93ID0gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmZpeGVkTGVmdEVsKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyLnNldFN0eWxlKHRoaXMuZml4ZWRMZWZ0RWwubmF0aXZlRWxlbWVudCwgJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUzZCgke3RoaXMuc2Nyb2xsTGVmdH1weCwgMHB4LCAwcHgpYCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5maXhlZFJpZ2h0RWwpIHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUodGhpcy5maXhlZFJpZ2h0RWwubmF0aXZlRWxlbWVudCwgJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUzZCgke3RoaXMuZml4ZWRSaWdodFNjcm9sbExlZnR9cHgsIDBweCwgMHB4KWApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvblNjcm9sbFRvWCgkZXZlbnQ6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHggPSAkZXZlbnQudGFyZ2V0LnNjcm9sbExlZnQ7XHJcbiAgICAgICAgdGhpcy51cGRhdGVTY3JvbGxQb3NpdGlvbih4KTtcclxuICAgICAgICAvLyB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB0aGlzLmRncy5vblNjcm9sbE1vdmUoeCwgU0NST0xMX1hfQUNUSU9OKTtcclxuICAgICAgICB0aGlzLmRncy5zaG93Rml4ZWRTaGFkb3cuZW1pdCh7IHNob3dSaWdodFNoYWRvdzogdGhpcy5zaG93UmlnaHRTaGFkb3csIHg6IHRoaXMuZml4ZWRSaWdodFNjcm9sbExlZnQgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25TY3JvbGxUb1koJGV2ZW50OiBhbnkpIHtcclxuICAgICAgICBjb25zdCB5ID0gJGV2ZW50LnRhcmdldC5zY3JvbGxUb3A7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRnLnZpcnR1YWxpemVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlU2Nyb2xsKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnNjcm9sbFRvcCA9IHk7XHJcblxyXG4gICAgICAgIHRoaXMuZGcuc2Nyb2xsWS5lbWl0KHkpO1xyXG4gICAgICAgIHRoaXMuZGdzLm9uU2Nyb2xsTW92ZSh5LCBTQ1JPTExfWV9BQ1RJT04pO1xyXG4gICAgfVxyXG5cclxuICAgIG9uUHNYUmVhY2hTdGFydCgkZXZlbnQ6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHggPSAkZXZlbnQudGFyZ2V0LnNjcm9sbExlZnQ7XHJcbiAgICAgICAgdGhpcy51cGRhdGVTY3JvbGxQb3NpdGlvbih4KTtcclxuICAgICAgICB0aGlzLmRncy5vblNjcm9sbE1vdmUoeCwgU0NST0xMX1hfUkVBQ0hfU1RBUlRfQUNUSU9OKTtcclxuICAgIH1cclxuXHJcbiAgICBvblBzWFJlYWNoRW5kKCRldmVudDogYW55KSB7XHJcbiAgICAgICAgdGhpcy5zaG93UmlnaHRTaGFkb3cgPSBmYWxzZTtcclxuICAgICAgICAvLyBjb25zdCB4ID0gJGV2ZW50LnRhcmdldC5zY3JvbGxMZWZ0O1xyXG4gICAgICAgIC8vIHRoaXMudXBkYXRlU2Nyb2xsUG9zaXRpb24oeCk7XHJcbiAgICAgICAgLy8gdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgLy8gLy8gdGhpcy5kZ3Mub25TaG93Rml4ZWRTaGFkb3codGhpcy5zaG93UmlnaHRTaGFkb3cpO1xyXG4gICAgICAgIC8vIHRoaXMuZGdzLm9uU2Nyb2xsTW92ZSh4LCBTQ1JPTExfWF9SRUFDSF9FTkRfQUNUSU9OKTtcclxuICAgIH1cclxuXHJcbiAgICBpc0NoZWNrZWQocm93RGF0YTogYW55KSB7XHJcbiAgICAgICAgaWYgKHJvd0RhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGZzLmlzUm93Q2hlY2tlZChyb3dEYXRhW3RoaXMuZGcuaWRGaWVsZF0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaXNTZWxlY3RlZChyb3dEYXRhOiBhbnkpIHtcclxuICAgICAgICBpZiAocm93RGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kZnMuaXNSb3dTZWxlY3RlZChyb3dEYXRhW3RoaXMuZGcuaWRGaWVsZF0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgdG9nZ2xlR3JvdXBSb3cocm93LCBvcGVuID0gdHJ1ZSkge1xyXG4gICAgICAgIHJvdy5leHBhbmRlZCA9IG9wZW47XHJcbiAgICAgICAgdGhpcy5wcy51cGRhdGUoKTtcclxuICAgIH1cclxuXHJcblxyXG5cclxuICAgIC8qKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSDliIYgPT09PT09IOmalCA9PT09PT0g57q/ID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXHJcblxyXG4gICAgLyoqIOiOt+WPluWPr+inhuWMuuWfn+mrmOW6piAqL1xyXG4gICAgcHJpdmF0ZSBnZXRWaWV3UG9ydEhlaWdodCgpIHtcclxuICAgICAgICBsZXQgdmlld1BvcnRIZWlnaHQgPSB0aGlzLmRnLmhlaWdodDtcclxuICAgICAgICBpZiAodGhpcy5kZy5zaG93SGVhZGVyKSB7XHJcbiAgICAgICAgICAgIHZpZXdQb3J0SGVpZ2h0ID0gdmlld1BvcnRIZWlnaHQgLSB0aGlzLmRnLnJlYWxIZWFkZXJIZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoKHRoaXMuZGcuZW5hYmxlRmlsdGVyUm93IHx8IHRoaXMuZGcuZW5hYmxlU21hcnRGaWx0ZXIpICYmIHRoaXMuZGcuc2hvd0ZpbHRlckJhcikge1xyXG4gICAgICAgICAgICB2aWV3UG9ydEhlaWdodCAtPSB0aGlzLmRnLmZpbHRlckJhckhlaWdodDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRnLnNob3dSb3dHcm91cFBhbmVsKSB7XHJcbiAgICAgICAgICAgIHZpZXdQb3J0SGVpZ2h0IC09IHRoaXMuZGcucm93R3JvdXBQYW5lbEhlaWdodDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRnLnNob3dGb290ZXIgJiYgdGhpcy5kYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB2aWV3UG9ydEhlaWdodCA9IHZpZXdQb3J0SGVpZ2h0IC0gdGhpcy5kZy5mb290ZXJIZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5kZy5wYWdpbmF0aW9uKSB7XHJcbiAgICAgICAgICAgIHZpZXdQb3J0SGVpZ2h0ID0gdmlld1BvcnRIZWlnaHQgLSB0aGlzLmRnLnBhZ2VySGVpZ2h0IC0gMjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRnLnNob3dCb3JkZXIpIHtcclxuICAgICAgICAgICAgdmlld1BvcnRIZWlnaHQgLT0gMjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMudmlld3BvcnRIID0gdmlld1BvcnRIZWlnaHQ7XHJcbiAgICAgICAgcmV0dXJuIHZpZXdQb3J0SGVpZ2h0O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOS4jeaKmOihjOaXtu+8jOaJgOacieaVsOaNrueahOmrmOW6plxyXG4gICAgcHJpdmF0ZSBhbGxSb3dzSGVpZ2h0KCkge1xyXG4gICAgICAgIGNvbnN0IHJvd0hlaWdodHBhdGNoID0gMTsgIC8vIHRoaXMuZGcuYXV0b0hlaWdodCA/IDIgOiAxO1xyXG4gICAgICAgIGNvbnN0IHJvd0hlaWdodCA9IHRoaXMuZGcucm93SGVpZ2h0ICsgcm93SGVpZ2h0cGF0Y2g7XHJcblxyXG4gICAgICAgIGxldCBpdGVtc0NvdW50ID0gMDtcclxuICAgICAgICBpZiAodGhpcy5kZy5ncm91cFN1bW1hcnlQb3NpdGlvbiA9PT0gJ2luR3JvdXBSb3cnKSB7XHJcbiAgICAgICAgICAgIGl0ZW1zQ291bnQgPSB0aGlzLmRhdGEuZmlsdGVyKG4gPT4gIW5bJ19fZ3JvdXBfZm9vdGVyX18nXSkubGVuZ3RoO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGl0ZW1zQ291bnQgPSB0aGlzLmRhdGEubGVuZ3RoO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGggPSBpdGVtc0NvdW50ICogcm93SGVpZ2h0O1xyXG5cclxuICAgICAgICBpZiAodGhpcy5kZy5hdXRvSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIGggKz0gaXRlbXNDb3VudDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBoICs9IDI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gaDtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldENhbnZhc0hlaWdodCgpIHtcclxuICAgICAgICBsZXQgY2FudmFzSGVpZ2h0ID0gMDtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmRhdGEgfHwgIXRoaXMuZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5jYW52YXNIZWlnaHQgPSAwO1xyXG4gICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRnLm5vd3JhcCkge1xyXG4gICAgICAgICAgICBjYW52YXNIZWlnaHQgPSB0aGlzLmFsbFJvd3NIZWlnaHQoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjYW52YXNIZWlnaHQgPSB0aGlzLmdldFRyRG9tSGVpZ2h0KCkucmVkdWNlKChyLCBjKSA9PiByICsgYywgMCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIWNhbnZhc0hlaWdodCkge1xyXG4gICAgICAgICAgICBjYW52YXNIZWlnaHQgPSB0aGlzLnZpZXdwb3J0SDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY2FudmFzSGVpZ2h0ID0gY2FudmFzSGVpZ2h0O1xyXG4gICAgICAgIHJldHVybiBjYW52YXNIZWlnaHQ7XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlQ2FudmFzSGVpZ2h0KCkge1xyXG4gICAgICAgIHRoaXMuY2FudmFzSGVpZ2h0ID0gdGhpcy5nZXRDYW52YXNIZWlnaHQoKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBnZXRSb3dGcm9tUG9zaXRpb24oeSkge1xyXG4gICAgICAgIHJldHVybiBNYXRoLmZsb29yKHkgLyAodGhpcy5kZy5yb3dIZWlnaHQgKyAxKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VmlzaWJsZVJhbmdlKHZpZXdwb3J0VG9wPzogbnVtYmVyLCB2aWV3cG9ydExlZnQ/OiBudW1iZXIpIHtcclxuICAgICAgICBpZiAodmlld3BvcnRUb3AgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB2aWV3cG9ydFRvcCA9IHRoaXMuc2Nyb2xsVG9wO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodmlld3BvcnRMZWZ0ID09IG51bGwpIHtcclxuICAgICAgICAgICAgdmlld3BvcnRMZWZ0ID0gdGhpcy5zY3JvbGxMZWZ0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgdG9wOiB0aGlzLmdldFJvd0Zyb21Qb3NpdGlvbih2aWV3cG9ydFRvcCksXHJcbiAgICAgICAgICAgIGJvdHRvbTogdGhpcy5nZXRSb3dGcm9tUG9zaXRpb24odmlld3BvcnRUb3AgKyB0aGlzLnZpZXdwb3J0SCkgKyAxLFxyXG4gICAgICAgICAgICBsZWZ0UHg6IHZpZXdwb3J0TGVmdCxcclxuICAgICAgICAgICAgcmlnaHRQeDogdmlld3BvcnRMZWZ0ICsgdGhpcy52aWV3cG9ydFdcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0UmVuZGVyZWRSYW5nZSh2aWV3cG9ydFRvcD86IG51bWJlciwgdmlld3BvcnRMZWZ0PzogbnVtYmVyKSB7XHJcbiAgICAgICAgY29uc3QgcmFuZ2UgPSB0aGlzLmdldFZpc2libGVSYW5nZSh2aWV3cG9ydFRvcCwgdmlld3BvcnRMZWZ0KTtcclxuICAgICAgICBjb25zdCBidWZmZXIgPSBNYXRoLnJvdW5kKHRoaXMudmlld3BvcnRIIC8gKHRoaXMuZGcucm93SGVpZ2h0ICsgMSkpO1xyXG4gICAgICAgIGNvbnN0IG1pbkJ1ZmZlciA9IHRoaXMubWluUm93QnVmZmVyO1xyXG5cclxuICAgICAgICBpZiAodGhpcy52U2Nyb2xsRGlyID09IC0xKSB7XHJcbiAgICAgICAgICAgIHJhbmdlLnRvcCAtPSBidWZmZXI7XHJcbiAgICAgICAgICAgIHJhbmdlLmJvdHRvbSArPSBtaW5CdWZmZXI7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnZTY3JvbGxEaXIgPT0gMSkge1xyXG4gICAgICAgICAgICByYW5nZS50b3AgLT0gbWluQnVmZmVyO1xyXG4gICAgICAgICAgICByYW5nZS5ib3R0b20gKz0gYnVmZmVyO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJhbmdlLnRvcCAtPSBtaW5CdWZmZXI7XHJcbiAgICAgICAgICAgIHJhbmdlLmJvdHRvbSArPSBtaW5CdWZmZXI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByYW5nZS50b3AgPSBNYXRoLm1heCgwLCByYW5nZS50b3ApO1xyXG4gICAgICAgIHJhbmdlLmJvdHRvbSA9IE1hdGgubWluKHRoaXMuZGF0YS5sZW5ndGggLSAxLCByYW5nZS5ib3R0b20pO1xyXG5cclxuICAgICAgICByYW5nZS5sZWZ0UHggLT0gdGhpcy52aWV3cG9ydFc7XHJcbiAgICAgICAgcmFuZ2UucmlnaHRQeCArPSB0aGlzLnZpZXdwb3J0VztcclxuXHJcbiAgICAgICAgcmFuZ2UubGVmdFB4ID0gTWF0aC5tYXgoMCwgcmFuZ2UubGVmdFB4KTtcclxuICAgICAgICByYW5nZS5yaWdodFB4ID0gTWF0aC5taW4odGhpcy5jYW52YXNXaWR0aCwgcmFuZ2UucmlnaHRQeCk7XHJcblxyXG4gICAgICAgIHJldHVybiByYW5nZTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlbmRlclJvd3MocmFuZ2UpIHtcclxuICAgICAgICBjb25zdCByb3dzID0gW107XHJcbiAgICAgICAgY29uc3QgZGF0YUxlbmd0aCA9IHRoaXMuZGF0YS5sZW5ndGg7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGkgPSByYW5nZS50b3A7IGkgPD0gcmFuZ2UuYm90dG9tOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMucm93c0NhY2hlW2ldIHx8IChpID09IGRhdGFMZW5ndGgpKSB7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByb3dzLnB1c2goaSk7XHJcblxyXG4gICAgICAgICAgICAvLyBDcmVhdGUgYW4gZW50cnkgcmlnaHQgYXdheSBzbyB0aGF0IGFwcGVuZFJvd0h0bWwoKSBjYW5cclxuICAgICAgICAgICAgLy8gc3RhcnQgcG9wdWxhdGF0aW5nIGl0LlxyXG4gICAgICAgICAgICB0aGlzLnJvd3NDYWNoZVtpXSA9IHtcclxuICAgICAgICAgICAgICAgIHJvd05vZGU6IG51bGwsXHJcblxyXG4gICAgICAgICAgICAgICAgLy8gQ29sU3BhbnMgb2YgcmVuZGVyZWQgY2VsbHMgKGJ5IGNvbHVtbiBpZHgpLlxyXG4gICAgICAgICAgICAgICAgLy8gQ2FuIGFsc28gYmUgdXNlZCBmb3IgY2hlY2tpbmcgd2hldGhlciBhIGNlbGwgaGFzIGJlZW4gcmVuZGVyZWQuXHJcbiAgICAgICAgICAgICAgICBjZWxsQ29sU3BhbnM6IFtdLFxyXG5cclxuICAgICAgICAgICAgICAgIC8vIENlbGwgbm9kZXMgKGJ5IGNvbHVtbiBpZHgpLiAgTGF6eS1wb3B1bGF0ZWQgYnkgZW5zdXJlQ2VsbE5vZGVzSW5Sb3dzQ2FjaGUoKS5cclxuICAgICAgICAgICAgICAgIGNlbGxOb2Rlc0J5Q29sdW1uSWR4OiBbXSxcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBDb2x1bW4gaW5kaWNlcyBvZiBjZWxsIG5vZGVzIHRoYXQgaGF2ZSBiZWVuIHJlbmRlcmVkLCBidXQgbm90IHlldCBpbmRleGVkIGluXHJcbiAgICAgICAgICAgICAgICAvLyBjZWxsTm9kZXNCeUNvbHVtbklkeC4gIFRoZXNlIGFyZSBpbiB0aGUgc2FtZSBvcmRlciBhcyBjZWxsIG5vZGVzIGFkZGVkIGF0IHRoZVxyXG4gICAgICAgICAgICAgICAgLy8gZW5kIG9mIHRoZSByb3cuXHJcbiAgICAgICAgICAgICAgICBjZWxsUmVuZGVyUXVldWU6IFtdXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSByb3dzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcclxuICAgICAgICAgICAgdGhpcy5yb3dzQ2FjaGVbcm93c1tpXV0ucm93Tm9kZSA9IHRoaXMuZGF0YVtyb3dzW2ldXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLnJvd3NDYWNoZSkubWFwKG4gPT4gdGhpcy5yb3dzQ2FjaGVbbl0ucm93Tm9kZSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgcmVtb3ZlUm93RnJvbUNhY2hlKHJvdykge1xyXG4gICAgICAgIGNvbnN0IGNhY2hlRW50cnkgPSB0aGlzLnJvd3NDYWNoZVtyb3ddO1xyXG4gICAgICAgIGlmICghY2FjaGVFbnRyeSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBkZWxldGUgdGhpcy5yb3dzQ2FjaGVbcm93XTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNsZWFudXBSb3dzKHJhbmdlVG9LZWVwKSB7XHJcbiAgICAgICAgZm9yIChjb25zdCBpIGluIHRoaXMucm93c0NhY2hlKSB7XHJcbiAgICAgICAgICAgIGlmIChpIDwgcmFuZ2VUb0tlZXAudG9wIHx8IGkgPiByYW5nZVRvS2VlcC5ib3R0b20pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlUm93RnJvbUNhY2hlKGkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmVuZGVyRGF0YShkZXRlY3RjaGFuZ2VzID0gdHJ1ZSkge1xyXG4gICAgICAgIHRoaXMuY2FudmFzSGVpZ2h0ID0gdGhpcy5nZXRDYW52YXNIZWlnaHQoKTtcclxuICAgICAgICBpZiAoIXRoaXMuZGcudmlydHVhbGl6ZWQgfHwgdGhpcy5kZy5hdXRvSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMucm93cyA9IHRoaXMuZGF0YTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCB2aXNpYmxlID0gdGhpcy5nZXRWaXNpYmxlUmFuZ2UoKTtcclxuICAgICAgICAgICAgY29uc3QgcmVuZGVyZWQgPSB0aGlzLmdldFJlbmRlcmVkUmFuZ2UoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIHJlbW92ZSByb3dzIG5vIGxvbmdlciBpbiB0aGUgdmlld3BvcnRcclxuICAgICAgICAgICAgdGhpcy5jbGVhbnVwUm93cyhyZW5kZXJlZCk7XHJcblxyXG4gICAgICAgICAgICAvLyByZW5kZXIgbWlzc2luZyByb3dzXHJcbiAgICAgICAgICAgIHRoaXMucm93cyA9IHRoaXMucmVuZGVyUm93cyhyZW5kZXJlZCk7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhcnRSb3dJbmRleCA9IHJlbmRlcmVkLnRvcDtcclxuICAgICAgICAgICAgdGhpcy5ibGFua1RvcEhlaWdodCA9IHRoaXMuc3RhcnRSb3dJbmRleCAqICh0aGlzLmRnLnJvd0hlaWdodCArIDEpO1xyXG4gICAgICAgICAgICB0aGlzLmJsYW5rQm90dG9tSGVpZ2h0ID0gdGhpcy5jYW52YXNIZWlnaHQgLSB0aGlzLmJsYW5rVG9wSGVpZ2h0IC0gKHRoaXMucm93cy5sZW5ndGggKiAodGhpcy5kZy5yb3dIZWlnaHQgKyAxKSk7XHJcbiAgICAgICAgICAgIHRoaXMubGFzdFJlbmRlcmVkU2Nyb2xsVG9wID0gdGhpcy5zY3JvbGxUb3A7XHJcbiAgICAgICAgICAgIHRoaXMubGFzdFJlbmRlcmVkU2Nyb2xsTGVmdCA9IHRoaXMuc2Nyb2xsTGVmdDtcclxuICAgICAgICAgICAgaWYgKGRldGVjdGNoYW5nZXMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaGFuZGxlU2Nyb2xsKCkge1xyXG4gICAgICAgIHRoaXMuc2Nyb2xsVG9wID0gdGhpcy5wcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsVG9wO1xyXG4gICAgICAgIHRoaXMuc2Nyb2xsTGVmdCA9IHRoaXMucHMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnNjcm9sbExlZnQ7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZVNjcm9sbCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2hhbmRsZVNjcm9sbCgpIHtcclxuICAgICAgICBjb25zdCB2aWV3cG9ydENvbnRhaW5lciA9IHRoaXMudmlld1Njcm9sbENvbnRhaW5lci5uYXRpdmVFbGVtZW50O1xyXG4gICAgICAgIGxldCBtYXhTY3JvbGxEaXN0YW5jZVkgPSB2aWV3cG9ydENvbnRhaW5lci5zY3JvbGxIZWlnaHQgLSB2aWV3cG9ydENvbnRhaW5lci5jbGllbnRIZWlnaHQ7XHJcbiAgICAgICAgbGV0IG1heFNjcm9sbERpc3RhbmNlWCA9IHZpZXdwb3J0Q29udGFpbmVyLnNjcm9sbFdpZHRoIC0gdmlld3BvcnRDb250YWluZXIuY2xpZW50V2lkdGg7XHJcblxyXG4gICAgICAgIC8vIFByb3RlY3QgYWdhaW5zdCBlcnJvbmVvdXMgY2xpZW50SGVpZ2h0L1dpZHRoIGdyZWF0ZXIgdGhhbiBzY3JvbGxIZWlnaHQvV2lkdGguXHJcbiAgICAgICAgLy8gU29tZXRpbWVzIHNlZW4gaW4gQ2hyb21lLlxyXG4gICAgICAgIG1heFNjcm9sbERpc3RhbmNlWSA9IE1hdGgubWF4KDAsIG1heFNjcm9sbERpc3RhbmNlWSk7XHJcbiAgICAgICAgbWF4U2Nyb2xsRGlzdGFuY2VYID0gTWF0aC5tYXgoMCwgbWF4U2Nyb2xsRGlzdGFuY2VYKTtcclxuXHJcbiAgICAgICAgLy8gQ2VpbGluZyB0aGUgbWF4IHNjcm9sbCB2YWx1ZXNcclxuICAgICAgICBpZiAodGhpcy5zY3JvbGxUb3AgPiBtYXhTY3JvbGxEaXN0YW5jZVkpIHtcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxUb3AgPSBtYXhTY3JvbGxEaXN0YW5jZVk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnNjcm9sbExlZnQgPiBtYXhTY3JvbGxEaXN0YW5jZVgpIHtcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxMZWZ0ID0gbWF4U2Nyb2xsRGlzdGFuY2VYO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgdlNjcm9sbERpc3QgPSBNYXRoLmFicyh0aGlzLnNjcm9sbFRvcCAtIHRoaXMucHJldlNjcm9sbFRvcCk7XHJcbiAgICAgICAgY29uc3QgaFNjcm9sbERpc3QgPSBNYXRoLmFicyh0aGlzLnNjcm9sbExlZnQgLSB0aGlzLnByZXZTY3JvbGxMZWZ0KTtcclxuXHJcbiAgICAgICAgaWYgKGhTY3JvbGxEaXN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMucHJldlNjcm9sbExlZnQgPSB0aGlzLnNjcm9sbExlZnQ7XHJcblxyXG4gICAgICAgICAgICAvLyAkdmlld3BvcnRTY3JvbGxDb250YWluZXJYWzBdLnNjcm9sbExlZnQgPSBzY3JvbGxMZWZ0O1xyXG4gICAgICAgICAgICAvLyBpZiAoaGFzRnJvemVuQ29sdW1ucygpKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBpZiAoaGFzRnJvemVuUm93cykge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICR2aWV3cG9ydFRvcFJbMF0uc2Nyb2xsTGVmdCA9IHNjcm9sbExlZnQ7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vICAgICBpZiAoaGFzRnJvemVuUm93cykge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICR2aWV3cG9ydFRvcExbMF0uc2Nyb2xsTGVmdCA9IHNjcm9sbExlZnQ7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh2U2Nyb2xsRGlzdCkge1xyXG4gICAgICAgICAgICB0aGlzLnZTY3JvbGxEaXIgPSB0aGlzLnByZXZTY3JvbGxUb3AgPCB0aGlzLnNjcm9sbFRvcCA/IDEgOiAtMTtcclxuICAgICAgICAgICAgdGhpcy5wcmV2U2Nyb2xsVG9wID0gdGhpcy5zY3JvbGxUb3A7XHJcblxyXG4gICAgICAgICAgICAvLyBpZiAoaGFzRnJvemVuQ29sdW1ucygpKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBpZiAoaGFzRnJvemVuUm93cyAmJiAhb3B0aW9ucy5mcm96ZW5Cb3R0b20pIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAkdmlld3BvcnRCb3R0b21MWzBdLnNjcm9sbFRvcCA9IHNjcm9sbFRvcDtcclxuICAgICAgICAgICAgLy8gICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgJHZpZXdwb3J0VG9wTFswXS5zY3JvbGxUb3AgPSBzY3JvbGxUb3A7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgICAgIC8vIHN3aXRjaCB2aXJ0dWFsIHBhZ2VzIGlmIG5lZWRlZFxyXG4gICAgICAgICAgICBpZiAodlNjcm9sbERpc3QgPCB0aGlzLnZpZXdwb3J0SCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2Nyb2xsVG8odGhpcy5zY3JvbGxUb3ApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaFNjcm9sbERpc3QgfHwgdlNjcm9sbERpc3QpIHtcclxuICAgICAgICAgICAgY29uc3QgZHggPSBNYXRoLmFicyh0aGlzLmxhc3RSZW5kZXJlZFNjcm9sbExlZnQgLSB0aGlzLnNjcm9sbExlZnQpO1xyXG4gICAgICAgICAgICBjb25zdCBkeSA9IE1hdGguYWJzKHRoaXMubGFzdFJlbmRlcmVkU2Nyb2xsVG9wIC0gdGhpcy5zY3JvbGxUb3ApO1xyXG4gICAgICAgICAgICBpZiAoZHggPiAyMCB8fCBkeSA+IDIwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpZiByZW5kZXJpbmcgaXMgZm9yY2VkIG9yIHNjcm9sbGluZyBpcyBzbWFsbCBlbm91Z2ggdG8gYmUgXCJlYXN5XCIsIGp1c3QgcmVuZGVyXHJcbiAgICAgICAgICAgICAgICBpZiAoZHkgPCB0aGlzLnZpZXdwb3J0SCAmJiBkeCA8IHRoaXMudmlld3BvcnRXKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJEYXRhKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyRGF0YSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaFNjcm9sbERpc3QgfHwgdlNjcm9sbERpc3QpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9zY3JvbGxUbyh5KSB7XHJcbiAgICAgICAgY29uc3QgJHZpZXdwb3J0U2Nyb2xsQ29udGFpbmVyWSA9IHRoaXMudmlld1Njcm9sbENvbnRhaW5lci5uYXRpdmVFbGVtZW50O1xyXG4gICAgICAgIHkgPSBNYXRoLm1heCh5LCAwKTtcclxuICAgICAgICB5ID0gTWF0aC5taW4oeSwgdGhpcy5jYW52YXNIZWlnaHQgLSB0aGlzLnZpZXdwb3J0SCk7XHJcblxyXG4gICAgICAgIGNvbnN0IG5ld1Njcm9sbFRvcCA9IHk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnByZXZTY3JvbGxUb3AgIT0gbmV3U2Nyb2xsVG9wKSB7XHJcbiAgICAgICAgICAgIHRoaXMudlNjcm9sbERpciA9ICh0aGlzLnByZXZTY3JvbGxUb3AgPCBuZXdTY3JvbGxUb3ApID8gMSA6IC0xO1xyXG4gICAgICAgICAgICB0aGlzLmxhc3RSZW5kZXJlZFNjcm9sbFRvcCA9ICh0aGlzLnNjcm9sbFRvcCA9IHRoaXMucHJldlNjcm9sbFRvcCA9IG5ld1Njcm9sbFRvcCk7XHJcblxyXG4gICAgICAgICAgICAvLyBpZiAoaGFzRnJvemVuQ29sdW1ucygpKSB7XHJcbiAgICAgICAgICAgIC8vICAgICAkdmlld3BvcnRUb3BMWzBdLnNjcm9sbFRvcCA9IG5ld1Njcm9sbFRvcDtcclxuICAgICAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICAgICAgLy8gaWYgKGhhc0Zyb3plblJvd3MpIHtcclxuICAgICAgICAgICAgLy8gICAgICR2aWV3cG9ydEJvdHRvbUxbMF0uc2Nyb2xsVG9wID0gJHZpZXdwb3J0Qm90dG9tUlswXS5zY3JvbGxUb3AgPSBuZXdTY3JvbGxUb3A7XHJcbiAgICAgICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgICAgIC8vICR2aWV3cG9ydFNjcm9sbENvbnRhaW5lclkuc2Nyb2xsVG9wID0gbmV3U2Nyb2xsVG9wO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvbk1vdXNlQ2xpY2soJGV2ZW50OiBNb3VzZUV2ZW50KSB7XHJcbiAgICAgICAgLy8gZG9jdW1lbnQuYm9keS5jbGljaygpO1xyXG4gICAgICAgIGNvbnN0IHRhcmdldCA9ICRldmVudC50YXJnZXQgYXMgYW55O1xyXG5cclxuICAgICAgICBpZiAodGFyZ2V0Lm5vZGVOYW1lID09PSAnVEVYVEFSRUEnIHx8IHRhcmdldC5ub2RlTmFtZSA9PT0gJ0lOUFVUJyApIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIGxldCB0ZCA9IHRhcmdldDtcclxuICAgICAgICBpZiAodGFyZ2V0Lm5vZGVOYW1lICE9PSAnVEQnKSB7XHJcbiAgICAgICAgICAgIHRkID0gdGFyZ2V0LmNsb3Nlc3QoJ1REJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXRoaXMuZGcuZWRpdGFibGUgJiYgdGhpcy5fX3RyaWdnZXJCb2R5Q2xpY2tFdmVudCkge1xyXG4gICAgICAgICAgICAvLyDop6PlhrPotoXpk77ngrnlh7vkuovku7bvvIzopoHlhYjmiafooYzpgInkuK3ooYxcclxuICAgICAgICAgICAgaWYgKHRkICYmIHRkLnNlbGVjdENlbGwgKSB7XHJcbiAgICAgICAgICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICB0ZC5zZWxlY3RDZWxsKCRldmVudCwgdGQpOyAgLy8g5oyJ55CG6K+05Y+v5Lul5Yig6Zmk55qE77yM5L2G5LiN5pWi5Yqo5ZOmbyjiiaflj6PiiaYpb1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRnLmVkaXRNb2RlID09PSAncm93Jykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgaWYgKHRkKSB7XHJcbiAgICAgICAgICAgIC8vIOihjOemgeeUqOaXtlxyXG4gICAgICAgICAgICBpZiAodGhpcy5kZy5kaXNhYmxlUm93ICYmIHRkLmdyaWRDZWxsRGF0YSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgeyByb3dEYXRhLCByb3dJbmRleCB9ID0gdGQuZ3JpZENlbGxEYXRhO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZGcuZGlzYWJsZVJvdyhyb3dEYXRhLCByb3dJbmRleCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLmVkaXRhYmxlICYmIHRoaXMuZGcuZWRpdE1vZGUgPT09ICdjZWxsJyAmJiB0ZC5lZGl0KSB7XHJcbiAgICAgICAgICAgICAgICB0ZC5lZGl0KCRldmVudCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGQuc2VsZWN0Q2VsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICB0ZC5jbG9zZUVkaXQoKTtcclxuICAgICAgICAgICAgICAgICAgICB0ZC5zZWxlY3RDZWxsKCRldmVudCwgdGQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBvbkJlZm9yZVNob3dDb250ZXh0TWVudSA9IChlOiBhbnkpID0+IHtcclxuICAgICAgICAvLyByb3dfMV9maXhlZGxlZnQgIHJvd18xICByb3dfMV9maXhlZHJpZ2h0XHJcbiAgICAgICAgY29uc3QgeyBjb250ZXh0TWVudURvbSwgZXZlbnQgfSA9IGU7XHJcblxyXG4gICAgICAgIGlmIChldmVudC50YXJnZXQuY2xvc2VzdCgnLmRhdGFncmlkLWVkaXRvcicpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBvZih7c2hvdzogZmFsc2V9KTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBsZXQgcm93SUQgPSBldmVudC50YXJnZXQuaWQ7XHJcblxyXG4gICAgICAgIGlmIChjb250ZXh0TWVudURvbSkge1xyXG4gICAgICAgICAgICAvLyDmjpLpmaTliIbnu4TooYzjgIHliIbnu4TlkIjorqHooYxcclxuICAgICAgICAgICAgaWYgKGNvbnRleHRNZW51RG9tLmNsYXNzTmFtZS5pbmRleE9mKCdmLWRhdGFncmlkLWdyb3VwLXJvdycpID09PSAtMSAmJiBjb250ZXh0TWVudURvbS5jbGFzc05hbWUuaW5kZXhPZignZi1kYXRhZ3JpZC1ncm91cC1mb290ZXInKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIHJvd0lEID0gY29udGV4dE1lbnVEb20uaWQucmVwbGFjZSgncm93XycsICcnKS5yZXBsYWNlKCdfZml4ZWRsZWZ0JywgJycpLnJlcGxhY2UoJ19maXhlZHJpZ2h0JywgJycpO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgcm93RGF0YSA9IHRoaXMuZGZzLmZpbmRSb3cocm93SUQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZm9jdXNUYXJnZXRXaWR0aCA9IHRoaXMudmlld3BvcnRXID4gdGhpcy50b3RhbFdpZHRoID8gdGhpcy50b3RhbFdpZHRoIDogdGhpcy52aWV3cG9ydFc7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gb2YoeyBzaG93OiB0cnVlLCBkYXRhOiB7IGRhdGE6IHJvd0RhdGEuZGF0YSwgZ3JpZDogdGhpcy5kZ30sIGZvY3VzVGFyZ2V0V2lkdGggfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG9mKHsgc2hvdzogZmFsc2UgfSk7XHJcbiAgICB9XHJcbn1cclxuIl19