/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, forwardRef, Input, HostBinding, Output, EventEmitter, Injector, ElementRef, ViewChild, NgZone, HostListener } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { DateTimeHelperService } from '@farris/ui-common/date';
import { NumberHelperService } from '@farris/ui-common/number';
import { LocaleService } from '@farris/ui-locale';
var TextComponent = /** @class */ (function () {
    function TextComponent(dtHelper, numberHelper, injector, ngzone) {
        this.dtHelper = dtHelper;
        this.numberHelper = numberHelper;
        this.injector = injector;
        this.ngzone = ngzone;
        this.cls = true;
        this.textChange = new EventEmitter();
        /**
         * 是否为密码输入
         */
        this.isPassword = false;
        // 是否多行文本
        this.isTextArea = false;
        // 是否启用自动尺寸
        this.autoSize = false;
        // 设置高度
        this.height = 0;
        // 是否是日期范围
        this.dateRange = false;
        // 千分位符号
        this.thousand = ',';
        // 小数点处符号
        this.decimal = '.';
        // 货币符号及值展现形式
        this.expression = '%s%v';
        this.textField = 'name';
        this.valueField = 'value';
        this.returnFormat = ''; // 从服务器端取值是格式化后的
        // 日期范围模式下input的显示分割符合
        this.dateRangeDelimiter = '~';
        this.enumDelimiter = ',';
        this._tshowType = 0;
        // 货币符号，默认是RMB
        this.currencySymbol = '￥';
        // 十进制前面填充的符号
        this.filledSymbol = '0';
        // 标签
        this.staticTitle = "";
        // 处理中英文情况， 因为多语言暂时不通过这个属性控制
        this.showTitle = false;
        this.beforeWriteValue = null;
        this.controlChange = (/**
         * @param {?} val
         * @return {?}
         */
        function (val) { });
        this.controlTouch = (/**
         * @param {?} val
         * @return {?}
         */
        function (val) { });
        this.localeService = this.injector.get(LocaleService);
    }
    Object.defineProperty(TextComponent.prototype, "showType", {
        get: /**
         * @return {?}
         */
        function () {
            return this._tshowType;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._tshowType = value;
            // 如果是周
            if (value == 4) {
                this.dateRange = true;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextComponent.prototype, "value", {
        get: /**
         * @return {?}
         */
        function () {
            return this.text;
        },
        // 普通文本输入值
        set: 
        // 普通文本输入值
        /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this.text = this.formatValue(value);
            this.textChange.emit(this.text);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} ev
     * @return {?}
     */
    TextComponent.prototype.changeTitle = /**
     * @param {?} ev
     * @return {?}
     */
    function (ev) {
        if (!this.isTextArea && !this.isPassword) {
            this.mouseEnterChangeTitle();
        }
    };
    Object.defineProperty(TextComponent.prototype, "option", {
        get: /**
         * @return {?}
         */
        function () {
            return this._option;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._option = value;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    TextComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    TextComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    TextComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @private
     * @return {?}
     */
    TextComponent.prototype.mouseEnterChangeTitle = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.textInnerEl.nativeElement.scrollHeight > this.textInnerEl.nativeElement.clientHeight) {
            this.staticTitle = this.text && this.text.length > 0 ? this.text : this.control;
        }
        else {
            this.staticTitle = '';
        }
    };
    /**
     * 处理多语言，待定
     */
    /**
     * 处理多语言，待定
     * @param {?} value
     * @return {?}
     */
    TextComponent.prototype.formatLang = /**
     * 处理多语言，待定
     * @param {?} value
     * @return {?}
     */
    function (value) {
        return value && value[this.currentLanguage] ? value[this.currentLanguage] : '';
    };
    /**
     * C货币
     * D十进制
     * F浮点数
     * N数字，带千分位
     * P百分比
     */
    /**
     * C货币
     * D十进制
     * F浮点数
     * N数字，带千分位
     * P百分比
     * @param {?} value
     * @return {?}
     */
    TextComponent.prototype.getFormatNumberValue = /**
     * C货币
     * D十进制
     * F浮点数
     * N数字，带千分位
     * P百分比
     * @param {?} value
     * @return {?}
     */
    function (value) {
        if (!this.format && !this._option) {
            return value.toString();
        }
        if (this._option && this._option.type && this._option.type == 'number') {
            if (this._option.formatter) {
                return this._option.formatter(value);
            }
            else {
                if (this._option.useThousands) {
                    if (this._option.precision != undefined) {
                        this.format = 'n' + this._option.precision;
                    }
                    else {
                        this.format = 'n2';
                    }
                }
                else {
                    if (this._option.precision != undefined) {
                        this.format = 'f' + this._option.precision;
                    }
                    else {
                        this.format = 'f2';
                    }
                }
            }
        }
        /** @type {?} */
        var firstLetter = this.currencyToUpperCase(this.format.substring(0, 1));
        /** @type {?} */
        var precision = Number(this.format.substring(1));
        /** @type {?} */
        var config = {};
        /** @type {?} */
        var result;
        if (!/C|D|F|N|P/g.test(firstLetter)) {
            console.warn("\u4E0D\u652F\u6301format\u4E3A " + this.format + " \u7C7B\u578B\u7684\u6570\u5B57\u683C\u5F0F\u5316");
            return;
        }
        if (this.thousand) {
            Object.assign(config, { thousand: this.thousand });
        }
        if (this.decimal) {
            Object.assign(config, { decimal: this.decimal });
        }
        if (this.expression) {
            Object.assign(config, { format: this.expression });
        }
        switch (firstLetter) {
            case 'C':
                Object.assign(config, { prefix: this.currencySymbol, precision: precision });
                result = this.numberHelper.formatMoney(value, config);
                break;
            case 'D':
                result = this.toDecimal(value, precision);
                break;
            case 'F':
                Object.assign(config, { prefix: '', thousand: '', precision: precision });
                result = this.numberHelper.formatMoney(value, config);
                break;
            case 'N':
                Object.assign(config, { prefix: '', precision: precision });
                result = this.numberHelper.formatMoney(value, config);
                break;
            case 'P':
                result = this.toPercent(value, precision);
                break;
        }
        return result;
    };
    /**
     * @param value 转换成十进制的数字
     * @param precision 十进制数字的长度
     */
    /**
     * @param {?} value 转换成十进制的数字
     * @param {?} precision 十进制数字的长度
     * @return {?}
     */
    TextComponent.prototype.toDecimal = /**
     * @param {?} value 转换成十进制的数字
     * @param {?} precision 十进制数字的长度
     * @return {?}
     */
    function (value, precision) {
        if (value.toString().indexOf('.') > -1) {
            console.warn('十进制转换仅限整型类型');
            return;
        }
        return (Array(precision).join(this.filledSymbol) + value).slice(-precision);
    };
    /**
     * @param value 转换成百分数的数字
     * @param decimal 小数点保留几位
     */
    /**
     * @param {?} value 转换成百分数的数字
     * @param {?} precision
     * @return {?}
     */
    TextComponent.prototype.toPercent = /**
     * @param {?} value 转换成百分数的数字
     * @param {?} precision
     * @return {?}
     */
    function (value, precision) {
        return Number(value * 100).toFixed(Number(precision)) + '%';
    };
    /**
     * 将货币符号首字母转换成大写
     */
    /**
     * 将货币符号首字母转换成大写
     * @param {?} value
     * @return {?}
     */
    TextComponent.prototype.currencyToUpperCase = /**
     * 将货币符号首字母转换成大写
     * @param {?} value
     * @return {?}
     */
    function (value) {
        return value.replace(/[a-z]+/g, (/**
         * @param {?} word
         * @return {?}
         */
        function (word) {
            return word.toUpperCase();
        }));
    };
    /**
     * 处理年，Y=>y, D=>d
     */
    /**
     * 处理年，Y=>y, D=>d
     * @param {?} value
     * @return {?}
     */
    TextComponent.prototype.dateToUpperCase = /**
     * 处理年，Y=>y, D=>d
     * @param {?} value
     * @return {?}
     */
    function (value) {
        /** @type {?} */
        var newFormat;
        if (/Y/g.test(value) === true) {
            newFormat = value.replace(/Y/g, 'y');
        }
        else {
            newFormat = value;
        }
        if (/D/g.test(newFormat) === true) {
            newFormat = newFormat.replace(/D/g, 'd');
        }
        return newFormat;
    };
    /**
     * 枚举类型处理
     */
    /**
     * 枚举类型处理
     * @param {?} value
     * @return {?}
     */
    TextComponent.prototype.getFormatEnumValue = /**
     * 枚举类型处理
     * @param {?} value
     * @return {?}
     */
    function (value) {
        var _this = this;
        if (value == undefined || value === null || value === '') {
            return '';
        }
        if (this.data && this.data.length) {
            // 可能存在多选枚举，作为分隔符  
            // let curVals = ('' + value).split(',');
            /** @type {?} */
            var curVals_1 = ('' + value).split(this.enumDelimiter);
            /** @type {?} */
            var nameResult = [];
            var _loop_1 = function (k) {
                /** @type {?} */
                var findObj = this_1.data.find((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    return item[_this.valueField] == curVals_1[k];
                }));
                if (findObj) {
                    nameResult.push(findObj[this_1.textField]);
                }
                else {
                    nameResult.push(curVals_1[k]);
                }
            };
            var this_1 = this;
            for (var k = 0; k < curVals_1.length; k++) {
                _loop_1(k);
            }
            if (nameResult.length > 0) {
                // return nameResult.join(',');
                return nameResult.join(this.enumDelimiter);
            }
            return '';
        }
        else {
            return value;
        }
    };
    /**
     * boolean值处理
     */
    /**
     * boolean值处理
     * @param {?} value
     * @return {?}
     */
    TextComponent.prototype.getFormatCheckBoxValue = /**
     * boolean值处理
     * @param {?} value
     * @return {?}
     */
    function (value) {
        if (value === true) {
            return this.localeService.getValue('text.yes');
        }
        else if (value === false || value == null || typeof value === 'undefined') {
            return this.localeService.getValue('text.no');
        }
        else {
            return value;
        }
    };
    /**
     * @private
     * @param {?} value
     * @param {?} fmt
     * @param {?=} hourSystem
     * @return {?}
     */
    TextComponent.prototype.timeFormatTo = /**
     * @private
     * @param {?} value
     * @param {?} fmt
     * @param {?=} hourSystem
     * @return {?}
     */
    function (value, fmt, hourSystem) {
        if (hourSystem === void 0) { hourSystem = 12; }
    };
    /**
     * @private
     * @param {?} fmt
     * @return {?}
     */
    TextComponent.prototype.makeFormater = /**
     * @private
     * @param {?} fmt
     * @return {?}
     */
    function (fmt) {
        return fmt;
    };
    /*
    * 日期格式化
    */
    /*
        * 日期格式化
        */
    /**
     * @param {?} value
     * @return {?}
     */
    TextComponent.prototype.dateformat = /*
        * 日期格式化
        */
    /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        /** @type {?} */
        var str;
        if (!this.format) {
            this.format = 'YYYY-MM-DD';
        }
        // 当前值是已经格式化后的日期字符串
        if (this.returnFormat && this.returnFormat != 'yyyy-MM-dd' && typeof value == 'string') {
            value = this.getDateFromFormatedString(value, this.returnFormat);
        }
        //
        if (this.format === 'hh:mm:ss' || this.format === 'HH:mm:ss') {
            // 格式化时间  临时处理
            str = value;
        }
        else {
            // if (this.showTime && value instanceof String) {
            //     str = value;
            // } else {
            //     const formArr = this.format.split(' ');
            //     if (this.showTime && formArr.length < 2) {
            //         formArr.push('HH:mm:ss');
            //         this.format = formArr.join(' ');
            //     }
            //     // 格式化日期
            //     str = this.dtHelper.formatTo(value, this.dateToUpperCase(this.format));
            // }
            str = this.dtHelper.formatTo(value, this.dateToUpperCase(this.format));
        }
        return str;
    };
    /**
     * @private
     * @param {?} dateString
     * @param {?} format
     * @return {?}
     */
    TextComponent.prototype.getDateFromFormatedString = /**
     * @private
     * @param {?} dateString
     * @param {?} format
     * @return {?}
     */
    function (dateString, format) {
        /** @type {?} */
        var result = { year: 0, month: 0, day: 0, hour: 0, minite: 0, second: 0 };
        if (dateString) {
            format.replace(/y+|Y+|M+|d+|D+|h+|H+|m+|s+/g, (/**
             * @param {?} m
             * @param {?} a
             * @param {?} b
             * @param {?} c
             * @return {?}
             */
            function (m, a, b, c) {
                dateString.substring(a).replace(/\d+/, (/**
                 * @param {?} d
                 * @return {?}
                 */
                function (d) { c = parseInt(d, 10); }));
                if (/y+/i.test(m) && !result.year)
                    result.year = c;
                if (/M+/.test(m) && !result.month)
                    result.month = c;
                if (/d+/i.test(m) && !result.day)
                    result.day = c;
                if (/h+/i.test(m) && !result.hour)
                    result.hour = c;
                if (/m+/.test(m) && !result.minite)
                    result.minite = c;
                if (/s+/.test(m) && !result.second)
                    result.second = c;
            }));
        }
        /** @type {?} */
        var resultDate = new Date(result.year + '/' + result.month + '/' + result.day + ' ' + result.hour + ':' + result.minite + ':' + result.second);
        return resultDate;
    };
    /**
     * 格式化处理
     */
    /**
     * 格式化处理
     * @param {?} value
     * @return {?}
     */
    TextComponent.prototype.formatValue = /**
     * 格式化处理
     * @param {?} value
     * @return {?}
     */
    function (value) {
        var _this = this;
        /** @type {?} */
        var str;
        if (this.currentLanguage) {
            return this.formatLang(value);
        }
        // if (!value) {
        //     return '';
        // }
        if (this.type !== 'boolean' && (value == null || typeof value === 'undefined')) {
            return '';
        }
        switch (this.type) {
            case 'string':
                str = value;
                break;
            case 'date':
            case 'datetime':
                // console.log(this.format);
                if (!this.dateRange) {
                    // if (!this.format) {
                    //     this.format = 'YYYY-MM-DD';
                    // }
                    // if (this.format === 'hh:mm:ss') {
                    //     // 格式化时间  临时处理
                    //     str = value;
                    // } else {
                    //     if (this.showTime) {
                    //         str = value;
                    //     } else {
                    //         // 格式化日期
                    //         str = this.dtHelper.formatTo(value, this.dateToUpperCase(this.format));
                    //     }
                    // }
                    str = this.dateformat(value);
                    // console.log(str);
                }
                else {
                    /** @type {?} */
                    var dateValues = value.split(this.dateRangeDelimiter);
                    /** @type {?} */
                    var dataStr_1 = [];
                    if (dateValues && dateValues.length) {
                        dateValues.forEach((/**
                         * @param {?} date
                         * @return {?}
                         */
                        function (date) {
                            /** @type {?} */
                            var val = _this.dateformat(date);
                            dataStr_1.push(val);
                        }));
                    }
                    str = dataStr_1.join(this.dateRangeDelimiter);
                }
                break;
            // case 'dateTime':
            //     str = this.timeFormatTo(value, this.makeFormater(this.format));
            //     break;
            case 'number':
                str = this.getFormatNumberValue(value);
                break;
            case 'enum':
                str = this.getFormatEnumValue(value);
                break;
            case 'boolean':
                str = this.getFormatCheckBoxValue(value);
                break;
            default:
                break; // throw new Error(`暂不支持 ${this.type} 类型`);
        }
        return str;
    };
    /**
     * @private
     * @param {?} value
     * @return {?}
     */
    TextComponent.prototype.setText2Star = /**
     * @private
     * @param {?} value
     * @return {?}
     */
    function (value) {
        if (this.isPassword) {
            /** @type {?} */
            var star = value ? '******' : '';
            this.text = star;
            this.control = star;
            return true;
        }
        return false;
    };
    /**
     * @param {?} value
     * @return {?}
     */
    TextComponent.prototype.writeValue = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        // lucas 2021-08-27
        if (this.setText2Star(value)) {
            return;
        }
        // xia 2021-03-13
        if (this.beforeWriteValue) {
            /** @type {?} */
            var options = {
                localizationType: this.localizationType,
                showTime: this.showTime,
                ref: this
            };
            /** @type {?} */
            var text = this.beforeWriteValue(value, options);
            if (text !== undefined) {
                this.text = text;
                return;
            }
        }
        this.control = this.formatValue(value);
        this.controlChange(value);
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    TextComponent.prototype.registerOnChange = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.controlChange = fn;
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    TextComponent.prototype.registerOnTouched = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.controlTouch = fn;
    };
    TextComponent.decorators = [
        { type: Component, args: [{
                    selector: 'farris-text',
                    template: "\n        <span #textInner\n            [ngClass]=\"{'f-form-control-text':!isTextArea,'f-form-control-textarea':isTextArea,'f-component-text-auto-size': this.autoSize}\"\n            [title]=\"staticTitle\" [style.text-align]=\"textAlign\"\n            [style.height]=\"!autoSize&&height>0?height+'px':null\" [style.minHeight]=\"autoSize&&height>0?height+'px':null\"\n            [style.maxHeight]=\"autoSize&&maxHeight>0?maxHeight+'px':null\">{{text && text.length > 0 ?  text : control}}</span>\n    ",
                    providers: [{
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: forwardRef((/**
                             * @return {?}
                             */
                            function () { return TextComponent; })),
                            multi: true,
                        }]
                }] }
    ];
    /** @nocollapse */
    TextComponent.ctorParameters = function () { return [
        { type: DateTimeHelperService },
        { type: NumberHelperService },
        { type: Injector },
        { type: NgZone }
    ]; };
    TextComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class.f-component-text',] }],
        textInnerEl: [{ type: ViewChild, args: ['textInner', { read: ElementRef },] }],
        textChange: [{ type: Output }],
        isPassword: [{ type: Input }],
        isTextArea: [{ type: Input }],
        autoSize: [{ type: Input }],
        maxHeight: [{ type: Input }],
        height: [{ type: Input }],
        type: [{ type: Input }],
        dateRange: [{ type: Input }],
        format: [{ type: Input }],
        lang: [{ type: Input }],
        data: [{ type: Input }],
        thousand: [{ type: Input }],
        decimal: [{ type: Input }],
        expression: [{ type: Input }],
        currentLanguage: [{ type: Input }],
        showTime: [{ type: Input }],
        textField: [{ type: Input }],
        valueField: [{ type: Input }],
        returnFormat: [{ type: Input }],
        textAlign: [{ type: Input }],
        dateRangeDelimiter: [{ type: Input }],
        enumDelimiter: [{ type: Input }],
        showType: [{ type: Input }],
        localizationType: [{ type: Input }],
        filledSymbol: [{ type: Input }],
        value: [{ type: Input }],
        changeTitle: [{ type: HostListener, args: ['mouseenter', ['$event'],] }],
        showTitle: [{ type: Input }],
        option: [{ type: Input }]
    };
    return TextComponent;
}());
export { TextComponent };
if (false) {
    /** @type {?} */
    TextComponent.prototype.cls;
    /** @type {?} */
    TextComponent.prototype.textInnerEl;
    /** @type {?} */
    TextComponent.prototype.textChange;
    /**
     * 是否为密码输入
     * @type {?}
     */
    TextComponent.prototype.isPassword;
    /** @type {?} */
    TextComponent.prototype.isTextArea;
    /** @type {?} */
    TextComponent.prototype.autoSize;
    /** @type {?} */
    TextComponent.prototype.maxHeight;
    /** @type {?} */
    TextComponent.prototype.height;
    /** @type {?} */
    TextComponent.prototype.type;
    /** @type {?} */
    TextComponent.prototype.dateRange;
    /** @type {?} */
    TextComponent.prototype.format;
    /** @type {?} */
    TextComponent.prototype.lang;
    /** @type {?} */
    TextComponent.prototype.data;
    /** @type {?} */
    TextComponent.prototype.thousand;
    /** @type {?} */
    TextComponent.prototype.decimal;
    /** @type {?} */
    TextComponent.prototype.expression;
    /** @type {?} */
    TextComponent.prototype.currentLanguage;
    /** @type {?} */
    TextComponent.prototype.showTime;
    /** @type {?} */
    TextComponent.prototype.textField;
    /** @type {?} */
    TextComponent.prototype.valueField;
    /** @type {?} */
    TextComponent.prototype.returnFormat;
    /** @type {?} */
    TextComponent.prototype.textAlign;
    /** @type {?} */
    TextComponent.prototype.dateRangeDelimiter;
    /** @type {?} */
    TextComponent.prototype.enumDelimiter;
    /**
     * @type {?}
     * @private
     */
    TextComponent.prototype._tshowType;
    /**
     * 国际化类型
     * @type {?}
     */
    TextComponent.prototype.localizationType;
    /** @type {?} */
    TextComponent.prototype.control;
    /** @type {?} */
    TextComponent.prototype.text;
    /** @type {?} */
    TextComponent.prototype.currencySymbol;
    /** @type {?} */
    TextComponent.prototype.filledSymbol;
    /** @type {?} */
    TextComponent.prototype.staticTitle;
    /** @type {?} */
    TextComponent.prototype.showTitle;
    /** @type {?} */
    TextComponent.prototype._option;
    /**
     * @type {?}
     * @private
     */
    TextComponent.prototype.localeService;
    /** @type {?} */
    TextComponent.prototype.beforeWriteValue;
    /**
     * @type {?}
     * @private
     */
    TextComponent.prototype.controlChange;
    /**
     * @type {?}
     * @private
     */
    TextComponent.prototype.controlTouch;
    /**
     * @type {?}
     * @private
     */
    TextComponent.prototype.dtHelper;
    /**
     * @type {?}
     * @private
     */
    TextComponent.prototype.numberHelper;
    /**
     * @type {?}
     * @private
     */
    TextComponent.prototype.injector;
    /** @type {?} */
    TextComponent.prototype.ngzone;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGV4dC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLXRleHQvIiwic291cmNlcyI6WyJsaWIvdGV4dC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFDSCxTQUFTLEVBQVUsVUFBVSxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxRQUFRLEVBQ2xFLFVBQVUsRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFDN0QsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLGlCQUFpQixFQUF3QixNQUFNLGdCQUFnQixDQUFDO0FBQ3pFLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQy9ELE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQy9ELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUVsRDtJQXFISSx1QkFDWSxRQUErQixFQUMvQixZQUFpQyxFQUNqQyxRQUFrQixFQUNuQixNQUFjO1FBSGIsYUFBUSxHQUFSLFFBQVEsQ0FBdUI7UUFDL0IsaUJBQVksR0FBWixZQUFZLENBQXFCO1FBQ2pDLGFBQVEsR0FBUixRQUFRLENBQVU7UUFDbkIsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQXZHYyxRQUFHLEdBQUcsSUFBSSxDQUFDO1FBRXhDLGVBQVUsR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDOzs7O1FBRXRDLGVBQVUsR0FBRyxLQUFLLENBQUM7O1FBRW5CLGVBQVUsR0FBRyxLQUFLLENBQUM7O1FBRW5CLGFBQVEsR0FBRyxLQUFLLENBQUM7O1FBSWpCLFdBQU0sR0FBRyxDQUFDLENBQUM7O1FBSVgsY0FBUyxHQUFHLEtBQUssQ0FBQzs7UUFRbEIsYUFBUSxHQUFHLEdBQUcsQ0FBQzs7UUFFZixZQUFPLEdBQUcsR0FBRyxDQUFDOztRQUVkLGVBQVUsR0FBRyxNQUFNLENB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OztJQUNsRCxvQ0FBc0U7O0lBQ3RFLG1DQUErQzs7Ozs7SUFFL0MsbUNBQTRCOztJQUU1QixtQ0FBNEI7O0lBRTVCLGlDQUEwQjs7SUFFMUIsa0NBQTJCOztJQUUzQiwrQkFBb0I7O0lBRXBCLDZCQUFzQjs7SUFFdEIsa0NBQTJCOztJQUUzQiwrQkFBcUI7O0lBRXJCLDZCQUFzQjs7SUFFdEIsNkJBQW1COztJQUVuQixpQ0FBd0I7O0lBRXhCLGdDQUF1Qjs7SUFFdkIsbUNBQTZCOztJQUM3Qix3Q0FBaUM7O0lBRWpDLGlDQUEyQjs7SUFDM0Isa0NBQTRCOztJQUM1QixtQ0FBOEI7O0lBQzlCLHFDQUEyQjs7SUFHM0Isa0NBQW1COztJQUVuQiwyQ0FBa0M7O0lBQ2xDLHNDQUE2Qjs7Ozs7SUFDN0IsbUNBQXVCOzs7OztJQWV2Qix5Q0FBa0M7O0lBQ2xDLGdDQUFhOztJQUViLDZCQUFVOztJQUVWLHVDQUFxQjs7SUFFckIscUNBQTRCOztJQWdCNUIsb0NBQWlCOztJQUVqQixrQ0FBMkI7O0lBRTNCLGdDQUFROzs7OztJQVNSLHNDQUEyQjs7SUFFM0IseUNBQTREOzs7OztJQUU1RCxzQ0FBcUM7Ozs7O0lBQ3JDLHFDQUFvQzs7Ozs7SUFHaEMsaUNBQXVDOzs7OztJQUN2QyxxQ0FBeUM7Ozs7O0lBQ3pDLGlDQUEwQjs7SUFDMUIsK0JBQXFCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICAgIENvbXBvbmVudCwgT25Jbml0LCBmb3J3YXJkUmVmLCBJbnB1dCwgSG9zdEJpbmRpbmcsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBJbmplY3RvcixcclxuICAgIFNpbXBsZUNoYW5nZXMsIEVsZW1lbnRSZWYsIFZpZXdDaGlsZCwgTmdab25lLCBIb3N0TGlzdGVuZXJcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgTkdfVkFMVUVfQUNDRVNTT1IsIENvbnRyb2xWYWx1ZUFjY2Vzc29yIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xyXG5pbXBvcnQgeyBEYXRlVGltZUhlbHBlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWNvbW1vbi9kYXRlJztcclxuaW1wb3J0IHsgTnVtYmVySGVscGVyU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktY29tbW9uL251bWJlcic7XHJcbmltcG9ydCB7IExvY2FsZVNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWxvY2FsZSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnZmFycmlzLXRleHQnLFxyXG4gICAgdGVtcGxhdGU6IGBcclxuICAgICAgICA8c3BhbiAjdGV4dElubmVyXHJcbiAgICAgICAgICAgIFtuZ0NsYXNzXT1cInsnZi1mb3JtLWNvbnRyb2wtdGV4dCc6IWlzVGV4dEFyZWEsJ2YtZm9ybS1jb250cm9sLXRleHRhcmVhJzppc1RleHRBcmVhLCdmLWNvbXBvbmVudC10ZXh0LWF1dG8tc2l6ZSc6IHRoaXMuYXV0b1NpemV9XCJcclxuICAgICAgICAgICAgW3RpdGxlXT1cInN0YXRpY1RpdGxlXCIgW3N0eWxlLnRleHQtYWxpZ25dPVwidGV4dEFsaWduXCJcclxuICAgICAgICAgICAgW3N0eWxlLmhlaWdodF09XCIhYXV0b1NpemUmJmhlaWdodD4wP2hlaWdodCsncHgnOm51bGxcIiBbc3R5bGUubWluSGVpZ2h0XT1cImF1dG9TaXplJiZoZWlnaHQ+MD9oZWlnaHQrJ3B4JzpudWxsXCJcclxuICAgICAgICAgICAgW3N0eWxlLm1heEhlaWdodF09XCJhdXRvU2l6ZSYmbWF4SGVpZ2h0PjA/bWF4SGVpZ2h0KydweCc6bnVsbFwiPnt7dGV4dCAmJiB0ZXh0Lmxlbmd0aCA+IDAgPyAgdGV4dCA6IGNvbnRyb2x9fTwvc3Bhbj5cclxuICAgIGAsXHJcbiAgICBzdHlsZXM6IFtdLFxyXG4gICAgcHJvdmlkZXJzOiBbe1xyXG4gICAgICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxyXG4gICAgICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IFRleHRDb21wb25lbnQpLFxyXG4gICAgICAgIG11bHRpOiB0cnVlLFxyXG4gICAgfV1cclxufSlcclxuZXhwb3J0IGNsYXNzIFRleHRDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIENvbnRyb2xWYWx1ZUFjY2Vzc29yIHtcclxuXHJcbiAgICBASG9zdEJpbmRpbmcoJ2NsYXNzLmYtY29tcG9uZW50LXRleHQnKSBjbHMgPSB0cnVlO1xyXG4gICAgQFZpZXdDaGlsZCgndGV4dElubmVyJywgeyByZWFkOiBFbGVtZW50UmVmIH0pIHRleHRJbm5lckVsOiBFbGVtZW50UmVmO1xyXG4gICAgQE91dHB1dCgpIHRleHRDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICAgIC8qKiDmmK/lkKbkuLrlr4bnoIHovpPlhaUgKi9cclxuICAgIEBJbnB1dCgpIGlzUGFzc3dvcmQgPSBmYWxzZTtcclxuICAgIC8vIOaYr+WQpuWkmuihjOaWh+acrFxyXG4gICAgQElucHV0KCkgaXNUZXh0QXJlYSA9IGZhbHNlO1xyXG4gICAgLy8g5piv5ZCm5ZCv55So6Ieq5Yqo5bC65a+4XHJcbiAgICBASW5wdXQoKSBhdXRvU2l6ZSA9IGZhbHNlO1xyXG4gICAgLy8g6K6+572u5pyA5aSn6auY5bqmXHJcbiAgICBASW5wdXQoKSBtYXhIZWlnaHQ6IG51bWJlcjtcclxuICAgIC8vIOiuvue9rumrmOW6plxyXG4gICAgQElucHV0KCkgaGVpZ2h0ID0gMDtcclxuICAgIC8vIOaOp+S7tuexu+Wei1xyXG4gICAgQElucHV0KCkgdHlwZTogc3RyaW5nO1xyXG4gICAgLy8g5piv5ZCm5piv5pel5pyf6IyD5Zu0XHJcbiAgICBASW5wdXQoKSBkYXRlUmFuZ2UgPSBmYWxzZTtcclxuICAgIC8vIOmcgOimgei9rOWMluexu+Wei+agvOW8j+eahOihqOi+vuW8j1xyXG4gICAgQElucHV0KCkgZm9ybWF0OiBhbnk7XHJcbiAgICAvLyDlpJror63oqIBcclxuICAgIEBJbnB1dCgpIGxhbmc6IHN0cmluZztcclxuICAgIC8vIOi9rOaNouexu+Wei+eUqOWIsOeahOaVsOaNrlxyXG4gICAgQElucHV0KCkgZGF0YTogYW55O1xyXG4gICAgLy8g5Y2D5YiG5L2N56ym5Y+3XHJcbiAgICBASW5wdXQoKSB0aG91c2FuZCA9ICcsJztcclxuICAgIC8vIOWwj+aVsOeCueWkhOespuWPt1xyXG4gICAgQElucHV0KCkgZGVjaW1hbCA9ICcuJztcclxuICAgIC8vIOi0p+W4geespuWPt+WPiuWAvOWxleeOsOW9ouW8j1xyXG4gICAgQElucHV0KCkgZXhwcmVzc2lvbiA9ICclcyV2JztcclxuICAgIEBJbnB1dCgpIGN1cnJlbnRMYW5ndWFnZTogc3RyaW5nO1xyXG4gICAgLy8gZm9ybUNvbnRyb2zmmL7npLrnmoTmlofmnKxcclxuICAgIEBJbnB1dCgpIHNob3dUaW1lOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgdGV4dEZpZWxkID0gJ25hbWUnO1xyXG4gICAgQElucHV0KCkgdmFsdWVGaWVsZCA9ICd2YWx1ZSc7XHJcbiAgICBASW5wdXQoKSByZXR1cm5Gb3JtYXQgPSAnJzsgLy8g5LuO5pyN5Yqh5Zmo56uv5Y+W5YC85piv5qC85byP5YyW5ZCO55qEXHJcblxyXG4gICAgLy8g5paH5pys5pa55ZCRXHJcbiAgICBASW5wdXQoKSB0ZXh0QWxpZ247XHJcbiAgICAvLyDml6XmnJ/ojIPlm7TmqKHlvI/kuItpbnB1dOeahOaYvuekuuWIhuWJsuespuWQiFxyXG4gICAgQElucHV0KCkgZGF0ZVJhbmdlRGVsaW1pdGVyID0gJ34nO1xyXG4gICAgQElucHV0KCkgZW51bURlbGltaXRlciA9ICcsJztcclxuICAgIHByaXZhdGUgX3RzaG93VHlwZSA9IDA7XHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IHNob3dUeXBlKHZhbHVlOiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLl90c2hvd1R5cGUgPSB2YWx1ZTtcclxuICAgICAgICAvLyDlpoLmnpzmmK/lkahcclxuICAgICAgICBpZiAodmFsdWUgPT0gNCkge1xyXG4gICAgICAgICAgICB0aGlzLmRhdGVSYW5nZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ2V0IHNob3dUeXBlKCk6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RzaG93VHlwZTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Zu96ZmF5YyW57G75Z6LXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIGxvY2FsaXphdGlvblR5cGU6IHN0cmluZztcclxuICAgIGNvbnRyb2w6IGFueTtcclxuICAgIC8vIOaZrumAmuaWh+acrFxyXG4gICAgdGV4dDogYW55O1xyXG4gICAgLy8g6LSn5biB56ym5Y+377yM6buY6K6k5pivUk1CXHJcbiAgICBjdXJyZW5jeVN5bWJvbCA9ICfvv6UnO1xyXG4gICAgLy8g5Y2B6L+b5Yi25YmN6Z2i5aGr5YWF55qE56ym5Y+3XHJcbiAgICBASW5wdXQoKSBmaWxsZWRTeW1ib2wgPSAnMCc7XHJcbiAgICAvLyDmma7pgJrmlofmnKzovpPlhaXlgLxcclxuICAgIEBJbnB1dCgpXHJcbiAgICBzZXQgdmFsdWUodmFsdWU6IGFueSkge1xyXG4gICAgICAgIHRoaXMudGV4dCA9IHRoaXMuZm9ybWF0VmFsdWUodmFsdWUpO1xyXG4gICAgICAgIHRoaXMudGV4dENoYW5nZS5lbWl0KHRoaXMudGV4dCk7XHJcbiAgICB9XHJcbiAgICBnZXQgdmFsdWUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudGV4dDtcclxuICAgIH1cclxuICAgIEBIb3N0TGlzdGVuZXIoJ21vdXNlZW50ZXInLCBbJyRldmVudCddKSBjaGFuZ2VUaXRsZShldikge1xyXG4gICAgICAgIGlmICghdGhpcy5pc1RleHRBcmVhICYmICF0aGlzLmlzUGFzc3dvcmQpIHtcclxuICAgICAgICAgICAgdGhpcy5tb3VzZUVudGVyQ2hhbmdlVGl0bGUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyDmoIfnrb5cclxuICAgIHN0YXRpY1RpdGxlID0gXCJcIjtcclxuICAgIC8vIOWkhOeQhuS4reiLseaWh+aDheWGte+8jCDlm6DkuLrlpJror63oqIDmmoLml7bkuI3pgJrov4fov5nkuKrlsZ7mgKfmjqfliLZcclxuICAgIEBJbnB1dCgpIHNob3dUaXRsZSA9IGZhbHNlO1xyXG4gICAgLy/mlbDlgLzmoLzlvI/lj4LmlbBcclxuICAgIF9vcHRpb247XHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IG9wdGlvbih2YWx1ZSkge1xyXG4gICAgICAgIHRoaXMuX29wdGlvbiA9IHZhbHVlO1xyXG4gICAgfVxyXG4gICAgZ2V0IG9wdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fb3B0aW9uO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgbG9jYWxlU2VydmljZTogYW55O1xyXG5cclxuICAgIGJlZm9yZVdyaXRlVmFsdWU6ICh2YWw6IGFueSwgb3B0aW9uczogYW55KSA9PiBzdHJpbmcgPSBudWxsO1xyXG5cclxuICAgIHByaXZhdGUgY29udHJvbENoYW5nZSA9ICh2YWwpID0+IHsgfTtcclxuICAgIHByaXZhdGUgY29udHJvbFRvdWNoID0gKHZhbCkgPT4geyB9O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHByaXZhdGUgZHRIZWxwZXI6IERhdGVUaW1lSGVscGVyU2VydmljZSxcclxuICAgICAgICBwcml2YXRlIG51bWJlckhlbHBlcjogTnVtYmVySGVscGVyU2VydmljZSxcclxuICAgICAgICBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvcixcclxuICAgICAgICBwdWJsaWMgbmd6b25lOiBOZ1pvbmVcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMubG9jYWxlU2VydmljZSA9IHRoaXMuaW5qZWN0b3IuZ2V0KExvY2FsZVNlcnZpY2UpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCkge1xyXG5cclxuICAgIH1cclxuICAgIG5nT25EZXN0cm95KCk6IHZvaWQge1xyXG5cclxuICAgIH1cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcclxuXHJcbiAgICB9XHJcbiAgICBwcml2YXRlIG1vdXNlRW50ZXJDaGFuZ2VUaXRsZSgpIHtcclxuICAgICAgICBpZiAodGhpcy50ZXh0SW5uZXJFbC5uYXRpdmVFbGVtZW50LnNjcm9sbEhlaWdodCA+IHRoaXMudGV4dElubmVyRWwubmF0aXZlRWxlbWVudC5jbGllbnRIZWlnaHQpIHtcclxuICAgICAgICAgICAgdGhpcy5zdGF0aWNUaXRsZSA9IHRoaXMudGV4dCAmJiB0aGlzLnRleHQubGVuZ3RoID4gMCA/IHRoaXMudGV4dCA6IHRoaXMuY29udHJvbDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnN0YXRpY1RpdGxlID0gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5aSE55CG5aSa6K+t6KiA77yM5b6F5a6aXHJcbiAgICAgKi9cclxuICAgIGZvcm1hdExhbmcodmFsdWU6IGFueSkge1xyXG4gICAgICAgIHJldHVybiB2YWx1ZSAmJiB2YWx1ZVt0aGlzLmN1cnJlbnRMYW5ndWFnZV0gPyB2YWx1ZVt0aGlzLmN1cnJlbnRMYW5ndWFnZV0gOiAnJztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ+i0p+W4gVxyXG4gICAgICogROWNgei/m+WItlxyXG4gICAgICogRua1rueCueaVsFxyXG4gICAgICogTuaVsOWtl++8jOW4puWNg+WIhuS9jVxyXG4gICAgICogUOeZvuWIhuavlFxyXG4gICAgICovXHJcbiAgICBnZXRGb3JtYXROdW1iZXJWYWx1ZSh2YWx1ZTogYW55KSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmZvcm1hdCAmJiAhdGhpcy5fb3B0aW9uKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZS50b1N0cmluZygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fb3B0aW9uICYmIHRoaXMuX29wdGlvbi50eXBlICYmIHRoaXMuX29wdGlvbi50eXBlID09ICdudW1iZXInKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9vcHRpb24uZm9ybWF0dGVyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fb3B0aW9uLmZvcm1hdHRlcih2YWx1ZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fb3B0aW9uLnVzZVRob3VzYW5kcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vcHRpb24ucHJlY2lzaW9uICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm1hdCA9ICduJyArIHRoaXMuX29wdGlvbi5wcmVjaXNpb247XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtYXQgPSAnbjInO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX29wdGlvbi5wcmVjaXNpb24gIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybWF0ID0gJ2YnICsgdGhpcy5fb3B0aW9uLnByZWNpc2lvbjtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm1hdCA9ICdmMic7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGZpcnN0TGV0dGVyID0gdGhpcy5jdXJyZW5jeVRvVXBwZXJDYXNlKHRoaXMuZm9ybWF0LnN1YnN0cmluZygwLCAxKSk7XHJcbiAgICAgICAgY29uc3QgcHJlY2lzaW9uID0gTnVtYmVyKHRoaXMuZm9ybWF0LnN1YnN0cmluZygxKSk7XHJcbiAgICAgICAgbGV0IGNvbmZpZyA9IHt9O1xyXG4gICAgICAgIGxldCByZXN1bHQ6IGFueTtcclxuICAgICAgICBpZiAoIS9DfER8RnxOfFAvZy50ZXN0KGZpcnN0TGV0dGVyKSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYOS4jeaUr+aMgWZvcm1hdOS4uiAke3RoaXMuZm9ybWF0fSDnsbvlnovnmoTmlbDlrZfmoLzlvI/ljJZgKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy50aG91c2FuZCkge1xyXG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKGNvbmZpZywgeyB0aG91c2FuZDogdGhpcy50aG91c2FuZCB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuZGVjaW1hbCkge1xyXG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKGNvbmZpZywgeyBkZWNpbWFsOiB0aGlzLmRlY2ltYWwgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmV4cHJlc3Npb24pIHtcclxuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihjb25maWcsIHsgZm9ybWF0OiB0aGlzLmV4cHJlc3Npb24gfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN3aXRjaCAoZmlyc3RMZXR0ZXIpIHtcclxuICAgICAgICAgICAgY2FzZSAnQyc6XHJcbiAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGNvbmZpZywgeyBwcmVmaXg6IHRoaXMuY3VycmVuY3lTeW1ib2wsIHByZWNpc2lvbiB9KTtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMubnVtYmVySGVscGVyLmZvcm1hdE1vbmV5KHZhbHVlLCBjb25maWcpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ0QnOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy50b0RlY2ltYWwodmFsdWUsIHByZWNpc2lvbik7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnRic6XHJcbiAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGNvbmZpZywgeyBwcmVmaXg6ICcnLCB0aG91c2FuZDogJycsIHByZWNpc2lvbiB9KTtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMubnVtYmVySGVscGVyLmZvcm1hdE1vbmV5KHZhbHVlLCBjb25maWcpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ04nOlxyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihjb25maWcsIHsgcHJlZml4OiAnJywgcHJlY2lzaW9uIH0pO1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5udW1iZXJIZWxwZXIuZm9ybWF0TW9uZXkodmFsdWUsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnUCc6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLnRvUGVyY2VudCh2YWx1ZSwgcHJlY2lzaW9uKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHBhcmFtIHZhbHVlIOi9rOaNouaIkOWNgei/m+WItueahOaVsOWtl1xyXG4gICAgICogQHBhcmFtIHByZWNpc2lvbiDljYHov5vliLbmlbDlrZfnmoTplb/luqZcclxuICAgICAqL1xyXG4gICAgdG9EZWNpbWFsKHZhbHVlOiBhbnksIHByZWNpc2lvbjogYW55KSB7XHJcbiAgICAgICAgaWYgKHZhbHVlLnRvU3RyaW5nKCkuaW5kZXhPZignLicpID4gLTEpIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKCfljYHov5vliLbovazmjaLku4XpmZDmlbTlnovnsbvlnosnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gKEFycmF5KHByZWNpc2lvbikuam9pbih0aGlzLmZpbGxlZFN5bWJvbCkgKyB2YWx1ZSkuc2xpY2UoLXByZWNpc2lvbik7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSB2YWx1ZSDovazmjaLmiJDnmb7liIbmlbDnmoTmlbDlrZdcclxuICAgICAqIEBwYXJhbSBkZWNpbWFsIOWwj+aVsOeCueS/neeVmeWHoOS9jVxyXG4gICAgICovXHJcbiAgICB0b1BlcmNlbnQodmFsdWU6IGFueSwgcHJlY2lzaW9uOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4gTnVtYmVyKHZhbHVlICogMTAwKS50b0ZpeGVkKE51bWJlcihwcmVjaXNpb24pKSArICclJztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWwhui0p+W4geespuWPt+mmluWtl+avjei9rOaNouaIkOWkp+WGmVxyXG4gICAgICovXHJcbiAgICBjdXJyZW5jeVRvVXBwZXJDYXNlKHZhbHVlOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4gdmFsdWUucmVwbGFjZSgvW2Etel0rL2csICh3b3JkOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHdvcmQudG9VcHBlckNhc2UoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWkhOeQhuW5tO+8jFk9PnksIEQ9PmRcclxuICAgICAqL1xyXG4gICAgZGF0ZVRvVXBwZXJDYXNlKHZhbHVlOiBhbnkpIHtcclxuICAgICAgICBsZXQgbmV3Rm9ybWF0OiBhbnk7XHJcbiAgICAgICAgaWYgKC9ZL2cudGVzdCh2YWx1ZSkgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgbmV3Rm9ybWF0ID0gdmFsdWUucmVwbGFjZSgvWS9nLCAneScpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG5ld0Zvcm1hdCA9IHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoL0QvZy50ZXN0KG5ld0Zvcm1hdCkgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgbmV3Rm9ybWF0ID0gbmV3Rm9ybWF0LnJlcGxhY2UoL0QvZywgJ2QnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBuZXdGb3JtYXQ7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOaemuS4vuexu+Wei+WkhOeQhlxyXG4gICAgICovXHJcbiAgICBnZXRGb3JtYXRFbnVtVmFsdWUodmFsdWU6IGFueSkge1xyXG4gICAgICAgIGlmICh2YWx1ZSA9PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09ICcnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuZGF0YSAmJiB0aGlzLmRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIC8vIOWPr+iDveWtmOWcqOWkmumAieaemuS4vu+8jOS9nOS4uuWIhumalOespiAgXHJcbiAgICAgICAgICAgIC8vIGxldCBjdXJWYWxzID0gKCcnICsgdmFsdWUpLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgICAgIGxldCBjdXJWYWxzID0gKCcnICsgdmFsdWUpLnNwbGl0KHRoaXMuZW51bURlbGltaXRlcik7XHJcbiAgICAgICAgICAgIGxldCBuYW1lUmVzdWx0ID0gW107XHJcbiAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgY3VyVmFscy5sZW5ndGg7IGsrKykge1xyXG4gICAgICAgICAgICAgICAgbGV0IGZpbmRPYmogPSB0aGlzLmRhdGEuZmluZChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbVt0aGlzLnZhbHVlRmllbGRdID09IGN1clZhbHNba107XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGlmIChmaW5kT2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZVJlc3VsdC5wdXNoKGZpbmRPYmpbdGhpcy50ZXh0RmllbGRdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWVSZXN1bHQucHVzaChjdXJWYWxzW2tdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobmFtZVJlc3VsdC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyByZXR1cm4gbmFtZVJlc3VsdC5qb2luKCcsJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmFtZVJlc3VsdC5qb2luKHRoaXMuZW51bURlbGltaXRlcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIGJvb2xlYW7lgLzlpITnkIZcclxuICAgICAqL1xyXG4gICAgZ2V0Rm9ybWF0Q2hlY2tCb3hWYWx1ZSh2YWx1ZTogYm9vbGVhbikge1xyXG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKCd0ZXh0LnllcycpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT09IGZhbHNlIHx8IHZhbHVlID09IG51bGwgfHwgdHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKCd0ZXh0Lm5vJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSB0aW1lRm9ybWF0VG8odmFsdWU6IGFueSwgZm10OiBzdHJpbmcsIGhvdXJTeXN0ZW0gPSAxMikge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIG1ha2VGb3JtYXRlcihmbXQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIGZtdDtcclxuICAgIH1cclxuICAgIC8qXHJcbiAgICAqIOaXpeacn+agvOW8j+WMllxyXG4gICAgKi9cclxuICAgIGRhdGVmb3JtYXQodmFsdWUpIHtcclxuICAgICAgICBsZXQgc3RyO1xyXG4gICAgICAgIGlmICghdGhpcy5mb3JtYXQpIHtcclxuICAgICAgICAgICAgdGhpcy5mb3JtYXQgPSAnWVlZWS1NTS1ERCc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOW9k+WJjeWAvOaYr+W3sue7j+agvOW8j+WMluWQjueahOaXpeacn+Wtl+espuS4slxyXG4gICAgICAgIGlmICh0aGlzLnJldHVybkZvcm1hdCAmJiB0aGlzLnJldHVybkZvcm1hdCAhPSAneXl5eS1NTS1kZCcgJiYgdHlwZW9mIHZhbHVlID09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIHZhbHVlID0gdGhpcy5nZXREYXRlRnJvbUZvcm1hdGVkU3RyaW5nKHZhbHVlLCB0aGlzLnJldHVybkZvcm1hdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vXHJcbiAgICAgICAgaWYgKHRoaXMuZm9ybWF0ID09PSAnaGg6bW06c3MnIHx8IHRoaXMuZm9ybWF0ID09PSAnSEg6bW06c3MnKSB7XHJcbiAgICAgICAgICAgIC8vIOagvOW8j+WMluaXtumXtCAg5Li05pe25aSE55CGXHJcbiAgICAgICAgICAgIHN0ciA9IHZhbHVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIGlmICh0aGlzLnNob3dUaW1lICYmIHZhbHVlIGluc3RhbmNlb2YgU3RyaW5nKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBzdHIgPSB2YWx1ZTtcclxuICAgICAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gICAgIGNvbnN0IGZvcm1BcnIgPSB0aGlzLmZvcm1hdC5zcGxpdCgnICcpO1xyXG4gICAgICAgICAgICAvLyAgICAgaWYgKHRoaXMuc2hvd1RpbWUgJiYgZm9ybUFyci5sZW5ndGggPCAyKSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgZm9ybUFyci5wdXNoKCdISDptbTpzcycpO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIHRoaXMuZm9ybWF0ID0gZm9ybUFyci5qb2luKCcgJyk7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vICAgICAvLyDmoLzlvI/ljJbml6XmnJ9cclxuICAgICAgICAgICAgLy8gICAgIHN0ciA9IHRoaXMuZHRIZWxwZXIuZm9ybWF0VG8odmFsdWUsIHRoaXMuZGF0ZVRvVXBwZXJDYXNlKHRoaXMuZm9ybWF0KSk7XHJcbiAgICAgICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgICAgIHN0ciA9IHRoaXMuZHRIZWxwZXIuZm9ybWF0VG8odmFsdWUsIHRoaXMuZGF0ZVRvVXBwZXJDYXNlKHRoaXMuZm9ybWF0KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBzdHI7XHJcbiAgICB9XHJcbiAgICBwcml2YXRlIGdldERhdGVGcm9tRm9ybWF0ZWRTdHJpbmcoZGF0ZVN0cmluZywgZm9ybWF0KSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IHsgeWVhcjogMCwgbW9udGg6IDAsIGRheTogMCwgaG91cjogMCwgbWluaXRlOiAwLCBzZWNvbmQ6IDAgfTsgLy8g5b2T54S26L+Z6YeM5Y+v5Lul6buY6K6kMTk3MC0xLTHml6VcclxuICAgICAgICBpZiAoZGF0ZVN0cmluZykge1xyXG4gICAgICAgICAgICBmb3JtYXQucmVwbGFjZSgveSt8WSt8TSt8ZCt8RCt8aCt8SCt8bSt8cysvZywgZnVuY3Rpb24gKG0sIGEsIGIsIGMpIHsvLyDov5nph4zlj6rlgZrkuoblubTmnIjml6UgIOWKoOaXtuWIhuenkuS5n+aYr+WPr+S7peeahFxyXG4gICAgICAgICAgICAgICAgZGF0ZVN0cmluZy5zdWJzdHJpbmcoYSkucmVwbGFjZSgvXFxkKy8sIGZ1bmN0aW9uIChkKSB7IGMgPSBwYXJzZUludChkLCAxMCkgfSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoL3krL2kudGVzdChtKSAmJiAhcmVzdWx0LnllYXIpIHJlc3VsdC55ZWFyID0gYztcclxuICAgICAgICAgICAgICAgIGlmICgvTSsvLnRlc3QobSkgJiYgIXJlc3VsdC5tb250aCkgcmVzdWx0Lm1vbnRoID0gYztcclxuICAgICAgICAgICAgICAgIGlmICgvZCsvaS50ZXN0KG0pICYmICFyZXN1bHQuZGF5KSByZXN1bHQuZGF5ID0gYztcclxuICAgICAgICAgICAgICAgIGlmICgvaCsvaS50ZXN0KG0pICYmICFyZXN1bHQuaG91cikgcmVzdWx0LmhvdXIgPSBjO1xyXG4gICAgICAgICAgICAgICAgaWYgKC9tKy8udGVzdChtKSAmJiAhcmVzdWx0Lm1pbml0ZSkgcmVzdWx0Lm1pbml0ZSA9IGM7XHJcbiAgICAgICAgICAgICAgICBpZiAoL3MrLy50ZXN0KG0pICYmICFyZXN1bHQuc2Vjb25kKSByZXN1bHQuc2Vjb25kID0gYztcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByZXN1bHREYXRlID0gbmV3IERhdGUocmVzdWx0LnllYXIgKyAnLycgKyByZXN1bHQubW9udGggKyAnLycgKyByZXN1bHQuZGF5ICsgJyAnICsgcmVzdWx0LmhvdXIgKyAnOicgKyByZXN1bHQubWluaXRlICsgJzonICsgcmVzdWx0LnNlY29uZCk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdERhdGU7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOagvOW8j+WMluWkhOeQhlxyXG4gICAgICovXHJcbiAgICBmb3JtYXRWYWx1ZSh2YWx1ZTogYW55KSB7XHJcbiAgICAgICAgbGV0IHN0cjogYW55O1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRMYW5ndWFnZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXRMYW5nKHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gaWYgKCF2YWx1ZSkge1xyXG4gICAgICAgIC8vICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgLy8gfVxyXG4gICAgICAgIGlmICh0aGlzLnR5cGUgIT09ICdib29sZWFuJyAmJiAodmFsdWUgPT0gbnVsbCB8fCB0eXBlb2YgdmFsdWUgPT09ICd1bmRlZmluZWQnKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN3aXRjaCAodGhpcy50eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ3N0cmluZyc6XHJcbiAgICAgICAgICAgICAgICBzdHIgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdkYXRlJzpcclxuICAgICAgICAgICAgY2FzZSAnZGF0ZXRpbWUnOlxyXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5mb3JtYXQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmRhdGVSYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmICghdGhpcy5mb3JtYXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy5mb3JtYXQgPSAnWVlZWS1NTS1ERCc7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmICh0aGlzLmZvcm1hdCA9PT0gJ2hoOm1tOnNzJykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAvLyDmoLzlvI/ljJbml7bpl7QgIOS4tOaXtuWkhOeQhlxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICBzdHIgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICBpZiAodGhpcy5zaG93VGltZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgc3RyID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAvLyDmoLzlvI/ljJbml6XmnJ9cclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIHN0ciA9IHRoaXMuZHRIZWxwZXIuZm9ybWF0VG8odmFsdWUsIHRoaXMuZGF0ZVRvVXBwZXJDYXNlKHRoaXMuZm9ybWF0KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHN0ciA9IHRoaXMuZGF0ZWZvcm1hdCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coc3RyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGVWYWx1ZXMgPSB2YWx1ZS5zcGxpdCh0aGlzLmRhdGVSYW5nZURlbGltaXRlcik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBkYXRhU3RyID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGVWYWx1ZXMgJiYgZGF0ZVZhbHVlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVZhbHVlcy5mb3JFYWNoKGRhdGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZhbCA9IHRoaXMuZGF0ZWZvcm1hdChkYXRlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFTdHIucHVzaCh2YWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyID0gZGF0YVN0ci5qb2luKHRoaXMuZGF0ZVJhbmdlRGVsaW1pdGVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgLy8gY2FzZSAnZGF0ZVRpbWUnOlxyXG4gICAgICAgICAgICAvLyAgICAgc3RyID0gdGhpcy50aW1lRm9ybWF0VG8odmFsdWUsIHRoaXMubWFrZUZvcm1hdGVyKHRoaXMuZm9ybWF0KSk7XHJcbiAgICAgICAgICAgIC8vICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnbnVtYmVyJzpcclxuICAgICAgICAgICAgICAgIHN0ciA9IHRoaXMuZ2V0Rm9ybWF0TnVtYmVyVmFsdWUodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2VudW0nOlxyXG4gICAgICAgICAgICAgICAgc3RyID0gdGhpcy5nZXRGb3JtYXRFbnVtVmFsdWUodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2Jvb2xlYW4nOlxyXG4gICAgICAgICAgICAgICAgc3RyID0gdGhpcy5nZXRGb3JtYXRDaGVja0JveFZhbHVlKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgYnJlYWs7IC8vIHRocm93IG5ldyBFcnJvcihg5pqC5LiN5pSv5oyBICR7dGhpcy50eXBlfSDnsbvlnotgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBzdHI7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzZXRUZXh0MlN0YXIodmFsdWUpIHtcclxuICAgICAgICBpZiAodGhpcy5pc1Bhc3N3b3JkKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXIgPSB2YWx1ZSA/ICcqKioqKionIDogJyc7XHJcbiAgICAgICAgICAgIHRoaXMudGV4dCA9IHN0YXI7XHJcbiAgICAgICAgICAgIHRoaXMuY29udHJvbCA9IHN0YXI7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHdyaXRlVmFsdWUodmFsdWU6IGFueSk6IHZvaWQge1xyXG4gICAgICAgIC8vIGx1Y2FzIDIwMjEtMDgtMjdcclxuICAgICAgICBpZiAodGhpcy5zZXRUZXh0MlN0YXIodmFsdWUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIHhpYSAyMDIxLTAzLTEzXHJcbiAgICAgICAgaWYgKHRoaXMuYmVmb3JlV3JpdGVWYWx1ZSkge1xyXG4gICAgICAgICAgICBjb25zdCBvcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgbG9jYWxpemF0aW9uVHlwZTogdGhpcy5sb2NhbGl6YXRpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgc2hvd1RpbWU6IHRoaXMuc2hvd1RpbWUsXHJcbiAgICAgICAgICAgICAgICByZWY6IHRoaXNcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgY29uc3QgdGV4dCA9IHRoaXMuYmVmb3JlV3JpdGVWYWx1ZSh2YWx1ZSwgb3B0aW9ucyk7XHJcbiAgICAgICAgICAgIGlmICh0ZXh0ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudGV4dCA9IHRleHQ7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb250cm9sID0gdGhpcy5mb3JtYXRWYWx1ZSh2YWx1ZSk7XHJcbiAgICAgICAgdGhpcy5jb250cm9sQ2hhbmdlKHZhbHVlKTtcclxuICAgIH1cclxuXHJcbiAgICByZWdpc3Rlck9uQ2hhbmdlKGZuOiAoKSA9PiB7fSk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY29udHJvbENoYW5nZSA9IGZuO1xyXG4gICAgfVxyXG5cclxuICAgIHJlZ2lzdGVyT25Ub3VjaGVkKGZuKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5jb250cm9sVG91Y2ggPSBmbjtcclxuICAgIH1cclxuXHJcbn1cclxuIl19