/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { cloneDeep } from 'lodash-es';
/*
* @Author: 疯狂秀才(lucas huang)
* @Date: 2018-10-27 10:55:02
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-10-16 14:14:14
* @Company: Inspur
* @Version: v0.0.1
*/
import { Component, Input, ViewChild, Output, EventEmitter, TemplateRef, ContentChildren, QueryList, Injector, ChangeDetectorRef, ElementRef, Renderer2 } from '@angular/core';
import { MessagerService } from '@farris/ui-messager';
import { TreeTableComponent } from '@farris/ui-treetable';
import { CommonUtils, FarrisTemplateDirective } from '@farris/ui-common';
import { LocaleService } from '@farris/ui-locale';
var MultiSelectComponent = /** @class */ (function () {
    function MultiSelectComponent(mesagerSer, injector, cd) {
        this.mesagerSer = mesagerSer;
        this.injector = injector;
        this.cd = cd;
        this.allTreeNodes = [];
        this._ds = [];
        this.displayType = 'List';
        /**
         * 显示右侧上移下移按钮
         */
        this.enableTargetSort = true;
        this.height = 445;
        this.fit = true;
        this.noDataMoveMessage = '请选择要移动的数据。';
        this.leftTitle = '未选择';
        this.rightTitle = '已选择';
        this.enableSearch = true;
        /**
         * 目标数据源显示checkbox 允许多选
         */
        this.showCheckbox = false;
        this.dataChange = new EventEmitter();
        this.selected = new EventEmitter();
        this.selectedIdChange = new EventEmitter();
        this.beforeMove = new EventEmitter();
        this.afterMove = new EventEmitter();
        this.sortMove = new EventEmitter();
        // 左侧选中的数据 { [keyVal]: obj, [keyVal]: obj ... }
        this._leftCheckeds = {};
        // 右侧数据
        this._rightData = [];
        this.canCheckLength = 0;
        this.leftCount = 0;
        this._searchValue = '';
        this.trackByItems = (/**
         * @param {?} index
         * @param {?} item
         * @return {?}
         */
        function (index, item) {
            return index;
        });
        if (!Object.values) {
            Object.values = (/**
             * @param {?} obj
             * @return {?}
             */
            function (obj) {
                return Object.keys(obj).map((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) {
                    return obj[e];
                }));
            });
        }
        this.el = this.injector.get(ElementRef);
        this.render = this.injector.get(Renderer2);
        this.localeService = this.injector.get(LocaleService);
        this.commonUtils = this.injector.get(CommonUtils, null);
    }
    Object.defineProperty(MultiSelectComponent.prototype, "dataSource", {
        get: /**
         * @return {?}
         */
        function () {
            return this._ds;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            val = val || [];
            this._ds = val;
            if (!this.searchValue) {
                if (val.length) {
                    if (val[0].toJSON) {
                        this.copyDataSource = val.map((/**
                         * @param {?} n
                         * @return {?}
                         */
                        function (n) { return n.toJSON(); }));
                    }
                    else {
                        this.copyDataSource = cloneDeep(val);
                    }
                }
                this.initRightData(this.selectedId);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MultiSelectComponent.prototype, "selections", {
        get: /**
         * @return {?}
         */
        function () {
            return this._rightData;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._rightData = val;
            this.cd.detectChanges();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MultiSelectComponent.prototype, "searchValue", {
        get: /**
         * @return {?}
         */
        function () {
            return this._searchValue;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._searchValue = value;
            // this.copyDataSource = [...this.dataSource];
            if (value === undefined || value === null || value === '') {
                this.dataSource = this.copyDataSource;
                return;
            }
            if (this.displayType === 'Tree') {
                /** @type {?} */
                var newDataSource = this.getTreeDataBySearch(this._searchValue, this.allTreeNodes);
                this.tt.loadData(newDataSource);
            }
            else {
                this.dataSource = this.getListDataBySearch(this._searchValue, this.copyDataSource);
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    MultiSelectComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        // this.copyDataSource = this.dataSource ? [...this.dataSource] : [];
        this.emptyData = this.localeService.getValue('multiSelect.emptyData') || '暂无数据';
        this.initRightData(this.selectedId);
        this.moveItem();
    };
    /**
     * @return {?}
     */
    MultiSelectComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var elt = this.el.nativeElement;
        this.render.addClass(elt, 'row');
        this.render.addClass(elt, 'f-multi-select');
        if (this.fit === true) {
            this.render.addClass(elt, 'f-utils-fill');
        }
        if (!!this.height) {
            this.render.setStyle(elt, 'height', this.height + 'px');
        }
        this.noDataMoveMessage =
            this.noDataMoveMessage === '请选择要移动的数据。' ? this.localeService.getValue('multiSelect.noDataMoveMessage') : this.noDataMoveMessage;
        if (this.tt && this.selectedId) {
            this.tt.checkedNodes(this.selectedId);
        }
    };
    /**
     * @return {?}
     */
    MultiSelectComponent.prototype.ngAfterContentInit = /**
     * @return {?}
     */
    function () {
        var _this_1 = this;
        this.templates.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            switch (item.getType()) {
                case 'text':
                    _this_1.displayTemplate = item.template;
                    break;
            }
        }));
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    MultiSelectComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes.dataSource && !changes.dataSource.isFirstChange()) {
            // this.copyDataSource = [...(this.dataSource || [])];
            this._leftCheckeds = {};
            this._rightData = [];
        }
        if (changes.selectedId && !changes.selectedId.isFirstChange()) {
            this.initRightData(changes.selectedId.currentValue);
        }
    };
    /**
     * @return {?}
     */
    MultiSelectComponent.prototype.getCanCheckLength = /**
     * @return {?}
     */
    function () {
        var _this_1 = this;
        /** @type {?} */
        var n = 0;
        /** @type {?} */
        var total = 0;
        if (this.isTree()) {
            this.tt.serializedValue.forEach((/**
             * @param {?} rn
             * @return {?}
             */
            function (rn) {
                if (rn.node.selectable) {
                    if (_this_1.canChecked(rn.node)) {
                        n++;
                    }
                }
            }));
            total = this.tt.serializedValue.length;
        }
        else {
            this.dataSource.forEach((/**
             * @param {?} d
             * @return {?}
             */
            function (d) {
                if (_this_1.canChecked(d)) {
                    n++;
                }
            }));
            total = this.dataSource.length;
        }
        this.leftCount = total;
        return n;
    };
    /**
     * 获取搜索的数据，List结构
     * @param value 搜索的字符
     * @param data 数据
     */
    /**
     * 获取搜索的数据，List结构
     * @private
     * @param {?} value 搜索的字符
     * @param {?} data 数据
     * @return {?}
     */
    MultiSelectComponent.prototype.getListDataBySearch = /**
     * 获取搜索的数据，List结构
     * @private
     * @param {?} value 搜索的字符
     * @param {?} data 数据
     * @return {?}
     */
    function (value, data) {
        var _this_1 = this;
        /** @type {?} */
        var result = [];
        value = '' + value;
        if (data instanceof Array) {
            data.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                /** @type {?} */
                var txt = '';
                /** @type {?} */
                var val = '';
                if (_this_1.textField) {
                    txt = '' + _this_1.getText(item);
                }
                if (_this_1.valueField) {
                    val = '' + _this_1.getValue(item);
                }
                if (_this_1.textField && _this_1.valueField) {
                    if (txt.indexOf(value) !== -1 || val.indexOf(value) !== -1) {
                        result.push(item);
                    }
                }
                else if (_this_1.textField && !_this_1.valueField) {
                    if (txt.indexOf(value) !== -1) {
                        result.push(item);
                    }
                }
                else if (!_this_1.textField && _this_1.valueField) {
                    if (val.indexOf(value) !== -1) {
                        result.push(item);
                    }
                }
            }));
        }
        return result;
    };
    /**
     * 获取包含value值得节点
     */
    /**
     * 获取包含value值得节点
     * @private
     * @param {?} value
     * @param {?} data
     * @param {?} newData
     * @return {?}
     */
    MultiSelectComponent.prototype.getTreeDataByRecursive = /**
     * 获取包含value值得节点
     * @private
     * @param {?} value
     * @param {?} data
     * @param {?} newData
     * @return {?}
     */
    function (value, data, newData) {
        var _this_1 = this;
        value = '' + value;
        data.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            /** @type {?} */
            var txt = '';
            /** @type {?} */
            var val = '';
            if (_this_1.textField) {
                txt = '' + _this_1.getText(item.data);
            }
            if (_this_1.valueField) {
                val = '' + _this_1.getValue(item.data);
            }
            if (_this_1.textField && _this_1.valueField) {
                if (txt.indexOf(value) !== -1 || val.indexOf(value) !== -1) {
                    newData.push(item);
                }
            }
            else if (_this_1.textField && !_this_1.valueField) {
                if (txt.indexOf(value) !== -1) {
                    newData.push(item);
                }
            }
            else if (!_this_1.textField && _this_1.valueField) {
                if (val.indexOf(value) !== -1) {
                    newData.push(item);
                }
            }
            if (item.children && item.children.length) {
                _this_1.getTreeDataByRecursive(value, item.children, newData);
            }
        }));
    };
    /**
     * 获取根节点
     */
    /**
     * 获取根节点
     * @private
     * @param {?} data
     * @param {?} rootData
     * @return {?}
     */
    MultiSelectComponent.prototype.getTreeRootNode = /**
     * 获取根节点
     * @private
     * @param {?} data
     * @param {?} rootData
     * @return {?}
     */
    function (data, rootData) {
        var _this_1 = this;
        data.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            if (item.parent === null) {
                rootData.push(item);
            }
            else {
                _this_1.getTreeRootNode(new Array(item.parent), rootData);
            }
        }));
    };
    /**
     * 获取搜索的数据，Tree结构
     * @param value 搜索的字符
     * @param data 数据
     */
    /**
     * 获取搜索的数据，Tree结构
     * @private
     * @param {?} value 搜索的字符
     * @param {?} data 数据
     * @return {?}
     */
    MultiSelectComponent.prototype.getTreeDataBySearch = /**
     * 获取搜索的数据，Tree结构
     * @private
     * @param {?} value 搜索的字符
     * @param {?} data 数据
     * @return {?}
     */
    function (value, data) {
        /** @type {?} */
        var rootNodes = [];
        /** @type {?} */
        var nodes = [];
        /** @type {?} */
        var finalRes = [];
        /** @type {?} */
        var uniqueId = [];
        // 获取包含value值得节点
        this.getTreeDataByRecursive(value, data, nodes);
        // 获取根节点
        this.getTreeRootNode(nodes, rootNodes);
        // 去重
        rootNodes.forEach((/**
         * @param {?} node
         * @return {?}
         */
        function (node) {
            if (!uniqueId.some((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item == node.id; }))) {
                finalRes.push(node);
                uniqueId.push(node.id);
            }
        }));
        return finalRes;
    };
    /**
     * @private
     * @param {?} ids
     * @return {?}
     */
    MultiSelectComponent.prototype.initRightData = /**
     * @private
     * @param {?} ids
     * @return {?}
     */
    function (ids) {
        var _this_1 = this;
        /** @type {?} */
        var dataSource = [];
        if (ids) {
            if (this.isTree()) {
                this.convertTreeDataToPlainData(this.copyDataSource, dataSource);
                this._rightData = this.getTreeSelectionsById(ids, dataSource);
            }
            else {
                this._rightData = this.getListSelectionsById(ids, this.copyDataSource);
            }
            this._leftCheckeds = ids.reduce((/**
             * @param {?} r
             * @param {?} id
             * @return {?}
             */
            function (r, id) {
                r[id] = _this_1._rightData.find((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n[_this_1.idField] == id; }));
                return r;
            }), {});
        }
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this_1.canCheckLength = _this_1.getCanCheckLength();
            if (_this_1.tt) {
                _this_1.tt.checkedNodes(ids, true, false, true);
                _this_1.allTreeNodes = cloneDeep(_this_1.tt.state.rowNodes.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n.node; })));
            }
        }));
    };
    /**
     * @param ids 选中数据的id
     * @param dataSource 原始数据
     */
    /**
     * @private
     * @param {?} ids 选中数据的id
     * @param {?} dataSource 原始数据
     * @return {?}
     */
    MultiSelectComponent.prototype.getListSelectionsById = /**
     * @private
     * @param {?} ids 选中数据的id
     * @param {?} dataSource 原始数据
     * @return {?}
     */
    function (ids, dataSource) {
        var _this_1 = this;
        /** @type {?} */
        var result = [];
        /** @type {?} */
        var _this = this;
        if ((typeof ids === 'string' && !!ids) || typeof ids === 'number') {
            /** @type {?} */
            var reusltObj = dataSource.find((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                return item[_this.idField] === ids;
            }));
            if (reusltObj) {
                result.push(reusltObj);
            }
        }
        else if (Array.isArray(ids)) {
            if (Array.isArray(dataSource)) {
                result = ids.map((/**
                 * @param {?} id
                 * @return {?}
                 */
                function (id) { return dataSource.find((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return item[_this_1.idField] === id; })); })).filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n; }));
            }
            else {
                result = [];
            }
        }
        else {
            result = [];
        }
        return result;
    };
    /**
     *
     * @param ids 选中数据的id
     * @param dataSource 原始数据
     */
    /**
     *
     * @private
     * @param {?} ids 选中数据的id
     * @param {?} dataSource 原始数据
     * @return {?}
     */
    MultiSelectComponent.prototype.getTreeSelectionsById = /**
     *
     * @private
     * @param {?} ids 选中数据的id
     * @param {?} dataSource 原始数据
     * @return {?}
     */
    function (ids, dataSource) {
        var _this_1 = this;
        /** @type {?} */
        var result = [];
        /** @type {?} */
        var _this = this;
        if ((typeof ids === 'string' && !!ids) || typeof ids === 'number') {
            /** @type {?} */
            var reusltObj = dataSource.find((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                return item.data[_this.idField] === ids;
            }));
            if (reusltObj && reusltObj.data) {
                result.push(reusltObj.data);
            }
        }
        else if (Array.isArray(ids)) {
            if (Array.isArray(dataSource)) {
                result = ids.map((/**
                 * @param {?} id
                 * @return {?}
                 */
                function (id) {
                    return dataSource.find((/**
                     * @param {?} item
                     * @return {?}
                     */
                    function (item) { return item.data[_this_1.idField] === id; }));
                })).filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n; })).map((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n.data; }));
            }
            else {
                result = [];
            }
        }
        else {
            result = [];
        }
        return result;
    };
    /**
     * 判断是否选中
     * @param data 要验证的数据
     * @param direction 验证的数据所在的位置 L: 左侧，R: 右侧
     */
    /**
     * 判断是否选中
     * @param {?} data 要验证的数据
     * @param {?} direction 验证的数据所在的位置 L: 左侧，R: 右侧
     * @return {?}
     */
    MultiSelectComponent.prototype.isChecked = /**
     * 判断是否选中
     * @param {?} data 要验证的数据
     * @param {?} direction 验证的数据所在的位置 L: 左侧，R: 右侧
     * @return {?}
     */
    function (data, direction) {
        /** @type {?} */
        var keyVal = data[this.idField];
        if (direction === 'L') {
            return (this._leftCheckeds && this._leftCheckeds[keyVal] !== undefined) || !this.canChecked(data);
        }
        else {
            if (this._rightCheckeds) {
                return this._rightCheckeds[keyVal] !== undefined;
            }
            else {
                return false;
            }
        }
    };
    /**
     * @param {?} item
     * @return {?}
     */
    MultiSelectComponent.prototype.canChecked = /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        var _this_1 = this;
        /** @type {?} */
        var data = item;
        if (this.isTree()) {
            data = item.data;
            if (item.selectable !== undefined && !item.selectable) {
                return false;
            }
        }
        if (!this.selections || this.selections.length === 0) {
            return true;
        }
        return this.selections.findIndex((/**
         * @param {?} c
         * @return {?}
         */
        function (c) { return c[_this_1.idField] === data[_this_1.idField]; })) === -1;
    };
    /**
     * @return {?}
     */
    MultiSelectComponent.prototype.isTree = /**
     * @return {?}
     */
    function () {
        return this.displayType === 'Tree';
    };
    /**
     * @param {?} data
     * @return {?}
     */
    MultiSelectComponent.prototype.leftDataChecked = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this_1 = this;
        if (data && data.length) {
            data.forEach((/**
             * @param {?} node
             * @return {?}
             */
            function (node) {
                /** @type {?} */
                var d = node;
                if (_this_1.isTree()) {
                    d = node.data;
                }
                if (_this_1.canChecked(node)) {
                    if (_this_1.isChecked(d, 'L')) {
                        delete _this_1._leftCheckeds[d[_this_1.idField]];
                    }
                    else {
                        if (!_this_1._leftCheckeds) {
                            _this_1._leftCheckeds = {};
                        }
                        _this_1._leftCheckeds[d[_this_1.idField]] = d;
                    }
                }
            }));
        }
    };
    /**
     * @param {?} dir
     * @return {?}
     */
    MultiSelectComponent.prototype.hasCheckeds = /**
     * @param {?} dir
     * @return {?}
     */
    function (dir) {
        if (dir === 'L') {
            if (this.isTree()) {
                return this.tt.checkeds && this.tt.checkeds.length;
            }
            if (this._leftCheckeds) {
                return Object.keys(this._leftCheckeds).length > 0;
            }
            else {
                return false;
            }
        }
        else {
            if (this._rightCheckeds) {
                return Object.keys(this._rightCheckeds).length > 0;
            }
            else {
                return false;
            }
        }
    };
    /**
     * @param {?} col
     * @return {?}
     */
    MultiSelectComponent.prototype.rightDataChecked = /**
     * @param {?} col
     * @return {?}
     */
    function (col) {
        /** @type {?} */
        var isCheck = this.isChecked(col, 'R');
        if (isCheck) {
            if (this.showCheckbox) {
                delete this._rightCheckeds[col[this.idField]];
            }
            else {
                this._rightCheckeds = {};
            }
            return;
        }
        else {
            if (this.showCheckbox) {
                this._rightCheckeds = this._rightCheckeds || {};
            }
            else {
                this._rightCheckeds = {};
            }
            this._rightCheckeds[col[this.idField]] = col;
        }
        this.cd.detectChanges();
        this.selected.emit({ selected: !isCheck, data: col });
    };
    /**
     * @private
     * @return {?}
     */
    MultiSelectComponent.prototype.clearSelections = /**
     * @private
     * @return {?}
     */
    function () {
    };
    /**
     * 将树结构数据转换为扁平数组
     * @param nodes 树节点数组
     * @param r 新的空数组
     */
    /**
     * 将树结构数据转换为扁平数组
     * @private
     * @param {?} nodes 树节点数组
     * @param {?=} r 新的空数组
     * @return {?}
     */
    MultiSelectComponent.prototype.convertTreeDataToPlainData = /**
     * 将树结构数据转换为扁平数组
     * @private
     * @param {?} nodes 树节点数组
     * @param {?=} r 新的空数组
     * @return {?}
     */
    function (nodes, r) {
        var _this_1 = this;
        if (r === void 0) { r = []; }
        if (nodes) {
            nodes.forEach((/**
             * @param {?} n
             * @return {?}
             */
            function (n) {
                r.push(n);
                if (n.children) {
                    _this_1.convertTreeDataToPlainData(n.children, r);
                }
            }));
        }
        return r;
    };
    //#region 左右移动
    //#region 左右移动
    /**
     * @private
     * @return {?}
     */
    MultiSelectComponent.prototype.moveItem = 
    //#region 左右移动
    /**
     * @private
     * @return {?}
     */
    function () {
        var _this_1 = this;
        this.beforeMove.subscribe((/**
         * @param {?} obj
         * @return {?}
         */
        function (obj) {
            /** @type {?} */
            var items = obj.items;
            /** @type {?} */
            var ids = Object.keys(items);
            /** @type {?} */
            var direction = 1;
            switch (obj.target) {
                case 'right':
                    Object.keys(items).forEach((/**
                     * @param {?} id
                     * @return {?}
                     */
                    function (id) {
                        if (!_this_1._rightData.find((/**
                         * @param {?} n
                         * @return {?}
                         */
                        function (n) { return n[_this_1.idField].toString() === id; }))) {
                            _this_1._rightData.push(items[id]);
                        }
                    }));
                    _this_1._rightData = tslib_1.__spread(_this_1._rightData);
                    if (_this_1.isTree()) {
                        _this_1.tt.clearAll();
                    }
                    direction = 1;
                    break;
                case 'rightAll':
                    items.forEach((/**
                     * @param {?} data
                     * @return {?}
                     */
                    function (data) {
                        if (_this_1._rightData.findIndex((/**
                         * @param {?} n
                         * @return {?}
                         */
                        function (n) { return n[_this_1.idField] === data[_this_1.idField]; })) === -1) {
                            _this_1._rightData.push(data);
                        }
                    }));
                    if (_this_1.isTree()) {
                        _this_1.tt.clearAll();
                    }
                    direction = 1;
                    break;
                case 'left':
                    _this_1._rightData = _this_1._rightData.filter((/**
                     * @param {?} v
                     * @return {?}
                     */
                    function (v) {
                        return ids.indexOf('' + v[_this_1.idField]) === -1;
                    }));
                    _this_1._rightCheckeds = {};
                    ids.forEach((/**
                     * @param {?} id
                     * @return {?}
                     */
                    function (id) {
                        delete _this_1._leftCheckeds[id];
                    }));
                    direction = -1;
                    if (_this_1.isTree()) {
                        _this_1.tt.findRowNodes(ids).forEach((/**
                         * @param {?} n
                         * @return {?}
                         */
                        function (n) {
                            n.node.selectable = true;
                        }));
                        _this_1.tt.unCheckedNodes(ids, true);
                    }
                    break;
                case 'leftAll':
                    _this_1._rightCheckeds = {};
                    _this_1._rightData = [];
                    direction = -1;
                    _this_1._leftCheckeds = {};
                    if (_this_1.isTree()) {
                        _this_1.tt.clearAll();
                        _this_1.tt.findRowNodes(ids).forEach((/**
                         * @param {?} n
                         * @return {?}
                         */
                        function (n) {
                            n.node.selectable = true;
                        }));
                    }
                    break;
            }
            _this_1.selectionsChange();
            _this_1.changeSelectIds(direction);
            _this_1.afterMove.emit(Object.values(items));
        }));
    };
    /** 右移 */
    /**
     * 右移
     * @param {?=} moveData
     * @return {?}
     */
    MultiSelectComponent.prototype.moveToRight = /**
     * 右移
     * @param {?=} moveData
     * @return {?}
     */
    function (moveData) {
        var _this_1 = this;
        var _a;
        if (moveData) {
            this.beforeMove.emit({ items: (_a = {}, _a[moveData[this.idField]] = moveData, _a), target: 'right' });
        }
        else {
            if (this.hasCheckeds('L')) {
                if (this.isTree()) {
                    this._leftCheckeds = {};
                    this.tt.checkeds.forEach((/**
                     * @param {?} n
                     * @return {?}
                     */
                    function (n) {
                        _this_1._leftCheckeds[n.data[_this_1.idField]] = n.data;
                    }));
                }
                this.beforeMove.emit({ items: this._leftCheckeds, target: 'right' });
            }
            else {
                this.mesagerSer.warning(this.noDataMoveMessage);
            }
        }
    };
    /** 全部右移 */
    /**
     * 全部右移
     * @return {?}
     */
    MultiSelectComponent.prototype.moveAllToRight = /**
     * 全部右移
     * @return {?}
     */
    function () {
        if (this.searchValue === '') {
            this._rightData = [];
        }
        if (this.displayType === 'List') {
            this.beforeMove.emit({ items: this.dataSource, target: 'rightAll' });
        }
        else {
            /** @type {?} */
            var _dataSource = [];
            this.convertTreeDataToPlainData(this.dataSource, _dataSource);
            _dataSource = _dataSource.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.selectable; })).map((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.data; }));
            this.beforeMove.emit({ items: _dataSource, target: 'rightAll' });
        }
    };
    /** 左移 */
    /**
     * 左移
     * @param {?=} moveData
     * @return {?}
     */
    MultiSelectComponent.prototype.moveToLeft = /**
     * 左移
     * @param {?=} moveData
     * @return {?}
     */
    function (moveData) {
        var _a;
        if (moveData) {
            this.beforeMove.emit({ items: (_a = {}, _a[moveData[this.idField]] = moveData, _a), target: 'left' });
        }
        else {
            if (this.hasCheckeds('R')) {
                this.beforeMove.emit({ items: this._rightCheckeds, target: 'left' });
            }
            else {
                this.mesagerSer.warning(this.noDataMoveMessage);
            }
        }
    };
    /** 全部左移 */
    /**
     * 全部左移
     * @return {?}
     */
    MultiSelectComponent.prototype.moveAllToLeft = /**
     * 全部左移
     * @return {?}
     */
    function () {
        this.beforeMove.emit({ items: this._rightData, target: 'leftAll' });
    };
    //#endregion
    //#region 上下移动显示列顺序
    //#endregion
    //#region 上下移动显示列顺序
    /**
     * @return {?}
     */
    MultiSelectComponent.prototype._getSelectInfo = 
    //#endregion
    //#region 上下移动显示列顺序
    /**
     * @return {?}
     */
    function () {
        var _this_1 = this;
        if (this.hasCheckeds('R')) {
            /** @type {?} */
            var key_1 = Object.keys(this._rightCheckeds)[0];
            /** @type {?} */
            var index = this._rightData.findIndex((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return '' + c[_this_1.idField] === key_1; }));
            return {
                key: key_1, index: index
            };
        }
        return null;
    };
    /** 置顶 */
    /**
     * 置顶
     * @return {?}
     */
    MultiSelectComponent.prototype.moveTop = /**
     * 置顶
     * @return {?}
     */
    function () {
        /** @type {?} */
        var obj = this._getSelectInfo();
        if (obj) {
            this._rightData.unshift(this._rightData[obj.index]);
            this._rightData.splice(obj.index + 1, 1);
            this.selectionsChange();
            this.changeSelectIds(0);
        }
        else {
            this.mesagerSer.warning(this.noDataMoveMessage);
        }
    };
    /** 上移 */
    /**
     * 上移
     * @return {?}
     */
    MultiSelectComponent.prototype.moveUp = /**
     * 上移
     * @return {?}
     */
    function () {
        var _a;
        if (this.hasCheckeds('R')) {
            /** @type {?} */
            var obj = this._getSelectInfo();
            if (obj) {
                // const len = obj.cols.length;
                /** @type {?} */
                var index = obj.index;
                if (index !== 0) {
                    /** @type {?} */
                    var tempArr = this._rightData.splice(index, 1);
                    (_a = this._rightData).splice.apply(_a, tslib_1.__spread([index - 1, 0], tempArr));
                }
                this.selectionsChange();
                this.changeSelectIds(0);
            }
        }
        else {
            this.mesagerSer.warning(this.noDataMoveMessage);
        }
    };
    /** 下移 */
    /**
     * 下移
     * @return {?}
     */
    MultiSelectComponent.prototype.moveDown = /**
     * 下移
     * @return {?}
     */
    function () {
        var _a;
        if (this.hasCheckeds('R')) {
            /** @type {?} */
            var obj = this._getSelectInfo();
            if (obj) {
                /** @type {?} */
                var len = this._rightData.length;
                /** @type {?} */
                var index = obj.index;
                if (index === 0 || index !== len - 1) {
                    /** @type {?} */
                    var tempArr = this._rightData.splice(index, 1);
                    (_a = this._rightData).splice.apply(_a, tslib_1.__spread([index + 1, 0], tempArr));
                }
                this.changeSelectIds(0);
                this.selectionsChange();
            }
        }
        else {
            this.mesagerSer.warning(this.noDataMoveMessage);
        }
    };
    /** 置底 */
    /**
     * 置底
     * @return {?}
     */
    MultiSelectComponent.prototype.moveBottom = /**
     * 置底
     * @return {?}
     */
    function () {
        /** @type {?} */
        var obj = this._getSelectInfo();
        if (obj) {
            this._rightData.push(this._rightCheckeds[obj.key]);
            this._rightData.splice(obj.index, 1);
            this.changeSelectIds(0);
            this.selectionsChange();
        }
        else {
            this.mesagerSer.warning(this.noDataMoveMessage);
        }
    };
    /**
     * 触发选择中id
     * @param number 1代表左侧数据右移，-1,代表数据左移，0代表上移下移
     */
    /**
     * 触发选择中id
     * @private
     * @param {?} number 1代表左侧数据右移，-1,代表数据左移，0代表上移下移
     * @return {?}
     */
    MultiSelectComponent.prototype.changeSelectIds = /**
     * 触发选择中id
     * @private
     * @param {?} number 1代表左侧数据右移，-1,代表数据左移，0代表上移下移
     * @return {?}
     */
    function (number) {
        var _this_1 = this;
        /** @type {?} */
        var ids = this._rightData.map((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            return item[_this_1.idField];
        }));
        if (number === 0) {
            if (typeof this.selectedId === 'string') {
                this.selectedId = ids.join(',');
            }
            else if (Array.isArray(this.selectedId)) {
                this.selectedId = ids;
            }
            this.selectedIdChange.emit(this.selectedId);
            return;
        }
        if (!this.selectedId) {
            this.selectedId = [];
        }
        if (number === 1 || number === -1) {
            if (!ids.length) {
                this.selectedId = [];
            }
            else {
                this.selectedId = ids;
            }
            if (this.isTree()) {
                if (ids && ids.length) {
                    this.tt.checkedNodes(ids, true, false, true);
                }
            }
        }
        this.canCheckLength = this.getCanCheckLength();
        this.selectedIdChange.emit(this.selectedId);
    };
    //#endregion
    //#endregion
    /**
     * @private
     * @return {?}
     */
    MultiSelectComponent.prototype.selectionsChange = 
    //#endregion
    /**
     * @private
     * @return {?}
     */
    function () {
        this.dataChange.emit(this._rightData);
        this.cd.detectChanges();
    };
    /**
     * @param {?} item
     * @param {?=} textField
     * @return {?}
     */
    MultiSelectComponent.prototype.getText = /**
     * @param {?} item
     * @param {?=} textField
     * @return {?}
     */
    function (item, textField) {
        if (textField === void 0) { textField = this.textField; }
        if (item) {
            if (this.commonUtils && this.commonUtils.getValue && textField) {
                return this.commonUtils.getValue(textField, item);
            }
            else {
                return item[textField];
            }
        }
        else {
            return '';
        }
    };
    /**
     * @param {?} item
     * @param {?=} valueField
     * @return {?}
     */
    MultiSelectComponent.prototype.getValue = /**
     * @param {?} item
     * @param {?=} valueField
     * @return {?}
     */
    function (item, valueField) {
        if (valueField === void 0) { valueField = this.valueField; }
        if (item) {
            if (this.commonUtils && this.commonUtils.getValue && valueField) {
                return this.commonUtils.getValue(valueField, item);
            }
            else {
                return item[valueField];
            }
        }
        else {
            return '';
        }
    };
    MultiSelectComponent.decorators = [
        { type: Component, args: [{
                    selector: 'multi-select',
                    template: "<div class=\"f-utils-fill f-multi-select-list d-flex flex-column\">\r\n    <div class=\"f-utils-flex-column f-multi-select-list-content f-utils-fill\">\r\n        <legend class=\"f-multi-select-list-title\">\r\n            {{leftTitle === '\u672A\u9009\u62E9' ? ('multiSelect.leftTitle'|locale) : leftTitle}} ( {{ canCheckLength }} / {{ leftCount }} )\r\n\r\n            <ng-content select=\".left-title\"></ng-content>\r\n        </legend>\r\n        <div class=\"input-group\" *ngIf=\"enableSearch\" style=\"margin: .75rem .875rem 0; width: auto\">\r\n            <input type=\"text\" class=\"form-control\" [(ngModel)]=\"searchValue\" placeholder=\"{{ 'multiSelect.filterPlaceholder' | locale }}\" />\r\n            <div class=\"input-group-append\" style=\"background: transparent;\">\r\n                <span class=\"fa f-icon-search\" *ngIf=\"!searchValue\" style=\"padding: 2px\"></span>\r\n                <span class=\"fa f-icon-close\" style=\"padding: 2px;cursor: pointer;\" *ngIf=\"searchValue\" (click)=\"searchValue = '';\"></span>\r\n            </div>\r\n        </div>\r\n        <div class=\"container columns-box f-utils-fill\">\r\n            <perfect-scrollbar [config]=\"{}\">\r\n                <ng-container *ngIf=\"displayType === 'List'; else tree\">\r\n                    <ul class=\"f-multi-select-list-group multi-select-list-group-flush f-multi-select-list-group--left\" [class.f-multi-select-norecords]=\"!dataSource || !dataSource.length\">\r\n                        <ng-template [ngIf]=\"dataSource && dataSource.length\">\r\n                            <li class=\"f-multi-select-list-group-item\" *ngFor=\"let data of dataSource;trackBy: trackByItems\" [ngClass]=\"{'f-state-disabled':!canChecked(data),'active':isChecked(data, 'L')}\">\r\n                                <div class=\"custom-control custom-checkbox  custom-control-inline\"\r\n                                    (click)=\"leftDataChecked([data])\">\r\n                                    <input type=\"checkbox\" class=\"custom-control-input\" [checked]=\"isChecked(data, 'L')\"\r\n                                        [disabled]=\"!canChecked(data)\">\r\n                                    <label class=\"custom-control-label\">\r\n                                        <display-text [template]=\"displayTemplate\" [data]=\"data\"></display-text>\r\n                                    </label>\r\n                                </div>\r\n                            </li>\r\n                        </ng-template>\r\n                        <ng-template [ngIf]=\"!dataSource || !dataSource.length\">\r\n                            <li class=\"f-multi-select-norecords-content\"> {{emptyData}} </li>\r\n                        </ng-template>\r\n                    </ul>\r\n                </ng-container>\r\n\r\n                <ng-template #tree>\r\n                    <farris-treetable #tt [data]=\"dataSource\" [idField]=\"idField\" [striped]=\"false\"\r\n                        [singleSelect]=\"false\" [showIcon]=\"false\" [showFilterBar]=\"false\" [showCheckbox]=\"true\"\r\n                        [selectOnCheck]=\"true\" [checkOnSelect]=\"true\" [showBorder]=\"false\">\r\n                        <ng-template farrisTemplate=\"body\" let-rowNode let-treeNode=\"node\" let-rowData=\"rowData\">\r\n                            <tr #row=\"row\" [selectRow]=\"rowNode\" [dblclick]=\"true\"\r\n                                [selectRowDisabled]=\"!canChecked(treeNode)\">\r\n                                <td style=\"border: 0\" [style.color]=\"row.selectRowDisabled? '#a6a6a6': '#333'\">\r\n                                    <farris-treeTableToggler [disabled]=\"!canChecked(treeNode)\" [rowNode]=\"rowNode\">\r\n                                    </farris-treeTableToggler>\r\n                                    <display-text [template]=\"displayTemplate\" [data]=\"rowData\"></display-text>\r\n                                </td>\r\n                            </tr>\r\n                        </ng-template>\r\n                    </farris-treetable>\r\n                </ng-template>\r\n            </perfect-scrollbar>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class=\"f-multi-select-list-btns\" [class.col-2]=\"!enableTargetSort\">\r\n    <button [title]=\"'multiSelect.shiftRight' | locale\" class=\"btn btn-secondary f-btn-icon\" type=\"button\"\r\n        (click)=\"moveToRight()\">\r\n        <span class=\"f-icon f-icon-arrow-chevron-right\"></span>\r\n    </button>\r\n    <button [title]=\"'multiSelect.allShiftRight' | locale\" class=\"btn btn-secondary f-btn-icon right-all\" type=\"button\"\r\n        (click)=\"moveAllToRight()\">\r\n        <span class=\"f-icon f-icon-arrow-seek-right\"></span>\r\n    </button>\r\n    <button [title]=\"'multiSelect.shiftLeft' | locale\" class=\"btn btn-secondary f-btn-icon\" type=\"button\"\r\n        (click)=\"moveToLeft()\">\r\n        <span class=\"f-icon f-icon-arrow-chevron-left\"></span>\r\n    </button>\r\n    <button [title]=\"'multiSelect.allShiftLeft' | locale\" class=\"btn btn-secondary f-btn-icon\" type=\"button\"\r\n        (click)=\"moveAllToLeft()\">\r\n        <span class=\"f-icon f-icon-arrow-seek-left\"></span>\r\n    </button>\r\n</div>\r\n<div class=\"f-utils-fill f-multi-select-list d-flex flex-column\">\r\n    <div class=\"f-utils-flex-column f-multi-select-list-content f-utils-fill\">\r\n        <legend class=\"f-multi-select-list-title\">\r\n            {{rightTitle === '\u5DF2\u9009\u62E9' ? ('multiSelect.rightTitle'|locale) : rightTitle}} ({{selections && selections.length}})\r\n\r\n            <ng-content select=\".right-title\"></ng-content>\r\n        </legend>\r\n        <div class=\"container columns-box f-utils-fill\">\r\n            <perfect-scrollbar [config]=\"{}\">\r\n                <ul class=\"f-multi-select-list-group multi-select-list-group-flush f-multi-select-list-group--right\">\r\n                    <li class=\"f-multi-select-list-group-item\" *ngFor=\"let data of selections;trackBy: trackByItems\"\r\n                        (click)=\"rightDataChecked(data)\"  [ngClass]=\"{'active':isChecked(data, 'R'),'item--show-checkbox':showCheckbox && data['showCheckbox'] !== false}\">\r\n                        <ng-container *ngIf=\"showCheckbox && data['showCheckbox'] !== false\">\r\n                            <div class=\"custom-control custom-checkbox f-checkradio-single\">\r\n                               <input type=\"checkbox\" class=\"custom-control-input\" [checked]=\"isChecked(data, 'R')\">\r\n                               <label class=\"custom-control-label\"></label>\r\n                            </div>\r\n                            <display-text [template]=\"displayTemplate\" [data]=\"data\" [side]=\"'R'\"></display-text>\r\n                        </ng-container>\r\n                        <ng-container *ngIf=\"!showCheckbox\">\r\n                            <display-text [template]=\"displayTemplate\" [data]=\"data\" [side]=\"'R'\"></display-text>\r\n                        </ng-container>\r\n                    </li>\r\n                </ul>\r\n            </perfect-scrollbar>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class=\"f-multi-select-list-btns\" *ngIf=\"enableTargetSort\">\r\n    <button [title]=\"'multiSelect.top' | locale\" class=\"btn btn-secondary f-btn-icon\" type=\"button\" (click)=\"moveTop()\">\r\n        <span class=\"f-icon f-icon-roofing\"></span>\r\n    </button>\r\n    <button [title]=\"'multiSelect.shiftUp' | locale\" class=\"btn btn-secondary f-btn-icon right-all\" type=\"button\"\r\n        (click)=\"moveUp()\">\r\n        <span class=\"f-icon f-icon-arrow-double-60-up\"></span>\r\n    </button>\r\n    <button [title]=\"'multiSelect.shiftDown' | locale\" class=\"btn btn-secondary f-btn-icon\" type=\"button\"\r\n        (click)=\"moveDown()\">\r\n        <span class=\"f-icon f-icon-arrow-double-60-down\"></span>\r\n    </button>\r\n    <button [title]=\"'multiSelect.bottom' | locale\" class=\"btn btn-secondary f-btn-icon\" type=\"button\"\r\n        (click)=\"moveBottom()\">\r\n        <span class=\"f-icon f-icon-bottomsetting\"></span>\r\n    </button>\r\n</div>",
                    styles: [".f-multi-select-list .search{position:relative}.f-multi-select-list .search .form-control{line-height:1.875;height:1.875;outline:0}.f-multi-select-list .f-table-norecords-content{margin:-10.0625rem 0 0 -.225rem}"]
                }] }
    ];
    /** @nocollapse */
    MultiSelectComponent.ctorParameters = function () { return [
        { type: MessagerService },
        { type: Injector },
        { type: ChangeDetectorRef }
    ]; };
    MultiSelectComponent.propDecorators = {
        dataSource: [{ type: Input }],
        displayType: [{ type: Input }],
        enableTargetSort: [{ type: Input }],
        idField: [{ type: Input }],
        textField: [{ type: Input }],
        valueField: [{ type: Input }],
        height: [{ type: Input }],
        fit: [{ type: Input }],
        noDataMoveMessage: [{ type: Input }],
        leftTitle: [{ type: Input }],
        rightTitle: [{ type: Input }],
        selectedId: [{ type: Input }],
        enableSearch: [{ type: Input }],
        showCheckbox: [{ type: Input }],
        dataChange: [{ type: Output }],
        selected: [{ type: Output }],
        selectedIdChange: [{ type: Output }],
        beforeMove: [{ type: Output }],
        afterMove: [{ type: Output }],
        sortMove: [{ type: Output }],
        templates: [{ type: ContentChildren, args: [FarrisTemplateDirective,] }],
        tt: [{ type: ViewChild, args: ['tt',] }]
    };
    return MultiSelectComponent;
}());
export { MultiSelectComponent };
if (false) {
    /**
     * @type {?}
     * @private
     */
    MultiSelectComponent.prototype.allTreeNodes;
    /**
     * @type {?}
     * @private
     */
    MultiSelectComponent.prototype._ds;
    /** @type {?} */
    MultiSelectComponent.prototype.displayType;
    /**
     * 显示右侧上移下移按钮
     * @type {?}
     */
    MultiSelectComponent.prototype.enableTargetSort;
    /** @type {?} */
    MultiSelectComponent.prototype.idField;
    /** @type {?} */
    MultiSelectComponent.prototype.textField;
    /** @type {?} */
    MultiSelectComponent.prototype.valueField;
    /** @type {?} */
    MultiSelectComponent.prototype.height;
    /** @type {?} */
    MultiSelectComponent.prototype.fit;
    /** @type {?} */
    MultiSelectComponent.prototype.noDataMoveMessage;
    /** @type {?} */
    MultiSelectComponent.prototype.leftTitle;
    /** @type {?} */
    MultiSelectComponent.prototype.rightTitle;
    /** @type {?} */
    MultiSelectComponent.prototype.selectedId;
    /** @type {?} */
    MultiSelectComponent.prototype.enableSearch;
    /**
     * 目标数据源显示checkbox 允许多选
     * @type {?}
     */
    MultiSelectComponent.prototype.showCheckbox;
    /** @type {?} */
    MultiSelectComponent.prototype.dataChange;
    /** @type {?} */
    MultiSelectComponent.prototype.selected;
    /** @type {?} */
    MultiSelectComponent.prototype.selectedIdChange;
    /** @type {?} */
    MultiSelectComponent.prototype.beforeMove;
    /** @type {?} */
    MultiSelectComponent.prototype.afterMove;
    /** @type {?} */
    MultiSelectComponent.prototype.sortMove;
    /** @type {?} */
    MultiSelectComponent.prototype.templates;
    /** @type {?} */
    MultiSelectComponent.prototype.tt;
    /** @type {?} */
    MultiSelectComponent.prototype._rightCheckeds;
    /** @type {?} */
    MultiSelectComponent.prototype._leftCheckeds;
    /** @type {?} */
    MultiSelectComponent.prototype._rightData;
    /** @type {?} */
    MultiSelectComponent.prototype.canCheckLength;
    /** @type {?} */
    MultiSelectComponent.prototype.leftCount;
    /** @type {?} */
    MultiSelectComponent.prototype._searchValue;
    /**
     * @type {?}
     * @private
     */
    MultiSelectComponent.prototype.copyDataSource;
    /** @type {?} */
    MultiSelectComponent.prototype.treeDataLength;
    /** @type {?} */
    MultiSelectComponent.prototype.displayTemplate;
    /** @type {?} */
    MultiSelectComponent.prototype.emptyData;
    /** @type {?} */
    MultiSelectComponent.prototype.el;
    /** @type {?} */
    MultiSelectComponent.prototype.render;
    /** @type {?} */
    MultiSelectComponent.prototype.localeService;
    /** @type {?} */
    MultiSelectComponent.prototype.commonUtils;
    /** @type {?} */
    MultiSelectComponent.prototype.trackByItems;
    /**
     * @type {?}
     * @private
     */
    MultiSelectComponent.prototype.mesagerSer;
    /**
     * @type {?}
     * @private
     */
    MultiSelectComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    MultiSelectComponent.prototype.cd;
}
var DisplayTextComponent = /** @class */ (function () {
    function DisplayTextComponent(ms) {
        this.ms = ms;
        this.side = 'L';
    }
    /**
     * @return {?}
     */
    DisplayTextComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        // console.log(this.data);
    };
    /**
     * @param {?} item
     * @return {?}
     */
    DisplayTextComponent.prototype._getText = /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        return this.ms.getText(item);
    };
    DisplayTextComponent.decorators = [
        { type: Component, args: [{
                    selector: 'display-text',
                    template: "\n        <ng-container *ngIf=\"template\" >\n            <ng-container\n                *ngTemplateOutlet=\"template; context: {$implicit: data,instance: ms, side: side, selected: ms.isChecked(data, 'R') }\">\n            </ng-container>\n        </ng-container>\n        <ng-container *ngIf=\"!template\">\n            {{ _getText(data) }}\n        </ng-container>\n    "
                }] }
    ];
    /** @nocollapse */
    DisplayTextComponent.ctorParameters = function () { return [
        { type: MultiSelectComponent }
    ]; };
    DisplayTextComponent.propDecorators = {
        template: [{ type: Input }],
        data: [{ type: Input }],
        side: [{ type: Input }]
    };
    return DisplayTextComponent;
}());
export { DisplayTextComponent };
if (false) {
    /** @type {?} */
    DisplayTextComponent.prototype.template;
    /** @type {?} */
    DisplayTextComponent.prototype.data;
    /** @type {?} */
    DisplayTextComponent.prototype.side;
    /** @type {?} */
    DisplayTextComponent.prototype.ms;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXVsdGktc2VsZWN0LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktbXVsdGktc2VsZWN0LyIsInNvdXJjZXMiOlsibGliL211bHRpLXNlbGVjdC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sV0FBVyxDQUFDOzs7Ozs7Ozs7QUFVdEMsT0FBTyxFQUNILFNBQVMsRUFBVSxLQUFLLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQ3pELFdBQVcsRUFBRSxlQUFlLEVBQUUsU0FBUyxFQUNiLFFBQVEsRUFBRSxpQkFBaUIsRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUMvRSxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLGtCQUFrQixFQUFZLE1BQU0sc0JBQXNCLENBQUM7QUFDcEUsT0FBTyxFQUFFLFdBQVcsRUFBRSx1QkFBdUIsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ3pFLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUdsRDtJQWlISSw4QkFBb0IsVUFBMkIsRUFBVSxRQUFrQixFQUFVLEVBQXFCO1FBQXRGLGVBQVUsR0FBVixVQUFVLENBQWlCO1FBQVUsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQUFVLE9BQUUsR0FBRixFQUFFLENBQW1CO1FBdkdsRyxpQkFBWSxHQUFHLEVBQUUsQ0FBQztRQUNsQixRQUFHLEdBQVEsRUFBRSxDQUFDO1FBbUJiLGdCQUFXLEdBQW9CLE1BQU0sQ0FBQzs7OztRQUV0QyxxQkFBZ0IsR0FBRyxJQUFJLENBQUM7UUFPeEIsV0FBTSxHQUFHLEdBQUcsQ0FBQztRQUNiLFFBQUcsR0FBRyxJQUFJLENBQUM7UUFDWCxzQkFBaUIsR0FBRyxZQUFZLENBQUM7UUFFakMsY0FBUyxHQUFHLEtBQUssQ0FBQztRQUNs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QUFTLElBQUk7UUFDVCxPQUFPLElBQUksQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2pDLENBQUM7O2dCQTFCSixTQUFTLFNBQUM7b0JBQ1AsUUFBUSxFQUFFLGNBQWM7b0JBQ3hCLFFBQVEsRUFBRSxzWEFTVDtpQkFDSjs7OztnQkFNMEIsb0JBQW9COzs7MkJBSjFDLEtBQUs7dUJBQ0wsS0FBSzt1QkFDTCxLQUFLOztJQVdWLDJCQUFDO0NBQUEsQUEzQkQsSUEyQkM7U0FkWSxvQkFBb0I7OztJQUM3Qix3Q0FBb0M7O0lBQ3BDLG9DQUFtQjs7SUFDbkIsb0NBQW9COztJQUVSLGtDQUErQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNsb25lRGVlcCB9IGZyb20gJ2xvZGFzaC1lcyc7XHJcbi8qXHJcbiogQEF1dGhvcjog55av54uC56eA5omNKGx1Y2FzIGh1YW5nKVxyXG4qIEBEYXRlOiAyMDE4LTEwLTI3IDEwOjU1OjAyXHJcbiAqIEBMYXN0RWRpdG9yczog55av54uC56eA5omNKEx1Y2FzIEh1YW5nKVxyXG4gKiBATGFzdEVkaXRUaW1lOiAyMDE5LTEwLTE2IDE0OjE0OjE0XHJcbiogQENvbXBhbnk6IEluc3B1clxyXG4qIEBWZXJzaW9uOiB2MC4wLjFcclxuKi9cclxuXHJcbmltcG9ydCB7XHJcbiAgICBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIFZpZXdDaGlsZCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIsXHJcbiAgICBUZW1wbGF0ZVJlZiwgQ29udGVudENoaWxkcmVuLCBRdWVyeUxpc3QsIEFmdGVyQ29udGVudEluaXQsIEFmdGVyVmlld0luaXQsXHJcbiAgICBPbkNoYW5nZXMsIFNpbXBsZUNoYW5nZXMsIEluamVjdG9yLCBDaGFuZ2VEZXRlY3RvclJlZiwgRWxlbWVudFJlZiwgUmVuZGVyZXIyXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IE1lc3NhZ2VyU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbWVzc2FnZXInO1xyXG5pbXBvcnQgeyBUcmVlVGFibGVDb21wb25lbnQsIFRyZWVOb2RlIH0gZnJvbSAnQGZhcnJpcy91aS10cmVldGFibGUnO1xyXG5pbXBvcnQgeyBDb21tb25VdGlscywgRmFycmlzVGVtcGxhdGVEaXJlY3RpdmUgfSBmcm9tICdAZmFycmlzL3VpLWNvbW1vbic7XHJcbmltcG9ydCB7IExvY2FsZVNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWxvY2FsZSc7XHJcblxyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ211bHRpLXNlbGVjdCcsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vbXVsdGktc2VsZWN0LmNvbXBvbmVudC5odG1sJyxcclxuICAgIHN0eWxlVXJsczogW1xyXG4gICAgICAgICcuL211bHRpLXNlbGVjdC5jc3MnXHJcbiAgICBdXHJcbn0pXHJcblxyXG5leHBvcnQgY2xhc3MgTXVsdGlTZWxlY3RDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcywgQWZ0ZXJWaWV3SW5pdCwgQWZ0ZXJDb250ZW50SW5pdCB7XHJcblxyXG4gICAgcHJpdmF0ZSBhbGxUcmVlTm9kZXMgPSBbXTtcclxuICAgIHByaXZhdGUgX2RzOiBhbnkgPSBbXTtcclxuICAgIGdldCBkYXRhU291cmNlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9kcztcclxuICAgIH1cclxuICAgIEBJbnB1dCgpIHNldCBkYXRhU291cmNlKHZhbDogYW55KSB7XHJcbiAgICAgICAgdmFsID0gdmFsICB8fCBbXTtcclxuICAgICAgICB0aGlzLl9kcyA9IHZhbDtcclxuICAgICAgICBpZiAoIXRoaXMuc2VhcmNoVmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKHZhbC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGlmICh2YWxbMF0udG9KU09OKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3B5RGF0YVNvdXJjZSA9IHZhbC5tYXAobiA9PiBuLnRvSlNPTigpKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3B5RGF0YVNvdXJjZSA9IGNsb25lRGVlcCh2YWwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdFJpZ2h0RGF0YSh0aGlzLnNlbGVjdGVkSWQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBASW5wdXQoKSBkaXNwbGF5VHlwZTogJ0xpc3QnIHwgJ1RyZWUnID0gJ0xpc3QnO1xyXG4gICAgLyoqIOaYvuekuuWPs+S+p+S4iuenu+S4i+enu+aMiemSriAqL1xyXG4gICAgQElucHV0KCkgZW5hYmxlVGFyZ2V0U29ydCA9IHRydWU7XHJcblxyXG4gICAgQElucHV0KCkgaWRGaWVsZDogc3RyaW5nO1xyXG5cclxuICAgIEBJbnB1dCgpIHRleHRGaWVsZDogc3RyaW5nO1xyXG4gICAgQElucHV0KCkgdmFsdWVGaWVsZDogc3RyaW5nO1xyXG5cclxuICAgIEBJbnB1dCgpIGhlaWdodCA9IDQ0NTtcclxuICAgIEBJbnB1dCgpIGZpdCA9IHRydWU7XHJcbiAgICBASW5wdXQoKSBub0RhdGFNb3ZlTWVzc2FnZSA9ICfor7fpgInmi6nopoHnp7vliqjnmoTmlbDmja7jgIInO1xyXG5cclxuICAgIEBJbnB1dCgpIGxlZnRUaXRsZSA9ICfmnKrpgInmi6knO1xyXG4gICAgQElucHV0KCkgcmlnaHRUaXRsZSA9ICflt7LpgInmi6knO1xyXG4gICAgQElucHV0KCkgc2VsZWN0ZWRJZDogYW55O1xyXG4gICAgQElucHV0KCkgZW5hYmxlU2VhcmNoID0gdHJ1ZTtcclxuICAgIC8qKiDnm67moIfmlbDmja7mupDmmL7npLpjaGVja2JveCDlhYHorrjlpJrpgIkgKi9cclxuICAgIEBJbnB1dCgpIHNob3dDaGVja2JveCA9IGZhbHNlO1xyXG5cclxuICAgIEBPdXRwdXQoKSBkYXRhQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIHNlbGVjdGVkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIHNlbGVjdGVkSWRDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgQE91dHB1dCgpIGJlZm9yZU1vdmUgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCkgYWZ0ZXJNb3ZlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIEBPdXRwdXQoKSBzb3J0TW92ZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBAQ29udGVudENoaWxkcmVuKEZhcnJpc1RlbXBsYXRlRGlyZWN0aXZlKSB0ZW1wbGF0ZXM6IFF1ZXJ5TGlzdDxGYXJyaXNUZW1wbGF0ZURpcmVjdGl2ZT47XHJcbiAgICBAVmlld0NoaWxkKCd0dCcpIHR0OiBUcmVlVGFibGVDb21wb25lbnQ7XHJcblxyXG5cclxuICAgIC8vIOWPs+S+p+mAieS4reeahOaVsOaNriB7IFtrZXlWYWxdOiBvYmosIFtrZXlWYWxdOiBvYmogLi4uIH1cclxuICAgIF9yaWdodENoZWNrZWRzOiBhbnk7XHJcbiAgICAvLyDlt6bkvqfpgInkuK3nmoTmlbDmja4geyBba2V5VmFsXTogb2JqLCBba2V5VmFsXTogb2JqIC4uLiB9XHJcbiAgICBfbGVmdENoZWNrZWRzOiBhbnkgPSB7fTtcclxuXHJcbiAgICAvLyDlj7PkvqfmlbDmja5cclxuICAgIF9yaWdodERhdGEgPSBbXTtcclxuICAgIGdldCBzZWxlY3Rpb25zKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9yaWdodERhdGE7XHJcbiAgICB9XHJcbiAgICBzZXQgc2VsZWN0aW9ucyh2YWw6IGFueSkge1xyXG4gICAgICAgIHRoaXMuX3JpZ2h0RGF0YSA9IHZhbDtcclxuICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgIH1cclxuICAgIGdldCBzZWFyY2hWYWx1ZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2VhcmNoVmFsdWU7XHJcbiAgICB9XHJcbiAgICBzZXQgc2VhcmNoVmFsdWUodmFsdWU6IHN0cmluZykge1xyXG4gICAgICAgIHRoaXMuX3NlYXJjaFZhbHVlID0gdmFsdWU7XHJcblxyXG4gICAgICAgIC8vIHRoaXMuY29weURhdGFTb3VyY2UgPSBbLi4udGhpcy5kYXRhU291cmNlXTtcclxuXHJcbiAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09ICcnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YVNvdXJjZSA9IHRoaXMuY29weURhdGFTb3VyY2U7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuZGlzcGxheVR5cGUgPT09ICdUcmVlJykge1xyXG4gICAgICAgICAgICBjb25zdCBuZXdEYXRhU291cmNlID0gdGhpcy5nZXRUcmVlRGF0YUJ5U2VhcmNoKHRoaXMuX3NlYXJjaFZhbHVlLCB0aGlzLmFsbFRyZWVOb2Rlcyk7XHJcbiAgICAgICAgICAgIHRoaXMudHQubG9hZERhdGEobmV3RGF0YVNvdXJjZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5kYXRhU291cmNlID0gdGhpcy5nZXRMaXN0RGF0YUJ5U2VhcmNoKHRoaXMuX3NlYXJjaFZhbHVlLCB0aGlzLmNvcHlEYXRhU291cmNlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY2FuQ2hlY2tMZW5ndGggPSAwO1xyXG4gICAgbGVmdENvdW50ID0gMDtcclxuICAgIF9zZWFyY2hWYWx1ZSA9ICcnO1xyXG4gICAgLy8g5aSN5Yi25LiA5Lu95pWw5o2u5rqQXHJcbiAgICBwcml2YXRlIGNvcHlEYXRhU291cmNlOiBhbnk7XHJcbiAgICAvLyDmoJHlvaLnu5PmnoTnmoTmlbDmja5sZW5ndGhcclxuICAgIHRyZWVEYXRhTGVuZ3RoOiBudW1iZXI7XHJcbiAgICBkaXNwbGF5VGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XHJcblxyXG5cclxuICAgIGVtcHR5RGF0YTtcclxuICAgIGVsOiBFbGVtZW50UmVmO1xyXG4gICAgcmVuZGVyOiBSZW5kZXJlcjI7XHJcbiAgICBsb2NhbGVTZXJ2aWNlOiBMb2NhbGVTZXJ2aWNlO1xyXG4gICAgY29tbW9uVXRpbHM6IENvbW1vblV0aWxzO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgbWVzYWdlclNlcjogTWVzc2FnZXJTZXJ2aWNlLCBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvciwgcHJpdmF0ZSBjZDogQ2hhbmdlRGV0ZWN0b3JSZWYpIHtcclxuICAgICAgICBpZiAoIU9iamVjdC52YWx1ZXMpIHtcclxuICAgICAgICAgICAgT2JqZWN0LnZhbHVlcyA9IGZ1bmN0aW9uIChvYmopIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhvYmopLm1hcChmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvYmpbZV07XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5lbCA9IHRoaXMuaW5qZWN0b3IuZ2V0PEVsZW1lbnRSZWY+KEVsZW1lbnRSZWYpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyID0gdGhpcy5pbmplY3Rvci5nZXQoUmVuZGVyZXIyKTtcclxuICAgICAgICB0aGlzLmxvY2FsZVNlcnZpY2UgPSB0aGlzLmluamVjdG9yLmdldChMb2NhbGVTZXJ2aWNlKTtcclxuXHJcbiAgICAgICAgdGhpcy5jb21tb25VdGlscyA9IHRoaXMuaW5qZWN0b3IuZ2V0KENvbW1vblV0aWxzLCBudWxsKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCgpIHtcclxuICAgICAgICAvLyB0aGlzLmNvcHlEYXRhU291cmNlID0gdGhpcy5kYXRhU291cmNlID8gWy4uLnRoaXMuZGF0YVNvdXJjZV0gOiBbXTtcclxuICAgICAgICB0aGlzLmVtcHR5RGF0YSA9IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZSgnbXVsdGlTZWxlY3QuZW1wdHlEYXRhJykgfHwgJ+aaguaXoOaVsOaNric7XHJcbiAgICAgICAgdGhpcy5pbml0UmlnaHREYXRhKHRoaXMuc2VsZWN0ZWRJZCk7XHJcbiAgICAgICAgdGhpcy5tb3ZlSXRlbSgpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcclxuICAgICAgICBjb25zdCBlbHQgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy5yZW5kZXIuYWRkQ2xhc3MoZWx0LCAncm93Jyk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXIuYWRkQ2xhc3MoZWx0LCAnZi1tdWx0aS1zZWxlY3QnKTtcclxuICAgICAgICBpZiAodGhpcy5maXQgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIuYWRkQ2xhc3MoZWx0LCAnZi11dGlscy1maWxsJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghIXRoaXMuaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyLnNldFN0eWxlKGVsdCwgJ2hlaWdodCcsIHRoaXMuaGVpZ2h0ICsgJ3B4Jyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLm5vRGF0YU1vdmVNZXNzYWdlID1cclxuICAgICAgICAgICAgdGhpcy5ub0RhdGFNb3ZlTWVzc2FnZSA9PT0gJ+ivt+mAieaLqeimgeenu+WKqOeahOaVsOaNruOAgicgPyB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoJ211bHRpU2VsZWN0Lm5vRGF0YU1vdmVNZXNzYWdlJykgOiB0aGlzLm5vRGF0YU1vdmVNZXNzYWdlO1xyXG5cclxuICAgICAgICBpZiAodGhpcy50dCAmJiB0aGlzLnNlbGVjdGVkSWQpIHtcclxuICAgICAgICAgICAgdGhpcy50dC5jaGVja2VkTm9kZXModGhpcy5zZWxlY3RlZElkKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdBZnRlckNvbnRlbnRJbml0KCkge1xyXG4gICAgICAgIHRoaXMudGVtcGxhdGVzLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgc3dpdGNoIChpdGVtLmdldFR5cGUoKSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAndGV4dCc6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5VGVtcGxhdGUgPSBpdGVtLnRlbXBsYXRlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgICAgIGlmIChjaGFuZ2VzLmRhdGFTb3VyY2UgJiYgIWNoYW5nZXMuZGF0YVNvdXJjZS5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgLy8gdGhpcy5jb3B5RGF0YVNvdXJjZSA9IFsuLi4odGhpcy5kYXRhU291cmNlIHx8IFtdKV07XHJcbiAgICAgICAgICAgIHRoaXMuX2xlZnRDaGVja2VkcyA9IHt9O1xyXG4gICAgICAgICAgICB0aGlzLl9yaWdodERhdGEgPSBbXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChjaGFuZ2VzLnNlbGVjdGVkSWQgJiYgIWNoYW5nZXMuc2VsZWN0ZWRJZC5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5pbml0UmlnaHREYXRhKGNoYW5nZXMuc2VsZWN0ZWRJZC5jdXJyZW50VmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXRDYW5DaGVja0xlbmd0aCgpIHtcclxuICAgICAgICBsZXQgbiA9IDA7XHJcbiAgICAgICAgbGV0IHRvdGFsID0gMDtcclxuICAgICAgICBpZiAodGhpcy5pc1RyZWUoKSkge1xyXG4gICAgICAgICAgICB0aGlzLnR0LnNlcmlhbGl6ZWRWYWx1ZS5mb3JFYWNoKHJuID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChybi5ub2RlLnNlbGVjdGFibGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jYW5DaGVja2VkKHJuLm5vZGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4rKztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0b3RhbCA9IHRoaXMudHQuc2VyaWFsaXplZFZhbHVlLmxlbmd0aDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmRhdGFTb3VyY2UuZm9yRWFjaChkID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNhbkNoZWNrZWQoZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBuKys7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0b3RhbCA9IHRoaXMuZGF0YVNvdXJjZS5sZW5ndGg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubGVmdENvdW50ID0gdG90YWw7XHJcbiAgICAgICAgcmV0dXJuIG47XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bmkJzntKLnmoTmlbDmja7vvIxMaXN057uT5p6EXHJcbiAgICAgKiBAcGFyYW0gdmFsdWUg5pCc57Si55qE5a2X56ymXHJcbiAgICAgKiBAcGFyYW0gZGF0YSDmlbDmja5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBnZXRMaXN0RGF0YUJ5U2VhcmNoKHZhbHVlOiBzdHJpbmcsIGRhdGE6IGFueVtdKTogYW55W10ge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIHZhbHVlID0gJycgKyB2YWx1ZTtcclxuICAgICAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgICAgIGRhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgdHh0ID0gJyc7XHJcbiAgICAgICAgICAgICAgICBsZXQgdmFsID0gJyc7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudGV4dEZpZWxkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHh0ID0gJycgKyB0aGlzLmdldFRleHQoaXRlbSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudmFsdWVGaWVsZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhbCA9ICcnICsgdGhpcy5nZXRWYWx1ZShpdGVtKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50ZXh0RmllbGQgJiYgdGhpcy52YWx1ZUZpZWxkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR4dC5pbmRleE9mKHZhbHVlKSAhPT0gLTEgfHwgdmFsLmluZGV4T2YodmFsdWUpICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGV4dEZpZWxkICYmICF0aGlzLnZhbHVlRmllbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHh0LmluZGV4T2YodmFsdWUpICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLnRleHRGaWVsZCAmJiB0aGlzLnZhbHVlRmllbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsLmluZGV4T2YodmFsdWUpICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5YyF5ZCrdmFsdWXlgLzlvpfoioLngrlcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBnZXRUcmVlRGF0YUJ5UmVjdXJzaXZlKHZhbHVlOiBzdHJpbmcsIGRhdGE6IGFueVtdLCBuZXdEYXRhOiBhbnlbXSkge1xyXG4gICAgICAgIHZhbHVlID0gJycgKyB2YWx1ZTtcclxuICAgICAgICBkYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcblxyXG4gICAgICAgICAgICBsZXQgdHh0ID0gJyc7XHJcbiAgICAgICAgICAgIGxldCB2YWwgPSAnJztcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnRleHRGaWVsZCkge1xyXG4gICAgICAgICAgICAgICAgdHh0ID0gJycgKyB0aGlzLmdldFRleHQoaXRlbS5kYXRhKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMudmFsdWVGaWVsZCkge1xyXG4gICAgICAgICAgICAgICAgdmFsID0gJycgKyB0aGlzLmdldFZhbHVlKGl0ZW0uZGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnRleHRGaWVsZCAmJiB0aGlzLnZhbHVlRmllbGQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0eHQuaW5kZXhPZih2YWx1ZSkgIT09IC0xIHx8IHZhbC5pbmRleE9mKHZhbHVlKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXdEYXRhLnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy50ZXh0RmllbGQgJiYgIXRoaXMudmFsdWVGaWVsZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR4dC5pbmRleE9mKHZhbHVlKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXdEYXRhLnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXRoaXMudGV4dEZpZWxkICYmIHRoaXMudmFsdWVGaWVsZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbC5pbmRleE9mKHZhbHVlKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXdEYXRhLnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGl0ZW0uY2hpbGRyZW4gJiYgaXRlbS5jaGlsZHJlbi5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0VHJlZURhdGFCeVJlY3Vyc2l2ZSh2YWx1ZSwgaXRlbS5jaGlsZHJlbiwgbmV3RGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5qC56IqC54K5XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZ2V0VHJlZVJvb3ROb2RlKGRhdGE6IGFueVtdLCByb290RGF0YTogYW55W10pIHtcclxuICAgICAgICBkYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChpdGVtLnBhcmVudCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcm9vdERhdGEucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0VHJlZVJvb3ROb2RlKG5ldyBBcnJheShpdGVtLnBhcmVudCksIHJvb3REYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5pCc57Si55qE5pWw5o2u77yMVHJlZee7k+aehFxyXG4gICAgICogQHBhcmFtIHZhbHVlIOaQnOe0oueahOWtl+esplxyXG4gICAgICogQHBhcmFtIGRhdGEg5pWw5o2uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZ2V0VHJlZURhdGFCeVNlYXJjaCh2YWx1ZTogc3RyaW5nLCBkYXRhOiBhbnlbXSk6IGFueVtdIHtcclxuICAgICAgICBjb25zdCByb290Tm9kZXMgPSBbXTtcclxuICAgICAgICBjb25zdCBub2RlcyA9IFtdO1xyXG4gICAgICAgIGNvbnN0IGZpbmFsUmVzID0gW107XHJcbiAgICAgICAgY29uc3QgdW5pcXVlSWQgPSBbXTtcclxuICAgICAgICAvLyDojrflj5bljIXlkKt2YWx1ZeWAvOW+l+iKgueCuVxyXG4gICAgICAgIHRoaXMuZ2V0VHJlZURhdGFCeVJlY3Vyc2l2ZSh2YWx1ZSwgZGF0YSwgbm9kZXMpO1xyXG4gICAgICAgIC8vIOiOt+WPluagueiKgueCuVxyXG4gICAgICAgIHRoaXMuZ2V0VHJlZVJvb3ROb2RlKG5vZGVzLCByb290Tm9kZXMpO1xyXG4gICAgICAgIC8vIOWOu+mHjVxyXG4gICAgICAgIHJvb3ROb2Rlcy5mb3JFYWNoKG5vZGUgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXVuaXF1ZUlkLnNvbWUoaXRlbSA9PiBpdGVtID09IG5vZGUuaWQpKSB7XHJcbiAgICAgICAgICAgICAgICBmaW5hbFJlcy5wdXNoKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgdW5pcXVlSWQucHVzaChub2RlLmlkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBmaW5hbFJlcztcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGluaXRSaWdodERhdGEoaWRzKSB7XHJcbiAgICAgICAgbGV0IGRhdGFTb3VyY2U6IGFueSA9IFtdO1xyXG5cclxuICAgICAgICBpZiAoaWRzKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzVHJlZSgpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnRUcmVlRGF0YVRvUGxhaW5EYXRhKHRoaXMuY29weURhdGFTb3VyY2UsIGRhdGFTb3VyY2UpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmlnaHREYXRhID0gdGhpcy5nZXRUcmVlU2VsZWN0aW9uc0J5SWQoaWRzLCBkYXRhU291cmNlKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JpZ2h0RGF0YSA9IHRoaXMuZ2V0TGlzdFNlbGVjdGlvbnNCeUlkKGlkcywgdGhpcy5jb3B5RGF0YVNvdXJjZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuX2xlZnRDaGVja2VkcyA9IGlkcy5yZWR1Y2UoKHIsIGlkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByW2lkXSA9IHRoaXMuX3JpZ2h0RGF0YS5maW5kKG4gPT4gblt0aGlzLmlkRmllbGRdID09IGlkKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByO1xyXG4gICAgICAgICAgICB9LCB7fSk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FuQ2hlY2tMZW5ndGggPSB0aGlzLmdldENhbkNoZWNrTGVuZ3RoKCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnR0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnR0LmNoZWNrZWROb2RlcyhpZHMsIHRydWUsIGZhbHNlLCB0cnVlKTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmFsbFRyZWVOb2RlcyA9IGNsb25lRGVlcCh0aGlzLnR0LnN0YXRlLnJvd05vZGVzLm1hcChuID0+IG4ubm9kZSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0gaWRzIOmAieS4reaVsOaNrueahGlkXHJcbiAgICAgKiBAcGFyYW0gZGF0YVNvdXJjZSDljp/lp4vmlbDmja5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBnZXRMaXN0U2VsZWN0aW9uc0J5SWQoaWRzOiBhbnksIGRhdGFTb3VyY2U6IGFueSkge1xyXG4gICAgICAgIGxldCByZXN1bHQgPSBbXTtcclxuICAgICAgICBjb25zdCBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKCh0eXBlb2YgaWRzID09PSAnc3RyaW5nJyAmJiAhIWlkcykgfHwgdHlwZW9mIGlkcyA9PT0gJ251bWJlcicpIHtcclxuICAgICAgICAgICAgY29uc3QgcmV1c2x0T2JqID0gZGF0YVNvdXJjZS5maW5kKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW1bX3RoaXMuaWRGaWVsZF0gPT09IGlkcztcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmIChyZXVzbHRPYmopIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHJldXNsdE9iaik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoaWRzKSkge1xyXG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShkYXRhU291cmNlKSkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gaWRzLm1hcChpZCA9PiBkYXRhU291cmNlLmZpbmQoaXRlbSA9PiBpdGVtW3RoaXMuaWRGaWVsZF0gPT09IGlkKSkuZmlsdGVyKG4gPT4gbik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBbXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBpZHMg6YCJ5Lit5pWw5o2u55qEaWRcclxuICAgICAqIEBwYXJhbSBkYXRhU291cmNlIOWOn+Wni+aVsOaNrlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGdldFRyZWVTZWxlY3Rpb25zQnlJZChpZHM6IGFueSwgZGF0YVNvdXJjZTogYW55KSB7XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIGNvbnN0IF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAoKHR5cGVvZiBpZHMgPT09ICdzdHJpbmcnICYmICEhaWRzKSB8fCB0eXBlb2YgaWRzID09PSAnbnVtYmVyJykge1xyXG4gICAgICAgICAgICBjb25zdCByZXVzbHRPYmogPSBkYXRhU291cmNlLmZpbmQoaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5kYXRhW190aGlzLmlkRmllbGRdID09PSBpZHM7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAocmV1c2x0T2JqICYmIHJldXNsdE9iai5kYXRhKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChyZXVzbHRPYmouZGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoaWRzKSkge1xyXG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShkYXRhU291cmNlKSkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gaWRzLm1hcChpZCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFTb3VyY2UuZmluZChpdGVtID0+IGl0ZW0uZGF0YVt0aGlzLmlkRmllbGRdID09PSBpZCk7XHJcbiAgICAgICAgICAgICAgICB9KS5maWx0ZXIobiA9PiBuKS5tYXAobiA9PiBuLmRhdGEpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gW107XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXN1bHQgPSBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Yik5pat5piv5ZCm6YCJ5LitXHJcbiAgICAgKiBAcGFyYW0gZGF0YSDopoHpqozor4HnmoTmlbDmja5cclxuICAgICAqIEBwYXJhbSBkaXJlY3Rpb24g6aqM6K+B55qE5pWw5o2u5omA5Zyo55qE5L2N572uIEw6IOW3puS+p++8jFI6IOWPs+S+p1xyXG4gICAgICovXHJcbiAgICBpc0NoZWNrZWQoZGF0YTogYW55LCBkaXJlY3Rpb246ICdMJyB8ICdSJyk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGNvbnN0IGtleVZhbCA9IGRhdGFbdGhpcy5pZEZpZWxkXTtcclxuICAgICAgICBpZiAoZGlyZWN0aW9uID09PSAnTCcpIHtcclxuICAgICAgICAgICAgcmV0dXJuICh0aGlzLl9sZWZ0Q2hlY2tlZHMgJiYgdGhpcy5fbGVmdENoZWNrZWRzW2tleVZhbF0gIT09IHVuZGVmaW5lZCkgfHwgIXRoaXMuY2FuQ2hlY2tlZChkYXRhKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fcmlnaHRDaGVja2Vkcykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JpZ2h0Q2hlY2tlZHNba2V5VmFsXSAhPT0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNhbkNoZWNrZWQoaXRlbTogYW55KSB7XHJcbiAgICAgICAgbGV0IGRhdGEgPSBpdGVtO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5pc1RyZWUoKSkge1xyXG4gICAgICAgICAgICBkYXRhID0gaXRlbS5kYXRhO1xyXG5cclxuICAgICAgICAgICAgaWYgKGl0ZW0uc2VsZWN0YWJsZSAhPT0gdW5kZWZpbmVkICYmICFpdGVtLnNlbGVjdGFibGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLnNlbGVjdGlvbnMgfHwgdGhpcy5zZWxlY3Rpb25zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0aW9ucy5maW5kSW5kZXgoYyA9PiBjW3RoaXMuaWRGaWVsZF0gPT09IGRhdGFbdGhpcy5pZEZpZWxkXSkgPT09IC0xO1xyXG4gICAgfVxyXG5cclxuICAgIGlzVHJlZSgpOiBhbnkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRpc3BsYXlUeXBlID09PSAnVHJlZSc7XHJcbiAgICB9XHJcblxyXG4gICAgbGVmdERhdGFDaGVja2VkKGRhdGE6IGFueVtdKSB7XHJcbiAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgZGF0YS5mb3JFYWNoKG5vZGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IGQgPSBub2RlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNUcmVlKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBkID0gbm9kZS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY2FuQ2hlY2tlZChub2RlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzQ2hlY2tlZChkLCAnTCcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9sZWZ0Q2hlY2tlZHNbZFt0aGlzLmlkRmllbGRdXTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2xlZnRDaGVja2Vkcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbGVmdENoZWNrZWRzID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbGVmdENoZWNrZWRzW2RbdGhpcy5pZEZpZWxkXV0gPSBkO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGhhc0NoZWNrZWRzKGRpcjogJ0wnIHwgJ1InKSB7XHJcbiAgICAgICAgaWYgKGRpciA9PT0gJ0wnKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzVHJlZSgpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50dC5jaGVja2VkcyAmJiB0aGlzLnR0LmNoZWNrZWRzLmxlbmd0aDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuX2xlZnRDaGVja2Vkcykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuX2xlZnRDaGVja2VkcykubGVuZ3RoID4gMDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9yaWdodENoZWNrZWRzKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5fcmlnaHRDaGVja2VkcykubGVuZ3RoID4gMDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByaWdodERhdGFDaGVja2VkKGNvbCkge1xyXG4gICAgICAgIGNvbnN0IGlzQ2hlY2sgPSB0aGlzLmlzQ2hlY2tlZChjb2wsICdSJyk7XHJcbiAgICAgICAgaWYgKGlzQ2hlY2spIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2hvd0NoZWNrYm94KSB7XHJcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fcmlnaHRDaGVja2Vkc1tjb2xbdGhpcy5pZEZpZWxkXV07XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yaWdodENoZWNrZWRzID0ge307XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNob3dDaGVja2JveCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmlnaHRDaGVja2VkcyA9IHRoaXMuX3JpZ2h0Q2hlY2tlZHMgfHwge307XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yaWdodENoZWNrZWRzID0ge307XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5fcmlnaHRDaGVja2Vkc1tjb2xbdGhpcy5pZEZpZWxkXV0gPSBjb2w7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWQuZW1pdCh7IHNlbGVjdGVkOiAhaXNDaGVjaywgZGF0YTogY29sIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY2xlYXJTZWxlY3Rpb25zKCkge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWwhuagkee7k+aehOaVsOaNrui9rOaNouS4uuaJgeW5s+aVsOe7hFxyXG4gICAgICogQHBhcmFtIG5vZGVzIOagkeiKgueCueaVsOe7hFxyXG4gICAgICogQHBhcmFtIHIg5paw55qE56m65pWw57uEXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgY29udmVydFRyZWVEYXRhVG9QbGFpbkRhdGEobm9kZXM6IFRyZWVOb2RlW10sIHI6IGFueVtdID0gW10pIHtcclxuICAgICAgICBpZiAobm9kZXMpIHtcclxuICAgICAgICAgICAgbm9kZXMuZm9yRWFjaChuID0+IHtcclxuICAgICAgICAgICAgICAgIHIucHVzaChuKTtcclxuICAgICAgICAgICAgICAgIGlmIChuLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb252ZXJ0VHJlZURhdGFUb1BsYWluRGF0YShuLmNoaWxkcmVuLCByKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcjtcclxuICAgIH1cclxuXHJcbiAgICAvLyNyZWdpb24g5bem5Y+z56e75YqoXHJcblxyXG4gICAgcHJpdmF0ZSBtb3ZlSXRlbSgpIHtcclxuICAgICAgICB0aGlzLmJlZm9yZU1vdmUuc3Vic2NyaWJlKChvYmo6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtcyA9IG9iai5pdGVtcztcclxuICAgICAgICAgICAgY29uc3QgaWRzID0gT2JqZWN0LmtleXMoaXRlbXMpO1xyXG4gICAgICAgICAgICBsZXQgZGlyZWN0aW9uID0gMTtcclxuICAgICAgICAgICAgc3dpdGNoIChvYmoudGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdyaWdodCc6XHJcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXMoaXRlbXMpLmZvckVhY2goaWQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX3JpZ2h0RGF0YS5maW5kKG4gPT4gblt0aGlzLmlkRmllbGRdLnRvU3RyaW5nKCkgPT09IGlkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmlnaHREYXRhLnB1c2goaXRlbXNbaWRdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JpZ2h0RGF0YSA9IFsuLi50aGlzLl9yaWdodERhdGFdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzVHJlZSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHQuY2xlYXJBbGwoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uID0gMTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3JpZ2h0QWxsJzpcclxuICAgICAgICAgICAgICAgICAgICBpdGVtcy5mb3JFYWNoKGRhdGEgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fcmlnaHREYXRhLmZpbmRJbmRleChuID0+IG5bdGhpcy5pZEZpZWxkXSA9PT0gZGF0YVt0aGlzLmlkRmllbGRdKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JpZ2h0RGF0YS5wdXNoKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNUcmVlKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50dC5jbGVhckFsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uID0gMTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2xlZnQnOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JpZ2h0RGF0YSA9IHRoaXMuX3JpZ2h0RGF0YS5maWx0ZXIodiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpZHMuaW5kZXhPZignJyArIHZbdGhpcy5pZEZpZWxkXSkgPT09IC0xO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JpZ2h0Q2hlY2tlZHMgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICBpZHMuZm9yRWFjaChpZCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9sZWZ0Q2hlY2tlZHNbaWRdO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9IC0xO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1RyZWUoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnR0LmZpbmRSb3dOb2RlcyhpZHMpLmZvckVhY2gobiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLm5vZGUuc2VsZWN0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnR0LnVuQ2hlY2tlZE5vZGVzKGlkcywgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2xlZnRBbGwnOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JpZ2h0Q2hlY2tlZHMgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yaWdodERhdGEgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICBkaXJlY3Rpb24gPSAtMTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9sZWZ0Q2hlY2tlZHMgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1RyZWUoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnR0LmNsZWFyQWxsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHQuZmluZFJvd05vZGVzKGlkcykuZm9yRWFjaChuID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4ubm9kZS5zZWxlY3RhYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvbnNDaGFuZ2UoKTtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VTZWxlY3RJZHMoZGlyZWN0aW9uKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuYWZ0ZXJNb3ZlLmVtaXQoT2JqZWN0LnZhbHVlcyhpdGVtcykpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKiog5Y+z56e7ICovXHJcbiAgICBtb3ZlVG9SaWdodChtb3ZlRGF0YT86IGFueSkge1xyXG5cclxuICAgICAgICBpZiAobW92ZURhdGEpIHtcclxuICAgICAgICAgICAgdGhpcy5iZWZvcmVNb3ZlLmVtaXQoeyBpdGVtczogeyBbbW92ZURhdGFbdGhpcy5pZEZpZWxkXV06IG1vdmVEYXRhIH0sIHRhcmdldDogJ3JpZ2h0JyB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5oYXNDaGVja2VkcygnTCcpKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNUcmVlKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9sZWZ0Q2hlY2tlZHMgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnR0LmNoZWNrZWRzLmZvckVhY2gobiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2xlZnRDaGVja2Vkc1tuLmRhdGFbdGhpcy5pZEZpZWxkXV0gPSBuLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5iZWZvcmVNb3ZlLmVtaXQoeyBpdGVtczogdGhpcy5fbGVmdENoZWNrZWRzLCB0YXJnZXQ6ICdyaWdodCcgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1lc2FnZXJTZXIud2FybmluZyh0aGlzLm5vRGF0YU1vdmVNZXNzYWdlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKiog5YWo6YOo5Y+z56e7ICovXHJcbiAgICBtb3ZlQWxsVG9SaWdodCgpIHtcclxuICAgICAgICBpZiAodGhpcy5zZWFyY2hWYWx1ZSA9PT0gJycpIHtcclxuICAgICAgICAgICAgdGhpcy5fcmlnaHREYXRhID0gW107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmRpc3BsYXlUeXBlID09PSAnTGlzdCcpIHtcclxuICAgICAgICAgICAgdGhpcy5iZWZvcmVNb3ZlLmVtaXQoeyBpdGVtczogdGhpcy5kYXRhU291cmNlLCB0YXJnZXQ6ICdyaWdodEFsbCcgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbGV0IF9kYXRhU291cmNlID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuY29udmVydFRyZWVEYXRhVG9QbGFpbkRhdGEodGhpcy5kYXRhU291cmNlLCBfZGF0YVNvdXJjZSk7XHJcbiAgICAgICAgICAgIF9kYXRhU291cmNlID0gX2RhdGFTb3VyY2UuZmlsdGVyKG4gPT4gbi5zZWxlY3RhYmxlKS5tYXAobiA9PiBuLmRhdGEpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5iZWZvcmVNb3ZlLmVtaXQoeyBpdGVtczogX2RhdGFTb3VyY2UsIHRhcmdldDogJ3JpZ2h0QWxsJyB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8qKiDlt6bnp7sgKi9cclxuICAgIG1vdmVUb0xlZnQobW92ZURhdGE/OiBhbnkpIHtcclxuXHJcbiAgICAgICAgaWYgKG1vdmVEYXRhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYmVmb3JlTW92ZS5lbWl0KHsgaXRlbXM6IHsgW21vdmVEYXRhW3RoaXMuaWRGaWVsZF1dOiBtb3ZlRGF0YSB9LCB0YXJnZXQ6ICdsZWZ0JyB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5oYXNDaGVja2VkcygnUicpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJlZm9yZU1vdmUuZW1pdCh7IGl0ZW1zOiB0aGlzLl9yaWdodENoZWNrZWRzLCB0YXJnZXQ6ICdsZWZ0JyB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubWVzYWdlclNlci53YXJuaW5nKHRoaXMubm9EYXRhTW92ZU1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKiDlhajpg6jlt6bnp7sgKi9cclxuICAgIG1vdmVBbGxUb0xlZnQoKSB7XHJcbiAgICAgICAgdGhpcy5iZWZvcmVNb3ZlLmVtaXQoeyBpdGVtczogdGhpcy5fcmlnaHREYXRhLCB0YXJnZXQ6ICdsZWZ0QWxsJyB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyNlbmRyZWdpb25cclxuXHJcbiAgICAvLyNyZWdpb24g5LiK5LiL56e75Yqo5pi+56S65YiX6aG65bqPXHJcblxyXG4gICAgX2dldFNlbGVjdEluZm8oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaGFzQ2hlY2tlZHMoJ1InKSkge1xyXG4gICAgICAgICAgICBjb25zdCBrZXkgPSBPYmplY3Qua2V5cyh0aGlzLl9yaWdodENoZWNrZWRzKVswXTtcclxuICAgICAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLl9yaWdodERhdGEuZmluZEluZGV4KGMgPT4gJycgKyBjW3RoaXMuaWRGaWVsZF0gPT09IGtleSk7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBrZXksIGluZGV4XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIC8qKiDnva7pobYgKi9cclxuICAgIG1vdmVUb3AoKSB7XHJcbiAgICAgICAgY29uc3Qgb2JqID0gdGhpcy5fZ2V0U2VsZWN0SW5mbygpO1xyXG4gICAgICAgIGlmIChvYmopIHtcclxuICAgICAgICAgICAgdGhpcy5fcmlnaHREYXRhLnVuc2hpZnQodGhpcy5fcmlnaHREYXRhW29iai5pbmRleF0pO1xyXG4gICAgICAgICAgICB0aGlzLl9yaWdodERhdGEuc3BsaWNlKG9iai5pbmRleCArIDEsIDEpO1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvbnNDaGFuZ2UoKTtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VTZWxlY3RJZHMoMCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNhZ2VyU2VyLndhcm5pbmcodGhpcy5ub0RhdGFNb3ZlTWVzc2FnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKiDkuIrnp7sgKi9cclxuICAgIG1vdmVVcCgpIHtcclxuICAgICAgICBpZiAodGhpcy5oYXNDaGVja2VkcygnUicpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG9iaiA9IHRoaXMuX2dldFNlbGVjdEluZm8oKTtcclxuICAgICAgICAgICAgaWYgKG9iaikge1xyXG4gICAgICAgICAgICAgICAgLy8gY29uc3QgbGVuID0gb2JqLmNvbHMubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSBvYmouaW5kZXg7XHJcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggIT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZW1wQXJyID0gdGhpcy5fcmlnaHREYXRhLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmlnaHREYXRhLnNwbGljZShpbmRleCAtIDEsIDAsIC4uLnRlbXBBcnIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zQ2hhbmdlKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZVNlbGVjdElkcygwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzYWdlclNlci53YXJuaW5nKHRoaXMubm9EYXRhTW92ZU1lc3NhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKiog5LiL56e7ICovXHJcbiAgICBtb3ZlRG93bigpIHtcclxuICAgICAgICBpZiAodGhpcy5oYXNDaGVja2VkcygnUicpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG9iaiA9IHRoaXMuX2dldFNlbGVjdEluZm8oKTtcclxuICAgICAgICAgICAgaWYgKG9iaikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbGVuID0gdGhpcy5fcmlnaHREYXRhLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gb2JqLmluZGV4O1xyXG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ID09PSAwIHx8IGluZGV4ICE9PSBsZW4gLSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGVtcEFyciA9IHRoaXMuX3JpZ2h0RGF0YS5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JpZ2h0RGF0YS5zcGxpY2UoaW5kZXggKyAxLCAwLCAuLi50ZW1wQXJyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlU2VsZWN0SWRzKDApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zQ2hhbmdlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm1lc2FnZXJTZXIud2FybmluZyh0aGlzLm5vRGF0YU1vdmVNZXNzYWdlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIOe9ruW6lSAqL1xyXG4gICAgbW92ZUJvdHRvbSgpIHtcclxuICAgICAgICBjb25zdCBvYmogPSB0aGlzLl9nZXRTZWxlY3RJbmZvKCk7XHJcbiAgICAgICAgaWYgKG9iaikge1xyXG4gICAgICAgICAgICB0aGlzLl9yaWdodERhdGEucHVzaCh0aGlzLl9yaWdodENoZWNrZWRzW29iai5rZXldKTtcclxuICAgICAgICAgICAgdGhpcy5fcmlnaHREYXRhLnNwbGljZShvYmouaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZVNlbGVjdElkcygwKTtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zQ2hhbmdlKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNhZ2VyU2VyLndhcm5pbmcodGhpcy5ub0RhdGFNb3ZlTWVzc2FnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDop6blj5HpgInmi6nkuK1pZFxyXG4gICAgICogQHBhcmFtIG51bWJlciAx5Luj6KGo5bem5L6n5pWw5o2u5Y+z56e777yMLTEs5Luj6KGo5pWw5o2u5bem56e777yMMOS7o+ihqOS4iuenu+S4i+enu1xyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGNoYW5nZVNlbGVjdElkcyhudW1iZXI6IG51bWJlcikge1xyXG4gICAgICAgIGNvbnN0IGlkcyA9IHRoaXMuX3JpZ2h0RGF0YS5tYXAoaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiBpdGVtW3RoaXMuaWRGaWVsZF07XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmIChudW1iZXIgPT09IDApIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLnNlbGVjdGVkSWQgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkSWQgPSBpZHMuam9pbignLCcpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkodGhpcy5zZWxlY3RlZElkKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZElkID0gaWRzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJZENoYW5nZS5lbWl0KHRoaXMuc2VsZWN0ZWRJZCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5zZWxlY3RlZElkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJZCA9IFtdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKG51bWJlciA9PT0gMSB8fCBudW1iZXIgPT09IC0xKSB7XHJcbiAgICAgICAgICAgIGlmICghaWRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZElkID0gW107XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkSWQgPSBpZHM7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzVHJlZSgpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaWRzICYmIGlkcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnR0LmNoZWNrZWROb2RlcyhpZHMsIHRydWUsIGZhbHNlLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNhbkNoZWNrTGVuZ3RoID0gdGhpcy5nZXRDYW5DaGVja0xlbmd0aCgpO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJZENoYW5nZS5lbWl0KHRoaXMuc2VsZWN0ZWRJZCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8jZW5kcmVnaW9uXHJcblxyXG4gICAgcHJpdmF0ZSBzZWxlY3Rpb25zQ2hhbmdlKCkge1xyXG4gICAgICAgIHRoaXMuZGF0YUNoYW5nZS5lbWl0KHRoaXMuX3JpZ2h0RGF0YSk7XHJcbiAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VGV4dChpdGVtLCB0ZXh0RmllbGQgPSB0aGlzLnRleHRGaWVsZCkge1xyXG4gICAgICAgIGlmIChpdGVtKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbW1vblV0aWxzICYmIHRoaXMuY29tbW9uVXRpbHMuZ2V0VmFsdWUgJiYgdGV4dEZpZWxkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb21tb25VdGlscy5nZXRWYWx1ZSh0ZXh0RmllbGQsIGl0ZW0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW1bdGV4dEZpZWxkXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VmFsdWUoaXRlbSwgdmFsdWVGaWVsZCA9IHRoaXMudmFsdWVGaWVsZCkge1xyXG4gICAgICAgIGlmIChpdGVtKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbW1vblV0aWxzICYmIHRoaXMuY29tbW9uVXRpbHMuZ2V0VmFsdWUgJiYgdmFsdWVGaWVsZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29tbW9uVXRpbHMuZ2V0VmFsdWUodmFsdWVGaWVsZCwgaXRlbSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbVt2YWx1ZUZpZWxkXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdHJhY2tCeUl0ZW1zID0gKGluZGV4LCBpdGVtKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGluZGV4O1xyXG4gICAgfVxyXG5cclxufVxyXG5cclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdkaXNwbGF5LXRleHQnLFxyXG4gICAgdGVtcGxhdGU6IGBcclxuICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwidGVtcGxhdGVcIiA+XHJcbiAgICAgICAgICAgIDxuZy1jb250YWluZXJcclxuICAgICAgICAgICAgICAgICpuZ1RlbXBsYXRlT3V0bGV0PVwidGVtcGxhdGU7IGNvbnRleHQ6IHskaW1wbGljaXQ6IGRhdGEsaW5zdGFuY2U6IG1zLCBzaWRlOiBzaWRlLCBzZWxlY3RlZDogbXMuaXNDaGVja2VkKGRhdGEsICdSJykgfVwiPlxyXG4gICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cclxuICAgICAgICA8L25nLWNvbnRhaW5lcj5cclxuICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiIXRlbXBsYXRlXCI+XHJcbiAgICAgICAgICAgIHt7IF9nZXRUZXh0KGRhdGEpIH19XHJcbiAgICAgICAgPC9uZy1jb250YWluZXI+XHJcbiAgICBgXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBEaXNwbGF5VGV4dENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgICBASW5wdXQoKSB0ZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PjtcclxuICAgIEBJbnB1dCgpIGRhdGE6IGFueTtcclxuICAgIEBJbnB1dCgpIHNpZGUgPSAnTCc7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHVibGljIG1zOiBNdWx0aVNlbGVjdENvbXBvbmVudCkgeyB9XHJcblxyXG4gICAgbmdPbkluaXQoKSB7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5kYXRhKTtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0VGV4dChpdGVtKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubXMuZ2V0VGV4dChpdGVtKTtcclxuICAgIH1cclxufVxyXG4iXX0=