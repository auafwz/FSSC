import { Injectable } from "@angular/core";
var WorkFlowMessageService = /** @class */ (function () {
    function WorkFlowMessageService() {
    }
    /**
     * 监听工作流消息
     * @param callback 回调
     */
    WorkFlowMessageService.prototype.listen = function (callback) {
        window.addEventListener('message', function (event) {
            var message = event.data;
            if (message) {
                message.sender = event.source;
            }
            if (typeof callback === 'function') {
                callback(message);
            }
        });
    };
    /**
     * 给工作流表单发送消息
     * @param message
     */
    WorkFlowMessageService.prototype.send = function (message) {
        if (!message) {
            return;
        }
        var win = window;
        if (message.target) {
            win = message.target || window;
            delete message.target;
        }
        if (win) {
            win.postMessage(message, '*');
        }
    };
    WorkFlowMessageService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    WorkFlowMessageService.ctorParameters = function () { return []; };
    return WorkFlowMessageService;
}());
export { WorkFlowMessageService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid29yay1mbG93LW1lc3NhZ2Uuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvY29tbWFuZC1zZXJ2aWNlcy8iLCJzb3VyY2VzIjpbImxpYi93b3JrLWZsb3cvd29yay1mbG93LW1lc3NhZ2Uuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRzNDO0lBRUU7SUFBZ0IsQ0FBQztJQUNqQjs7O09BR0c7SUFDSSx1Q0FBTSxHQUFiLFVBQWMsUUFBd0M7UUFDcEQsTUFBTSxDQUFDLGdCQUFnQixDQUFDLFNBQVMsRUFBRSxVQUFVLEtBQUs7WUFDaEQsSUFBSSxPQUFPLEdBQUcsS0FBSyxDQUFDLElBQXlCLENBQUM7WUFDOUMsSUFBSSxPQUFPLEVBQUU7Z0JBQ1gsT0FBTyxDQUFDLE1BQU0sR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDO2FBQy9CO1lBQ0QsSUFBSSxPQUFPLFFBQVEsS0FBSyxVQUFVLEVBQUU7Z0JBQ2xDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQzthQUNuQjtRQUNILENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUNEOzs7T0FHRztJQUNJLHFDQUFJLEdBQVgsVUFBWSxPQUEwQjtRQUNwQyxJQUFJLENBQUMsT0FBTyxFQUFFO1lBQ1osT0FBTztTQUNSO1FBQ0QsSUFBSSxHQUFHLEdBQVcsTUFBTSxDQUFDO1FBQ3pCLElBQUksT0FBTyxDQUFDLE1BQU0sRUFBRTtZQUNsQixHQUFHLEdBQUcsT0FBTyxDQUFDLE1BQWdCLElBQUksTUFBTSxDQUFDO1lBQ3pDLE9BQU8sT0FBTyxDQUFDLE1BQU0sQ0FBQztTQUN2QjtRQUNELElBQUksR0FBRyxFQUFFO1lBQ1AsR0FBRyxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUUsR0FBRyxDQUFDLENBQUM7U0FDL0I7SUFDSCxDQUFDOztnQkFsQ0YsVUFBVTs7OztJQW1DWCw2QkFBQztDQUFBLEFBbkNELElBbUNDO1NBbENZLHNCQUFzQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xyXG5pbXBvcnQgeyBXb3JrRmxvdyB9IGZyb20gXCIuL3R5cGVzXCI7XHJcblxyXG5ASW5qZWN0YWJsZSgpXHJcbmV4cG9ydCBjbGFzcyBXb3JrRmxvd01lc3NhZ2VTZXJ2aWNlIHtcclxuICBjb25zdHJ1Y3RvcigpIHsgfVxyXG4gIC8qKlxyXG4gICAqIOebkeWQrOW3peS9nOa1gea2iOaBr1xyXG4gICAqIEBwYXJhbSBjYWxsYmFjayDlm57osINcclxuICAgKi9cclxuICBwdWJsaWMgbGlzdGVuKGNhbGxiYWNrOiAoZTogV29ya0Zsb3cuSU1lc3NhZ2UpID0+IHZvaWQpIHtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgIHZhciBtZXNzYWdlID0gZXZlbnQuZGF0YSBhcyBXb3JrRmxvdy5JTWVzc2FnZTtcclxuICAgICAgaWYgKG1lc3NhZ2UpIHtcclxuICAgICAgICBtZXNzYWdlLnNlbmRlciA9IGV2ZW50LnNvdXJjZTtcclxuICAgICAgfVxyXG4gICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgY2FsbGJhY2sobWVzc2FnZSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDnu5nlt6XkvZzmtYHooajljZXlj5HpgIHmtojmga9cclxuICAgKiBAcGFyYW0gbWVzc2FnZSBcclxuICAgKi9cclxuICBwdWJsaWMgc2VuZChtZXNzYWdlOiBXb3JrRmxvdy5JTWVzc2FnZSk6IHZvaWQge1xyXG4gICAgaWYgKCFtZXNzYWdlKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGxldCB3aW46IFdpbmRvdyA9IHdpbmRvdztcclxuICAgIGlmIChtZXNzYWdlLnRhcmdldCkge1xyXG4gICAgICB3aW4gPSBtZXNzYWdlLnRhcmdldCBhcyBXaW5kb3cgfHwgd2luZG93O1xyXG4gICAgICBkZWxldGUgbWVzc2FnZS50YXJnZXQ7XHJcbiAgICB9XHJcbiAgICBpZiAod2luKSB7XHJcbiAgICAgIHdpbi5wb3N0TWVzc2FnZShtZXNzYWdlLCAnKicpO1xyXG4gICAgfVxyXG4gIH1cclxufSJdfQ==