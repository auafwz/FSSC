!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs"),require("@angular/common"),require("@angular/core"),require("@farris/ui-perfect-scrollbar"),require("@farris/ui-draggable"),require("@farris/ui-modal")):"function"==typeof define&&define.amd?define("@farris/ui-dialog",["exports","rxjs","@angular/common","@angular/core","@farris/ui-perfect-scrollbar","@farris/ui-draggable","@farris/ui-modal"],e):e((t.farris=t.farris||{},t.farris["ui-dialog"]={}),t.rxjs,t.ng.common,t.ng.core,t.uiPerfectScrollbar,t.uiDraggable,t.uiModal)}(this,function(t,n,e,i,o,s,h){"use strict";var r=(a.prototype.hasDialogOpened=function(t){var i=0,e="farris-dialog,.overlay-pane";t&&(e+=","+t);var n=window.document.querySelectorAll(e);return Array.from(n).filter(function(t){return!Array.from(n[0].classList).some(function(t){return"f-combo-list"==t})}).forEach(function(t){var e="";""!==(e="DIV"===t.tagName?window.getComputedStyle(t).display:window.getComputedStyle(t.querySelector("div")).display)&&"block"!==e||i++}),0<i},a.decorators=[{type:i.Injectable}],a);function a(){}var l=(d.prototype.ngOnInit=function(){var t=this;this.hostId="farris-dialog_"+(new Date).getTime(),this.render2.setProperty(this.el.nativeElement,"id",this.hostId),this.beforeOpen||(this.beforeOpen=function(){return!0}),this.beforeClose||(this.beforeClose=function(){return!0}),this.modal.onShown.subscribe(function(){t.opened.emit()}),this.modal.onHidden.subscribe(function(){return t.closed.emit()}),this.checkDialogSize(),setTimeout(function(){t.parentElement?t.parentElement.appendChild(t.el.nativeElement):document.body.appendChild(t.el.nativeElement)},100)},d.prototype.ngOnChanges=function(t){},d.prototype.ngOnDestroy=function(){var t=this;setTimeout(function(){t.destroy()},150)},d.prototype.ngAfterViewInit=function(){this.dlgHeaderLineHeight=this.getDialogHeaderLineHeight(),this.resetPosition()},d.prototype.destroy=function(){this.parentElement?this.parentElement.querySelector("#"+this.hostId)&&this.parentElement.removeChild(this.el.nativeElement):document.body.querySelector("#"+this.hostId)&&document.body.removeChild(this.el.nativeElement)},d.prototype.getDialogHeaderLineHeight=function(){return this.modalHeader.nativeElement.getBoundingClientRect().height},Object.defineProperty(d.prototype,"size",{get:function(){var t=this.height-this.dialogHeaderHeight;return this.showButtons&&(t-=this.dialogFooterHeight),{width:this.width,height:this.height,contentHeight:t,contentWidth:this.width}},enumerable:!0,configurable:!0}),d.prototype._checkDialogSize=function(t,e){var i={width:document.body.offsetWidth,height:window.innerHeight};return this.parentElement&&(i.width=this.parentElement.offsetWidth,i.height=this.parentElement.offsetHeight),i.width&&i.width<t&&(t=i.width),i.height&&i.height<e&&(e=i.height),{width:t,height:e}},d.prototype.checkDialogSize=function(){var t=this._checkDialogSize(this.width,this.height);this.width!==t.width&&(this.width=t.width-20,this.widthChange.emit(this.width)),this.height!==t.height&&(this.height=t.height-20,this.heightChange.emit(this.height))},d.prototype.updateModalBodyHeight=function(){var t=this.el.nativeElement.querySelector(".modal-body"),e=this.size.contentHeight;this.render2.setStyle(t,"height",e+"px")},d.prototype.resetPosition=function(){var t=Number.parseInt(""+-this.width/2)+"px",e=Number.parseInt(""+-this.height/2)+"px",i=this.el.nativeElement.querySelector(".modal-dialog"),n=this.el.nativeElement.querySelector(".modal-body");this.el.nativeElement.querySelector(".modal-footer"),this.render2.setStyle(i,"margin-left",t),this.render2.setStyle(i,"margin-top",e);var o=this.size.contentHeight;this.render2.setStyle(n,"height",o+"px"),this.render2.setStyle(n,"overflow","hidden"),this.render2.setStyle(i,"transform","translate3d(0px, 0px, 0px)")},d.prototype.openDialog=function(t){t&&(this.resetPosition(),this.draggbar.resetPosition(),this.modal.show())},d.prototype.closeDialog=function(t){t&&this.modal.hide()},d.prototype.show=function(){var e=this,t=this.beforeOpen();"boolean"==typeof t?this.openDialog(t):t instanceof n.Observable?t.subscribe(function(t){e.openDialog(t)}):t instanceof Promise&&t.then(function(t){e.openDialog(t)})},d.prototype.close=function(t){var e=this;t&&t.stopPropagation();var i=this.beforeClose();"boolean"==typeof i?this.closeDialog(i):i instanceof n.Observable?i.subscribe(function(t){e.closeDialog(t)}):i instanceof Promise&&i.then(function(t){e.closeDialog(t)})},d.prototype.reSize=function(t){t.width&&(this.width=t.width),t.height&&(this.height=t.height),this.resetPosition(),this.draggbar.resetPosition(),this.widthChange.emit(this.width),this.heightChange.emit(this.height),this.resized.emit({size:{width:this.width,height:this.height}})},d.prototype.onResizing=function(t){t.size.width=t.size.width<100?100:t.size.width,t.size.height=t.size.height<100?100:t.size.height,this.width=t.size.width,this.height=t.size.height,this.resizing.emit(t)},d.prototype.resizeStop=function(t){t.size.width=t.size.width<100?100:t.size.width,t.size.height=t.size.height<100?100:t.size.height,this.width=t.size.width,this.height=t.size.height,this.updateModalBodyHeight(),this.widthChange.emit(this.width),this.heightChange.emit(this.height),this.resized.emit(t)},d.prototype.dropdown=function(t){},d.prototype.maxDialog=function(){this.originalWidth=this.width,this.originalHeight=this.height,this.width=(document.scrollingElement?document.scrollingElement:document.documentElement).clientWidth-20,this.height=(document.scrollingElement?document.scrollingElement:document.documentElement).clientHeight-20,this.draggable=!1,this.resizable=!1,this.isMax=!0,this.resetPosition(),this.resized.emit({size:{width:this.width,height:this.height}}),this.maxed.emit({size:{width:this.width,height:this.height}})},d.prototype.revertDialog=function(){this.isMax=!1,this.width=this.originalWidth,this.height=this.originalHeight,this.draggable=!0,this.resizable=!0,this.resetPosition(),this.draggbar.resetPosition(),this.resized.emit({size:{width:this.width,height:this.height}}),this.maxed.emit({size:{width:this.width,height:this.height}})},d.prototype.changeDialogSize=function(){this.isMax?this.revertDialog():this.maxDialog()},d.decorators=[{type:i.Component,args:[{selector:"farris-dialog",template:'<div #backdropEl class="modal fade farris-modal" bsModal #staticModal="bs-modal" [config]="{backdrop: \'static\'}"\r\n    tabindex="-1" role="dialog" aria-labelledby="dialog-static-name">\r\n    <div [ngDraggable]="draggable" [ngResizable]="resizable" rzHandles="all" [handle]="header"\r\n        (rzStop)="resizeStop($event)" (rzResizing)="onResizing($event)" (stopped)="dropdown($event)"\r\n        [rzMinWidth]="minWidth" [rzMaxWidth]="maxWidth" [rzMinHeight]="minHeight" [rzMaxHeight]="maxHeight"\r\n        [inBounds]="true" [bounds]="backdropEl" class="modal-dialog" [style.width]="width + \'px\'"\r\n        [style.height]="height + \'px\'">\r\n        <div #modalContent class="modal-content">\r\n            <div #header class="modal-header">\r\n                <div class="modal-title">\r\n                    <span *ngIf="iconCls" [class]="iconCls"></span>\r\n                    <span class="modal-title-label">{{ title }}</span>\r\n                </div>\r\n                <div class="actions">\r\n\r\n                    <ul>\r\n                        <li *ngIf="toolTemplate">\r\n                            <ng-template [ngTemplateOutlet]="toolTemplate">\r\n\r\n                            </ng-template>\r\n                        </li>\r\n                        <li *ngIf="showMinButton" class="f-btn-icon f-bare"><span class="f-icon modal_minimize"></span>\r\n                        </li>\r\n                        <li *ngIf="showMaxButton" (click)="changeDialogSize()" class="f-btn-icon f-bare"><span\r\n                                class="f-icon modal_maximize" [class.modalrevert]="isMax"></span></li>\r\n                        <li *ngIf="showCloseButton" (click)="close($event)" class="f-btn-icon f-bare"><span\r\n                                class="f-icon modal_close"></span></li>\r\n                    </ul>\r\n                </div>\r\n            </div>\r\n            <div class="modal-body">\r\n                <perfect-scrollbar [disabled]="!enableScroll" [config]="scrollConfig">\r\n                    <ng-content></ng-content>\r\n                </perfect-scrollbar>\r\n            </div>\r\n\r\n            <div class="modal-footer" *ngIf="showButtons" [style.textAlign]="buttonAlign">\r\n                <ng-container [ngTemplateOutlet]="buttons"></ng-container>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>',styles:[""]}]}],d.ctorParameters=function(){return[{type:i.Renderer2},{type:i.ElementRef}]},d.propDecorators={title:[{type:i.Input}],iconCls:[{type:i.Input}],width:[{type:i.Input}],height:[{type:i.Input}],minWidth:[{type:i.Input}],minHeight:[{type:i.Input}],maxWidth:[{type:i.Input}],maxHeight:[{type:i.Input}],showButtons:[{type:i.Input}],showCloseButton:[{type:i.Input}],showMaxButton:[{type:i.Input}],showMinButton:[{type:i.Input}],resizable:[{type:i.Input}],draggable:[{type:i.Input}],buttonAlign:[{type:i.Input}],scrollConfig:[{type:i.Input}],beforeOpen:[{type:i.Input}],beforeClose:[{type:i.Input}],modal:[{type:i.ViewChild,args:[h.ModalDirective]}],draggbar:[{type:i.ViewChild,args:[s.AngularDraggableDirective]}],opened:[{type:i.Output}],closed:[{type:i.Output}],resized:[{type:i.Output}],resizing:[{type:i.Output}],maxed:[{type:i.Output}],widthChange:[{type:i.Output}],heightChange:[{type:i.Output}],enableScroll:[{type:i.Input}],buttons:[{type:i.Input}],dialogHeaderHeight:[{type:i.Input}],dialogFooterHeight:[{type:i.Input}],parentElement:[{type:i.Input}],toolTemplate:[{type:i.ContentChild,args:["toolTemplate"]}],modalContent:[{type:i.ViewChild,args:["modalContent"]}],modalHeader:[{type:i.ViewChild,args:["header"]}]},d);function d(t,e){this.render2=t,this.el=e,this.title="我是标题",this.iconCls=undefined,this.width=300,this.height=200,this.minWidth=100,this.minHeight=100,this.maxWidth=null,this.maxHeight=null,this.showButtons=!0,this.showCloseButton=!0,this.showMaxButton=!0,this.showMinButton=!1,this.resizable=!0,this.draggable=!0,this.buttonAlign="center",this.scrollConfig={},this.opened=new i.EventEmitter,this.closed=new i.EventEmitter,this.resized=new i.EventEmitter,this.resizing=new i.EventEmitter,this.maxed=new i.EventEmitter,this.widthChange=new i.EventEmitter,this.heightChange=new i.EventEmitter,this.enableScroll=!0,this.dialogHeaderHeight=38,this.dialogFooterHeight=50,this.parentElement=null,this.isMax=!1,this.hostId=""}var g=(p.forRoot=function(){return{ngModule:p,providers:[r]}},p.decorators=[{type:i.NgModule,args:[{declarations:[l],imports:[o.PerfectScrollbarModule,s.AngularDraggableModule,h.ModalModule,e.CommonModule],exports:[l,h.ModalModule]}]}],p);function p(){}t.DialogService=r,t.DialogComponent=l,t.FarrisDialogModule=g,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=farris-ui-dialog.umd.min.js.map