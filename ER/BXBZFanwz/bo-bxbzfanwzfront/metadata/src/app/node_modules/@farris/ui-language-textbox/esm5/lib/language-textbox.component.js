/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { LanguageTextboxService } from './language-textbox.service';
/*
* @Author: 疯狂秀才(Lucas Huang)
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @Company: Inspur
 * @Version: v0.0.1
 * @Date: 2019-03-12 15:46:47
 * @LastEditTime: 2019-04-08 18:46:53
 */
import { Component, Input, ViewChild, ElementRef, ComponentFactoryResolver, Injector, ApplicationRef, NgZone, Renderer2, ViewEncapsulation, forwardRef, Optional, Self } from '@angular/core';
import { NG_VALUE_ACCESSOR, NgControl, RequiredValidator } from '@angular/forms';
import { InputGroupComponent } from '@farris/ui-input-group';
import { LanguageTextPanelComponent } from './language-textbox-panel.component';
import { LocaleService } from '@farris/ui-locale';
import { ChangeDetectorRef } from '@angular/core';
/** @type {?} */
export var LANGUAGE_TEXTBOX_VALUE_ACCESSOR = {
    provide: NG_VALUE_ACCESSOR,
    useExisting: forwardRef((/**
     * @return {?}
     */
    function () { return LanguageTextboxComponent; })),
    multi: true
};
var LanguageTextboxComponent = /** @class */ (function () {
    function LanguageTextboxComponent(el, cfr, injector, ngZone, applicationRef, renderer, requiredValidator, cd) {
        var _this = this;
        this.el = el;
        this.cfr = cfr;
        this.injector = injector;
        this.ngZone = ngZone;
        this.applicationRef = applicationRef;
        this.renderer = renderer;
        this.requiredValidator = requiredValidator;
        this.cd = cd;
        this.disabled = false;
        this.readonly = false;
        this.editable = false;
        this.enableClear = false;
        this.languages = [];
        this.panelHeight = 260;
        this.panelWidth = 365;
        /**
         * 面板输入框根据LOCALE_ID 自动获得焦点
         * 设为 false 时，仅第1个获得焦点
         */
        this.autoFocus = true;
        this.openOnFocus = true;
        this.groupIcon = '<span class="f-icon f-icon-yxs_earth"></span>';
        this.currentLanguageItem = undefined;
        this.data = {};
        this.value = '';
        this.onTextBoxclickHandler = null;
        this.lts = null;
        this.onModelChange = (/**
         * @param {?=} obj
         * @return {?}
         */
        function (obj) { });
        this.onModelTouched = (/**
         * @param {?=} obj
         * @return {?}
         */
        function (obj) { });
        this.localeService = this.injector.get(LocaleService);
        this.lts = this.injector.get(LanguageTextboxService, null);
        if (!this.lts) {
            this.lts = new LanguageTextboxService();
        }
        this.lts.hide$.subscribe((/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            _this.hideDropDownPanel();
        }));
    }
    /**
     * @return {?}
     */
    LanguageTextboxComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (!this.editable) {
            this.editable = this.languages && this.languages.length && this.languages.length === 1;
        }
        this.bindLanguageInfo(this.languages);
        this.onTextBoxclickHandler = this.renderer.listen(this.input.textbox.nativeElement, 'click', (/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            e.stopPropagation();
            if (_this.editable) {
                _this.hideDropDownPanel();
                return;
            }
            if (!_this.comboPanelRef) {
                _this.showDropDownPanel();
            }
        }));
        this.ngCtrl = this.injector.get(NgControl, null);
        this.registerKeyDown();
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    LanguageTextboxComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes.languages && !changes.languages.isFirstChange()) {
            this.bindLanguageInfo(changes.languages.currentValue);
            this.setValue();
        }
    };
    /**
     * @private
     * @param {?} languages
     * @return {?}
     */
    LanguageTextboxComponent.prototype.bindLanguageInfo = /**
     * @private
     * @param {?} languages
     * @return {?}
     */
    function (languages) {
        if (languages && languages.length) {
            if (!this.currentLanguage) {
                /** @type {?} */
                var runtimeLanguageCode_1 = this.localeService.localeId;
                if (runtimeLanguageCode_1) {
                    /** @type {?} */
                    var defaultLang = languages.find((/**
                     * @param {?} l
                     * @return {?}
                     */
                    function (l) { return l.code === runtimeLanguageCode_1; }));
                    if (defaultLang) {
                        this.currentLanguage = defaultLang.code;
                        this.currentLanguageItem = defaultLang;
                    }
                    else {
                        if (languages.length) {
                            this.currentLanguage = languages[0].code;
                            this.currentLanguageItem = languages[0];
                        }
                    }
                }
                else {
                    console.warn('当前上下文环境未取到语言代码。');
                }
            }
            else {
                this.currentLanguageItem = this.getLanguageItem(this.currentLanguage);
            }
        }
        else {
            // throw new Error(`Can not find the '[languages]' data.`);
            console.warn("Please set  the '[languages]' data.");
        }
    };
    /**
     * @return {?}
     */
    LanguageTextboxComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this.onKeyDownHandler) {
            this.onKeyDownHandler();
        }
        this.hideDropDownPanel();
        if (this.onTextBoxclickHandler) {
            this.onTextBoxclickHandler();
        }
    };
    /**
     * @private
     * @return {?}
     */
    LanguageTextboxComponent.prototype.registerKeyDown = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var textEl = this.input.textbox.nativeElement;
        this.onKeyDownHandler = this.renderer.listen(textEl, 'keydown', this.onKeyDown.bind(this));
        // this.ngZone.runOutsideAngular(() => {
        // });
    };
    /**
     * @private
     * @param {?} $event
     * @return {?}
     */
    LanguageTextboxComponent.prototype.onKeyDown = /**
     * @private
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        var _this = this;
        if ($event) {
            $event.stopPropagation();
            /** @type {?} */
            var keyCode = $event.keyCode;
            // F2
            if (keyCode === 113) {
                this.showDropDownPanel();
            }
            if (keyCode !== 38 && keyCode !== 40) {
                return;
            }
            /** @type {?} */
            var languageItemIndex = this.languages.findIndex((/**
             * @param {?} l
             * @return {?}
             */
            function (l) { return l.code === _this.currentLanguageItem.code; }));
            switch (keyCode) {
                case 38:
                    if (languageItemIndex === 0) {
                        this.currentLanguageItem = this.languages[this.languages.length - 1];
                    }
                    else {
                        this.currentLanguageItem = this.languages[languageItemIndex - 1];
                    }
                    this.currentLanguage = this.currentLanguageItem.code;
                    break;
                case 40:
                    if (languageItemIndex === this.languages.length - 1) {
                        this.currentLanguageItem = this.languages[0];
                    }
                    else {
                        this.currentLanguageItem = this.languages[languageItemIndex + 1];
                    }
                    this.currentLanguage = this.currentLanguageItem.code;
                    break;
            }
            this.setValue();
            this.cd.markForCheck();
            this.cd.detectChanges();
            // this.input.cd.detectChanges();
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.input.setFocusToEnd();
            }));
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    LanguageTextboxComponent.prototype.onFocus = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        $event.stopPropagation();
        if (this.openOnFocus) {
            this.showDropDownPanel();
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    LanguageTextboxComponent.prototype.onBlur = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        $event.stopPropagation();
        // this.hideDropDownPanel();
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    LanguageTextboxComponent.prototype.onIconClick = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        if ($event.originalEvent) {
            $event.originalEvent.stopPropagation();
            $event.originalEvent.preventDefault();
        }
        if (!this.comboPanelRef) {
            this.showDropDownPanel();
        }
        return false;
    };
    /**
     * @private
     * @return {?}
     */
    LanguageTextboxComponent.prototype.getCliecntRect = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var rect = this.input.el.nativeElement.getBoundingClientRect();
        /** @type {?} */
        var winWidth = window.innerWidth;
        /** @type {?} */
        var winHeight = window.innerHeight;
        /** @type {?} */
        var posleft = rect.left;
        if (winWidth - posleft < this.panelWidth) {
            posleft = posleft + rect.width - this.panelWidth;
        }
        /** @type {?} */
        var postop = rect.top;
        if (winHeight - postop < this.panelHeight) {
            postop = postop - rect.height;
        }
        else {
            postop = postop + rect.height;
        }
        return {
            left: posleft,
            // + rect.width - this.panelWidth
            top: postop,
            height: this.panelHeight,
            width: this.panelWidth
        };
    };
    /**
     * @private
     * @return {?}
     */
    LanguageTextboxComponent.prototype.updateLangOrder = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var idx = -1;
        /** @type {?} */
        var curritem = this.languages.find((/**
         * @param {?} n
         * @param {?} i
         * @return {?}
         */
        function (n, i) {
            /** @type {?} */
            var f = n.code === _this.localeService.localeId;
            if (f) {
                idx = i;
            }
            return f;
        }));
        if (curritem) {
            /** @type {?} */
            var _item = Object.assign({}, curritem);
            this.languages.splice(idx, 1);
            this.languages.unshift(_item);
        }
    };
    /**
     * @return {?}
     */
    LanguageTextboxComponent.prototype.showDropDownPanel = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (!this.languages || this.languages.length === 1) {
            return;
        }
        if (this.readonly || this.disabled) {
            return;
        }
        if (!this.comboPanelRef) {
            /** @type {?} */
            var compFac = this.cfr.resolveComponentFactory(LanguageTextPanelComponent);
            this.comboPanelRef = compFac.create(this.injector);
            this.applicationRef.attachView(this.comboPanelRef.hostView);
            Object.assign(this.comboPanelRef.instance, this.getCliecntRect());
            /** @type {?} */
            var panelRefEl = this.comboPanelRef.location.nativeElement;
            document.body.appendChild(panelRefEl);
            this.renderer.addClass(panelRefEl, 'overlay-pane');
            // this.renderer.setStyle(panelRefEl, 'width', '100vw');
            // this.renderer.setStyle(panelRefEl, 'height', '100vh');
            this.renderer.setStyle(panelRefEl, 'z-index', '99999999');
            this.renderer.setStyle(panelRefEl, 'left', '0');
            this.renderer.setStyle(panelRefEl, 'top', '0');
            this.globalListener = this.registerListenClick();
            // 根据上下文语言，自动调整语言列表的顺序，将当前语言设为第1个
            this.updateLangOrder();
            this.comboPanelRef.instance.items = this.languages;
            this.comboPanelRef.instance.languageInputRef = this;
            this.comboPanelRef.instance.data = tslib_1.__assign({}, this.data);
            this.comboPanelRef.instance.currentItem = this.currentLanguageItem;
            this.comboPanelRef.instance.itemClick.subscribe((/**
             * @param {?} data
             * @return {?}
             */
            function (data) {
                // this.currentLanguageItem = item;
                // this.currentLanguage = item.code;
                _this.data = tslib_1.__assign({}, data);
                _this.hideDropDownPanel();
                _this.setValue();
            }));
            this.comboPanelRef.instance.hidePanel.subscribe((/**
             * @return {?}
             */
            function () {
                _this.hideDropDownPanel();
            }));
            this.comboPanelRef.instance.showPanel.subscribe((/**
             * @param {?} panelIns
             * @return {?}
             */
            function (panelIns) {
                panelIns.setInputFocus();
            }));
            this.comboPanelRef.instance.show(this);
            this.lts.setActivePane(this);
        }
        else {
            this.hideDropDownPanel();
        }
    };
    /**
     * @private
     * @param {?} code
     * @return {?}
     */
    LanguageTextboxComponent.prototype.getLanguageItem = /**
     * @private
     * @param {?} code
     * @return {?}
     */
    function (code) {
        return this.languages.find((/**
         * @param {?} l
         * @return {?}
         */
        function (l) { return l.code === code; }));
    };
    /**
     * @return {?}
     */
    LanguageTextboxComponent.prototype.onClear = /**
     * @return {?}
     */
    function () { };
    /**
     * @param {?=} val
     * @return {?}
     */
    LanguageTextboxComponent.prototype.onChanges = /**
     * @param {?=} val
     * @return {?}
     */
    function (val) {
        this.data[this.currentLanguage] = this.value;
        this.onModelChange(tslib_1.__assign({}, this.data));
        this.onModelTouched(tslib_1.__assign({}, this.data));
    };
    /**
     * @return {?}
     */
    LanguageTextboxComponent.prototype.setValue = /**
     * @return {?}
     */
    function () {
        if (this.data) {
            this.value = this.data[this.currentLanguage] || '';
        }
        else {
            this.value = '';
        }
        this.onChanges();
        this.cd.detectChanges();
    };
    /**
     * @private
     * @return {?}
     */
    LanguageTextboxComponent.prototype.removeGlobalListener = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.globalListener) {
            this.globalListener();
            this.globalListener = null;
        }
    };
    /**
     * @private
     * @param {?} action
     * @param {?} fn
     * @return {?}
     */
    LanguageTextboxComponent.prototype.iframeEventHandle = /**
     * @private
     * @param {?} action
     * @param {?} fn
     * @return {?}
     */
    function (action, fn) {
        var e_1, _a;
        /** @type {?} */
        var iframes = Array.from(document.querySelectorAll('iframe'));
        if (iframes && iframes.length) {
            try {
                for (var iframes_1 = tslib_1.__values(iframes), iframes_1_1 = iframes_1.next(); !iframes_1_1.done; iframes_1_1 = iframes_1.next()) {
                    var iframe = iframes_1_1.value;
                    /** @type {?} */
                    var iframeDoc = iframe.contentDocument;
                    if (iframeDoc) {
                        iframeDoc[action]('mousedown', fn);
                        iframeDoc[action]('mousewheel', fn);
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (iframes_1_1 && !iframes_1_1.done && (_a = iframes_1.return)) _a.call(iframes_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
    };
    /**
     * @private
     * @return {?}
     */
    LanguageTextboxComponent.prototype.registerListenClick = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var removePanel = (/**
         * @param {?} event
         * @return {?}
         */
        function (event) {
            if (!_this.comboPanelRef) {
                return;
            }
            /** @type {?} */
            var targets = [_this.comboPanelRef.location.nativeElement, _this.el.nativeElement];
            if (targets.some((/**
             * @param {?} t
             * @return {?}
             */
            function (t) { return t.contains(event.target); }))) {
                return;
            }
            _this.hideDropDownPanel();
        });
        document.body.addEventListener('mousedown', removePanel, true);
        document.body.addEventListener('mousewheel', removePanel, true);
        this.iframeEventHandle('addEventListener', removePanel);
        return (/**
         * @return {?}
         */
        function () {
            document.body.removeEventListener('mousedown', removePanel, true);
            document.body.removeEventListener('mousewheel', removePanel, true);
            _this.iframeEventHandle('removeEventListener', removePanel);
        });
        // return this.renderer.listen('document', 'click', (event: any) => {
        //     if (!this.comboPanelRef) {
        //         return;
        //     }
        //     const targets = [this.comboPanelRef.location.nativeElement, this.el.nativeElement];
        //     if (targets.some(t => t.contains(event.target))) {
        //         return;
        //     }
        //     this.hideDropDownPanel();
        // });
    };
    /**
     * @return {?}
     */
    LanguageTextboxComponent.prototype.hideDropDownPanel = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.comboPanelRef && this.comboPanelRef.instance) {
            // if (this.comboPanelRef.instance.opened) {
            //     this.comboPanelRef.instance.hide();
            // }
            this.comboPanelRef.instance.opened = false;
            /** @type {?} */
            var componentEl = this.comboPanelRef.location.nativeElement;
            if (componentEl.parentNode) {
                componentEl.parentNode.removeChild(componentEl);
            }
            this.removeGlobalListener();
            this.ngZone.runOutsideAngular((/**
             * @return {?}
             */
            function () {
                _this.input.focus();
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    if (_this.comboPanelRef) {
                        _this.comboPanelRef.destroy();
                        _this.comboPanelRef = null;
                    }
                }), 100);
            }));
        }
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    LanguageTextboxComponent.prototype.writeValue = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        if (obj && Object.keys(obj).length) {
            this.data = obj;
            this.value = obj[this.currentLanguage];
        }
        else {
            this.data = {};
            this.value = '';
        }
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    LanguageTextboxComponent.prototype.registerOnChange = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onModelChange = fn;
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    LanguageTextboxComponent.prototype.registerOnTouched = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onModelTouched = fn;
    };
    /**
     * @param {?} isDisabled
     * @return {?}
     */
    LanguageTextboxComponent.prototype.setDisabledState = /**
     * @param {?} isDisabled
     * @return {?}
     */
    function (isDisabled) {
        this.disabled = isDisabled;
    };
    LanguageTextboxComponent.decorators = [
        { type: Component, args: [{
                    selector: 'language-textbox',
                    template: "\n        <input-group #input\n            [customCls] = \"'farris-language-textbox'\"\n            [groupText]=\"groupIcon\"\n            [disabled]=\"disabled\"\n            [readonly]=\"readonly\"\n            [editable]=\"editable\"\n            [(ngModel)]=\"value\"\n            [enableClear]=\"false\"\n            [value]=\"value\"\n            (valueChange)=\"onChanges($event)\"\n            (clear)=\"onClear()\"\n            (clickHandle)=\"onIconClick($event)\"\n            (focusHandle)=\"onFocus($event)\"\n        >\n        </input-group>\n    ",
                    providers: [LANGUAGE_TEXTBOX_VALUE_ACCESSOR],
                    encapsulation: ViewEncapsulation.None,
                    styles: ["\n        .farris-language-textbox .input-group-text {\n            padding-right: 3px;\n        }\n        .farris-language-textbox .input-group-text .language-text {\n            padding-right: 3px;\n        }\n        "]
                }] }
    ];
    /** @nocollapse */
    LanguageTextboxComponent.ctorParameters = function () { return [
        { type: ElementRef },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: NgZone },
        { type: ApplicationRef },
        { type: Renderer2 },
        { type: RequiredValidator, decorators: [{ type: Optional }, { type: Self }] },
        { type: ChangeDetectorRef }
    ]; };
    LanguageTextboxComponent.propDecorators = {
        disabled: [{ type: Input }],
        readonly: [{ type: Input }],
        editable: [{ type: Input }],
        enableClear: [{ type: Input }],
        languages: [{ type: Input }],
        currentLanguage: [{ type: Input }],
        panelHeight: [{ type: Input }],
        panelWidth: [{ type: Input }],
        autoFocus: [{ type: Input }],
        input: [{ type: ViewChild, args: ['input',] }],
        openOnFocus: [{ type: Input }]
    };
    return LanguageTextboxComponent;
}());
export { LanguageTextboxComponent };
if (false) {
    /** @type {?} */
    LanguageTextboxComponent.prototype.disabled;
    /** @type {?} */
    LanguageTextboxComponent.prototype.readonly;
    /** @type {?} */
    LanguageTextboxComponent.prototype.editable;
    /** @type {?} */
    LanguageTextboxComponent.prototype.enableClear;
    /** @type {?} */
    LanguageTextboxComponent.prototype.languages;
    /** @type {?} */
    LanguageTextboxComponent.prototype.currentLanguage;
    /** @type {?} */
    LanguageTextboxComponent.prototype.panelHeight;
    /** @type {?} */
    LanguageTextboxComponent.prototype.panelWidth;
    /**
     * 面板输入框根据LOCALE_ID 自动获得焦点
     * 设为 false 时，仅第1个获得焦点
     * @type {?}
     */
    LanguageTextboxComponent.prototype.autoFocus;
    /** @type {?} */
    LanguageTextboxComponent.prototype.input;
    /** @type {?} */
    LanguageTextboxComponent.prototype.openOnFocus;
    /** @type {?} */
    LanguageTextboxComponent.prototype.groupIcon;
    /** @type {?} */
    LanguageTextboxComponent.prototype.comboPanelRef;
    /** @type {?} */
    LanguageTextboxComponent.prototype.currentLanguageItem;
    /**
     * @type {?}
     * @private
     */
    LanguageTextboxComponent.prototype.data;
    /**
     * @type {?}
     * @private
     */
    LanguageTextboxComponent.prototype.globalListener;
    /**
     * @type {?}
     * @private
     */
    LanguageTextboxComponent.prototype.ngCtrl;
    /** @type {?} */
    LanguageTextboxComponent.prototype.value;
    /** @type {?} */
    LanguageTextboxComponent.prototype.onKeyDownHandler;
    /** @type {?} */
    LanguageTextboxComponent.prototype.localeService;
    /** @type {?} */
    LanguageTextboxComponent.prototype.onTextBoxclickHandler;
    /** @type {?} */
    LanguageTextboxComponent.prototype.lts;
    /** @type {?} */
    LanguageTextboxComponent.prototype.onModelChange;
    /** @type {?} */
    LanguageTextboxComponent.prototype.onModelTouched;
    /**
     * @type {?}
     * @private
     */
    LanguageTextboxComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    LanguageTextboxComponent.prototype.cfr;
    /**
     * @type {?}
     * @private
     */
    LanguageTextboxComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    LanguageTextboxComponent.prototype.ngZone;
    /**
     * @type {?}
     * @private
     */
    LanguageTextboxComponent.prototype.applicationRef;
    /**
     * @type {?}
     * @private
     */
    LanguageTextboxComponent.prototype.renderer;
    /**
     * @type {?}
     * @private
     */
    LanguageTextboxComponent.prototype.requiredValidator;
    /**
     * @type {?}
     * @private
     */
    LanguageTextboxComponent.prototype.cd;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGFuZ3VhZ2UtdGV4dGJveC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLWxhbmd1YWdlLXRleHRib3gvIiwic291cmNlcyI6WyJsaWIvbGFuZ3VhZ2UtdGV4dGJveC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQzs7Ozs7Ozs7O0FBV3BFLE9BQU8sRUFDSCxTQUFTLEVBQVUsS0FBSyxFQUFFLFNBQVMsRUFBZ0IsVUFBVSxFQUM3RCx3QkFBd0IsRUFBRSxRQUFRLEVBQUUsY0FBYyxFQUNsRCxNQUFNLEVBQUUsU0FBUyxFQUFFLGlCQUFpQixFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUNuRSxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsaUJBQWlCLEVBQXdCLFNBQVMsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3ZHLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQzdELE9BQU8sRUFBRSwwQkFBMEIsRUFBRSxNQUFNLG9DQUFvQyxDQUFDO0FBRWhGLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNsRCxPQUFPLEVBQUUsaUJBQWlCLEVBQWEsTUFBTSxlQUFlLENBQUM7O0FBRTdELE1BQU0sS0FBTywrQkFBK0IsR0FBUTtJQUNoRCxPQUFPLEVBQUUsaUJBQWlCO0lBQzFCLFdBQVcsRUFBRSxVQUFVOzs7SUFBQyxjQUFNLE9BQUEsd0JBQXdCLEVBQXhCLENBQXdCLEVBQUM7SUFDdkQsS0FBSyxFQUFFLElBQUk7Q0FDZDtBQUdEO0lBc0VJLGtDQUNZLEVBQWMsRUFDZCxHQUE2QixFQUM3QixRQUFrQixFQUNsQixNQUFjLEVBQ2QsY0FBOEIsRUFDOUIsUUFBbUIsRUFDQyxpQkFBb0MsRUFDeEQsRUFBcUI7UUFSakMsaUJBb0JLO1FB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LGlCQUFpQjs7OzJCQTBDckIsS0FBSzsyQkFDTCxLQUFLOzJCQUNMLEtBQUs7OEJBQ0wsS0FBSzs0QkFDTCxLQUFLO2tDQUNMLEtBQUs7OEJBQ0wsS0FBSzs2QkFDTCxLQUFLOzRCQUtMLEtBQUs7d0JBRUwsU0FBUyxTQUFDLE9BQU87OEJBRWpCLEtBQUs7O0lBaWFWLCtCQUFDO0NBQUEsQUFsZEQsSUFrZEM7U0FsYlksd0JBQXdCOzs7SUFDakMsNENBQTBCOztJQUMxQiw0Q0FBMEI7O0lBQzFCLDRDQUEwQjs7SUFDMUIsK0NBQTZCOztJQUM3Qiw2Q0FBd0M7O0lBQ3hDLG1EQUFpQzs7SUFDakMsK0NBQTJCOztJQUMzQiw4Q0FBMEI7Ozs7OztJQUsxQiw2Q0FBMEI7O0lBRTFCLHlDQUErQzs7SUFFL0MsK0NBQTRCOztJQUU1Qiw2Q0FBNEQ7O0lBRTVELGlEQUF3RDs7SUFDeEQsdURBQThDOzs7OztJQUM5Qyx3Q0FBZ0M7Ozs7O0lBQ2hDLGtEQUFtQzs7Ozs7SUFDbkMsMENBQTBCOztJQUMxQix5Q0FBVzs7SUFFWCxvREFBc0I7O0lBQ3RCLGlEQUE2Qjs7SUFFN0IseURBQTZCOztJQUM3Qix1Q0FBbUM7O0lBRW5DLGlEQUFtQzs7SUFDbkMsa0RBQW9DOzs7OztJQUloQyxzQ0FBc0I7Ozs7O0lBQ3RCLHVDQUFxQzs7Ozs7SUFDckMsNENBQTBCOzs7OztJQUMxQiwwQ0FBc0I7Ozs7O0lBQ3RCLGtEQUFzQzs7Ozs7SUFDdEMsNENBQTJCOzs7OztJQUMzQixxREFBZ0U7Ozs7O0lBQ2hFLHNDQUE2QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IExhbmd1YWdlVGV4dGJveFNlcnZpY2UgfSBmcm9tICcuL2xhbmd1YWdlLXRleHRib3guc2VydmljZSc7XHJcbmltcG9ydCB7IEhvc3RMaXN0ZW5lciwgT25DaGFuZ2VzLCBTaW1wbGVDaGFuZ2VzIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcblxyXG4vKlxyXG4qIEBBdXRob3I6IOeWr+eLguengOaJjShMdWNhcyBIdWFuZylcclxuICogQExhc3RFZGl0b3JzOiDnlq/ni4Lnp4DmiY0oTHVjYXMgSHVhbmcpXHJcbiAqIEBDb21wYW55OiBJbnNwdXJcclxuICogQFZlcnNpb246IHYwLjAuMVxyXG4gKiBARGF0ZTogMjAxOS0wMy0xMiAxNTo0Njo0N1xyXG4gKiBATGFzdEVkaXRUaW1lOiAyMDE5LTA0LTA4IDE4OjQ2OjUzXHJcbiAqL1xyXG5pbXBvcnQge1xyXG4gICAgQ29tcG9uZW50LCBPbkluaXQsIElucHV0LCBWaWV3Q2hpbGQsIENvbXBvbmVudFJlZiwgRWxlbWVudFJlZixcclxuICAgIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciwgSW5qZWN0b3IsIEFwcGxpY2F0aW9uUmVmLFxyXG4gICAgTmdab25lLCBSZW5kZXJlcjIsIFZpZXdFbmNhcHN1bGF0aW9uLCBmb3J3YXJkUmVmLCBPcHRpb25hbCwgU2VsZlxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBOR19WQUxVRV9BQ0NFU1NPUiwgQ29udHJvbFZhbHVlQWNjZXNzb3IsIE5nQ29udHJvbCwgUmVxdWlyZWRWYWxpZGF0b3IgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XHJcbmltcG9ydCB7IElucHV0R3JvdXBDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWlucHV0LWdyb3VwJztcclxuaW1wb3J0IHsgTGFuZ3VhZ2VUZXh0UGFuZWxDb21wb25lbnQgfSBmcm9tICcuL2xhbmd1YWdlLXRleHRib3gtcGFuZWwuY29tcG9uZW50JztcclxuaW1wb3J0IHsgTGFuZ3VhZ2VJdGVtLCBMYW5ndWFnZURhdGEgfSBmcm9tICcuL3R5cGVzJztcclxuaW1wb3J0IHsgTG9jYWxlU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9jYWxlJztcclxuaW1wb3J0IHsgQ2hhbmdlRGV0ZWN0b3JSZWYsIE9uRGVzdHJveSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5cclxuZXhwb3J0IGNvbnN0IExBTkdVQUdFX1RFWFRCT1hfVkFMVUVfQUNDRVNTT1I6IGFueSA9IHtcclxuICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxyXG4gICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gTGFuZ3VhZ2VUZXh0Ym94Q29tcG9uZW50KSxcclxuICAgIG11bHRpOiB0cnVlXHJcbn07XHJcblxyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2xhbmd1YWdlLXRleHRib3gnLFxyXG4gICAgdGVtcGxhdGU6IGBcclxuICAgICAgICA8aW5wdXQtZ3JvdXAgI2lucHV0XHJcbiAgICAgICAgICAgIFtjdXN0b21DbHNdID0gXCInZmFycmlzLWxhbmd1YWdlLXRleHRib3gnXCJcclxuICAgICAgICAgICAgW2dyb3VwVGV4dF09XCJncm91cEljb25cIlxyXG4gICAgICAgICAgICBbZGlzYWJsZWRdPVwiZGlzYWJsZWRcIlxyXG4gICAgICAgICAgICBbcmVhZG9ubHldPVwicmVhZG9ubHlcIlxyXG4gICAgICAgICAgICBbZWRpdGFibGVdPVwiZWRpdGFibGVcIlxyXG4gICAgICAgICAgICBbKG5nTW9kZWwpXT1cInZhbHVlXCJcclxuICAgICAgICAgICAgW2VuYWJsZUNsZWFyXT1cImZhbHNlXCJcclxuICAgICAgICAgICAgW3ZhbHVlXT1cInZhbHVlXCJcclxuICAgICAgICAgICAgKHZhbHVlQ2hhbmdlKT1cIm9uQ2hhbmdlcygkZXZlbnQpXCJcclxuICAgICAgICAgICAgKGNsZWFyKT1cIm9uQ2xlYXIoKVwiXHJcbiAgICAgICAgICAgIChjbGlja0hhbmRsZSk9XCJvbkljb25DbGljaygkZXZlbnQpXCJcclxuICAgICAgICAgICAgKGZvY3VzSGFuZGxlKT1cIm9uRm9jdXMoJGV2ZW50KVwiXHJcbiAgICAgICAgPlxyXG4gICAgICAgIDwvaW5wdXQtZ3JvdXA+XHJcbiAgICBgLFxyXG4gICAgc3R5bGVzOiBbXHJcbiAgICAgICAgYFxyXG4gICAgICAgIC5mYXJyaXMtbGFuZ3VhZ2UtdGV4dGJveCAuaW5wdXQtZ3JvdXAtdGV4dCB7XHJcbiAgICAgICAgICAgIHBhZGRpbmctcmlnaHQ6IDNweDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLmZhcnJpcy1sYW5ndWFnZS10ZXh0Ym94IC5pbnB1dC1ncm91cC10ZXh0IC5sYW5ndWFnZS10ZXh0IHtcclxuICAgICAgICAgICAgcGFkZGluZy1yaWdodDogM3B4O1xyXG4gICAgICAgIH1cclxuICAgICAgICBgXHJcbiAgICBdLFxyXG4gICAgcHJvdmlkZXJzOiBbTEFOR1VBR0VfVEVYVEJPWF9WQUxVRV9BQ0NFU1NPUl0sXHJcbiAgICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBMYW5ndWFnZVRleHRib3hDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSwgQ29udHJvbFZhbHVlQWNjZXNzb3IsIE9uQ2hhbmdlcyB7XHJcbiAgICBASW5wdXQoKSBkaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgQElucHV0KCkgcmVhZG9ubHkgPSBmYWxzZTtcclxuICAgIEBJbnB1dCgpIGVkaXRhYmxlID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBlbmFibGVDbGVhciA9IGZhbHNlO1xyXG4gICAgQElucHV0KCkgbGFuZ3VhZ2VzOiBMYW5ndWFnZUl0ZW1bXSA9IFtdO1xyXG4gICAgQElucHV0KCkgY3VycmVudExhbmd1YWdlOiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBwYW5lbEhlaWdodCA9IDI2MDtcclxuICAgIEBJbnB1dCgpIHBhbmVsV2lkdGggPSAzNjU7XHJcbiAgICAvKipcclxuICAgICAqIOmdouadv+i+k+WFpeahhuagueaNrkxPQ0FMRV9JRCDoh6rliqjojrflvpfnhKbngrlcclxuICAgICAqIOiuvuS4uiBmYWxzZSDml7bvvIzku4XnrKwx5Liq6I635b6X54Sm54K5XHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIGF1dG9Gb2N1cyA9IHRydWU7XHJcblxyXG4gICAgQFZpZXdDaGlsZCgnaW5wdXQnKSBpbnB1dDogSW5wdXRHcm91cENvbXBvbmVudDtcclxuXHJcbiAgICBASW5wdXQoKSBvcGVuT25Gb2N1cyA9IHRydWU7XHJcblxyXG4gICAgZ3JvdXBJY29uID0gJzxzcGFuIGNsYXNzPVwiZi1pY29uIGYtaWNvbi15eHNfZWFydGhcIj48L3NwYW4+JztcclxuXHJcbiAgICBjb21ib1BhbmVsUmVmOiBDb21wb25lbnRSZWY8TGFuZ3VhZ2VUZXh0UGFuZWxDb21wb25lbnQ+O1xyXG4gICAgY3VycmVudExhbmd1YWdlSXRlbTogTGFuZ3VhZ2VJdGVtID0gdW5kZWZpbmVkO1xyXG4gICAgcHJpdmF0ZSBkYXRhOiBMYW5ndWFnZURhdGEgPSB7fTtcclxuICAgIHByaXZhdGUgZ2xvYmFsTGlzdGVuZXI6ICgpID0+IHZvaWQ7XHJcbiAgICBwcml2YXRlIG5nQ3RybDogTmdDb250cm9sO1xyXG4gICAgdmFsdWUgPSAnJztcclxuXHJcbiAgICBvbktleURvd25IYW5kbGVyOiBhbnk7XHJcbiAgICBsb2NhbGVTZXJ2aWNlOiBMb2NhbGVTZXJ2aWNlO1xyXG5cclxuICAgIG9uVGV4dEJveGNsaWNrSGFuZGxlciA9IG51bGw7XHJcbiAgICBsdHM6IExhbmd1YWdlVGV4dGJveFNlcnZpY2UgPSBudWxsO1xyXG5cclxuICAgIG9uTW9kZWxDaGFuZ2UgPSAob2JqPzogYW55KSA9PiB7IH07XHJcbiAgICBvbk1vZGVsVG91Y2hlZCA9IChvYmo/OiBhbnkpID0+IHsgfTtcclxuXHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSBlbDogRWxlbWVudFJlZixcclxuICAgICAgICBwcml2YXRlIGNmcjogQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLFxyXG4gICAgICAgIHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLFxyXG4gICAgICAgIHByaXZhdGUgbmdab25lOiBOZ1pvbmUsXHJcbiAgICAgICAgcHJpdmF0ZSBhcHBsaWNhdGlvblJlZjogQXBwbGljYXRpb25SZWYsXHJcbiAgICAgICAgcHJpdmF0ZSByZW5kZXJlcjogUmVuZGVyZXIyLFxyXG4gICAgICAgIEBPcHRpb25hbCgpIEBTZWxmKCkgcHJpdmF0ZSByZXF1aXJlZFZhbGlkYXRvcjogUmVxdWlyZWRWYWxpZGF0b3IsXHJcbiAgICAgICAgcHJpdmF0ZSBjZDogQ2hhbmdlRGV0ZWN0b3JSZWYpIHtcclxuICAgICAgICAgICAgdGhpcy5sb2NhbGVTZXJ2aWNlID0gdGhpcy5pbmplY3Rvci5nZXQoTG9jYWxlU2VydmljZSk7XHJcbiAgICAgICAgICAgIHRoaXMubHRzID0gdGhpcy5pbmplY3Rvci5nZXQoTGFuZ3VhZ2VUZXh0Ym94U2VydmljZSwgbnVsbCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXRoaXMubHRzKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmx0cyA9IG5ldyBMYW5ndWFnZVRleHRib3hTZXJ2aWNlKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMubHRzLmhpZGUkLnN1YnNjcmliZSggZSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGVEcm9wRG93blBhbmVsKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmVkaXRhYmxlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWRpdGFibGUgPSB0aGlzLmxhbmd1YWdlcyAmJiB0aGlzLmxhbmd1YWdlcy5sZW5ndGggJiYgdGhpcy5sYW5ndWFnZXMubGVuZ3RoID09PSAxO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5iaW5kTGFuZ3VhZ2VJbmZvKHRoaXMubGFuZ3VhZ2VzKTtcclxuXHJcbiAgICAgICAgdGhpcy5vblRleHRCb3hjbGlja0hhbmRsZXIgPSB0aGlzLnJlbmRlcmVyLmxpc3Rlbih0aGlzLmlucHV0LnRleHRib3gubmF0aXZlRWxlbWVudCwgJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmVkaXRhYmxlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGVEcm9wRG93blBhbmVsKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghdGhpcy5jb21ib1BhbmVsUmVmKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dEcm9wRG93blBhbmVsKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5uZ0N0cmwgPSB0aGlzLmluamVjdG9yLmdldChOZ0NvbnRyb2wsIG51bGwpO1xyXG5cclxuICAgICAgICB0aGlzLnJlZ2lzdGVyS2V5RG93bigpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcclxuICAgICAgICBpZiAoY2hhbmdlcy5sYW5ndWFnZXMgJiYgIWNoYW5nZXMubGFuZ3VhZ2VzLmlzRmlyc3RDaGFuZ2UoKSkge1xyXG4gICAgICAgICAgICB0aGlzLmJpbmRMYW5ndWFnZUluZm8oY2hhbmdlcy5sYW5ndWFnZXMuY3VycmVudFZhbHVlKTtcclxuICAgICAgICAgICAgdGhpcy5zZXRWYWx1ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGJpbmRMYW5ndWFnZUluZm8obGFuZ3VhZ2VzOiBMYW5ndWFnZUl0ZW1bXSkge1xyXG4gICAgICAgIGlmIChsYW5ndWFnZXMgJiYgbGFuZ3VhZ2VzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuY3VycmVudExhbmd1YWdlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBydW50aW1lTGFuZ3VhZ2VDb2RlID0gdGhpcy5sb2NhbGVTZXJ2aWNlLmxvY2FsZUlkO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJ1bnRpbWVMYW5ndWFnZUNvZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBkZWZhdWx0TGFuZyA9IGxhbmd1YWdlcy5maW5kKGwgPT4gbC5jb2RlID09PSBydW50aW1lTGFuZ3VhZ2VDb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdExhbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50TGFuZ3VhZ2UgPSBkZWZhdWx0TGFuZy5jb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRMYW5ndWFnZUl0ZW0gPSBkZWZhdWx0TGFuZztcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGFuZ3VhZ2VzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50TGFuZ3VhZ2UgPSBsYW5ndWFnZXNbMF0uY29kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudExhbmd1YWdlSXRlbSA9IGxhbmd1YWdlc1swXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCflvZPliY3kuIrkuIvmlofnjq/looPmnKrlj5bliLDor63oqIDku6PnoIHjgIInKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudExhbmd1YWdlSXRlbSA9IHRoaXMuZ2V0TGFuZ3VhZ2VJdGVtKHRoaXMuY3VycmVudExhbmd1YWdlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIHRocm93IG5ldyBFcnJvcihgQ2FuIG5vdCBmaW5kIHRoZSAnW2xhbmd1YWdlc10nIGRhdGEuYCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgUGxlYXNlIHNldCAgdGhlICdbbGFuZ3VhZ2VzXScgZGF0YS5gKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkRlc3Ryb3koKSB7XHJcbiAgICAgICAgaWYgKHRoaXMub25LZXlEb3duSGFuZGxlcikge1xyXG4gICAgICAgICAgICB0aGlzLm9uS2V5RG93bkhhbmRsZXIoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuaGlkZURyb3BEb3duUGFuZWwoKTtcclxuICAgICAgICBpZiAodGhpcy5vblRleHRCb3hjbGlja0hhbmRsZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5vblRleHRCb3hjbGlja0hhbmRsZXIoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuXHJcblxyXG4gICAgcHJpdmF0ZSByZWdpc3RlcktleURvd24oKSB7XHJcbiAgICAgICAgY29uc3QgdGV4dEVsID0gdGhpcy5pbnB1dC50ZXh0Ym94Lm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy5vbktleURvd25IYW5kbGVyID0gdGhpcy5yZW5kZXJlci5saXN0ZW4odGV4dEVsLCAna2V5ZG93bicsIHRoaXMub25LZXlEb3duLmJpbmQodGhpcykpO1xyXG4gICAgICAgIC8vIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcclxuICAgICAgICAvLyB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIG9uS2V5RG93bigkZXZlbnQ6IEtleWJvYXJkRXZlbnQpIHtcclxuICAgICAgICBpZiAoJGV2ZW50KSB7XHJcbiAgICAgICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGtleUNvZGUgPSAkZXZlbnQua2V5Q29kZTtcclxuICAgICAgICAgICAgLy8gRjJcclxuICAgICAgICAgICAgaWYgKGtleUNvZGUgPT09IDExMykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zaG93RHJvcERvd25QYW5lbCgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgaWYgKGtleUNvZGUgIT09IDM4ICYmIGtleUNvZGUgIT09IDQwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGxhbmd1YWdlSXRlbUluZGV4ID0gdGhpcy5sYW5ndWFnZXMuZmluZEluZGV4KGwgPT4gbC5jb2RlID09PSB0aGlzLmN1cnJlbnRMYW5ndWFnZUl0ZW0uY29kZSk7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoa2V5Q29kZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAzODpcclxuICAgICAgICAgICAgICAgICAgICBpZiAobGFuZ3VhZ2VJdGVtSW5kZXggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50TGFuZ3VhZ2VJdGVtID0gdGhpcy5sYW5ndWFnZXNbdGhpcy5sYW5ndWFnZXMubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50TGFuZ3VhZ2VJdGVtID0gdGhpcy5sYW5ndWFnZXNbbGFuZ3VhZ2VJdGVtSW5kZXggLSAxXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50TGFuZ3VhZ2UgPSB0aGlzLmN1cnJlbnRMYW5ndWFnZUl0ZW0uY29kZTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDA6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxhbmd1YWdlSXRlbUluZGV4ID09PSB0aGlzLmxhbmd1YWdlcy5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudExhbmd1YWdlSXRlbSA9IHRoaXMubGFuZ3VhZ2VzWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudExhbmd1YWdlSXRlbSA9IHRoaXMubGFuZ3VhZ2VzW2xhbmd1YWdlSXRlbUluZGV4ICsgMV07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudExhbmd1YWdlID0gdGhpcy5jdXJyZW50TGFuZ3VhZ2VJdGVtLmNvZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5zZXRWYWx1ZSgpO1xyXG4gICAgICAgICAgICB0aGlzLmNkLm1hcmtGb3JDaGVjaygpO1xyXG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgLy8gdGhpcy5pbnB1dC5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW5wdXQuc2V0Rm9jdXNUb0VuZCgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25Gb2N1cygkZXZlbnQpIHtcclxuICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgaWYgKHRoaXMub3Blbk9uRm9jdXMpIHtcclxuICAgICAgICAgICAgdGhpcy5zaG93RHJvcERvd25QYW5lbCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvbkJsdXIoJGV2ZW50KSB7XHJcbiAgICAgICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIC8vIHRoaXMuaGlkZURyb3BEb3duUGFuZWwoKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkljb25DbGljaygkZXZlbnQpIHtcclxuICAgICAgICBpZiAoJGV2ZW50Lm9yaWdpbmFsRXZlbnQpIHtcclxuICAgICAgICAgICAgJGV2ZW50Lm9yaWdpbmFsRXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICRldmVudC5vcmlnaW5hbEV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5jb21ib1BhbmVsUmVmKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd0Ryb3BEb3duUGFuZWwoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0Q2xpZWNudFJlY3QoKSB7XHJcbiAgICAgICAgY29uc3QgcmVjdCA9IHRoaXMuaW5wdXQuZWwubmF0aXZlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcbiAgICAgICAgY29uc3Qgd2luV2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcclxuICAgICAgICBjb25zdCB3aW5IZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XHJcblxyXG4gICAgICAgIGxldCBwb3NsZWZ0ID0gcmVjdC5sZWZ0O1xyXG4gICAgICAgIGlmICh3aW5XaWR0aCAtIHBvc2xlZnQgPCB0aGlzLnBhbmVsV2lkdGgpIHtcclxuICAgICAgICAgICAgcG9zbGVmdCA9IHBvc2xlZnQgKyByZWN0LndpZHRoIC0gdGhpcy5wYW5lbFdpZHRoO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHBvc3RvcCA9IHJlY3QudG9wO1xyXG4gICAgICAgIGlmICh3aW5IZWlnaHQgLSBwb3N0b3AgPCB0aGlzLnBhbmVsSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHBvc3RvcCA9IHBvc3RvcCAtIHJlY3QuaGVpZ2h0O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHBvc3RvcCA9IHBvc3RvcCArIHJlY3QuaGVpZ2h0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgbGVmdDogcG9zbGVmdCwgLy8gKyByZWN0LndpZHRoIC0gdGhpcy5wYW5lbFdpZHRoXHJcbiAgICAgICAgICAgIHRvcDogcG9zdG9wLFxyXG4gICAgICAgICAgICBoZWlnaHQ6IHRoaXMucGFuZWxIZWlnaHQsXHJcbiAgICAgICAgICAgIHdpZHRoOiB0aGlzLnBhbmVsV2lkdGhcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgdXBkYXRlTGFuZ09yZGVyKCkge1xyXG4gICAgICAgIGxldCBpZHggPSAtMTtcclxuICAgICAgICBjb25zdCBjdXJyaXRlbSA9IHRoaXMubGFuZ3VhZ2VzLmZpbmQoKG4sIGkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZiA9IG4uY29kZSA9PT0gdGhpcy5sb2NhbGVTZXJ2aWNlLmxvY2FsZUlkO1xyXG4gICAgICAgICAgICBpZiAoZikge1xyXG4gICAgICAgICAgICAgICAgaWR4ID0gaTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZjtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKGN1cnJpdGVtKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IF9pdGVtID0gT2JqZWN0LmFzc2lnbih7fSwgY3Vycml0ZW0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5sYW5ndWFnZXMuc3BsaWNlKGlkeCwgMSk7XHJcbiAgICAgICAgICAgIHRoaXMubGFuZ3VhZ2VzLnVuc2hpZnQoX2l0ZW0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzaG93RHJvcERvd25QYW5lbCgpIHtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmxhbmd1YWdlcyB8fCB0aGlzLmxhbmd1YWdlcy5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMucmVhZG9ubHkgfHwgdGhpcy5kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmNvbWJvUGFuZWxSZWYpIHtcclxuICAgICAgICAgICAgY29uc3QgY29tcEZhYyA9IHRoaXMuY2ZyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KExhbmd1YWdlVGV4dFBhbmVsQ29tcG9uZW50KTtcclxuICAgICAgICAgICAgdGhpcy5jb21ib1BhbmVsUmVmID0gY29tcEZhYy5jcmVhdGUodGhpcy5pbmplY3Rvcik7XHJcbiAgICAgICAgICAgIHRoaXMuYXBwbGljYXRpb25SZWYuYXR0YWNoVmlldyh0aGlzLmNvbWJvUGFuZWxSZWYuaG9zdFZpZXcpO1xyXG5cclxuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLmNvbWJvUGFuZWxSZWYuaW5zdGFuY2UsIHRoaXMuZ2V0Q2xpZWNudFJlY3QoKSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBwYW5lbFJlZkVsID0gdGhpcy5jb21ib1BhbmVsUmVmLmxvY2F0aW9uLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocGFuZWxSZWZFbCk7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3MocGFuZWxSZWZFbCwgJ292ZXJsYXktcGFuZScpO1xyXG4gICAgICAgICAgICAvLyB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHBhbmVsUmVmRWwsICd3aWR0aCcsICcxMDB2dycpO1xyXG4gICAgICAgICAgICAvLyB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHBhbmVsUmVmRWwsICdoZWlnaHQnLCAnMTAwdmgnKTtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShwYW5lbFJlZkVsLCAnei1pbmRleCcsICc5OTk5OTk5OScpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHBhbmVsUmVmRWwsICdsZWZ0JywgJzAnKTtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShwYW5lbFJlZkVsLCAndG9wJywgJzAnKTtcclxuICAgICAgICAgICAgdGhpcy5nbG9iYWxMaXN0ZW5lciA9IHRoaXMucmVnaXN0ZXJMaXN0ZW5DbGljaygpO1xyXG5cclxuICAgICAgICAgICAgLy8g5qC55o2u5LiK5LiL5paH6K+t6KiA77yM6Ieq5Yqo6LCD5pW06K+t6KiA5YiX6KGo55qE6aG65bqP77yM5bCG5b2T5YmN6K+t6KiA6K6+5Li656ysMeS4qlxyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUxhbmdPcmRlcigpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jb21ib1BhbmVsUmVmLmluc3RhbmNlLml0ZW1zID0gdGhpcy5sYW5ndWFnZXM7XHJcbiAgICAgICAgICAgIHRoaXMuY29tYm9QYW5lbFJlZi5pbnN0YW5jZS5sYW5ndWFnZUlucHV0UmVmID0gdGhpcztcclxuICAgICAgICAgICAgdGhpcy5jb21ib1BhbmVsUmVmLmluc3RhbmNlLmRhdGEgPSB7Li4udGhpcy5kYXRhfTtcclxuICAgICAgICAgICAgdGhpcy5jb21ib1BhbmVsUmVmLmluc3RhbmNlLmN1cnJlbnRJdGVtID0gdGhpcy5jdXJyZW50TGFuZ3VhZ2VJdGVtO1xyXG4gICAgICAgICAgICB0aGlzLmNvbWJvUGFuZWxSZWYuaW5zdGFuY2UuaXRlbUNsaWNrLnN1YnNjcmliZSgoZGF0YTogTGFuZ3VhZ2VEYXRhKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzLmN1cnJlbnRMYW5ndWFnZUl0ZW0gPSBpdGVtO1xyXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5jdXJyZW50TGFuZ3VhZ2UgPSBpdGVtLmNvZGU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSB7Li4uZGF0YX07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGVEcm9wRG93blBhbmVsKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFZhbHVlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLmNvbWJvUGFuZWxSZWYuaW5zdGFuY2UuaGlkZVBhbmVsLnN1YnNjcmliZSggKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlRHJvcERvd25QYW5lbCgpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY29tYm9QYW5lbFJlZi5pbnN0YW5jZS5zaG93UGFuZWwuc3Vic2NyaWJlKCAocGFuZWxJbnM6IExhbmd1YWdlVGV4dFBhbmVsQ29tcG9uZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBwYW5lbElucy5zZXRJbnB1dEZvY3VzKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jb21ib1BhbmVsUmVmLmluc3RhbmNlLnNob3codGhpcyk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmx0cy5zZXRBY3RpdmVQYW5lKHRoaXMpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGlkZURyb3BEb3duUGFuZWwoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRMYW5ndWFnZUl0ZW0oY29kZTogc3RyaW5nKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubGFuZ3VhZ2VzLmZpbmQobCA9PiBsLmNvZGUgPT09IGNvZGUpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQ2xlYXIoKSB7IH1cclxuXHJcbiAgICBvbkNoYW5nZXModmFsPzogYW55KSB7XHJcbiAgICAgICAgdGhpcy5kYXRhW3RoaXMuY3VycmVudExhbmd1YWdlXSA9IHRoaXMudmFsdWU7XHJcbiAgICAgICAgdGhpcy5vbk1vZGVsQ2hhbmdlKHsuLi50aGlzLmRhdGF9KTtcclxuICAgICAgICB0aGlzLm9uTW9kZWxUb3VjaGVkKHsuLi50aGlzLmRhdGF9KTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRWYWx1ZSgpIHtcclxuICAgICAgICBpZiAodGhpcy5kYXRhKSB7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLmRhdGFbdGhpcy5jdXJyZW50TGFuZ3VhZ2VdIHx8ICcnO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSAnJztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMub25DaGFuZ2VzKCk7XHJcbiAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgcmVtb3ZlR2xvYmFsTGlzdGVuZXIoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZ2xvYmFsTGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5nbG9iYWxMaXN0ZW5lcigpO1xyXG4gICAgICAgICAgICB0aGlzLmdsb2JhbExpc3RlbmVyID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBpZnJhbWVFdmVudEhhbmRsZShhY3Rpb246ICdhZGRFdmVudExpc3RlbmVyJyB8ICdyZW1vdmVFdmVudExpc3RlbmVyJywgZm4pIHtcclxuICAgICAgICBjb25zdCBpZnJhbWVzID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdpZnJhbWUnKSk7XHJcbiAgICAgICAgaWYgKGlmcmFtZXMgJiYgaWZyYW1lcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBpZnJhbWUgb2YgaWZyYW1lcykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaWZyYW1lRG9jID0gaWZyYW1lLmNvbnRlbnREb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIGlmIChpZnJhbWVEb2MpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZnJhbWVEb2NbYWN0aW9uXSgnbW91c2Vkb3duJywgZm4pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmcmFtZURvY1thY3Rpb25dKCdtb3VzZXdoZWVsJywgZm4pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmVnaXN0ZXJMaXN0ZW5DbGljaygpIHtcclxuICAgICAgICBjb25zdCByZW1vdmVQYW5lbCA9IChldmVudDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5jb21ib1BhbmVsUmVmKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldHMgPSBbdGhpcy5jb21ib1BhbmVsUmVmLmxvY2F0aW9uLm5hdGl2ZUVsZW1lbnQsIHRoaXMuZWwubmF0aXZlRWxlbWVudF07XHJcbiAgICAgICAgICAgIGlmICh0YXJnZXRzLnNvbWUodCA9PiB0LmNvbnRhaW5zKGV2ZW50LnRhcmdldCkpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuaGlkZURyb3BEb3duUGFuZWwoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgcmVtb3ZlUGFuZWwsIHRydWUpO1xyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V3aGVlbCcsIHJlbW92ZVBhbmVsLCB0cnVlKTtcclxuXHJcblxyXG4gICAgICAgIHRoaXMuaWZyYW1lRXZlbnRIYW5kbGUoJ2FkZEV2ZW50TGlzdGVuZXInLCByZW1vdmVQYW5lbCk7XHJcblxyXG4gICAgICAgIHJldHVybiAoKSA9PiB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgcmVtb3ZlUGFuZWwsIHRydWUpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNld2hlZWwnLCByZW1vdmVQYW5lbCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIHRoaXMuaWZyYW1lRXZlbnRIYW5kbGUoJ3JlbW92ZUV2ZW50TGlzdGVuZXInLCByZW1vdmVQYW5lbCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyByZXR1cm4gdGhpcy5yZW5kZXJlci5saXN0ZW4oJ2RvY3VtZW50JywgJ2NsaWNrJywgKGV2ZW50OiBhbnkpID0+IHtcclxuICAgICAgICAvLyAgICAgaWYgKCF0aGlzLmNvbWJvUGFuZWxSZWYpIHtcclxuICAgICAgICAvLyAgICAgICAgIHJldHVybjtcclxuICAgICAgICAvLyAgICAgfVxyXG5cclxuICAgICAgICAvLyAgICAgY29uc3QgdGFyZ2V0cyA9IFt0aGlzLmNvbWJvUGFuZWxSZWYubG9jYXRpb24ubmF0aXZlRWxlbWVudCwgdGhpcy5lbC5uYXRpdmVFbGVtZW50XTtcclxuICAgICAgICAvLyAgICAgaWYgKHRhcmdldHMuc29tZSh0ID0+IHQuY29udGFpbnMoZXZlbnQudGFyZ2V0KSkpIHtcclxuICAgICAgICAvLyAgICAgICAgIHJldHVybjtcclxuICAgICAgICAvLyAgICAgfVxyXG5cclxuICAgICAgICAvLyAgICAgdGhpcy5oaWRlRHJvcERvd25QYW5lbCgpO1xyXG4gICAgICAgIC8vIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGhpZGVEcm9wRG93blBhbmVsKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmNvbWJvUGFuZWxSZWYgJiYgdGhpcy5jb21ib1BhbmVsUmVmLmluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIC8vIGlmICh0aGlzLmNvbWJvUGFuZWxSZWYuaW5zdGFuY2Uub3BlbmVkKSB7XHJcbiAgICAgICAgICAgIC8vICAgICB0aGlzLmNvbWJvUGFuZWxSZWYuaW5zdGFuY2UuaGlkZSgpO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIHRoaXMuY29tYm9QYW5lbFJlZi5pbnN0YW5jZS5vcGVuZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgY29uc3QgY29tcG9uZW50RWwgPSB0aGlzLmNvbWJvUGFuZWxSZWYubG9jYXRpb24ubmF0aXZlRWxlbWVudDtcclxuICAgICAgICAgICAgaWYgKGNvbXBvbmVudEVsLnBhcmVudE5vZGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudEVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoY29tcG9uZW50RWwpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLnJlbW92ZUdsb2JhbExpc3RlbmVyKCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0LmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jb21ib1BhbmVsUmVmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29tYm9QYW5lbFJlZi5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29tYm9QYW5lbFJlZiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSwgMTAwKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHdyaXRlVmFsdWUob2JqOiBhbnkpOiB2b2lkIHtcclxuICAgICAgICBpZiAob2JqICYmIE9iamVjdC5rZXlzKG9iaikubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YSA9IG9iajtcclxuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IG9ialt0aGlzLmN1cnJlbnRMYW5ndWFnZV07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5kYXRhID0ge307XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSAnJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZWdpc3Rlck9uQ2hhbmdlKGZuOiBhbnkpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLm9uTW9kZWxDaGFuZ2UgPSBmbjtcclxuICAgIH1cclxuICAgIHJlZ2lzdGVyT25Ub3VjaGVkKGZuOiBhbnkpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLm9uTW9kZWxUb3VjaGVkID0gZm47XHJcbiAgICB9XHJcbiAgICBzZXREaXNhYmxlZFN0YXRlPyhpc0Rpc2FibGVkOiBib29sZWFuKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5kaXNhYmxlZCA9IGlzRGlzYWJsZWQ7XHJcbiAgICB9XHJcbn1cclxuIl19