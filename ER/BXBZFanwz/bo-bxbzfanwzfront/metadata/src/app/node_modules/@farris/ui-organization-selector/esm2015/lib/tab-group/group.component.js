/**
 * @fileoverview added by tsickle
 * Generated from: lib/tab-group/group.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ChangeDetectorRef, Component, EventEmitter, Injector, Input, Output, ViewChild } from '@angular/core';
import * as _ from 'lodash-es';
import { noDataImg } from '../../assets/resource';
import { ApiService } from '../../utils/api.service';
import { CommonUtil } from '../../utils/common.tool';
import { FavoritesTool } from '../../utils/favorites.tool';
import { ChangeType } from '../../utils/index.type';
import { StateMgrTool } from '../../utils/state.mgr.tool';
import { tap, switchMap } from 'rxjs/operators';
import { AppendGroupOrgComponent } from '../append-group-org/appendorg.component';
import { FormMessageService, FormLoadingService } from '@farris/command-services';
export class GroupComponent {
    /**
     * @param {?} apiService
     * @param {?} favoritesTool
     * @param {?} stateMgr
     * @param {?} cdr
     * @param {?} injector
     * @param {?} formMessageService
     * @param {?} formLoadingService
     */
    constructor(apiService, favoritesTool, stateMgr, cdr, injector, formMessageService, formLoadingService) {
        this.apiService = apiService;
        this.favoritesTool = favoritesTool;
        this.stateMgr = stateMgr;
        this.cdr = cdr;
        this.injector = injector;
        this.formMessageService = formMessageService;
        this.formLoadingService = formLoadingService;
        this.primaryField = 'orgId';
        this.groupChange = new EventEmitter();
        this.groupIdField = 'id';
        this.userIdField = 'userId';
        this.selections = [];
        this.noDataImg = noDataImg;
        this.allChecked = false;
        this.items = [];
        this.favoritesList = [];
        this.groupData = { public: [], personal: [] };
        this.personnelList = [];
        this.groupPersonnels = [];
        this.publicVisible = true;
        this.personalVisible = true;
        this.publicToken = 'public';
        this.personalToken = 'personal';
        this.showGroupOrgDialog = false;
        this.currentGroupType = 'public';
        this.allIndexId = CommonUtil.newGuid();
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        if (this.enableFavorites) {
            this.favoritesSub.unsubscribe();
        }
        this.selectionsSub.unsubscribe();
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        if (this.enableFavorites) {
            this.favoritesSub = this.favoritesTool.favoritesSubject.subscribe((/**
             * @param {?} data
             * @return {?}
             */
            data => {
                this.favoritesList = data;
                this.setFavorites();
            }));
        }
        this.selectionsSub = this.stateMgr.selectionsSubject.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        data => {
            if (data.changeType === ChangeType.ValueChanged) {
                this.selections = _.cloneDeep(data.value);
                this.toggleChecked();
            }
            else if (data.changeType === ChangeType.Remove) {
                this.unSelectLine(data.value);
            }
            else if (data.changeType === ChangeType.Append) {
                this.selectLine(data.value);
            }
            this.cdr.detectChanges();
        }));
        this.getGroupList();
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
    }
    /**
     * @return {?}
     */
    assembleData() {
        this.getGroupList();
    }
    // 变更群组内的组织
    /**
     * @return {?}
     */
    updateGroup() {
        /** @type {?} */
        const addList = [];
        /** @type {?} */
        const primaryIds = this.items.map((/**
         * @param {?} item
         * @return {?}
         */
        item => { return item[this.primaryField]; })).join();
        this.appendOrg.currentOrgs.forEach((/**
         * @param {?} org
         * @return {?}
         */
        org => {
            if (primaryIds.indexOf(org[this.primaryField]) === -1) {
                addList.push(org[this.primaryField]);
            }
        }));
        /** @type {?} */
        const addOrgsInCurrentGroup$ = this.apiService.saveGroup({
            groupId: this.selectedGroupId,
            addIds: addList,
            deleteIds: [],
            changeType: Number(3)
        });
        addOrgsInCurrentGroup$.pipe(tap((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            if (data) {
                console.log('已为当前群组追加新的组织成员！');
                this.getOrgsByGroup({ id: this.selectedGroupId }, this.currentGroupType);
                this.toggleGroupOrgDialog(false);
            }
        }))).subscribe();
    }
    // 删除群组
    /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    deleteGroup(e, item) {
        this.formMessageService.confirm("是否删除此群组？").pipe(switchMap((/**
         * @param {?} result
         * @return {?}
         */
        (result) => {
            if (!!result) {
                if (item[this.groupIdField] === this.selectedGroupId) {
                    this.selectedGroupId = null;
                    this.currentGroupType = this.publicToken;
                }
                /** @type {?} */
                const deleteGroup$ = this.apiService.saveGroup({
                    groupId: item[this.groupIdField],
                    changeType: Number(4)
                });
                return deleteGroup$.pipe(tap((/**
                 * @param {?} data
                 * @return {?}
                 */
                (data) => {
                    if (data) {
                        console.log('群组删除成功！');
                        this.getGroupList();
                        e.stopPropagation();
                        e.cancelBubble = true;
                    }
                })));
            }
            else {
                return;
            }
        }))).subscribe();
    }
    // 变更群组基本信息（名称、描述）
    /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    editGroup(e, item) {
        this.selectedGroupId = item[this.groupIdField];
        this.groupChange.next(item);
        e.stopPropagation();
        e.cancelBubble = true;
    }
    // 删除群组内的组织
    /**
     * @param {?} e
     * @param {?} data
     * @return {?}
     */
    removeOrg(e, data) {
        this.formMessageService.confirm("是否将此组织移出当前群组？").pipe(switchMap((/**
         * @param {?} result
         * @return {?}
         */
        (result) => {
            if (!!result) {
                /** @type {?} */
                const deleteOrg$ = this.apiService.saveGroup({
                    groupId: this.selectedGroupId,
                    addIds: [],
                    deleteIds: [data[this.primaryField]],
                    changeType: Number(3)
                });
                return deleteOrg$.pipe(tap((/**
                 * @param {?} data
                 * @return {?}
                 */
                (data) => {
                    if (data) {
                        console.log('群组内组织删除成功！');
                        this.getOrgsByGroup({ id: this.selectedGroupId }, this.currentGroupType);
                        e.stopPropagation();
                        e.cancelBubble = true;
                    }
                })));
            }
            else {
                return;
            }
        }))).subscribe();
    }
    // 设置群组内组织的勾选状态
    /**
     * @private
     * @param {?} data
     * @param {?} checked
     * @return {?}
     */
    setChecked(data, checked) {
        /** @type {?} */
        const itemIndex = CommonUtil.findIndex(data[this.primaryField], this.primaryField, this.items);
        if (itemIndex > -1) {
            this.items[itemIndex].checked = checked;
        }
    }
    // 设置群组内组织的收藏状态
    /**
     * @private
     * @return {?}
     */
    setFavorites() {
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            if (CommonUtil.findIndex(item[this.primaryField], this.primaryField, this.favoritesList) !== -1) {
                item.inFavorites = true;
            }
            else {
                item.inFavorites = false;
            }
        }));
    }
    // 通过弹窗增加群组内的组织
    /**
     * @param {?} show
     * @param {?=} groupType
     * @return {?}
     */
    toggleGroupOrgDialog(show, groupType = this.personalToken) {
        if (groupType === this.personalToken) {
            this.showGroupOrgDialog = show;
        }
    }
    // 获取某个群组内的所有组织
    /**
     * @param {?} item
     * @param {?=} groupType
     * @return {?}
     */
    getOrgsByGroup(item, groupType = this.publicToken) {
        this.formLoadingService.show();
        this.currentGroupType = groupType;
        this.allChecked = false;
        this.selectedGroupId = item[this.groupIdField];
        // const helpExtend = window && (window as any).orgHelpExtend;
        // helpExtend.getDataByGroupId(item[this.groupIdField], this.absOrgType).then(data => {
        // });
        this.apiService.getGroupMembers(item[this.groupIdField], this.absOrgType).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            this.items = data ? data : [];
            this.groupData.personal.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                if (item[this.groupIdField] === this.selectedGroupId && item.total !== this.items.length) {
                    item.total = this.items.length;
                }
            }));
            this.items.forEach((/**
             * @param {?} it
             * @return {?}
             */
            it => {
                if (CommonUtil.findIndex(it[this.primaryField], this.primaryField, this.favoritesList) !== -1) {
                    it.inFavorites = true;
                }
                else {
                    it.inFavorites = false;
                }
                it.indexId = Math.random().toString(16).substring(2);
                // it.displayName = !!this.showUserCode ? ('[' + it.code + ']' + it.name) : it.name;
            }));
            this.toggleChecked();
            this.setFavorites();
            this.formLoadingService.hide();
        }));
    }
    // 获取组织群组列表
    /**
     * @return {?}
     */
    getGroupList() {
        this.apiService.getOrgGroups(this.absOrgType).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            /** @type {?} */
            const resPublic = data && data.publicGroup;
            /** @type {?} */
            const resPersonal = data && data.privateGroup;
            this.groupData.public = resPublic ? resPublic : [];
            this.groupData.personal = resPersonal ? resPersonal : [];
            /** @type {?} */
            const firstPublicGroup = resPublic[0] && resPublic[0][this.groupIdField];
            /** @type {?} */
            const firstPersonalGroup = resPersonal[0] && resPersonal[0][this.groupIdField];
            this.selectedGroupId = this.selectedGroupId ? this.selectedGroupId : firstPublicGroup;
            this.selectedGroupId = this.selectedGroupId ? this.selectedGroupId : firstPersonalGroup;
            if (!!this.selectedGroupId) {
                if (this.groupData.public.findIndex((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => item[this.groupIdField] === this.selectedGroupId)) !== -1) {
                    this.currentGroupType = this.publicToken;
                }
                else if (this.groupData.personal.findIndex((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => item[this.groupIdField] === this.selectedGroupId)) !== -1) {
                    this.currentGroupType = this.personalToken;
                }
                this.getOrgsByGroup({ id: this.selectedGroupId }, this.currentGroupType);
            }
        }));
    }
    // 收藏或者取消收藏组织
    /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    toggleFavorites(e, item) {
        this.favoritesTool.toggleFavorites(e, item);
    }
    // 切换公共群组或者个人群组的收折状态
    /**
     * @param {?} e
     * @param {?} type
     * @return {?}
     */
    toggleVisible(e, type) {
        if (type === this.publicToken) {
            this.publicVisible = !this.publicVisible;
        }
        else if (type === this.personalToken) {
            this.personalVisible = !this.personalVisible;
        }
        e.stopPropagation();
        e.cancelBubble = true;
    }
    /**
     * @param {?} e
     * @return {?}
     */
    toggleAll(e) {
        if (!this.allChecked) {
            this.checkAll();
        }
        else {
            this.unCheckAll();
        }
        e.preventDefault();
    }
    /**
     * @param {?} data
     * @param {?} e
     * @return {?}
     */
    toggleOne(data, e) {
        if (data.checked) {
            if (this.multiSelect) {
                this.emitSelections(data, ChangeType.Remove);
            }
            else {
                this.emitSelections([]);
            }
        }
        else {
            if (this.multiSelect) {
                this.emitSelections(data, ChangeType.Append);
            }
            else {
                this.emitSelections(new Array(data));
            }
        }
        e.preventDefault();
    }
    /**
     * 全选后处理
     * @return {?}
     */
    checkAll() {
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            if (CommonUtil.findIndex(item[this.primaryField], this.primaryField, this.selections) === -1) {
                this.emitSelections(item, ChangeType.Append);
            }
        }));
    }
    /**
     * 全部取消
     * @return {?} void
     */
    unCheckAll() {
        /** @type {?} */
        const checkeds = this.items.filter((/**
         * @param {?} item
         * @return {?}
         */
        item => item.checked));
        checkeds.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            this.emitSelections(item, ChangeType.Remove);
        }));
    }
    /**
     * 当前行选中
     * @param {?} data 当前行的数据（）
     * @return {?}
     */
    selectLine(data) {
        if (this.multiSelect) {
            this._insertOneIntoSelections(data);
        }
        else {
            this.selections = [];
            this.items.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                if (item.checked) {
                    item.checked = false;
                }
            }));
            this._insertOneIntoSelections(data);
        }
        if (this.isAllChecked()) {
            this.allChecked = true;
        }
    }
    /**
     * 单选取消选中
     * @param {?} data 取消选中行
     * @return {?}
     */
    unSelectLine(data) {
        /** @type {?} */
        const index = CommonUtil.findIndex(data[this.primaryField], this.primaryField, this.selections);
        if (index > -1) {
            this.selections.splice(index, 1);
        }
        this.setChecked(data, false);
        if (this.isAllChecked()) {
            this.allChecked = true;
        }
        else {
            this.allChecked = false;
        }
    }
    /**
     * @private
     * @param {?} selections
     * @param {?=} changeType
     * @return {?}
     */
    emitSelections(selections, changeType = ChangeType.ValueChanged) {
        this.stateMgr.emitSelections(selections, changeType);
    }
    /**
     * 选中并插入当前行数据到右侧
     * @param {?} data 当前行的数据
     * @return {?}
     */
    _insertOneIntoSelections(data) {
        // 如果当前数据已经移入右侧数据，则返回。
        if (CommonUtil.findIndex(data[this.primaryField], this.primaryField, this.selections) > -1) {
            return;
        }
        this.setChecked(data, true);
        this.selections.push(data);
        this.selections = this.selections.slice();
    }
    /**
     * 翻页检查：人员展示区的勾选状态与已选人员区是否对应
     * @return {?}
     */
    toggleChecked() {
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            if (CommonUtil.findIndex(item[this.primaryField], this.primaryField, this.selections) > -1) {
                item.checked = true;
            }
            else {
                item.checked = false;
            }
        }));
        if (this.isAllChecked()) {
            this.allChecked = true;
        }
        else {
            this.allChecked = false;
        }
    }
    /**
     * @private
     * @return {?}
     */
    isAllChecked() {
        /** @type {?} */
        let count = 0;
        /** @type {?} */
        let allChecked = false;
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            this.selections.forEach((/**
             * @param {?} selection
             * @return {?}
             */
            selection => {
                if (item[this.primaryField] === selection[this.primaryField]) {
                    count += 1;
                }
            }));
        }));
        if (this.items.length === count && count > 0) {
            allChecked = true;
        }
        return allChecked;
    }
    /**
     * @param {?} index
     * @param {?} item
     * @return {?}
     */
    trackByFn(index, item) {
        return index;
    }
}
GroupComponent.decorators = [
    { type: Component, args: [{
                selector: 'lib-group',
                template: "<div class=\"candidate flex-left\">\r\n    <perfect-scrollbar *ngIf=\"groupData.personal.length || groupData.public.length\">\r\n        <div class=\"h-100\">\r\n            <div class=\"group_blank_15\"></div>\r\n            <div class=\"group-top-tree\">\r\n                <span class=\"f-icon\" [class.f-icon-minus-outline]=\"publicVisible\"\r\n                    [class.f-icon-plus-outline]=\"!publicVisible\" (click)=\"toggleVisible($event, publicToken)\"></span>\r\n                \u516C\u5171\u7FA4\u7EC4\r\n            </div>\r\n            <ng-template [ngIf]=\"publicVisible\">\r\n                <div class=\"s-opCell-f\" [class.active]=\"selectedGroupId === item[groupIdField]\" title=\"\"\r\n                    *ngFor=\"let item of groupData.public\" (click)=\"getOrgsByGroup(item, publicToken)\">\r\n                    <div class=\"s-opCell-f-group\">\r\n                        <!--\r\n                        <farris-avatar [avatarWidth]=\"32\" [avatarHeight]=\"32\" [cover]=\"item['avatar']\" [readonly]=\"true\"\r\n                            class=\"s-opCell-a\">\r\n                        </farris-avatar>\r\n                        -->\r\n                        <div class=\"s-opCell-d\">\r\n                            <p class=\"s-opCell-d1\">{{item.title}} {{item.total}}\u4E2A\u7EC4\u7EC7</p>\r\n                            <p class=\"s-opCell-d2\" title=\"{{item.description}}\">{{item.description}}</p>\r\n                        </div>\r\n                    </div>\r\n                    <!-- <span class=\"span-find-details\">\u67E5\u770B\u8BE6\u60C5</span> -->\r\n                </div>\r\n            </ng-template>\r\n            <div class=\"group_blank_15\"></div>\r\n            <div class=\"group-top-tree\">\r\n                <span class=\"f-icon\" [class.f-icon-minus-outline]=\"personalVisible\"\r\n                    [class.f-icon-plus-outline]=\"!personalVisible\"\r\n                    (click)=\"toggleVisible($event, personalToken)\"></span>\r\n                \u4E2A\u4EBA\u7FA4\u7EC4\r\n            </div>\r\n            <ng-template [ngIf]=\"personalVisible\">\r\n                <div class=\"s-opCell-f\" [class.active]=\"selectedGroupId === item[groupIdField]\"\r\n                    *ngFor=\"let item of groupData.personal\" (click)=\"getOrgsByGroup(item, personalToken)\">\r\n                    <div class=\"s-opCell-f-group\">\r\n                        <!--\r\n                        <farris-avatar [avatarWidth]=\"32\" [avatarHeight]=\"32\" [cover]=\"item['avatar']\" [readonly]=\"true\"\r\n                            class=\"s-opCell-a\">\r\n                        </farris-avatar>\r\n                        -->\r\n                        <div class=\"s-opCell-d\">\r\n                            <p class=\"s-opCell-d1\">{{item.title}} {{item.total}}\u4E2A\u7EC4\u7EC7</p>\r\n                            <p class=\"s-opCell-d2\" title=\"{{item.description}}\">{{item.description}}</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"s-opCell-edit\">\r\n                        <span class=\"f-icon f-icon-new-edit\" (click)=\"editGroup($event, item)\"></span>\r\n                        <span class=\"f-icon f-icon-minus-circle default-light-color\"\r\n                            (click)=\"deleteGroup($event, item)\"></span>\r\n                    </div>\r\n                </div>\r\n            </ng-template>\r\n        </div>\r\n    </perfect-scrollbar>\r\n    <div *ngIf=\"groupData.personal.length === 0 && groupData.public.length === 0\"\r\n        [ngStyle]=\"{'background-image': noDataImg}\" class=\"fp-candidate-nodata\">\r\n        \u6682\u65E0\u6570\u636E</div>\r\n</div>\r\n<div class=\"candidate flex-right\">\r\n    <div class=\"candidate-title\" *ngIf=\"groupData?.public.length > 0 || groupData?.personal.length > 0\">\r\n        <div class=\"custom-control custom-checkbox mb-2\" *ngIf=\"multiSelect\">\r\n            <input class=\"custom-control-input\" [id]=\"allIndexId\" type=\"checkbox\" [(ngModel)]=\"allChecked\">\r\n            <label class=\"custom-control-label\" [for]=\"allIndexId\" (click)=\"toggleAll($event)\">\u5168\u9009</label>\r\n        </div>\r\n        <div *ngIf=\"!multiSelect\"></div>\r\n        <div (click)=\"toggleGroupOrgDialog(true, currentGroupType)\"\r\n            [ngStyle]=\"{'color': currentGroupType === publicToken ? '#d8d8d8' : '#2a87ff', 'cursor': currentGroupType === publicToken ? 'not-allowed' : 'pointer'}\">\r\n            <span class=\"f-icon f-icon-department\"></span>\r\n            \u6DFB\u52A0\u7EC4\u7EC7\r\n        </div>\r\n    </div>\r\n    <perfect-scrollbar *ngIf=\"items.length!==0\">\r\n        <div class=\"candidate-content\">\r\n            <div *ngFor=\"let data of items; let i = index;trackBy: trackByFn\" class=\"s-selectedPerson\">\r\n                <div class=\"custom-control custom-checkbox mb-2\">\r\n                    <input class=\"custom-control-input\" [ngModel]=\"data.checked\" [id]=\"data.indexId\" type=\"checkbox\">\r\n                    <label class=\"custom-control-label\" [for]=\"data.indexId\" (click)=\"toggleOne(data, $event)\">\r\n                        <div style=\"display: flex; height: 32px; margin: -21px 0 0 24px;\">\r\n                            <!-- <farris-avatar [avatarWidth]=\"32\" [avatarHeight]=\"32\" [cover]=\"data.ext1\" [readonly]=\"true\">\r\n                            </farris-avatar> -->\r\n                            <div style=\"margin-left: 11px; margin-top: -2px;  padding-right: 10px; overflow: hidden;\">\r\n                                <p class=\"candidate-content-title\" title=\"{{data.name}}\">\r\n                                    {{data.name}}</p>\r\n                                <p class=\"candidate-content-orgpath\" title=\"{{data.orgAllPath}}\">\r\n                                    {{data.orgAllPath}}</p>\r\n                            </div>\r\n                        </div>\r\n                    </label>\r\n                </div>\r\n                <span class=\"f-icon f-icon-minus-circle deleteBtn\" *ngIf=\"currentGroupType===personalToken\" (click)=\"removeOrg($event, data)\"></span>\r\n                <span class=\"f-icon f-icon-star\" *ngIf=\"enableFavorites\" [class.default-light-color]=\"data.inFavorites\"\r\n                    [class.default-dark-color]=\"!data.inFavorites\" (click)=\"toggleFavorites($event, data)\"></span>\r\n            </div>\r\n\r\n        </div>\r\n    </perfect-scrollbar>\r\n    <div *ngIf=\"items.length===0\" [ngStyle]=\"{'background-image': noDataImg}\" class=\"fp-candidate-nodata\">\r\n        \u6682\u65E0\u6570\u636E</div>\r\n</div>\r\n\r\n<!--\u7FA4\u7EC4\u5F39\u7A97\u9009\u7EC4\u7EC7--->\r\n<div class=\"s-group-dialog-container\" *ngIf=\"showGroupOrgDialog\">\r\n    <div class=\"s-org-group-title\">\r\n        <span class=\"f-icon f-sidebar-close\" (click)=\"toggleGroupOrgDialog(false)\"></span>\u6DFB\u52A0\u7EC4\u7EC7\r\n    </div>\r\n    <append-group-org #appendOrg style=\"margin-top: 15px;\"\r\n        [primaryField]=\"primaryField\" [enableHierarchicalLoading]=\"enableHierarchicalLoading\"\r\n        [notGetStopOrg]=\"notGetStopOrg\" [layer]=\"layer\" [multiSelect]=\"multiSelect\" [absOrgType]=\"absOrgType\"\r\n        [cascadeCheck]=\"cascadeCheck\" [cascadeDown]=\"cascadeDown\" [cascadeUp]=\"cascadeUp\" [keepSelect]=\"keepSelect\"\r\n        [showCheckAll]=\"showCheckAll\" [selectedLimit]=\"selectedLimit\">\r\n    </append-group-org>\r\n    <div class=\"s-org-group-footer\">\r\n        <input type=\"button\" class=\"btn btn-primary fr\" style=\"width: 100px;\" value=\"\u786E\u5B9A\"\r\n            (click)=\"updateGroup()\" />\r\n        <input type=\"button\" class=\"btn btn-secondary fr mr-3\" value=\"\u53D6\u6D88\" (click)=\"toggleGroupOrgDialog(false)\" />\r\n    </div>\r\n</div>\r\n<div class=\"s-help-bg\" *ngIf=\"showGroupOrgDialog\"></div>",
                styles: [":host{display:-webkit-box;display:flex;height:100%;-webkit-box-flex:1;flex:1;overflow:hidden;position:static}.candidate{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;position:relative;border-right:1px solid #dee1ea;overflow:hidden}.candidate.flex-left{-webkit-box-flex:0;flex:0 0 42%}.candidate.flex-right{-webkit-box-flex:0;flex:0 0 58%}.candidate .s-opCell-f{display:-webkit-box;display:flex;height:40px;border-radius:6px;padding-left:10px;-webkit-box-pack:justify;justify-content:space-between;margin:1px 5px 0;cursor:pointer}.candidate .s-opCell-f .s-opCell-f-group{display:-webkit-box;display:flex;-webkit-box-flex:1;flex:1}.candidate .s-opCell-f.active,.candidate .s-opCell-f:hover{background-color:#eef5ff}.candidate .s-opCell-f:hover .s-opCell-edit{visibility:visible}.candidate .s-opCell-a{margin-top:4px;margin-left:6px}.candidate .s-opCell-d{-webkit-box-flex:1;flex:1;overflow:hidden;margin:1.5px 10px 0}.candidate .s-opCell-d1{line-height:20px;font-size:13px;height:20px;color:#2d2f33;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;margin:0;padding:0;max-width:210px}.candidate .s-opCell-d2{color:#a8adb8;font-size:12px;line-height:14px;height:14px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;margin:0;padding:0;max-width:210px}.candidate .s-opCell-f .f-avatar .f-avatar-image{display:block!important}.candidate .fp-candidate-nodata{width:100px;height:100px;text-align:center;background-repeat:no-repeat;background-size:contain;color:#b4bccc;padding-top:110px;position:absolute;left:50%;top:50%;margin:-70px 0 0 -50px}.candidate .s-opCell-f:hover .span-find-details{display:block}.candidate .s-opCell-f .span-find-details{margin-right:5px;line-height:40px;color:#2a87ff;width:60px;display:none}.candidate .s-opCell-f .s-opCell-edit{line-height:40px;width:60px;text-align:center;visibility:hidden}.candidate .s-opCell-f .s-opCell-edit .f-icon-new-edit{margin-right:10px;color:#949aa6}.candidate .s-opCell-f .s-opCell-edit .f-icon-minus-circle{color:#f46160}.candidate .group-top-tree{margin:0 15px 10px;font-size:13px}.candidate .group_blank_15{width:100%;height:15px}.candidate .group-top-tree .f-icon{color:#d5d4d7;margin-right:8px}.candidate .group-top-tree .k-checkbox-label::after,.candidate .group-top-tree .k-checkbox-label::before{top:1px}.candidate .candidate-content{clear:both}.candidate .s-selectedPerson:first-child{margin-top:0}.candidate .s-selectedPerson{min-width:240px;float:left;width:calc(100% - 6px);position:relative;height:40px;padding:5px 12px;margin:0 3px 1px}.candidate .s-selectedPerson:hover{background:#eef5ff;border-radius:5px}.candidate .f-icon{font-size:14px}.candidate .s-selectedPerson .deleteBtn{font-size:14px;color:#f46160;cursor:pointer;position:absolute;right:60px;top:13px;visibility:hidden}.candidate .s-selectedPerson:hover .deleteBtn{visibility:visible}.candidate .s-selectedPerson .f-icon-star{position:absolute;top:13px;right:15px;font-size:14px}.candidate .s-selectedPerson .default-light-color{color:#f7b500}.candidate .s-selectedPerson .default-dark-color{color:#d8dce6}.candidate .k-checkbox-label::before{top:10px;font-size:16px;width:14px;height:14px}.candidate .k-checkbox-label::after{top:10px;font-size:16px;width:15px;height:14px}.candidate .candidate-content-title{margin:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:13px}.candidate .candidate-content-orgpath{margin:0;font-size:12px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;color:#c7ccd7}.candidate .candidate-title{display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between}.candidate .candidate-title .custom-control{margin:10px 0 0 15px;line-height:35px}.candidate .s-selectedPerson .custom-control-label::before{top:8px}.candidate .candidate-title .title-clearall{margin:5px 15px 0 0;color:#2a87ff;cursor:pointer;line-height:35px}.candidate .candidate-title div{line-height:35px;margin:9px 10px 0 0;color:#2a87ff;cursor:pointer}.candidate .saved-group{position:absolute;width:111px;height:26px;line-height:26px;background:#eaedf2;border-radius:5px;text-align:center;font-size:13px;bottom:10px;left:13px;z-index:999;color:#909ba2;cursor:pointer}.candidate .saved-group:hover{color:#2a87ff;background:#eaf4ff}.candidate .saved-group:hover .f-icon{color:#2a87ff}.candidate .saved-group .f-icon{color:#909ba2;margin-right:5px;cursor:pointer;font-size:14px}.s-group-dialog-container{height:520px;width:700px;position:fixed;left:50%;top:50%;margin:-260px 0 0 -350px;background:#fff;padding:15px 20px;border-radius:10px;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;z-index:9999}.s-group-dialog-container .s-org-group-footer{margin-top:15px}.s-help-bg{background:rgb(0 0 0 / 15%);position:fixed;left:0;top:0;right:0;bottom:0;z-index:9997}.s-group-dialog-container .s-org-group-title{font-size:17px;line-height:24px;color:#2d2f33;font-weight:600}.s-group-dialog-container .s-org-group-title .f-icon{float:right;font-size:20px;color:#878d99;margin-top:3px;cursor:pointer}.s-group-dialog-container .s-org-group-footer .fr{float:right;height:32px}"]
            }] }
];
/** @nocollapse */
GroupComponent.ctorParameters = () => [
    { type: ApiService },
    { type: FavoritesTool },
    { type: StateMgrTool },
    { type: ChangeDetectorRef },
    { type: Injector },
    { type: FormMessageService },
    { type: FormLoadingService }
];
GroupComponent.propDecorators = {
    appendOrg: [{ type: ViewChild, args: ['appendOrg',] }],
    primaryField: [{ type: Input }],
    multiSelect: [{ type: Input }],
    absOrgType: [{ type: Input }],
    busNum: [{ type: Input }],
    enableFavorites: [{ type: Input }],
    notGetStopOrg: [{ type: Input }],
    groupApiUrl: [{ type: Input }],
    enableHierarchicalLoading: [{ type: Input }],
    cascadeCheck: [{ type: Input }],
    cascadeDown: [{ type: Input }],
    cascadeUp: [{ type: Input }],
    keepSelect: [{ type: Input }],
    layer: [{ type: Input }],
    selectedLimit: [{ type: Input }],
    showCheckAll: [{ type: Input }],
    groupChange: [{ type: Output }]
};
if (false) {
    /** @type {?} */
    GroupComponent.prototype.appendOrg;
    /** @type {?} */
    GroupComponent.prototype.primaryField;
    /** @type {?} */
    GroupComponent.prototype.multiSelect;
    /** @type {?} */
    GroupComponent.prototype.absOrgType;
    /** @type {?} */
    GroupComponent.prototype.busNum;
    /** @type {?} */
    GroupComponent.prototype.enableFavorites;
    /** @type {?} */
    GroupComponent.prototype.notGetStopOrg;
    /** @type {?} */
    GroupComponent.prototype.groupApiUrl;
    /** @type {?} */
    GroupComponent.prototype.enableHierarchicalLoading;
    /** @type {?} */
    GroupComponent.prototype.cascadeCheck;
    /** @type {?} */
    GroupComponent.prototype.cascadeDown;
    /** @type {?} */
    GroupComponent.prototype.cascadeUp;
    /** @type {?} */
    GroupComponent.prototype.keepSelect;
    /** @type {?} */
    GroupComponent.prototype.layer;
    /** @type {?} */
    GroupComponent.prototype.selectedLimit;
    /** @type {?} */
    GroupComponent.prototype.showCheckAll;
    /** @type {?} */
    GroupComponent.prototype.groupChange;
    /** @type {?} */
    GroupComponent.prototype.groupIdField;
    /** @type {?} */
    GroupComponent.prototype.userIdField;
    /** @type {?} */
    GroupComponent.prototype.selections;
    /** @type {?} */
    GroupComponent.prototype.noDataImg;
    /** @type {?} */
    GroupComponent.prototype.allChecked;
    /** @type {?} */
    GroupComponent.prototype.items;
    /** @type {?} */
    GroupComponent.prototype.favoritesList;
    /** @type {?} */
    GroupComponent.prototype.groupData;
    /** @type {?} */
    GroupComponent.prototype.personnelList;
    /** @type {?} */
    GroupComponent.prototype.groupPersonnels;
    /** @type {?} */
    GroupComponent.prototype.publicVisible;
    /** @type {?} */
    GroupComponent.prototype.personalVisible;
    /** @type {?} */
    GroupComponent.prototype.publicToken;
    /** @type {?} */
    GroupComponent.prototype.personalToken;
    /** @type {?} */
    GroupComponent.prototype.selectedGroupId;
    /** @type {?} */
    GroupComponent.prototype.allIndexId;
    /** @type {?} */
    GroupComponent.prototype.showGroupOrgDialog;
    /** @type {?} */
    GroupComponent.prototype.currentGroupType;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.selectionsSub;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.favoritesSub;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.apiService;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.favoritesTool;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.stateMgr;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.cdr;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.formMessageService;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.formLoadingService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3JvdXAuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1vcmdhbml6YXRpb24tc2VsZWN0b3IvIiwic291cmNlcyI6WyJsaWIvdGFiLWdyb3VwL2dyb3VwLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBaUIsaUJBQWlCLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBVSxRQUFRLEVBQUUsS0FBSyxFQUErQixNQUFNLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ25LLE9BQU8sS0FBSyxDQUFDLE1BQU0sV0FBVyxDQUFDO0FBRS9CLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUNsRCxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDckQsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBQ3JELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUMzRCxPQUFPLEVBQUUsVUFBVSxFQUFvQixNQUFNLHdCQUF3QixDQUFDO0FBQ3RFLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUMxRCxPQUFPLEVBQUUsR0FBRyxFQUFFLFNBQVMsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ2hELE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLHlDQUF5QyxDQUFDO0FBQ2xGLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxrQkFBa0IsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBT2xGLE1BQU0sT0FBTyxjQUFjOzs7Ozs7Ozs7O0lBeUN2QixZQUNZLFVBQXNCLEVBQ3RCLGFBQTRCLEVBQzVCLFFBQXNCLEVBQ3RCLEdBQXNCLEVBQ3RCLFFBQWtCLEVBQ2xCLGtCQUFzQyxFQUN0QyxrQkFBc0M7UUFOdEMsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQUN0QixrQkFBYSxHQUFiLGFBQWEsQ0FBZTtRQUM1QixhQUFRLEdBQVIsUUFBUSxDQUFjO1FBQ3RCLFFBQUcsR0FBSCxHQUFHLENBQW1CO1FBQ3RCLGFBQVEsR0FBUixRQUFRLENBQVU7UUFDbEIsdUJBQWtCLEdBQWxCLGtCQUFrQixDQUFvQjtRQUN0Qyx1QkFBa0IsR0FBbEIsa0JBQWtCLENBQW9CO1FBN0N6QyxpQkFBWSxHQUFHLE9BQU8sQ0FBQztRQWV0QixnQkFBVyxHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7UUFFaEQsaUJBQVksR0FBRyxJQUFJLENBQUM7UUFDcEIsZ0JBQVcsR0FBRyxRQUFRLENBQUM7UUFDdkIsZUFBVSxHQUFVLEVBQUUsQ0FBQztRQUN2QixjQUFTLEdBQUcsU0FBUyxDQUFDO1FBQ3RCLGVBQVUsR0FBRyxLQUFLLENBQUM7UUFDbkIsVUFBSyxHQUFHLEVBQUUsQ0FBQztRQUNYLGtCQUFhLEdBQUcsRUFBRSxDQUFDO1FBQ25CLGNBQVMsR0FBVSxFQUFFLE1BQU0sRUFBRSxFQUFFLEVBQUUsUUFBUSxFQUFFLEVBQUUsRUFBRSxDQUFDO1FBQ2hELGtCQUFhLEdBQUcsRUFBRSxDQUFDO1FBQ25CLG9CQUFlLEdBQUcsRUFBRSxDQUFDO1FBQ3JCLGtCQUFhLEdBQUcsSUFBSSxDQUFDO1FBQ3JCLG9CQUFlLEdBQUcsSUFBSSxDQUFDO1FBQ3ZCLGdCQUFXLEdBQUcsUUFBUSxDQUFDO1FBQ3ZCLGtCQUFhLEdBQUcsVUFBVSxDQUFDO1FBRzNCLHVCQUFrQixHQUFHLEtBQUssQ0FBQztRQUMzQixxQkFBZ0IsR0FBRyxRQUFRLENBQUM7UUFheEIsSUFBSSxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUMsT0FBTyxFQUFFLENBQUM7SUFDM0MsQ0FBQzs7OztJQUVELFdBQVc7UUFDUCxJQUFJLElBQUksQ0FBQyxlQUFlLEVBQUU7WUFDdEIsSUFBSSxDQUFDLFlBQVksQ0FBQyxXQUFXLEVBQUUsQ0FBQztTQUNuQztRQUNELElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDckMsQ0FBQzs7OztJQUVELFFBQVE7UUFDSixJQUFJLElBQUksQ0FBQyxlQUFlLEVBQUU7WUFDdEIsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLGdCQUFnQixDQUFDLFNBQVM7Ozs7WUFBQyxJQUFJLENBQUMsRUFBRTtnQkFDckUsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUM7Z0JBQzFCLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQztZQUN4QixDQUFDLEVBQUMsQ0FBQztTQUNOO1FBQ0QsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLGlCQUFpQixDQUFDLFNBQVM7Ozs7UUFBQyxJQUFJLENBQUMsRUFBRTtZQUNsRSxJQUFJLElBQUksQ0FBQyxVQUFVLEtBQUssVUFBVSxDQUFDLFlBQVksRUFBRTtnQkFDN0MsSUFBSSxDQUFDLFVBQVUsR0FBRyxDQUFDLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDMUMsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO2FBQ3hCO2lCQUFNLElBQUksSUFBSSxDQUFDLFVBQVUsS0FBSyxVQUFVLENBQUMsTUFBTSxFQUFFO2dCQUM5QyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQzthQUNqQztpQkFBTSxJQUFJLElBQUksQ0FBQyxVQUFVLEtBQUssVUFBVSxDQUFDLE1BQU0sRUFBRTtnQkFDOUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7YUFDL0I7WUFDRCxJQUFJLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQzdCLENBQUMsRUFBQyxDQUFDO1FBQ0gsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO0lBQ3hCLENBQUM7Ozs7SUFFRCxlQUFlO0lBRWYsQ0FBQzs7OztJQUVELFlBQVk7UUFDUixJQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7SUFDeEIsQ0FBQzs7Ozs7SUFHRCxXQUFXOztjQUNELE9BQU8sR0FBVSxFQUFFOztjQUNuQixVQUFVLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHOzs7O1FBQUMsSUFBSSxDQUFDLEVBQUUsR0FBRyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUEsQ0FBQSxDQUFDLEVBQUMsQ0FBQyxJQUFJLEVBQUU7UUFDbkYsSUFBSSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsT0FBTzs7OztRQUFDLEdBQUcsQ0FBQyxFQUFFO1lBQ3JDLElBQUcsVUFBVSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUU7Z0JBQ2xELE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDO2FBQ3hDO1FBQ0wsQ0FBQyxFQUFDLENBQUM7O2NBQ0csc0JBQXNCLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUM7WUFDckQsT0FBTyxFQUFFLElBQUksQ0FBQyxlQUFlO1lBQzdCLE1BQU0sRUFBRSxPQUFPO1lBQ2YsU0FBUyxFQUFFLEVBQUU7WUFDYixVQUFVLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQztTQUN4QixDQUFDO1FBQ0Ysc0JBQXNCLENBQUMsSUFBSSxDQUN2QixHQUFHOzs7O1FBQ0MsQ0FBQyxJQUFJLEVBQUUsRUFBRTtZQUNMLElBQUcsSUFBSSxFQUFFO2dCQUNMLE9BQU8sQ0FBQyxHQUFHLENBQUMsaUJBQWlCLENBQUMsQ0FBQztnQkFDL0IsSUFBSSxDQUFDLGNBQWMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxJQUFJLENBQUMsZUFBZSxFQUFFLEVBQUUsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUM7Z0JBQ3pFLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxLQUFLLENBQUMsQ0FBQzthQUNwQztRQUNMLENBQUMsRUFDSixDQUNKLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDbEIsQ0FBQzs7Ozs7OztJQUdELFdBQVcsQ0FBQyxDQUFhLEVBQUUsSUFBZTtRQUN0QyxJQUFJLENBQUMsa0JBQWtCLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FDNUMsU0FBUzs7OztRQUFDLENBQUMsTUFBZSxFQUFFLEVBQUU7WUFDMUIsSUFBRyxDQUFDLENBQUMsTUFBTSxFQUFFO2dCQUNULElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxJQUFJLENBQUMsZUFBZSxFQUFFO29CQUNsRCxJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksQ0FBQztvQkFDNUIsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQyxXQUFXLENBQUM7aUJBQzVDOztzQkFDSyxZQUFZLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUM7b0JBQzNDLE9BQU8sRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQztvQkFDaEMsVUFBVSxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUM7aUJBQ3hCLENBQUM7Z0JBQ0YsT0FBTyxZQUFZLENBQUMsSUFBSSxDQUNwQixHQUFHOzs7O2dCQUNDLENBQUMsSUFBSSxFQUFFLEVBQUU7b0JBQ0wsSUFBRyxJQUFJLEVBQUU7d0JBQ0wsT0FBTyxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQzt3QkFDdkIsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO3dCQUNwQixDQUFDLENBQUMsZUFBZSxFQUFFLENBQUM7d0JBQ3BCLENBQUMsQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDO3FCQUN6QjtnQkFDTCxDQUFDLEVBQ0osQ0FDSixDQUFBO2FBQ0o7aUJBQU07Z0JBQ0gsT0FBTzthQUNWO1FBQ0wsQ0FBQyxFQUFDLENBQ0wsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUNsQixDQUFDOzs7Ozs7O0lBR0QsU0FBUyxDQUFDLENBQWEsRUFBRSxJQUFlO1FBQ3BDLElBQUksQ0FBQyxlQUFlLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUMvQyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUM1QixDQUFDLENBQUMsZUFBZSxFQUFFLENBQUM7UUFDcEIsQ0FBQyxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUM7SUFDMUIsQ0FBQzs7Ozs7OztJQUdELFNBQVMsQ0FBQyxDQUFNLEVBQUUsSUFBUztRQUN2QixJQUFJLENBQUMsa0JBQWtCLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxDQUFDLElBQUksQ0FDakQsU0FBUzs7OztRQUFDLENBQUMsTUFBZSxFQUFFLEVBQUU7WUFDMUIsSUFBRyxDQUFDLENBQUMsTUFBTSxFQUFFOztzQkFDSCxVQUFVLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUM7b0JBQ3pDLE9BQU8sRUFBRSxJQUFJLENBQUMsZUFBZTtvQkFDN0IsTUFBTSxFQUFFLEVBQUU7b0JBQ1YsU0FBUyxFQUFFLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztvQkFDcEMsVUFBVSxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUM7aUJBQ3hCLENBQUM7Z0JBQ0YsT0FBTyxVQUFVLENBQUMsSUFBSSxDQUNsQixHQUFHOzs7O2dCQUNDLENBQUMsSUFBSSxFQUFFLEVBQUU7b0JBQ0wsSUFBRyxJQUFJLEVBQUU7d0JBQ0wsT0FBTyxDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUMsQ0FBQzt3QkFDMUIsSUFBSSxDQUFDLGNBQWMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxJQUFJLENBQUMsZUFBZSxFQUFFLEVBQUUsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUM7d0JBQ3pFLENBQUMsQ0FBQyxlQUFlLEVBQUUsQ0FBQzt3QkFDcEIsQ0FBQyxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUM7cUJBQ3pCO2dCQUNMLENBQUMsRUFDSixDQUNKLENBQUE7YUFDSjtpQkFBTTtnQkFDSCxPQUFPO2FBQ1Y7UUFDTCxDQUFDLEVBQUMsQ0FDTCxDQUFDLFNBQVMsRUFBRSxDQUFDO0lBQ2xCLENBQUM7Ozs7Ozs7O0lBR08sVUFBVSxDQUFDLElBQVMsRUFBRSxPQUFnQjs7Y0FDcEMsU0FBUyxHQUFHLFVBQVUsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsRUFBRSxJQUFJLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUM7UUFDOUYsSUFBSSxTQUFTLEdBQUcsQ0FBQyxDQUFDLEVBQUU7WUFDaEIsSUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO1NBQzNDO0lBQ0wsQ0FBQzs7Ozs7O0lBR08sWUFBWTtRQUNoQixJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU87Ozs7UUFBQyxJQUFJLENBQUMsRUFBRTtZQUN0QixJQUFJLFVBQVUsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsRUFBRSxJQUFJLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRTtnQkFDN0YsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7YUFDM0I7aUJBQU07Z0JBQ0gsSUFBSSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUM7YUFDNUI7UUFDTCxDQUFDLEVBQUMsQ0FBQTtJQUNOLENBQUM7Ozs7Ozs7SUFHRCxvQkFBb0IsQ0FBQyxJQUFhLEVBQUUsU0FBUyxHQUFHLElBQUksQ0FBQyxhQUFhO1FBQzlELElBQUksU0FBUyxLQUFLLElBQUksQ0FBQyxhQUFhLEVBQUU7WUFDbEMsSUFBSSxDQUFDLGtCQUFrQixHQUFHLElBQUksQ0FBQztTQUNsQztJQUNMLENBQUM7Ozs7Ozs7SUFHRCxjQUFjLENBQUMsSUFBUyxFQUFFLFNBQVMsR0FBRyxJQUFJLENBQUMsV0FBVztRQUNsRCxJQUFJLENBQUMsa0JBQWtCLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDL0IsSUFBSSxDQUFDLGdCQUFnQixHQUFHLFNBQVMsQ0FBQztRQUNsQyxJQUFJLENBQUMsVUFBVSxHQUFHLEtBQUssQ0FBQztRQUN4QixJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDL0MsOERBQThEO1FBQzlELHVGQUF1RjtRQUV2RixNQUFNO1FBQ04sSUFBSSxDQUFDLFVBQVUsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsRUFBRSxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsU0FBUzs7OztRQUFDLENBQUMsSUFBUyxFQUFFLEVBQUU7WUFDOUYsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO1lBQzlCLElBQUksQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLE9BQU87Ozs7WUFBQyxJQUFJLENBQUMsRUFBRTtnQkFDbkMsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxLQUFLLElBQUksQ0FBQyxlQUFlLElBQUksSUFBSSxDQUFDLEtBQUssS0FBSyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRTtvQkFDdEYsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQztpQkFDbEM7WUFDTCxDQUFDLEVBQUMsQ0FBQztZQUNILElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTzs7OztZQUFDLEVBQUUsQ0FBQyxFQUFFO2dCQUNwQixJQUFJLFVBQVUsQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsRUFBRSxJQUFJLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRTtvQkFDM0YsRUFBRSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7aUJBQ3pCO3FCQUFNO29CQUNILEVBQUUsQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDO2lCQUMxQjtnQkFDRCxFQUFFLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUNyRCxvRkFBb0Y7WUFDeEYsQ0FBQyxFQUFDLENBQUM7WUFDSCxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7WUFDckIsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO1lBQ3BCLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUNuQyxDQUFDLEVBQUMsQ0FBQztJQUNQLENBQUM7Ozs7O0lBR0QsWUFBWTtRQUNSLElBQUksQ0FBQyxVQUFVLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxTQUFTOzs7O1FBQUMsQ0FBQyxJQUFTLEVBQUUsRUFBRTs7a0JBQzVELFNBQVMsR0FBRyxJQUFJLElBQUksSUFBSSxDQUFDLFdBQVc7O2tCQUNwQyxXQUFXLEdBQUcsSUFBSSxJQUFJLElBQUksQ0FBQyxZQUFZO1lBQzdDLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxHQUFHLFNBQVMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFDbkQsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLEdBQUcsV0FBVyxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQzs7a0JBQ25ELGdCQUFnQixHQUFHLFNBQVMsQ0FBQyxDQUFDLENBQUMsSUFBSSxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQzs7a0JBQ2xFLGtCQUFrQixHQUFHLFdBQVcsQ0FBQyxDQUFDLENBQUMsSUFBSSxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQztZQUM5RSxJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLGdCQUFnQixDQUFDO1lBQ3RGLElBQUksQ0FBQyxlQUFlLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsa0JBQWtCLENBQUM7WUFDeEYsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRTtnQkFDeEIsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxTQUFTOzs7O2dCQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxJQUFJLENBQUMsZUFBZSxFQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUU7b0JBQ2xHLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDO2lCQUM1QztxQkFBTSxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLFNBQVM7Ozs7Z0JBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxLQUFLLElBQUksQ0FBQyxlQUFlLEVBQUMsS0FBSyxDQUFDLENBQUMsRUFBRTtvQkFDM0csSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQyxhQUFhLENBQUM7aUJBQzlDO2dCQUNELElBQUksQ0FBQyxjQUFjLENBQUMsRUFBRSxFQUFFLEVBQUUsSUFBSSxDQUFDLGVBQWUsRUFBRSxFQUFFLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO2FBQzVFO1FBQ0wsQ0FBQyxFQUFDLENBQUE7SUFDTixDQUFDOzs7Ozs7O0lBR0QsZUFBZSxDQUFDLENBQU0sRUFBRSxJQUFTO1FBQzdCLElBQUksQ0FBQyxhQUFhLENBQUMsZUFBZSxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNoRCxDQUFDOzs7Ozs7O0lBR0QsYUFBYSxDQUFDLENBQUMsRUFBRSxJQUFZO1FBQ3pCLElBQUksSUFBSSxLQUFLLElBQUksQ0FBQyxXQUFXLEVBQUU7WUFDM0IsSUFBSSxDQUFDLGFBQWEsR0FBRyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUM7U0FDNUM7YUFBTSxJQUFJLElBQUksS0FBSyxJQUFJLENBQUMsYUFBYSxFQUFFO1lBQ3BDLElBQUksQ0FBQyxlQUFlLEdBQUcsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDO1NBQ2hEO1FBQ0QsQ0FBQyxDQUFDLGVBQWUsRUFBRSxDQUFDO1FBQ3BCLENBQUMsQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDO0lBQzFCLENBQUM7Ozs7O0lBRUQsU0FBUyxDQUFDLENBQU07UUFDWixJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRTtZQUNsQixJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7U0FDbkI7YUFBTTtZQUNILElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQztTQUNyQjtRQUNELENBQUMsQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUN2QixDQUFDOzs7Ozs7SUFFRCxTQUFTLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDYixJQUFJLElBQUksQ0FBQyxPQUFPLEVBQUU7WUFDZCxJQUFJLElBQUksQ0FBQyxXQUFXLEVBQUU7Z0JBQ2xCLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxFQUFFLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQzthQUNoRDtpQkFBTTtnQkFDSCxJQUFJLENBQUMsY0FBYyxDQUFDLEVBQUUsQ0FBQyxDQUFDO2FBQzNCO1NBQ0o7YUFBTTtZQUNILElBQUksSUFBSSxDQUFDLFdBQVcsRUFBRTtnQkFDbEIsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLEVBQUUsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDO2FBQ2hEO2lCQUFNO2dCQUNILElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQzthQUN4QztTQUNKO1FBQ0QsQ0FBQyxDQUFDLGNBQWMsRUFBRSxDQUFDO0lBQ3ZCLENBQUM7Ozs7O0lBTUQsUUFBUTtRQUNKLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTzs7OztRQUFDLElBQUksQ0FBQyxFQUFFO1lBQ3RCLElBQUksVUFBVSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxFQUFFLElBQUksQ0FBQyxZQUFZLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFO2dCQUMxRixJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksRUFBRSxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUM7YUFDaEQ7UUFDTCxDQUFDLEVBQUMsQ0FBQztJQUNQLENBQUM7Ozs7O0lBT0QsVUFBVTs7Y0FDQSxRQUFRLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNOzs7O1FBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFDO1FBQ3hELFFBQVEsQ0FBQyxPQUFPOzs7O1FBQUMsSUFBSSxDQUFDLEVBQUU7WUFDcEIsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLEVBQUUsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ2pELENBQUMsRUFBQyxDQUFBO0lBQ04sQ0FBQzs7Ozs7O0lBTUQsVUFBVSxDQUFDLElBQVM7UUFDaEIsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQ2xCLElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUN2QzthQUFNO1lBQ0gsSUFBSSxDQUFDLFVBQVUsR0FBRyxFQUFFLENBQUM7WUFDckIsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPOzs7O1lBQUMsSUFBSSxDQUFDLEVBQUU7Z0JBQ3RCLElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRTtvQkFDZCxJQUFJLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQztpQkFDeEI7WUFDTCxDQUFDLEVBQUMsQ0FBQztZQUNILElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUN2QztRQUNELElBQUksSUFBSSxDQUFDLFlBQVksRUFBRSxFQUFFO1lBQ3JCLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO1NBQzFCO0lBQ0wsQ0FBQzs7Ozs7O0lBTUQsWUFBWSxDQUFDLElBQVM7O2NBQ1osS0FBSyxHQUFHLFVBQVUsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsRUFBRSxJQUFJLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxVQUFVLENBQUM7UUFDL0YsSUFBSSxLQUFLLEdBQUcsQ0FBQyxDQUFDLEVBQUU7WUFDWixJQUFJLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUM7U0FDcEM7UUFDRCxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztRQUM3QixJQUFJLElBQUksQ0FBQyxZQUFZLEVBQUUsRUFBRTtZQUNyQixJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQztTQUMxQjthQUFNO1lBQ0gsSUFBSSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUM7U0FDM0I7SUFDTCxDQUFDOzs7Ozs7O0lBRU8sY0FBYyxDQUFDLFVBQWUsRUFBRSxVQUFVLEdBQUcsVUFBVSxDQUFDLFlBQVk7UUFDeEUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxjQUFjLENBQUMsVUFBVSxFQUFFLFVBQVUsQ0FBQyxDQUFDO0lBQ3pELENBQUM7Ozs7OztJQU9ELHdCQUF3QixDQUFDLElBQVM7UUFDOUIsc0JBQXNCO1FBQ3RCLElBQUksVUFBVSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxFQUFFLElBQUksQ0FBQyxZQUFZLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFO1lBQ3hGLE9BQU87U0FDVjtRQUNELElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQzVCLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzNCLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUM5QyxDQUFDOzs7OztJQUtELGFBQWE7UUFDVCxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU87Ozs7UUFBQyxJQUFJLENBQUMsRUFBRTtZQUN0QixJQUFJLFVBQVUsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsRUFBRSxJQUFJLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRTtnQkFDeEYsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUM7YUFDdkI7aUJBQU07Z0JBQ0gsSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7YUFDeEI7UUFDTCxDQUFDLEVBQUMsQ0FBQztRQUNILElBQUksSUFBSSxDQUFDLFlBQVksRUFBRSxFQUFFO1lBQ3JCLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO1NBQzFCO2FBQU07WUFDSCxJQUFJLENBQUMsVUFBVSxHQUFHLEtBQUssQ0FBQztTQUMzQjtJQUNMLENBQUM7Ozs7O0lBRU8sWUFBWTs7WUFDWixLQUFLLEdBQUcsQ0FBQzs7WUFDVCxVQUFVLEdBQUcsS0FBSztRQUV0QixJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU87Ozs7UUFBQyxJQUFJLENBQUMsRUFBRTtZQUN0QixJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU87Ozs7WUFBQyxTQUFTLENBQUMsRUFBRTtnQkFDaEMsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxLQUFLLFNBQVMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLEVBQUU7b0JBQzFELEtBQUssSUFBSSxDQUFDLENBQUM7aUJBQ2Q7WUFDTCxDQUFDLEVBQUMsQ0FBQztRQUNQLENBQUMsRUFBQyxDQUFDO1FBQ0gsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sS0FBSyxLQUFLLElBQUksS0FBSyxHQUFHLENBQUMsRUFBRTtZQUMxQyxVQUFVLEdBQUcsSUFBSSxDQUFDO1NBQ3JCO1FBQ0QsT0FBTyxVQUFVLENBQUM7SUFDdEIsQ0FBQzs7Ozs7O0lBRUQsU0FBUyxDQUFDLEtBQUssRUFBRSxJQUFJO1FBQ2pCLE9BQU8sS0FBSyxDQUFDO0lBQ2pCLENBQUM7OztZQWhiSixTQUFTLFNBQUM7Z0JBQ1AsUUFBUSxFQUFFLFdBQVc7Z0JBQ3JCLDZ2UEFBcUM7O2FBRXhDOzs7O1lBYlEsVUFBVTtZQUVWLGFBQWE7WUFFYixZQUFZO1lBUkcsaUJBQWlCO1lBQW1DLFFBQVE7WUFXM0Usa0JBQWtCO1lBQUUsa0JBQWtCOzs7d0JBUzFDLFNBQVMsU0FBQyxXQUFXOzJCQUNyQixLQUFLOzBCQUNMLEtBQUs7eUJBQ0wsS0FBSztxQkFDTCxLQUFLOzhCQUNMLEtBQUs7NEJBQ0wsS0FBSzswQkFDTCxLQUFLO3dDQUNMLEtBQUs7MkJBQ0wsS0FBSzswQkFDTCxLQUFLO3dCQUNMLEtBQUs7eUJBQ0wsS0FBSztvQkFDTCxLQUFLOzRCQUNMLEtBQUs7MkJBQ0wsS0FBSzswQkFDTCxNQUFNOzs7O0lBaEJQLG1DQUEyRDs7SUFDM0Qsc0NBQWdDOztJQUNoQyxxQ0FBMEI7O0lBQzFCLG9DQUE0Qjs7SUFDNUIsZ0NBQXdCOztJQUN4Qix5Q0FBa0M7O0lBQ2xDLHVDQUFnQzs7SUFDaEMscUNBQTZCOztJQUM3QixtREFBNEM7O0lBQzVDLHNDQUErQjs7SUFDL0IscUNBQThCOztJQUM5QixtQ0FBNEI7O0lBQzVCLG9DQUE2Qjs7SUFDN0IsK0JBQXVCOztJQUN2Qix1Q0FBK0I7O0lBQy9CLHNDQUErQjs7SUFDL0IscUNBQWdEOztJQUVoRCxzQ0FBb0I7O0lBQ3BCLHFDQUF1Qjs7SUFDdkIsb0NBQXVCOztJQUN2QixtQ0FBc0I7O0lBQ3RCLG9DQUFtQjs7SUFDbkIsK0JBQVc7O0lBQ1gsdUNBQW1COztJQUNuQixtQ0FBZ0Q7O0lBQ2hELHVDQUFtQjs7SUFDbkIseUNBQXFCOztJQUNyQix1Q0FBcUI7O0lBQ3JCLHlDQUF1Qjs7SUFDdkIscUNBQXVCOztJQUN2Qix1Q0FBMkI7O0lBQzNCLHlDQUF3Qjs7SUFDeEIsb0NBQW1COztJQUNuQiw0Q0FBMkI7O0lBQzNCLDBDQUE0Qjs7Ozs7SUFDNUIsdUNBQW9DOzs7OztJQUNwQyxzQ0FBbUM7Ozs7O0lBRy9CLG9DQUE4Qjs7Ozs7SUFDOUIsdUNBQW9DOzs7OztJQUNwQyxrQ0FBOEI7Ozs7O0lBQzlCLDZCQUE4Qjs7Ozs7SUFDOUIsa0NBQTBCOzs7OztJQUMxQiw0Q0FBOEM7Ozs7O0lBQzlDLDRDQUE4QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFmdGVyVmlld0luaXQsIENoYW5nZURldGVjdG9yUmVmLCBDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgSW5qZWN0LCBJbmplY3RvciwgSW5wdXQsIE9uRGVzdHJveSwgT25Jbml0LCBPcHRpb25hbCwgT3V0cHV0LCBWaWV3Q2hpbGQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0ICogYXMgXyBmcm9tICdsb2Rhc2gtZXMnO1xyXG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgbm9EYXRhSW1nIH0gZnJvbSAnLi4vLi4vYXNzZXRzL3Jlc291cmNlJztcclxuaW1wb3J0IHsgQXBpU2VydmljZSB9IGZyb20gJy4uLy4uL3V0aWxzL2FwaS5zZXJ2aWNlJztcclxuaW1wb3J0IHsgQ29tbW9uVXRpbCB9IGZyb20gJy4uLy4uL3V0aWxzL2NvbW1vbi50b29sJztcclxuaW1wb3J0IHsgRmF2b3JpdGVzVG9vbCB9IGZyb20gJy4uLy4uL3V0aWxzL2Zhdm9yaXRlcy50b29sJztcclxuaW1wb3J0IHsgQ2hhbmdlVHlwZSwgR3JvdXAsIEdyb3VwSXRlbSB9IGZyb20gJy4uLy4uL3V0aWxzL2luZGV4LnR5cGUnO1xyXG5pbXBvcnQgeyBTdGF0ZU1nclRvb2wgfSBmcm9tICcuLi8uLi91dGlscy9zdGF0ZS5tZ3IudG9vbCc7XHJcbmltcG9ydCB7IHRhcCwgc3dpdGNoTWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBBcHBlbmRHcm91cE9yZ0NvbXBvbmVudCB9IGZyb20gJy4uL2FwcGVuZC1ncm91cC1vcmcvYXBwZW5kb3JnLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IEZvcm1NZXNzYWdlU2VydmljZSwgRm9ybUxvYWRpbmdTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy9jb21tYW5kLXNlcnZpY2VzJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdsaWItZ3JvdXAnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2dyb3VwLmNvbXBvbmVudC5odG1sJyxcclxuICAgIHN0eWxlVXJsczogWycuL2dyb3VwLmNvbXBvbmVudC5jc3MnXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgR3JvdXBDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIEFmdGVyVmlld0luaXQsIE9uRGVzdHJveSB7XHJcblxyXG4gICAgQFZpZXdDaGlsZCgnYXBwZW5kT3JnJykgYXBwZW5kT3JnOiBBcHBlbmRHcm91cE9yZ0NvbXBvbmVudDtcclxuICAgIEBJbnB1dCgpIHByaW1hcnlGaWVsZCA9ICdvcmdJZCc7XHJcbiAgICBASW5wdXQoKSBtdWx0aVNlbGVjdDogYW55O1xyXG4gICAgQElucHV0KCkgYWJzT3JnVHlwZTogc3RyaW5nO1xyXG4gICAgQElucHV0KCkgYnVzTnVtOiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBlbmFibGVGYXZvcml0ZXM6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBub3RHZXRTdG9wT3JnOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgZ3JvdXBBcGlVcmw6IHN0cmluZztcclxuICAgIEBJbnB1dCgpIGVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmc6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBjYXNjYWRlQ2hlY2s6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBjYXNjYWRlRG93bjogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGNhc2NhZGVVcDogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGtlZXBTZWxlY3Q6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBsYXllcjogbnVtYmVyO1xyXG4gICAgQElucHV0KCkgc2VsZWN0ZWRMaW1pdDogbnVtYmVyO1xyXG4gICAgQElucHV0KCkgc2hvd0NoZWNrQWxsOiBib29sZWFuOyBcclxuICAgIEBPdXRwdXQoKSBncm91cENoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICAgIGdyb3VwSWRGaWVsZCA9ICdpZCc7XHJcbiAgICB1c2VySWRGaWVsZCA9ICd1c2VySWQnO1xyXG4gICAgc2VsZWN0aW9uczogYW55W10gPSBbXTtcclxuICAgIG5vRGF0YUltZyA9IG5vRGF0YUltZztcclxuICAgIGFsbENoZWNrZWQgPSBmYWxzZTtcclxuICAgIGl0ZW1zID0gW107XHJcbiAgICBmYXZvcml0ZXNMaXN0ID0gW107XHJcbiAgICBncm91cERhdGE6IEdyb3VwID0geyBwdWJsaWM6IFtdLCBwZXJzb25hbDogW10gfTtcclxuICAgIHBlcnNvbm5lbExpc3QgPSBbXTtcclxuICAgIGdyb3VwUGVyc29ubmVscyA9IFtdO1xyXG4gICAgcHVibGljVmlzaWJsZSA9IHRydWU7XHJcbiAgICBwZXJzb25hbFZpc2libGUgPSB0cnVlO1xyXG4gICAgcHVibGljVG9rZW4gPSAncHVibGljJztcclxuICAgIHBlcnNvbmFsVG9rZW4gPSAncGVyc29uYWwnO1xyXG4gICAgc2VsZWN0ZWRHcm91cElkOiBzdHJpbmc7XHJcbiAgICBhbGxJbmRleElkOiBzdHJpbmc7XHJcbiAgICBzaG93R3JvdXBPcmdEaWFsb2cgPSBmYWxzZTtcclxuICAgIGN1cnJlbnRHcm91cFR5cGUgPSAncHVibGljJztcclxuICAgIHByaXZhdGUgc2VsZWN0aW9uc1N1YjogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSBmYXZvcml0ZXNTdWI6IFN1YnNjcmlwdGlvbjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwcml2YXRlIGFwaVNlcnZpY2U6IEFwaVNlcnZpY2UsXHJcbiAgICAgICAgcHJpdmF0ZSBmYXZvcml0ZXNUb29sOiBGYXZvcml0ZXNUb29sLFxyXG4gICAgICAgIHByaXZhdGUgc3RhdGVNZ3I6IFN0YXRlTWdyVG9vbCxcclxuICAgICAgICBwcml2YXRlIGNkcjogQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgICAgICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXHJcbiAgICAgICAgcHJpdmF0ZSBmb3JtTWVzc2FnZVNlcnZpY2U6IEZvcm1NZXNzYWdlU2VydmljZSxcclxuICAgICAgICBwcml2YXRlIGZvcm1Mb2FkaW5nU2VydmljZTogRm9ybUxvYWRpbmdTZXJ2aWNlXHJcbiAgICApIHtcclxuICAgICAgICB0aGlzLmFsbEluZGV4SWQgPSBDb21tb25VdGlsLm5ld0d1aWQoKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5lbmFibGVGYXZvcml0ZXMpIHtcclxuICAgICAgICAgICAgdGhpcy5mYXZvcml0ZXNTdWIudW5zdWJzY3JpYmUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25zU3ViLnVuc3Vic2NyaWJlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlRmF2b3JpdGVzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmF2b3JpdGVzU3ViID0gdGhpcy5mYXZvcml0ZXNUb29sLmZhdm9yaXRlc1N1YmplY3Quc3Vic2NyaWJlKGRhdGEgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mYXZvcml0ZXNMaXN0ID0gZGF0YTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0RmF2b3JpdGVzKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNlbGVjdGlvbnNTdWIgPSB0aGlzLnN0YXRlTWdyLnNlbGVjdGlvbnNTdWJqZWN0LnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgICAgICAgaWYgKGRhdGEuY2hhbmdlVHlwZSA9PT0gQ2hhbmdlVHlwZS5WYWx1ZUNoYW5nZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IF8uY2xvbmVEZWVwKGRhdGEudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b2dnbGVDaGVja2VkKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS5jaGFuZ2VUeXBlID09PSBDaGFuZ2VUeXBlLlJlbW92ZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy51blNlbGVjdExpbmUoZGF0YS52YWx1ZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS5jaGFuZ2VUeXBlID09PSBDaGFuZ2VUeXBlLkFwcGVuZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RMaW5lKGRhdGEudmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmdldEdyb3VwTGlzdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgYXNzZW1ibGVEYXRhKCkge1xyXG4gICAgICAgIHRoaXMuZ2V0R3JvdXBMaXN0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5Y+Y5pu0576k57uE5YaF55qE57uE57uHXHJcbiAgICB1cGRhdGVHcm91cCgpIHtcclxuICAgICAgICBjb25zdCBhZGRMaXN0OiBhbnlbXSA9IFtdO1xyXG4gICAgICAgIGNvbnN0IHByaW1hcnlJZHMgPSB0aGlzLml0ZW1zLm1hcChpdGVtID0+IHsgcmV0dXJuIGl0ZW1bdGhpcy5wcmltYXJ5RmllbGRdfSkuam9pbigpO1xyXG4gICAgICAgIHRoaXMuYXBwZW5kT3JnLmN1cnJlbnRPcmdzLmZvckVhY2gob3JnID0+IHtcclxuICAgICAgICAgICAgaWYocHJpbWFyeUlkcy5pbmRleE9mKG9yZ1t0aGlzLnByaW1hcnlGaWVsZF0pID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgYWRkTGlzdC5wdXNoKG9yZ1t0aGlzLnByaW1hcnlGaWVsZF0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY29uc3QgYWRkT3Jnc0luQ3VycmVudEdyb3VwJCA9IHRoaXMuYXBpU2VydmljZS5zYXZlR3JvdXAoe1xyXG4gICAgICAgICAgICBncm91cElkOiB0aGlzLnNlbGVjdGVkR3JvdXBJZCxcclxuICAgICAgICAgICAgYWRkSWRzOiBhZGRMaXN0LFxyXG4gICAgICAgICAgICBkZWxldGVJZHM6IFtdLFxyXG4gICAgICAgICAgICBjaGFuZ2VUeXBlOiBOdW1iZXIoMylcclxuICAgICAgICB9KTtcclxuICAgICAgICBhZGRPcmdzSW5DdXJyZW50R3JvdXAkLnBpcGUoXHJcbiAgICAgICAgICAgIHRhcChcclxuICAgICAgICAgICAgICAgIChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn5bey5Li65b2T5YmN576k57uE6L+95Yqg5paw55qE57uE57uH5oiQ5ZGY77yBJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0T3Jnc0J5R3JvdXAoeyBpZDogdGhpcy5zZWxlY3RlZEdyb3VwSWQgfSwgdGhpcy5jdXJyZW50R3JvdXBUeXBlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGVHcm91cE9yZ0RpYWxvZyhmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKS5zdWJzY3JpYmUoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDliKDpmaTnvqTnu4RcclxuICAgIGRlbGV0ZUdyb3VwKGU6IE1vdXNlRXZlbnQsIGl0ZW06IEdyb3VwSXRlbSkge1xyXG4gICAgICAgIHRoaXMuZm9ybU1lc3NhZ2VTZXJ2aWNlLmNvbmZpcm0oXCLmmK/lkKbliKDpmaTmraTnvqTnu4TvvJ9cIikucGlwZShcclxuICAgICAgICAgICAgc3dpdGNoTWFwKChyZXN1bHQ6IGJvb2xlYW4pID0+IHtcclxuICAgICAgICAgICAgICAgIGlmKCEhcmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1bdGhpcy5ncm91cElkRmllbGRdID09PSB0aGlzLnNlbGVjdGVkR3JvdXBJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkR3JvdXBJZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEdyb3VwVHlwZSA9IHRoaXMucHVibGljVG9rZW47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlbGV0ZUdyb3VwJCA9IHRoaXMuYXBpU2VydmljZS5zYXZlR3JvdXAoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cElkOiBpdGVtW3RoaXMuZ3JvdXBJZEZpZWxkXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlVHlwZTogTnVtYmVyKDQpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlbGV0ZUdyb3VwJC5waXBlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+e+pOe7hOWIoOmZpOaIkOWKn++8gScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEdyb3VwTGlzdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmNhbmNlbEJ1YmJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKS5zdWJzY3JpYmUoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDlj5jmm7TnvqTnu4Tln7rmnKzkv6Hmga/vvIjlkI3np7DjgIHmj4/ov7DvvIlcclxuICAgIGVkaXRHcm91cChlOiBNb3VzZUV2ZW50LCBpdGVtOiBHcm91cEl0ZW0pIHtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkR3JvdXBJZCA9IGl0ZW1bdGhpcy5ncm91cElkRmllbGRdO1xyXG4gICAgICAgIHRoaXMuZ3JvdXBDaGFuZ2UubmV4dChpdGVtKTtcclxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIGUuY2FuY2VsQnViYmxlID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDliKDpmaTnvqTnu4TlhoXnmoTnu4Tnu4dcclxuICAgIHJlbW92ZU9yZyhlOiBhbnksIGRhdGE6IGFueSkge1xyXG4gICAgICAgIHRoaXMuZm9ybU1lc3NhZ2VTZXJ2aWNlLmNvbmZpcm0oXCLmmK/lkKblsIbmraTnu4Tnu4fnp7vlh7rlvZPliY3nvqTnu4TvvJ9cIikucGlwZShcclxuICAgICAgICAgICAgc3dpdGNoTWFwKChyZXN1bHQ6IGJvb2xlYW4pID0+IHtcclxuICAgICAgICAgICAgICAgIGlmKCEhcmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVsZXRlT3JnJCA9IHRoaXMuYXBpU2VydmljZS5zYXZlR3JvdXAoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cElkOiB0aGlzLnNlbGVjdGVkR3JvdXBJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkSWRzOiBbXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlSWRzOiBbZGF0YVt0aGlzLnByaW1hcnlGaWVsZF1dLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VUeXBlOiBOdW1iZXIoMylcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVsZXRlT3JnJC5waXBlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+e+pOe7hOWGhee7hOe7h+WIoOmZpOaIkOWKn++8gScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldE9yZ3NCeUdyb3VwKHsgaWQ6IHRoaXMuc2VsZWN0ZWRHcm91cElkIH0sIHRoaXMuY3VycmVudEdyb3VwVHlwZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuY2FuY2VsQnViYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApLnN1YnNjcmliZSgpOyAgIFxyXG4gICAgfVxyXG5cclxuICAgIC8vIOiuvue9rue+pOe7hOWGhee7hOe7h+eahOWLvumAieeKtuaAgVxyXG4gICAgcHJpdmF0ZSBzZXRDaGVja2VkKGRhdGE6IGFueSwgY2hlY2tlZDogYm9vbGVhbikge1xyXG4gICAgICAgIGNvbnN0IGl0ZW1JbmRleCA9IENvbW1vblV0aWwuZmluZEluZGV4KGRhdGFbdGhpcy5wcmltYXJ5RmllbGRdLCB0aGlzLnByaW1hcnlGaWVsZCwgdGhpcy5pdGVtcyk7XHJcbiAgICAgICAgaWYgKGl0ZW1JbmRleCA+IC0xKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXRlbXNbaXRlbUluZGV4XS5jaGVja2VkID0gY2hlY2tlZDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8g6K6+572u576k57uE5YaF57uE57uH55qE5pS26JeP54q25oCBXHJcbiAgICBwcml2YXRlIHNldEZhdm9yaXRlcygpIHtcclxuICAgICAgICB0aGlzLml0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChDb21tb25VdGlsLmZpbmRJbmRleChpdGVtW3RoaXMucHJpbWFyeUZpZWxkXSwgdGhpcy5wcmltYXJ5RmllbGQsIHRoaXMuZmF2b3JpdGVzTGlzdCkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmluRmF2b3JpdGVzID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uaW5GYXZvcml0ZXMgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgLy8g6YCa6L+H5by556qX5aKe5Yqg576k57uE5YaF55qE57uE57uHXHJcbiAgICB0b2dnbGVHcm91cE9yZ0RpYWxvZyhzaG93OiBib29sZWFuLCBncm91cFR5cGUgPSB0aGlzLnBlcnNvbmFsVG9rZW4pIHtcclxuICAgICAgICBpZiAoZ3JvdXBUeXBlID09PSB0aGlzLnBlcnNvbmFsVG9rZW4pIHtcclxuICAgICAgICAgICAgdGhpcy5zaG93R3JvdXBPcmdEaWFsb2cgPSBzaG93O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDojrflj5bmn5DkuKrnvqTnu4TlhoXnmoTmiYDmnInnu4Tnu4dcclxuICAgIGdldE9yZ3NCeUdyb3VwKGl0ZW06IGFueSwgZ3JvdXBUeXBlID0gdGhpcy5wdWJsaWNUb2tlbikge1xyXG4gICAgICAgIHRoaXMuZm9ybUxvYWRpbmdTZXJ2aWNlLnNob3coKTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRHcm91cFR5cGUgPSBncm91cFR5cGU7XHJcbiAgICAgICAgdGhpcy5hbGxDaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZEdyb3VwSWQgPSBpdGVtW3RoaXMuZ3JvdXBJZEZpZWxkXTtcclxuICAgICAgICAvLyBjb25zdCBoZWxwRXh0ZW5kID0gd2luZG93ICYmICh3aW5kb3cgYXMgYW55KS5vcmdIZWxwRXh0ZW5kO1xyXG4gICAgICAgIC8vIGhlbHBFeHRlbmQuZ2V0RGF0YUJ5R3JvdXBJZChpdGVtW3RoaXMuZ3JvdXBJZEZpZWxkXSwgdGhpcy5hYnNPcmdUeXBlKS50aGVuKGRhdGEgPT4ge1xyXG5cclxuICAgICAgICAvLyB9KTtcclxuICAgICAgICB0aGlzLmFwaVNlcnZpY2UuZ2V0R3JvdXBNZW1iZXJzKGl0ZW1bdGhpcy5ncm91cElkRmllbGRdLCB0aGlzLmFic09yZ1R5cGUpLnN1YnNjcmliZSgoZGF0YTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuaXRlbXMgPSBkYXRhID8gZGF0YSA6IFtdO1xyXG4gICAgICAgICAgICB0aGlzLmdyb3VwRGF0YS5wZXJzb25hbC5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW1bdGhpcy5ncm91cElkRmllbGRdID09PSB0aGlzLnNlbGVjdGVkR3JvdXBJZCAmJiBpdGVtLnRvdGFsICE9PSB0aGlzLml0ZW1zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0udG90YWwgPSB0aGlzLml0ZW1zLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuaXRlbXMuZm9yRWFjaChpdCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoQ29tbW9uVXRpbC5maW5kSW5kZXgoaXRbdGhpcy5wcmltYXJ5RmllbGRdLCB0aGlzLnByaW1hcnlGaWVsZCwgdGhpcy5mYXZvcml0ZXNMaXN0KSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICBpdC5pbkZhdm9yaXRlcyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0LmluRmF2b3JpdGVzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpdC5pbmRleElkID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygxNikuc3Vic3RyaW5nKDIpO1xyXG4gICAgICAgICAgICAgICAgLy8gaXQuZGlzcGxheU5hbWUgPSAhIXRoaXMuc2hvd1VzZXJDb2RlID8gKCdbJyArIGl0LmNvZGUgKyAnXScgKyBpdC5uYW1lKSA6IGl0Lm5hbWU7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUNoZWNrZWQoKTtcclxuICAgICAgICAgICAgdGhpcy5zZXRGYXZvcml0ZXMoKTtcclxuICAgICAgICAgICAgdGhpcy5mb3JtTG9hZGluZ1NlcnZpY2UuaGlkZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOiOt+WPlue7hOe7h+e+pOe7hOWIl+ihqFxyXG4gICAgZ2V0R3JvdXBMaXN0KCkge1xyXG4gICAgICAgIHRoaXMuYXBpU2VydmljZS5nZXRPcmdHcm91cHModGhpcy5hYnNPcmdUeXBlKS5zdWJzY3JpYmUoKGRhdGE6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCByZXNQdWJsaWMgPSBkYXRhICYmIGRhdGEucHVibGljR3JvdXA7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc1BlcnNvbmFsID0gZGF0YSAmJiBkYXRhLnByaXZhdGVHcm91cDtcclxuICAgICAgICAgICAgdGhpcy5ncm91cERhdGEucHVibGljID0gcmVzUHVibGljID8gcmVzUHVibGljIDogW107XHJcbiAgICAgICAgICAgIHRoaXMuZ3JvdXBEYXRhLnBlcnNvbmFsID0gcmVzUGVyc29uYWwgPyByZXNQZXJzb25hbCA6IFtdO1xyXG4gICAgICAgICAgICBjb25zdCBmaXJzdFB1YmxpY0dyb3VwID0gcmVzUHVibGljWzBdICYmIHJlc1B1YmxpY1swXVt0aGlzLmdyb3VwSWRGaWVsZF07XHJcbiAgICAgICAgICAgIGNvbnN0IGZpcnN0UGVyc29uYWxHcm91cCA9IHJlc1BlcnNvbmFsWzBdICYmIHJlc1BlcnNvbmFsWzBdW3RoaXMuZ3JvdXBJZEZpZWxkXTtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEdyb3VwSWQgPSB0aGlzLnNlbGVjdGVkR3JvdXBJZCA/IHRoaXMuc2VsZWN0ZWRHcm91cElkIDogZmlyc3RQdWJsaWNHcm91cDtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEdyb3VwSWQgPSB0aGlzLnNlbGVjdGVkR3JvdXBJZCA/IHRoaXMuc2VsZWN0ZWRHcm91cElkIDogZmlyc3RQZXJzb25hbEdyb3VwO1xyXG4gICAgICAgICAgICBpZiAoISF0aGlzLnNlbGVjdGVkR3JvdXBJZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZ3JvdXBEYXRhLnB1YmxpYy5maW5kSW5kZXgoaXRlbSA9PiBpdGVtW3RoaXMuZ3JvdXBJZEZpZWxkXSA9PT0gdGhpcy5zZWxlY3RlZEdyb3VwSWQpICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEdyb3VwVHlwZSA9IHRoaXMucHVibGljVG9rZW47XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZ3JvdXBEYXRhLnBlcnNvbmFsLmZpbmRJbmRleChpdGVtID0+IGl0ZW1bdGhpcy5ncm91cElkRmllbGRdID09PSB0aGlzLnNlbGVjdGVkR3JvdXBJZCkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50R3JvdXBUeXBlID0gdGhpcy5wZXJzb25hbFRva2VuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRPcmdzQnlHcm91cCh7IGlkOiB0aGlzLnNlbGVjdGVkR3JvdXBJZCB9LCB0aGlzLmN1cnJlbnRHcm91cFR5cGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyDmlLbol4/miJbogIXlj5bmtojmlLbol4/nu4Tnu4dcclxuICAgIHRvZ2dsZUZhdm9yaXRlcyhlOiBhbnksIGl0ZW06IGFueSkge1xyXG4gICAgICAgIHRoaXMuZmF2b3JpdGVzVG9vbC50b2dnbGVGYXZvcml0ZXMoZSwgaXRlbSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5YiH5o2i5YWs5YWx576k57uE5oiW6ICF5Liq5Lq6576k57uE55qE5pS25oqY54q25oCBXHJcbiAgICB0b2dnbGVWaXNpYmxlKGUsIHR5cGU6IHN0cmluZykge1xyXG4gICAgICAgIGlmICh0eXBlID09PSB0aGlzLnB1YmxpY1Rva2VuKSB7XHJcbiAgICAgICAgICAgIHRoaXMucHVibGljVmlzaWJsZSA9ICF0aGlzLnB1YmxpY1Zpc2libGU7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSB0aGlzLnBlcnNvbmFsVG9rZW4pIHtcclxuICAgICAgICAgICAgdGhpcy5wZXJzb25hbFZpc2libGUgPSAhdGhpcy5wZXJzb25hbFZpc2libGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgZS5jYW5jZWxCdWJibGUgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHRvZ2dsZUFsbChlOiBhbnkpIHtcclxuICAgICAgICBpZiAoIXRoaXMuYWxsQ2hlY2tlZCkge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrQWxsKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy51bkNoZWNrQWxsKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH1cclxuXHJcbiAgICB0b2dnbGVPbmUoZGF0YSwgZSkge1xyXG4gICAgICAgIGlmIChkYXRhLmNoZWNrZWQpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMubXVsdGlTZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZW1pdFNlbGVjdGlvbnMoZGF0YSwgQ2hhbmdlVHlwZS5SZW1vdmUpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbWl0U2VsZWN0aW9ucyhbXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbWl0U2VsZWN0aW9ucyhkYXRhLCBDaGFuZ2VUeXBlLkFwcGVuZCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXRTZWxlY3Rpb25zKG5ldyBBcnJheShkYXRhKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5YWo6YCJ5ZCO5aSE55CGXHJcbiAgICAgKiBAcGFyYW0gZGF0YUFyciDlhajpgInnmoTlgLxcclxuICAgICAqL1xyXG4gICAgY2hlY2tBbGwoKSB7XHJcbiAgICAgICAgdGhpcy5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBpZiAoQ29tbW9uVXRpbC5maW5kSW5kZXgoaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0sIHRoaXMucHJpbWFyeUZpZWxkLCB0aGlzLnNlbGVjdGlvbnMpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbWl0U2VsZWN0aW9ucyhpdGVtLCBDaGFuZ2VUeXBlLkFwcGVuZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWFqOmDqOWPlua2iFxyXG4gICAgICogQHBhcmFtIGRhdGFBcnIg5Y+W5raI55qE5pWw5o2uXHJcbiAgICAgKiBAcmV0dXJucyB2b2lkXHJcbiAgICAgKi9cclxuICAgIHVuQ2hlY2tBbGwoKSB7XHJcbiAgICAgICAgY29uc3QgY2hlY2tlZHMgPSB0aGlzLml0ZW1zLmZpbHRlcihpdGVtID0+IGl0ZW0uY2hlY2tlZCk7XHJcbiAgICAgICAgY2hlY2tlZHMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgdGhpcy5lbWl0U2VsZWN0aW9ucyhpdGVtLCBDaGFuZ2VUeXBlLlJlbW92ZSk7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOW9k+WJjeihjOmAieS4rVxyXG4gICAgICogQHBhcmFtIGRhdGEg5b2T5YmN6KGM55qE5pWw5o2u77yI77yJXHJcbiAgICAgKi9cclxuICAgIHNlbGVjdExpbmUoZGF0YTogYW55KSB7XHJcbiAgICAgICAgaWYgKHRoaXMubXVsdGlTZWxlY3QpIHtcclxuICAgICAgICAgICAgdGhpcy5faW5zZXJ0T25lSW50b1NlbGVjdGlvbnMoZGF0YSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChpdGVtLmNoZWNrZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuX2luc2VydE9uZUludG9TZWxlY3Rpb25zKGRhdGEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5pc0FsbENoZWNrZWQoKSkge1xyXG4gICAgICAgICAgICB0aGlzLmFsbENoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWNlemAieWPlua2iOmAieS4rVxyXG4gICAgICogQHBhcmFtIGRhdGEg5Y+W5raI6YCJ5Lit6KGMXHJcbiAgICAgKi9cclxuICAgIHVuU2VsZWN0TGluZShkYXRhOiBhbnkpIHtcclxuICAgICAgICBjb25zdCBpbmRleCA9IENvbW1vblV0aWwuZmluZEluZGV4KGRhdGFbdGhpcy5wcmltYXJ5RmllbGRdLCB0aGlzLnByaW1hcnlGaWVsZCwgdGhpcy5zZWxlY3Rpb25zKTtcclxuICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvbnMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZXRDaGVja2VkKGRhdGEsIGZhbHNlKTtcclxuICAgICAgICBpZiAodGhpcy5pc0FsbENoZWNrZWQoKSkge1xyXG4gICAgICAgICAgICB0aGlzLmFsbENoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWxsQ2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGVtaXRTZWxlY3Rpb25zKHNlbGVjdGlvbnM6IGFueSwgY2hhbmdlVHlwZSA9IENoYW5nZVR5cGUuVmFsdWVDaGFuZ2VkKSB7XHJcbiAgICAgICAgdGhpcy5zdGF0ZU1nci5lbWl0U2VsZWN0aW9ucyhzZWxlY3Rpb25zLCBjaGFuZ2VUeXBlKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOmAieS4reW5tuaPkuWFpeW9k+WJjeihjOaVsOaNruWIsOWPs+S+p1xyXG4gICAgICogQHBhcmFtIGRhdGEg5b2T5YmN6KGM55qE5pWw5o2uXHJcbiAgICAgKiBAcGFyYW0gY29sbGVjdGlvbiDmmoLlrZjlvZPliY3mlbDmja7nmoTpm4blkIhcclxuICAgICAqL1xyXG4gICAgX2luc2VydE9uZUludG9TZWxlY3Rpb25zKGRhdGE6IGFueSkge1xyXG4gICAgICAgIC8vIOWmguaenOW9k+WJjeaVsOaNruW3sue7j+enu+WFpeWPs+S+p+aVsOaNru+8jOWImei/lOWbnuOAglxyXG4gICAgICAgIGlmIChDb21tb25VdGlsLmZpbmRJbmRleChkYXRhW3RoaXMucHJpbWFyeUZpZWxkXSwgdGhpcy5wcmltYXJ5RmllbGQsIHRoaXMuc2VsZWN0aW9ucykgPiAtMSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2V0Q2hlY2tlZChkYXRhLCB0cnVlKTtcclxuICAgICAgICB0aGlzLnNlbGVjdGlvbnMucHVzaChkYXRhKTtcclxuICAgICAgICB0aGlzLnNlbGVjdGlvbnMgPSB0aGlzLnNlbGVjdGlvbnMuc2xpY2UoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOe/u+mhteajgOafpe+8muS6uuWRmOWxleekuuWMuueahOWLvumAieeKtuaAgeS4juW3sumAieS6uuWRmOWMuuaYr+WQpuWvueW6lFxyXG4gICAgICovXHJcbiAgICB0b2dnbGVDaGVja2VkKCkge1xyXG4gICAgICAgIHRoaXMuaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgaWYgKENvbW1vblV0aWwuZmluZEluZGV4KGl0ZW1bdGhpcy5wcmltYXJ5RmllbGRdLCB0aGlzLnByaW1hcnlGaWVsZCwgdGhpcy5zZWxlY3Rpb25zKSA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAodGhpcy5pc0FsbENoZWNrZWQoKSkge1xyXG4gICAgICAgICAgICB0aGlzLmFsbENoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWxsQ2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGlzQWxsQ2hlY2tlZCgpOiBib29sZWFuIHtcclxuICAgICAgICBsZXQgY291bnQgPSAwO1xyXG4gICAgICAgIGxldCBhbGxDaGVja2VkID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zLmZvckVhY2goc2VsZWN0aW9uID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChpdGVtW3RoaXMucHJpbWFyeUZpZWxkXSA9PT0gc2VsZWN0aW9uW3RoaXMucHJpbWFyeUZpZWxkXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvdW50ICs9IDE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmICh0aGlzLml0ZW1zLmxlbmd0aCA9PT0gY291bnQgJiYgY291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgIGFsbENoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYWxsQ2hlY2tlZDtcclxuICAgIH1cclxuXHJcbiAgICB0cmFja0J5Rm4oaW5kZXgsIGl0ZW0pIHtcclxuICAgICAgICByZXR1cm4gaW5kZXg7XHJcbiAgICB9XHJcblxyXG59XHJcbiJdfQ==