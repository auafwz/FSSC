/**
 * @fileoverview added by tsickle
 * Generated from: lib/controlcomponent/inputgroup/inputgroup.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, EventEmitter, Output } from '@angular/core';
import { SolutionService } from '../../service/solution.service';
export class InputGroupComponent {
    /**
     * @param {?} solutionService
     */
    constructor(solutionService) {
        this.solutionService = solutionService;
        this.conditionChange = new EventEmitter();
        //控件内显示文本是否为弹窗返回的文本，手动输入或者手动做出修改时为false
        this.isTextFromDialog = false;
    }
    /**
     * @param {?} inputGroupItem
     * @return {?}
     */
    set item(inputGroupItem) {
        this._inputItem = inputGroupItem;
    }
    /**
     * @return {?}
     */
    get item() {
        return this.constructInputGroupItem(this._inputItem);
    }
    /**
     * @param {?} inputGroupItem
     * @return {?}
     */
    constructInputGroupItem(inputGroupItem) {
        /** @type {?} */
        const inputGroupValueObj = (/** @type {?} */ (inputGroupItem.value));
        inputGroupValueObj.textValue = inputGroupValueObj.textValue && inputGroupValueObj.textValue.trim();
        inputGroupItem.value = inputGroupValueObj;
        return inputGroupItem;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.testId = this.solutionService.getGuid();
        this.getInputGroupBindingInfo();
    }
    /**
     * @return {?}
     */
    getInputGroupBindingInfo() {
        /** @type {?} */
        const inputGroupControl = ((/** @type {?} */ (this.item.control)));
        this.usageMode = inputGroupControl.usageMode;
        if (this.usageMode == 'open-modal' || this.usageMode == 'open-remote-modal') {
            this.dialogOptions = inputGroupControl.dialogOptions;
            /*
                example of dialogOptions = {
                   modalId: "1e011720-eb0f-4c9c-82b6-6844c89b2303"
                   mapFields: {hDepartment: "Name"}
                   title: "测试标题栏"
                   width: 800
                   height: 600
                }
             */
            if (this.dialogOptions.mapFields) {
                this.textField = JSON.stringify(this.dialogOptions.mapFields).split('"')[1];
            }
        }
    }
    /**
     * @param {?} field
     * @return {?}
     */
    getConditionItemTitle(field) {
        return this.solutionService.getConditionItemTitle(field);
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onClick(event) {
        if (this.usageMode == 'text') {
            this.item.control.click();
        }
        else {
            /** @type {?} */
            const options = this.dialogOptions;
            options.handle = (/**
             * @param {?} selectedItem
             * @return {?}
             */
            (selectedItem) => {
                if (selectedItem && this.textField) {
                    this.item.value.value = selectedItem;
                    this.item.value.textValue = this.item.value.getTextValue(this.textField);
                    this.item.value.textField = this.textField;
                    this.item.value.isInputText = false;
                    this.isTextFromDialog = true;
                    this.textFormDialog = this.item.value.textValue;
                    this.onBlur();
                }
            });
            this.item.control.click({ event, options });
        }
    }
    /**
     * @return {?}
     */
    onBlur() {
        if (this.usageMode == 'text') {
            this.item.value.isInputText = true;
        }
        if (this.usageMode == 'open-modal' || this.usageMode == 'open-remote-modal') {
            if (!this.isTextFromDialog) {
                //console.log('弹窗模式下控件内文本是手动输入的');
                this.item.value.isInputText = true;
            }
            if (this.item.value.textValue != this.textFormDialog) {
                //console.log('通过弹窗选择的值已被手动修改');
                this.isTextFromDialog = false;
                this.item.value.value = [];
                this.item.value.textField = undefined;
                this.item.value.isInputText = true;
            }
        }
        this.conditionChange.emit();
    }
}
InputGroupComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-solution-inputgroup',
                template: "<div class=\"farris-group-wrap\" id=\"{{item.id}}\">\r\n    <div class=\"form-group farris-form-group  common-group\"  [ngClass]=\"{'q-state-readonly':item.readonly}\">\r\n        <label class=\"col-form-label\" *ngIf=\"item\" title=\"{{getConditionItemTitle(item)}}\">\r\n            <span class=\"farris-label-info text-danger\" *ngIf=\"item.control.isRequired()\">*</span>\r\n            <span class=\"farris-label-text\">{{item.fieldName}}</span>\r\n        </label>\r\n        <div class=\"farris-input-wrap\">\r\n            <input-group \r\n                [(ngModel)]=\"item.value.textValue\" \r\n                name=\"{{item.fieldName}}\" \r\n                id=\"{{testId}}\"\r\n                [groupText]=\"item.control.groupText\"\r\n                [editable]=\"item.control.editable\"\r\n                [placeholder]=\"item.placeHolder\"\r\n                [readonly]=\"item.readonly\"\r\n                (clickHandle)=\"onClick($event)\"\r\n                (blurHandle)=\"onBlur()\">\r\n            </input-group>\r\n        </div>\r\n    </div>\r\n</div>"
            }] }
];
/** @nocollapse */
InputGroupComponent.ctorParameters = () => [
    { type: SolutionService }
];
InputGroupComponent.propDecorators = {
    item: [{ type: Input }],
    conditionChange: [{ type: Output, args: ['conditionChange',] }]
};
if (false) {
    /**
     * QueryCondition类型
     * @type {?}
     */
    InputGroupComponent.prototype._inputItem;
    /** @type {?} */
    InputGroupComponent.prototype.conditionChange;
    /** @type {?} */
    InputGroupComponent.prototype.testId;
    /** @type {?} */
    InputGroupComponent.prototype.usageMode;
    /** @type {?} */
    InputGroupComponent.prototype.dialogOptions;
    /** @type {?} */
    InputGroupComponent.prototype.textField;
    /** @type {?} */
    InputGroupComponent.prototype.isTextFromDialog;
    /** @type {?} */
    InputGroupComponent.prototype.textFormDialog;
    /**
     * @type {?}
     * @private
     */
    InputGroupComponent.prototype.solutionService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5wdXRncm91cC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL2NvbXBvbmVudC1xdWVyeWNvbmRpdGlvbi8iLCJzb3VyY2VzIjpbImxpYi9jb250cm9sY29tcG9uZW50L2lucHV0Z3JvdXAvaW5wdXRncm91cC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBVSxZQUFZLEVBQUUsTUFBTSxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBRTlFLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQVVqRSxNQUFNLE9BQU8sbUJBQW1COzs7O0lBbUM1QixZQUFvQixlQUErQjtRQUEvQixvQkFBZSxHQUFmLGVBQWUsQ0FBZ0I7UUFyQnhCLG9CQUFlLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQzs7UUFVaEUscUJBQWdCLEdBQVksS0FBSyxDQUFDO0lBV21CLENBQUM7Ozs7O0lBN0J0RCxJQUNJLElBQUksQ0FBQyxjQUFtQjtRQUN4QixJQUFJLENBQUMsVUFBVSxHQUFHLGNBQWMsQ0FBQztJQUNyQyxDQUFDOzs7O0lBQ0QsSUFBSSxJQUFJO1FBQ0osT0FBTyxJQUFJLENBQUMsdUJBQXVCLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQ3pELENBQUM7Ozs7O0lBZ0JELHVCQUF1QixDQUFDLGNBQThCOztjQUM1QyxrQkFBa0IsR0FBRyxtQkFBQSxjQUFjLENBQUMsS0FBSyxFQUFtQjtRQUNsRSxrQkFBa0IsQ0FBQyxTQUFTLEdBQUcsa0JBQWtCLENBQUMsU0FBUyxJQUFJLGtCQUFrQixDQUFDLFNBQVMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUNuRyxjQUFjLENBQUMsS0FBSyxHQUFHLGtCQUFrQixDQUFDO1FBQzFDLE9BQU8sY0FBYyxDQUFDO0lBQzFCLENBQUM7Ozs7SUFJRCxRQUFRO1FBQ0osSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJ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aEQsZ0NBQWdDO2dCQUNoQyxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsS0FBSyxDQUFDO2dCQUM5QixJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLEdBQUcsRUFBRSxDQUFDO2dCQUMzQixJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDO2dCQUN0QyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDO2FBQ3RDO1NBQ0o7UUFDRCxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ2hDLENBQUM7OztZQS9HSixTQUFTLFNBQUM7Z0JBQ1AsUUFBUSxFQUFFLHlCQUF5QjtnQkFDbkMsNmpDQUEwQzthQUM3Qzs7OztZQVJRLGVBQWU7OzttQkFnQm5CLEtBQUs7OEJBUUwsTUFBTSxTQUFDLGlCQUFpQjs7Ozs7OztJQVZ6Qix5Q0FBMkI7O0lBVTNCLDhDQUFnRTs7SUFFaEUscUNBQWU7O0lBRWYsd0NBQWtCOztJQUVsQiw0Q0FBbUI7O0lBRW5CLHdDQUFrQjs7SUFFbEIsK0NBQWtDOztJQUVsQyw2Q0FBdUI7Ozs7O0lBU1gsOENBQXVDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT25Jbml0LCBFdmVudEVtaXR0ZXIsIE91dHB1dH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFF1ZXJ5Q29uZGl0aW9uIH0gZnJvbSAnLi4vLi4vZW50aXR5L3F1ZXJ5Y29uZGl0aW9uJztcclxuaW1wb3J0IHsgU29sdXRpb25TZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZS9zb2x1dGlvbi5zZXJ2aWNlJztcclxuaW1wb3J0IHsgSW5wdXRHcm91cENvbnRyb2wgfSBmcm9tICcuLi8uLi9lbnRpdHkvY29udHJvbHR5cGUvaW5wdXQtZ3JvdXAvaW5wdXRncm91cGNvbnRyb2wnO1xyXG5pbXBvcnQgeyBJbnB1dEdyb3VwVmFsdWUgfSBmcm9tICcuLi8uLi9lbnRpdHkvY29uZGl0aW9udmFsdWUvaW5wdXRncm91cHZhbHVlJztcclxuXHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnYXBwLXNvbHV0aW9uLWlucHV0Z3JvdXAnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2lucHV0Z3JvdXAuY29tcG9uZW50Lmh0bWwnLFxyXG59KVxyXG5cclxuZXhwb3J0IGNsYXNzIElucHV0R3JvdXBDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG4gICAgLyoqXHJcbiAgICAgKiBRdWVyeUNvbmRpdGlvbuexu+Wei1xyXG4gICAgICovXHJcbiAgICBfaW5wdXRJdGVtOiBRdWVyeUNvbmRpdGlvbjtcclxuXHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IGl0ZW0oaW5wdXRHcm91cEl0ZW06IGFueSkge1xyXG4gICAgICAgIHRoaXMuX2lucHV0SXRlbSA9IGlucHV0R3JvdXBJdGVtO1xyXG4gICAgfVxyXG4gICAgZ2V0IGl0ZW0oKTogYW55e1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdElucHV0R3JvdXBJdGVtKHRoaXMuX2lucHV0SXRlbSk7XHJcbiAgICB9XHJcblxyXG4gICAgQE91dHB1dCgnY29uZGl0aW9uQ2hhbmdlJykgY29uZGl0aW9uQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgLy/nu4Tku7ZpZFxyXG4gICAgdGVzdElkOiBzdHJpbmc7XHJcbiAgICAvL+S9v+eUqOaooeW8j++8jOaWh+acrHRleHTmiJbogIXlvLnnqpdvcGVuLW1vZGFsXHJcbiAgICB1c2FnZU1vZGU6IHN0cmluZztcclxuICAgIC8v5by556qX5ZG95Luk6ZyA6KaB5o6l5pS255qE5Y+C5pWwXHJcbiAgICBkaWFsb2dPcHRpb25zOiBhbnk7XHJcbiAgICAvL+W8ueeql+aooeW8j+S4i++8jOWPluWIl+ihqOS4reWTquS4quWtl+auteeahOWAvOaYoOWwhOWIsOW9k+WJjeWtl+autVxyXG4gICAgdGV4dEZpZWxkOiBzdHJpbmc7XHJcbiAgICAvL+aOp+S7tuWGheaYvuekuuaWh+acrOaYr+WQpuS4uuW8ueeql+i/lOWbnueahOaWh+acrO+8jOaJi+WKqOi+k+WFpeaIluiAheaJi+WKqOWBmuWHuuS/ruaUueaXtuS4umZhbHNlXHJcbiAgICBpc1RleHRGcm9tRGlhbG9nOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICAvL+W8ueeql+i/lOWbnueahOaWh+acrFxyXG4gICAgdGV4dEZvcm1EaWFsb2c6IHN0cmluZztcclxuXHJcbiAgICBjb25zdHJ1Y3RJbnB1dEdyb3VwSXRlbShpbnB1dEdyb3VwSXRlbTogUXVlcnlDb25kaXRpb24pOiBRdWVyeUNvbmRpdGlvbiB7XHJcbiAgICAgICAgY29uc3QgaW5wdXRHcm91cFZhbHVlT2JqID0gaW5wdXRHcm91cEl0ZW0udmFsdWUgYXMgSW5wdXRHcm91cFZhbHVlO1xyXG4gICAgICAgIGlucHV0R3JvdXBWYWx1ZU9iai50ZXh0VmFsdWUgPSBpbnB1dEdyb3VwVmFsdWVPYmoudGV4dFZhbHVlICYmIGlucHV0R3JvdXBWYWx1ZU9iai50ZXh0VmFsdWUudHJpbSgpO1xyXG4gICAgICAgIGlucHV0R3JvdXBJdGVtLnZhbHVlID0gaW5wdXRHcm91cFZhbHVlT2JqO1xyXG4gICAgICAgIHJldHVybiBpbnB1dEdyb3VwSXRlbTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHNvbHV0aW9uU2VydmljZTpTb2x1dGlvblNlcnZpY2Upe31cclxuXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnRlc3RJZCA9IHRoaXMuc29sdXRpb25TZXJ2aWNlLmdldEd1aWQoKTtcclxuICAgICAgICB0aGlzLmdldElucHV0R3JvdXBCaW5kaW5nSW5mbygpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldElucHV0R3JvdXBCaW5kaW5nSW5mbygpIHtcclxuICAgICAgICBjb25zdCBpbnB1dEdyb3VwQ29udHJvbCA9ICh0aGlzLml0ZW0uY29udHJvbCBhcyBJbnB1dEdyb3VwQ29udHJvbCk7XHJcbiAgICAgICAgdGhpcy51c2FnZU1vZGUgPSBpbnB1dEdyb3VwQ29udHJvbC51c2FnZU1vZGU7XHJcbiAgICAgICAgaWYodGhpcy51c2FnZU1vZGUgPT0gJ29wZW4tbW9kYWwnfHx0aGlzLnVzYWdlTW9kZSA9PSAnb3Blbi1yZW1vdGUtbW9kYWwnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlhbG9nT3B0aW9ucyA9IGlucHV0R3JvdXBDb250cm9sLmRpYWxvZ09wdGlvbnM7XHJcbiAgICAgICAgICAgIC8qXHJcbiAgICAgICAgICAgICAgICBleGFtcGxlIG9mIGRpYWxvZ09wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICBtb2RhbElkOiBcIjFlMDExNzIwLWViMGYtNGM5Yy04MmI2LTY4NDRjODliMjMwM1wiXHJcbiAgICAgICAgICAgICAgICAgICBtYXBGaWVsZHM6IHtoRGVwYXJ0bWVudDogXCJOYW1lXCJ9XHJcbiAgICAgICAgICAgICAgICAgICB0aXRsZTogXCLmtYvor5XmoIfpopjmoI9cIlxyXG4gICAgICAgICAgICAgICAgICAgd2lkdGg6IDgwMFxyXG4gICAgICAgICAgICAgICAgICAgaGVpZ2h0OiA2MDBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIGlmKHRoaXMuZGlhbG9nT3B0aW9ucy5tYXBGaWVsZHMpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy50ZXh0RmllbGQgPSBKU09OLnN0cmluZ2lmeSh0aGlzLmRpYWxvZ09wdGlvbnMubWFwRmllbGRzKS5zcGxpdCgnXCInKVsxXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXRDb25kaXRpb25JdGVtVGl0bGUoZmllbGQ6UXVlcnlDb25kaXRpb24pe1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNvbHV0aW9uU2VydmljZS5nZXRDb25kaXRpb25JdGVtVGl0bGUoZmllbGQpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBvbkNsaWNrKGV2ZW50OiBhbnkpe1xyXG4gICAgICAgIGlmKHRoaXMudXNhZ2VNb2RlID09ICd0ZXh0Jyl7XHJcbiAgICAgICAgICAgIHRoaXMuaXRlbS5jb250cm9sLmNsaWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSB0aGlzLmRpYWxvZ09wdGlvbnM7XHJcbiAgICAgICAgICAgIG9wdGlvbnMuaGFuZGxlID0gKHNlbGVjdGVkSXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYoc2VsZWN0ZWRJdGVtICYmIHRoaXMudGV4dEZpZWxkKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLml0ZW0udmFsdWUudmFsdWUgPSBzZWxlY3RlZEl0ZW07XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtLnZhbHVlLnRleHRWYWx1ZSA9IHRoaXMuaXRlbS52YWx1ZS5nZXRUZXh0VmFsdWUodGhpcy50ZXh0RmllbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXRlbS52YWx1ZS50ZXh0RmllbGQgPSB0aGlzLnRleHRGaWVsZDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLml0ZW0udmFsdWUuaXNJbnB1dFRleHQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1RleHRGcm9tRGlhbG9nID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRleHRGb3JtRGlhbG9nID0gdGhpcy5pdGVtLnZhbHVlLnRleHRWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQmx1cigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuaXRlbS5jb250cm9sLmNsaWNrKHtldmVudCwgb3B0aW9uc30pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvbkJsdXIoKXtcclxuICAgICAgICBpZih0aGlzLnVzYWdlTW9kZSA9PSAndGV4dCcpIHtcclxuICAgICAgICAgICAgdGhpcy5pdGVtLnZhbHVlLmlzSW5wdXRUZXh0ID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy51c2FnZU1vZGUgPT0gJ29wZW4tbW9kYWwnfHx0aGlzLnVzYWdlTW9kZSA9PSAnb3Blbi1yZW1vdGUtbW9kYWwnKSB7XHJcbiAgICAgICAgICAgIGlmKCF0aGlzLmlzVGV4dEZyb21EaWFsb2cpIHtcclxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ+W8ueeql+aooeW8j+S4i+aOp+S7tuWGheaWh+acrOaYr+aJi+WKqOi+k+WFpeeahCcpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtLnZhbHVlLmlzSW5wdXRUZXh0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZih0aGlzLml0ZW0udmFsdWUudGV4dFZhbHVlICE9IHRoaXMudGV4dEZvcm1EaWFsb2cpe1xyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygn6YCa6L+H5by556qX6YCJ5oup55qE5YC85bey6KKr5omL5Yqo5L+u5pS5Jyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzVGV4dEZyb21EaWFsb2cgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXRlbS52YWx1ZS52YWx1ZSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtLnZhbHVlLnRleHRGaWVsZCA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXRlbS52YWx1ZS5pc0lucHV0VGV4dCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb25kaXRpb25DaGFuZ2UuZW1pdCgpO1xyXG4gICAgfVxyXG59Il19