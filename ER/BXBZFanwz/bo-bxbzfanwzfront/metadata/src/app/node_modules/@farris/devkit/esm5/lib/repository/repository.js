/*
 * @Author: Witt
 * @Date: 2018-10-12 15:37:11
 * @Last Modified by: aalizzwell
 * @Last Modified time: 2019-09-03 19:10:44
 * @todo 待优化问题
 * 1、apiUrl是否应该在基类中，子类中的api如何传递给基类；
 */
import { Injectable } from '@angular/core';
import { DataTypeInfo } from '../core/index';
import { MetadataUtil } from '../metadata/index';
import { createEntity, createEntities } from '../entity/index';
import { EntityCollection } from './entity_collection';
import { PaginationManager } from './pagination_manager';
import { DataChangeHistory } from './data_change_history';
import { SortConditionManager } from './sort_condition_manager';
import { FilterConditionManager } from './filter_condition_manager';
import { UID } from '../misc/uid';
/**
 * 本地仓库
 * @description
 * # Repository
 *
 * Repository负责与后台接口交互并将接口返回的数据转换为Entity集合进行保存。因此Repository有两个重要的职责：后端交互、数据存储。
 * Repository中存储的数据是Entity类型，可以通过API对数据进行修改或删除。由于Repository和BindingData相互监听，对数据仓库的操作最终会通过BindingData更新到界面上。
 *
 * ## 实体操作
 * 实体操作仅对Repository本地已经存在的数据进行操作，不会发送请求。
 *
 * - 通过主键获取实体
 *
 *   ```javascript
 *    this.repository.entityCollection.getEntityById("id");
 *   ```
 *
 * - 删除实体数据
 *
 *   ```javascript
 *   this.repository.entityCollection.removeEntityById("id")
 *   ```
 *
 * - 清空所有实体
 *
 *   ```javascript
 *   this.repository.entityCollection.clear();
 *   ```
 *
 * - 将实体数据转换为json格式
 *
 *   ```javascript
 *   this.repository.entityCollection.toJSON();
 *   ```
 *
 * - 添加实体
 *
 *   ```javascript
 *   this.repository.entityCollection.addEntity(entity:T);
 *   ```
 * - 添加子表实体
 *
 *   ```javascript
 *   const befRepository = this.repository as BefRepository<any>;
 *   const entityManager = befRepository.entityManager;
 *   entityManager.appendEntityByPath("/主实体Id/子表名s",{子表JSON数据});
 *   ```
 * - 批量添加实体
 *
 *   ```javascript
 *   this.repository.entityCollection.addEntities(entities:T[])
 *   ```
 *
 * - 批量添加子表实体
 *
 *   ```javascript
 *   const befRepository = this.repository as BefRepository<any>;
 *   const entityManager = befRepository.entityManager;
 *   const childrenEntities = entityManager.createEntitiesByPath(["主实体Id","子表名s"], entityListData: any[])
 *   entityManager.appendEntitiesByPath(["主实体Id","子表名s"],childrenEntities);
 *   ```
 *
 * - 批量加载实体
 *
 *   ```javascript
 *   this.repository.entityCollection.loadEntities(entities:T[]);
 *   ```
 *
 *   > 加载实体会将本地仓库数据置为加载的实体。
 *
 * - 创建实体
 *
 *   ```javascript
 *   this.repository.buildEntity(JSON数据);
 *   ```
 *
 * - 批量创建实体
 *
 *   ```javascript
 *   this.repository.buildEntities(JSON数据);
 *   ```
 *
 * - 获取子表数据
 *
 *   ```javascript
 *   const befRepository = this.repository as BefRepository<any>;
 *   const entityManager = befRepository.entityManager;
 *   entityManager.getEntityByPath(["主实体Id","子表名","子表id"]);
 *   ```
 *
 *   !> **注意** entityManager属性仅存在于BefRepository类，因此在使用EntityManager时应先将Repository转换为BefRepository
 *
 * - 获取所有子表数据
 *
 *   ```javascript
 *   const befRepository = this.repository as BefRepository<any>;
 *   const entityManager = befRepository.entityManager;
 *   entityManager.getEntitiesByPath(["主实体Id","子表名"]);
 *   ```
 *
 *   > EntityManager不仅可以获取子表数据，同样可以获取主表数据。
 *   >
 *   > ```javascript
 *   > entityManager.getEntitiesByPath(["主实体Id"]);
 *   > ```
 *
 * - 获取实体属性值
 *
 *   ```javascript
 *   const entity = this.repository.entityCollection.getEntityById("id");
 *   cosnt name = entity['name'];
 *   // 或者
 *   const entity: any = this.repository.entityCollection.getEntityById("id");
 *   cosnt name = entity.name;
 *   ```
 *
 * ## 后端交互
 *
 * ​	通过接口操作后端数据，会直接对数据产生影响。
 *
 * - 更新实体数据
 *
 *   ```javascript
 *   this.repository.updateById('id');
 *   ```
 *
 * - 删除实体
 *
 *   ```javascript
 *   this.repository.removeById("id");
 *   ```
 *
 * - 批量删除实体
 *
 *   ```javascript
 *   this.repository.removeByIds(ids:string[])
 *   ```
 *
 * - 删除下级表数据
 *
 *   ```javascript
 *   this.repository.removeByPath(['主表Id','子表名','子表Id'])
 *   ```
 *
 * - 新增主实体
 *
 *   ```javascript
 *   this.repository.append();
 *   ```
 *
 * - 新增子实体
 *
 *   ```javascript
 *   this.repository.appendByPath(['主表id','子表名']);
 *   ```
 *
 * - 加载实体数据
 *
 *   ```javascript
 *   this.repository.getById('id');
 *   ```
 *
 * - 获取主表数据
 *
 *   ```javascript
 *   this.repository.getEntities(filter: any[], sorts: any[], pageSize: number | null, pageIndex: number | null)
 *
 *   ```
 *
 *   > pageSize、pageIndex可以不传。
 *
 * - 获取主表数据（POST方法）
 *
 *   ```javascript
 *   this.repository.filter(filter: any[], sorts: any[], pageSize: number | null, pageIndex: number | null)
 *   ```
 *
 * - 提交指定实体变更到后端
 *
 *   ```javascript
 *   this.repository.updateChangesById("id");
 *   ```
 *
 * - 提交所有变更
 *
 *   ```javascript
 *   this.repository.updateAllChanges();
 *   ```
 *
 * - 应用变更（保存）
 *
 *   ```javascript
 *   this.repository.applyChanges();
 *   ```
 *
 * - 取消变更
 *
 *   ```javascript
 *   this.repository.cancelChanges();
 *   ```
 *
 * - 清除Repository所有变更
 *
 *   ```javascript
 *   const befRepository = this.repository as BefRepository<any>;
 *   befRepository.entityManager.clearAllEntityChanges();
 *   ```
 *
 * - 批量新增子表数据
 *   ```javascript
 *   this.repository.batchAppendByPath(path: string, defaultValues: Array<any>);
 *   ```
 *
 *   > path `string`：/主表id/从表前端nodeCode，如果/1/orders
 *   >
 *   > defaultValues `Array<any>`：新增从表时的默认值，数组，元素为对象，key为字段名，value为默认值。
 *
 * - 批量删除子表数据
 *
 *   ```javascript
 *   this.repository.batchRemoveByPath(path: string, ids: string);
 *   ```
 *
 *   > path `string`： /主表id/从表前端nodeCode，如果/1/orders
 *   >
 *   > ids `string` ：要删除的子表数据id，格式为`id1,id2,id3`
 */
var Repository = /** @class */ (function () {
    // #endregion
    /**
     * 构造函数
     */
    function Repository() {
        /**
         * 用户分页配置信息
         */
        this.paginationInfo = null;
        this.readMetadata();
        if (this.entityType) {
            this.entityTypeInfo = new DataTypeInfo(this.entityType);
            this.entityCollection = new EntityCollection(this.entityType);
        }
        this.dataChangeHistory = new DataChangeHistory();
        this.sortConditionManager = new SortConditionManager();
        this.filterConditionManager = new FilterConditionManager();
    }
    Object.defineProperty(Repository.prototype, "primaryKey", {
        // #endregion
        // #region get/set方法
        /**
         * 实体主键
         */
        get: function () {
            return this.entityCollection.primaryKey;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Repository.prototype, "changes", {
        get: function () {
            return this.entityCollection.changes;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Repository.prototype, "entityCollectionChange", {
        /**
         * 实体变更集合
         */
        get: function () {
            return this.entityCollection.collectionChanged;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Repository.prototype, "name", {
        /**
         * 获取名称
         */
        get: function () {
            // 1、老表单没有name属性
            // 2、不能使用construcotr.name，压缩脚本会把name改掉，或者压缩成相同的名称（目前发现已知）
            if (!this.innerName) {
                var guid = UID.create();
                this.innerName = "Repository_" + guid;
            }
            return this.innerName;
        },
        /**
         * 设置名称
         */
        set: function (value) {
            this.innerName = value;
        },
        enumerable: true,
        configurable: true
    });
    Repository.prototype.updateEntityType = function (entityType) {
        this.entityType = entityType;
        this.entityTypeInfo = new DataTypeInfo(this.entityType);
        this.entityCollection = new EntityCollection(this.entityType);
    };
    /**
     * 读取元数据
     */
    Repository.prototype.readMetadata = function () {
        var repositoryMetadata = MetadataUtil.getClassMetadataByName(this.constructor, 'NgRepository');
        if (repositoryMetadata) {
            // API地址
            this.apiUri = repositoryMetadata.apiUrl;
            // 实体类型
            this.entityType = repositoryMetadata.entityType;
        }
        // // API地址
        // this.apiUri = repositoryMetadata.apiUrl;
        // // 实体类型
        // this.entityType = repositoryMetadata.entityType;
    };
    /**
     * 初始化分页配置
     * @param config 用户分页配置
     */
    Repository.prototype.setPaginationConfig = function (config) {
        this.paginationManager = new PaginationManager(this.entityType, config);
        var _a = (this.paginationManager.getPaginationConfigByPath('/') || {}).pageSize, pageSize = _a === void 0 ? 0 : _a;
        // tslint:disable-next-line: max-line-length
        this.entityCollection.paginationInfo = Object.assign({ pageSize: pageSize }, this.paginationManager.pagination, this.entityCollection.paginationInfo);
        // 无需再单独设置一次pageSize，减少一次变更
        // this.entityCollection.pageSize = pageSize;
    };
    /**
     * 重置状态
     */
    Repository.prototype.reset = function () {
        this.entityCollection.reset();
    };
    /**
     * 创建实体
     */
    Repository.prototype.buildEntity = function (data) {
        var entity = createEntity(this.entityType, data);
        return entity;
    };
    /**
     * 批量创建实体
     */
    Repository.prototype.buildEntities = function (listData) {
        var entities = createEntities(this.entityType, listData);
        return entities;
    };
    Repository.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    Repository.ctorParameters = function () { return []; };
    return Repository;
}());
export { Repository };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVwb3NpdG9yeS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvZGV2a2l0LyIsInNvdXJjZXMiOlsibGliL3JlcG9zaXRvcnkvcmVwb3NpdG9yeS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7OztHQU9HO0FBRUgsT0FBTyxFQUFRLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUdqRCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRTdDLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNqRCxPQUFPLEVBQVUsWUFBWSxFQUFFLGNBQWMsRUFBcUIsTUFBTSxpQkFBaUIsQ0FBQztBQUUxRixPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN2RCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUN6RCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUMxRCxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUNoRSxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUNwRSxPQUFPLEVBQUUsR0FBRyxFQUFFLE1BQU0sYUFBYSxDQUFDO0FBRWxDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBa09HO0FBQ0g7SUFpR0UsYUFBYTtJQUViOztPQUVHO0lBQ0g7UUFsRUE7O1dBRUc7UUFDSSxtQkFBYyxHQUFRLElBQUks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QixDQUFDLGNBQWMsQ0FBQyxDQUFDO1FBQzVJLDJCQUEyQjtRQUMzQiw2Q0FBNkM7SUFDL0MsQ0FBQztJQUNEOztPQUVHO0lBQ0ksMEJBQUssR0FBWjtRQUNFLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUNoQyxDQUFDO0lBRUQ7O09BRUc7SUFDSSxnQ0FBVyxHQUFsQixVQUFtQixJQUFTO1FBQzFCLElBQU0sTUFBTSxHQUFHLFlBQVksQ0FBSSxJQUFJLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3RELE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7SUFFRDs7T0FFRztJQUNJLGtDQUFhLEdBQXBCLFVBQXFCLFFBQWU7UUFDbEMsSUFBTSxRQUFRLEdBQVEsY0FBYyxDQUFJLElBQUksQ0FBQyxVQUFVLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDbkUsT0FBTyxRQUFRLENBQUM7SUFDbEIsQ0FBQzs7Z0JBN0tGLFVBQVU7Ozs7SUFrVVgsaUJBQUM7Q0FBQSxBQWxVRCxJQWtVQztTQWpVcUIsVUFBVSIsInNvdXJjZXNDb250ZW50IjpbIi8qXHJcbiAqIEBBdXRob3I6IFdpdHRcclxuICogQERhdGU6IDIwMTgtMTAtMTIgMTU6Mzc6MTFcclxuICogQExhc3QgTW9kaWZpZWQgYnk6IGFhbGl6endlbGxcclxuICogQExhc3QgTW9kaWZpZWQgdGltZTogMjAxOS0wOS0wMyAxOToxMDo0NFxyXG4gKiBAdG9kbyDlvoXkvJjljJbpl67pophcclxuICogMeOAgWFwaVVybOaYr+WQpuW6lOivpeWcqOWfuuexu+S4re+8jOWtkOexu+S4reeahGFwaeWmguS9leS8oOmAkue7meWfuuexu++8m1xyXG4gKi9cclxuXHJcbmltcG9ydCB7IFR5cGUsIEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xyXG5cclxuaW1wb3J0IHsgRGF0YVR5cGVJbmZvIH0gZnJvbSAnLi4vY29yZS9pbmRleCc7XHJcbmltcG9ydCB7IE1vZGlmaWNhdGlvbiB9IGZyb20gJy4uL2NoYW5nZXNldC9pbmRleCc7XHJcbmltcG9ydCB7IE1ldGFkYXRhVXRpbCB9IGZyb20gJy4uL21ldGFkYXRhL2luZGV4JztcclxuaW1wb3J0IHsgRW50aXR5LCBjcmVhdGVFbnRpdHksIGNyZWF0ZUVudGl0aWVzLCBGaWVsZE1ldGFkYXRhVXRpbCB9IGZyb20gJy4uL2VudGl0eS9pbmRleCc7XHJcbmltcG9ydCB7IE5nUmVwb3NpdG9yeSB9IGZyb20gJy4vZGVjb3JhdG9ycyc7XHJcbmltcG9ydCB7IEVudGl0eUNvbGxlY3Rpb24gfSBmcm9tICcuL2VudGl0eV9jb2xsZWN0aW9uJztcclxuaW1wb3J0IHsgUGFnaW5hdGlvbk1hbmFnZXIgfSBmcm9tICcuL3BhZ2luYXRpb25fbWFuYWdlcic7XHJcbmltcG9ydCB7IERhdGFDaGFuZ2VIaXN0b3J5IH0gZnJvbSAnLi9kYXRhX2NoYW5nZV9oaXN0b3J5JztcclxuaW1wb3J0IHsgU29ydENvbmRpdGlvbk1hbmFnZXIgfSBmcm9tICcuL3NvcnRfY29uZGl0aW9uX21hbmFnZXInO1xyXG5pbXBvcnQgeyBGaWx0ZXJDb25kaXRpb25NYW5hZ2VyIH0gZnJvbSAnLi9maWx0ZXJfY29uZGl0aW9uX21hbmFnZXInO1xyXG5pbXBvcnQgeyBVSUQgfSBmcm9tICcuLi9taXNjL3VpZCc7XHJcblxyXG4vKipcclxuICog5pys5Zyw5LuT5bqTXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiAjIFJlcG9zaXRvcnlcclxuICogXHJcbiAqIFJlcG9zaXRvcnnotJ/otKPkuI7lkI7lj7DmjqXlj6PkuqTkupLlubblsIbmjqXlj6Pov5Tlm57nmoTmlbDmja7ovazmjaLkuLpFbnRpdHnpm4blkIjov5vooYzkv53lrZjjgILlm6DmraRSZXBvc2l0b3J55pyJ5Lik5Liq6YeN6KaB55qE6IGM6LSj77ya5ZCO56uv5Lqk5LqS44CB5pWw5o2u5a2Y5YKo44CCXHJcbiAqIFJlcG9zaXRvcnnkuK3lrZjlgqjnmoTmlbDmja7mmK9FbnRpdHnnsbvlnovvvIzlj6/ku6XpgJrov4dBUEnlr7nmlbDmja7ov5vooYzkv67mlLnmiJbliKDpmaTjgILnlLHkuo5SZXBvc2l0b3J55ZKMQmluZGluZ0RhdGHnm7jkupLnm5HlkKzvvIzlr7nmlbDmja7ku5PlupPnmoTmk43kvZzmnIDnu4jkvJrpgJrov4dCaW5kaW5nRGF0YeabtOaWsOWIsOeVjOmdouS4iuOAglxyXG4gKiBcclxuICogIyMg5a6e5L2T5pON5L2cXHJcbiAqIOWunuS9k+aTjeS9nOS7heWvuVJlcG9zaXRvcnnmnKzlnLDlt7Lnu4/lrZjlnKjnmoTmlbDmja7ov5vooYzmk43kvZzvvIzkuI3kvJrlj5HpgIHor7fmsYLjgIJcclxuICogXHJcbiAqIC0g6YCa6L+H5Li76ZSu6I635Y+W5a6e5L2TXHJcbiAqIFxyXG4gKiAgIGBgYGphdmFzY3JpcHRcclxuICogICAgdGhpcy5yZXBvc2l0b3J5LmVudGl0eUNvbGxlY3Rpb24uZ2V0RW50aXR5QnlJZChcImlkXCIpO1xyXG4gKiAgIGBgYFxyXG4gKiBcclxuICogLSDliKDpmaTlrp7kvZPmlbDmja5cclxuICogXHJcbiAqICAgYGBgamF2YXNjcmlwdFxyXG4gKiAgIHRoaXMucmVwb3NpdG9yeS5lbnRpdHlDb2xsZWN0aW9uLnJlbW92ZUVudGl0eUJ5SWQoXCJpZFwiKVxyXG4gKiAgIGBgYFxyXG4gKiBcclxuICogLSDmuIXnqbrmiYDmnInlrp7kvZNcclxuICogXHJcbiAqICAgYGBgamF2YXNjcmlwdFxyXG4gKiAgIHRoaXMucmVwb3NpdG9yeS5lbnRpdHlDb2xsZWN0aW9uLmNsZWFyKCk7XHJcbiAqICAgYGBgXHJcbiAqIFxyXG4gKiAtIOWwhuWunuS9k+aVsOaNrui9rOaNouS4umpzb27moLzlvI9cclxuICogXHJcbiAqICAgYGBgamF2YXNjcmlwdFxyXG4gKiAgIHRoaXMucmVwb3NpdG9yeS5lbnRpdHlDb2xsZWN0aW9uLnRvSlNPTigpO1xyXG4gKiAgIGBgYFxyXG4gKiBcclxuICogLSDmt7vliqDlrp7kvZNcclxuICogXHJcbiAqICAgYGBgamF2YXNjcmlwdFxyXG4gKiAgIHRoaXMucmVwb3NpdG9yeS5lbnRpdHlDb2xsZWN0aW9uLmFkZEVudGl0eShlbnRpdHk6VCk7XHJcbiAqICAgYGBgXHJcbiAqIC0g5re75Yqg5a2Q6KGo5a6e5L2TXHJcbiAqIFxyXG4gKiAgIGBgYGphdmFzY3JpcHRcclxuICogICBjb25zdCBiZWZSZXBvc2l0b3J5ID0gdGhpcy5yZXBvc2l0b3J5IGFzIEJlZlJlcG9zaXRvcnk8YW55PjtcclxuICogICBjb25zdCBlbnRpdHlNYW5hZ2VyID0gYmVmUmVwb3NpdG9yeS5lbnRpdHlNYW5hZ2VyO1xyXG4gKiAgIGVudGl0eU1hbmFnZXIuYXBwZW5kRW50aXR5QnlQYXRoKFwiL+S4u+WunuS9k0lkL+WtkOihqOWQjXNcIix75a2Q6KGoSlNPTuaVsOaNrn0pO1xyXG4gKiAgIGBgYFxyXG4gKiAtIOaJuemHj+a3u+WKoOWunuS9k1xyXG4gKiBcclxuICogICBgYGBqYXZhc2NyaXB0XHJcbiAqICAgdGhpcy5yZXBvc2l0b3J5LmVudGl0eUNvbGxlY3Rpb24uYWRkRW50aXRpZXMoZW50aXRpZXM6VFtdKVxyXG4gKiAgIGBgYFxyXG4gKiAgIFxyXG4gKiAtIOaJuemHj+a3u+WKoOWtkOihqOWunuS9k1xyXG4gKiBcclxuICogICBgYGBqYXZhc2NyaXB0XHJcbiAqICAgY29uc3QgYmVmUmVwb3NpdG9yeSA9IHRoaXMucmVwb3NpdG9yeSBhcyBCZWZSZXBvc2l0b3J5PGFueT47XHJcbiAqICAgY29uc3QgZW50aXR5TWFuYWdlciA9IGJlZlJlcG9zaXRvcnkuZW50aXR5TWFuYWdlcjtcclxuICogICBjb25zdCBjaGlsZHJlbkVudGl0aWVzID0gZW50aXR5TWFuYWdlci5jcmVhdGVFbnRpdGllc0J5UGF0aChbXCLkuLvlrp7kvZNJZFwiLFwi5a2Q6KGo5ZCNc1wiXSwgZW50aXR5TGlzdERhdGE6IGFueVtdKVxyXG4gKiAgIGVudGl0eU1hbmFnZXIuYXBwZW5kRW50aXRpZXNCeVBhdGgoW1wi5Li75a6e5L2TSWRcIixcIuWtkOihqOWQjXNcIl0sY2hpbGRyZW5FbnRpdGllcyk7XHJcbiAqICAgYGBgXHJcbiAqIFxyXG4gKiAtIOaJuemHj+WKoOi9veWunuS9k1xyXG4gKiBcclxuICogICBgYGBqYXZhc2NyaXB0XHJcbiAqICAgdGhpcy5yZXBvc2l0b3J5LmVudGl0eUNvbGxlY3Rpb24ubG9hZEVudGl0aWVzKGVudGl0aWVzOlRbXSk7XHJcbiAqICAgYGBgXHJcbiAqIFxyXG4gKiAgID4g5Yqg6L295a6e5L2T5Lya5bCG5pys5Zyw5LuT5bqT5pWw5o2u572u5Li65Yqg6L2955qE5a6e5L2T44CCXHJcbiAqIFxyXG4gKiAtIOWIm+W7uuWunuS9k1xyXG4gKiBcclxuICogICBgYGBqYXZhc2NyaXB0XHJcbiAqICAgdGhpcy5yZXBvc2l0b3J5LmJ1aWxkRW50aXR5KEpTT07mlbDmja4pO1xyXG4gKiAgIGBgYFxyXG4gKiBcclxuICogLSDmibnph4/liJvlu7rlrp7kvZNcclxuICogXHJcbiAqICAgYGBgamF2YXNjcmlwdFxyXG4gKiAgIHRoaXMucmVwb3NpdG9yeS5idWlsZEVudGl0aWVzKEpTT07mlbDmja4pO1xyXG4gKiAgIGBgYFxyXG4gKiBcclxuICogLSDojrflj5blrZDooajmlbDmja5cclxuICogXHJcbiAqICAgYGBgamF2YXNjcmlwdFxyXG4gKiAgIGNvbnN0IGJlZlJlcG9zaXRvcnkgPSB0aGlzLnJlcG9zaXRvcnkgYXMgQmVmUmVwb3NpdG9yeTxhbnk+O1xyXG4gKiAgIGNvbnN0IGVudGl0eU1hbmFnZXIgPSBiZWZSZXBvc2l0b3J5LmVudGl0eU1hbmFnZXI7XHJcbiAqICAgZW50aXR5TWFuYWdlci5nZXRFbnRpdHlCeVBhdGgoW1wi5Li75a6e5L2TSWRcIixcIuWtkOihqOWQjVwiLFwi5a2Q6KGoaWRcIl0pO1xyXG4gKiAgIGBgYFxyXG4gKiBcclxuICogICAhPiAqKuazqOaEjyoqIGVudGl0eU1hbmFnZXLlsZ7mgKfku4XlrZjlnKjkuo5CZWZSZXBvc2l0b3J557G777yM5Zug5q2k5Zyo5L2/55SoRW50aXR5TWFuYWdlcuaXtuW6lOWFiOWwhlJlcG9zaXRvcnnovazmjaLkuLpCZWZSZXBvc2l0b3J5XHJcbiAqIFxyXG4gKiAtIOiOt+WPluaJgOacieWtkOihqOaVsOaNrlxyXG4gKiBcclxuICogICBgYGBqYXZhc2NyaXB0XHJcbiAqICAgY29uc3QgYmVmUmVwb3NpdG9yeSA9IHRoaXMucmVwb3NpdG9yeSBhcyBCZWZSZXBvc2l0b3J5PGFueT47XHJcbiAqICAgY29uc3QgZW50aXR5TWFuYWdlciA9IGJlZlJlcG9zaXRvcnkuZW50aXR5TWFuYWdlcjtcclxuICogICBlbnRpdHlNYW5hZ2VyLmdldEVudGl0aWVzQnlQYXRoKFtcIuS4u+WunuS9k0lkXCIsXCLlrZDooajlkI1cIl0pO1xyXG4gKiAgIGBgYFxyXG4gKiBcclxuICogICA+IEVudGl0eU1hbmFnZXLkuI3ku4Xlj6/ku6Xojrflj5blrZDooajmlbDmja7vvIzlkIzmoLflj6/ku6Xojrflj5bkuLvooajmlbDmja7jgIJcclxuICogICA+XHJcbiAqICAgPiBgYGBqYXZhc2NyaXB0XHJcbiAqICAgPiBlbnRpdHlNYW5hZ2VyLmdldEVudGl0aWVzQnlQYXRoKFtcIuS4u+WunuS9k0lkXCJdKTtcclxuICogICA+IGBgYFxyXG4gKiAgIFxyXG4gKiAtIOiOt+WPluWunuS9k+WxnuaAp+WAvFxyXG4gKiBcclxuICogICBgYGBqYXZhc2NyaXB0XHJcbiAqICAgY29uc3QgZW50aXR5ID0gdGhpcy5yZXBvc2l0b3J5LmVudGl0eUNvbGxlY3Rpb24uZ2V0RW50aXR5QnlJZChcImlkXCIpO1xyXG4gKiAgIGNvc250IG5hbWUgPSBlbnRpdHlbJ25hbWUnXTtcclxuICogICAvLyDmiJbogIVcclxuICogICBjb25zdCBlbnRpdHk6IGFueSA9IHRoaXMucmVwb3NpdG9yeS5lbnRpdHlDb2xsZWN0aW9uLmdldEVudGl0eUJ5SWQoXCJpZFwiKTtcclxuICogICBjb3NudCBuYW1lID0gZW50aXR5Lm5hbWU7XHJcbiAqICAgYGBgXHJcbiAqIFxyXG4gKiAjIyDlkI7nq6/kuqTkupJcclxuICogXHJcbiAqIOKAi1x06YCa6L+H5o6l5Y+j5pON5L2c5ZCO56uv5pWw5o2u77yM5Lya55u05o6l5a+55pWw5o2u5Lqn55Sf5b2x5ZON44CCXHJcbiAqIFxyXG4gKiAtIOabtOaWsOWunuS9k+aVsOaNrlxyXG4gKiBcclxuICogICBgYGBqYXZhc2NyaXB0XHJcbiAqICAgdGhpcy5yZXBvc2l0b3J5LnVwZGF0ZUJ5SWQoJ2lkJyk7XHJcbiAqICAgYGBgXHJcbiAqIFxyXG4gKiAtIOWIoOmZpOWunuS9k1xyXG4gKiBcclxuICogICBgYGBqYXZhc2NyaXB0XHJcbiAqICAgdGhpcy5yZXBvc2l0b3J5LnJlbW92ZUJ5SWQoXCJpZFwiKTtcclxuICogICBgYGBcclxuICogXHJcbiAqIC0g5om56YeP5Yig6Zmk5a6e5L2TXHJcbiAqIFxyXG4gKiAgIGBgYGphdmFzY3JpcHRcclxuICogICB0aGlzLnJlcG9zaXRvcnkucmVtb3ZlQnlJZHMoaWRzOnN0cmluZ1tdKVxyXG4gKiAgIGBgYFxyXG4gKiBcclxuICogLSDliKDpmaTkuIvnuqfooajmlbDmja5cclxuICogXHJcbiAqICAgYGBgamF2YXNjcmlwdFxyXG4gKiAgIHRoaXMucmVwb3NpdG9yeS5yZW1vdmVCeVBhdGgoWyfkuLvooahJZCcsJ+WtkOihqOWQjScsJ+WtkOihqElkJ10pXHJcbiAqICAgYGBgXHJcbiAqIFxyXG4gKiAtIOaWsOWinuS4u+WunuS9k1xyXG4gKiBcclxuICogICBgYGBqYXZhc2NyaXB0XHJcbiAqICAgdGhpcy5yZXBvc2l0b3J5LmFwcGVuZCgpO1xyXG4gKiAgIGBgYFxyXG4gKiBcclxuICogLSDmlrDlop7lrZDlrp7kvZNcclxuICogXHJcbiAqICAgYGBgamF2YXNjcmlwdFxyXG4gKiAgIHRoaXMucmVwb3NpdG9yeS5hcHBlbmRCeVBhdGgoWyfkuLvooahpZCcsJ+WtkOihqOWQjSddKTtcclxuICogICBgYGBcclxuICogXHJcbiAqIC0g5Yqg6L295a6e5L2T5pWw5o2uXHJcbiAqIFxyXG4gKiAgIGBgYGphdmFzY3JpcHRcclxuICogICB0aGlzLnJlcG9zaXRvcnkuZ2V0QnlJZCgnaWQnKTtcclxuICogICBgYGBcclxuICogXHJcbiAqIC0g6I635Y+W5Li76KGo5pWw5o2uXHJcbiAqIFxyXG4gKiAgIGBgYGphdmFzY3JpcHRcclxuICogICB0aGlzLnJlcG9zaXRvcnkuZ2V0RW50aXRpZXMoZmlsdGVyOiBhbnlbXSwgc29ydHM6IGFueVtdLCBwYWdlU2l6ZTogbnVtYmVyIHwgbnVsbCwgcGFnZUluZGV4OiBudW1iZXIgfCBudWxsKVxyXG4gKiAgIFxyXG4gKiAgIGBgYFxyXG4gKiBcclxuICogICA+IHBhZ2VTaXpl44CBcGFnZUluZGV45Y+v5Lul5LiN5Lyg44CCXHJcbiAqIFxyXG4gKiAtIOiOt+WPluS4u+ihqOaVsOaNru+8iFBPU1Tmlrnms5XvvIlcclxuICogXHJcbiAqICAgYGBgamF2YXNjcmlwdFxyXG4gKiAgIHRoaXMucmVwb3NpdG9yeS5maWx0ZXIoZmlsdGVyOiBhbnlbXSwgc29ydHM6IGFueVtdLCBwYWdlU2l6ZTogbnVtYmVyIHwgbnVsbCwgcGFnZUluZGV4OiBudW1iZXIgfCBudWxsKVxyXG4gKiAgIGBgYFxyXG4gKiBcclxuICogLSDmj5DkuqTmjIflrprlrp7kvZPlj5jmm7TliLDlkI7nq69cclxuICogXHJcbiAqICAgYGBgamF2YXNjcmlwdFxyXG4gKiAgIHRoaXMucmVwb3NpdG9yeS51cGRhdGVDaGFuZ2VzQnlJZChcImlkXCIpO1xyXG4gKiAgIGBgYFxyXG4gKiBcclxuICogLSDmj5DkuqTmiYDmnInlj5jmm7RcclxuICogXHJcbiAqICAgYGBgamF2YXNjcmlwdFxyXG4gKiAgIHRoaXMucmVwb3NpdG9yeS51cGRhdGVBbGxDaGFuZ2VzKCk7XHJcbiAqICAgYGBgXHJcbiAqIFxyXG4gKiAtIOW6lOeUqOWPmOabtO+8iOS/neWtmO+8iVxyXG4gKiBcclxuICogICBgYGBqYXZhc2NyaXB0XHJcbiAqICAgdGhpcy5yZXBvc2l0b3J5LmFwcGx5Q2hhbmdlcygpO1xyXG4gKiAgIGBgYFxyXG4gKiBcclxuICogLSDlj5bmtojlj5jmm7RcclxuICogXHJcbiAqICAgYGBgamF2YXNjcmlwdFxyXG4gKiAgIHRoaXMucmVwb3NpdG9yeS5jYW5jZWxDaGFuZ2VzKCk7XHJcbiAqICAgYGBgXHJcbiAqIFxyXG4gKiAtIOa4hemZpFJlcG9zaXRvcnnmiYDmnInlj5jmm7RcclxuICogXHJcbiAqICAgYGBgamF2YXNjcmlwdFxyXG4gKiAgIGNvbnN0IGJlZlJlcG9zaXRvcnkgPSB0aGlzLnJlcG9zaXRvcnkgYXMgQmVmUmVwb3NpdG9yeTxhbnk+O1xyXG4gKiAgIGJlZlJlcG9zaXRvcnkuZW50aXR5TWFuYWdlci5jbGVhckFsbEVudGl0eUNoYW5nZXMoKTtcclxuICogICBgYGBcclxuICogICBcclxuICogLSDmibnph4/mlrDlop7lrZDooajmlbDmja5cclxuICogICBgYGBqYXZhc2NyaXB0XHJcbiAqICAgdGhpcy5yZXBvc2l0b3J5LmJhdGNoQXBwZW5kQnlQYXRoKHBhdGg6IHN0cmluZywgZGVmYXVsdFZhbHVlczogQXJyYXk8YW55Pik7XHJcbiAqICAgYGBgXHJcbiAqICAgXHJcbiAqICAgPiBwYXRoIGBzdHJpbmdg77yaL+S4u+ihqGlkL+S7juihqOWJjeerr25vZGVDb2Rl77yM5aaC5p6cLzEvb3JkZXJzXHJcbiAqICAgPlxyXG4gKiAgID4gZGVmYXVsdFZhbHVlcyBgQXJyYXk8YW55PmDvvJrmlrDlop7ku47ooajml7bnmoTpu5jorqTlgLzvvIzmlbDnu4TvvIzlhYPntKDkuLrlr7nosaHvvIxrZXnkuLrlrZfmrrXlkI3vvIx2YWx1ZeS4uum7mOiupOWAvOOAglxyXG4gKiAgIFxyXG4gKiAtIOaJuemHj+WIoOmZpOWtkOihqOaVsOaNrlxyXG4gKiAgIFxyXG4gKiAgIGBgYGphdmFzY3JpcHRcclxuICogICB0aGlzLnJlcG9zaXRvcnkuYmF0Y2hSZW1vdmVCeVBhdGgocGF0aDogc3RyaW5nLCBpZHM6IHN0cmluZyk7XHJcbiAqICAgYGBgXHJcbiAqICAgXHJcbiAqICAgPiBwYXRoIGBzdHJpbmdg77yaIC/kuLvooahpZC/ku47ooajliY3nq69ub2RlQ29kZe+8jOWmguaenC8xL29yZGVyc1xyXG4gKiAgID5cclxuICogICA+IGlkcyBgc3RyaW5nYCDvvJropoHliKDpmaTnmoTlrZDooajmlbDmja5pZO+8jOagvOW8j+S4umBpZDEsaWQyLGlkM2BcclxuICovXHJcbkBJbmplY3RhYmxlKClcclxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFJlcG9zaXRvcnk8VCBleHRlbmRzIEVudGl0eT4ge1xyXG5cclxuICAvLyAjcmVnaW9uIOengeacieWxnuaAp1xyXG5cclxuICAvKipcclxuICAgKiDlkI3np7BcclxuICAgKi9cclxuICBwcml2YXRlIGlubmVyTmFtZTogc3RyaW5nO1xyXG5cclxuICAvLyAjZW5kcmVnaW9uXHJcblxyXG4gIC8vICNyZWdpb24g5YWs5pyJ5bGe5oCn77yI5YWx5pyJ5bGe5oCn5LiN5bqU6K+l55u05o6l5pq06Zyy77yM5b6F5YyF6KOF77yJXHJcblxyXG4gIC8qKlxyXG4gICAqIEFQSeWcsOWdgFxyXG4gICAqL1xyXG4gIHB1YmxpYyBhcGlVcmk6IHN0cmluZztcclxuXHJcbiAgLyoqXHJcbiAgICog5a6e5L2T57G75Z6LXHJcbiAgICovXHJcbiAgcHVibGljIGVudGl0eVR5cGU6IGFueTtcclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIOWunuS9k+exu+Wei+S/oeaBr1xyXG4gICAqIEB0b2Rv77ya5a6e5L2T5bGC5bqU6K+l5LqL5YWI5LiA5LiqRW50aXR5VHlwZUluZm/vvIzlubbnu6fmib9EYXRhVHlwZUluZm/jgIJcclxuICAgKi9cclxuICBwdWJsaWMgZW50aXR5VHlwZUluZm86IERhdGFUeXBlSW5mbztcclxuXHJcbiAgLyoqXHJcbiAgICog5a6e5L2T6ZuG5ZCIXHJcbiAgICovXHJcbiAgcHVibGljIGVudGl0eUNvbGxlY3Rpb246IEVudGl0eUNvbGxlY3Rpb248VD47XHJcblxyXG4gIC8qKlxyXG4gICAqIOeUqOaIt+WIhumhtemFjee9ruS/oeaBr1xyXG4gICAqL1xyXG4gIHB1YmxpYyBwYWdpbmF0aW9uSW5mbzogYW55ID0gbnVsbDtcclxuXHJcbiAgLyoqXHJcbiAgICog5pWw5o2u5Y+Y5pu05Y6G5Y+y77yI5LuF6ZKI5a+55Li76KGo5aKe5Yqg44CB5ZCE56eN6KGo5Yig6Zmk77yJXHJcbiAgICovXHJcbiAgcHVibGljIGRhdGFDaGFuZ2VIaXN0b3J5OiBEYXRhQ2hhbmdlSGlzdG9yeTtcclxuXHJcbiAgLyoqXHJcbiAgICog5o6S5bqP5p2h5Lu2566h55CG5ZmoXHJcbiAgICovXHJcbiAgcHVibGljIHNvcnRDb25kaXRpb25NYW5hZ2VyOiBTb3J0Q29uZGl0aW9uTWFuYWdlcjtcclxuICAvKipcclxuICAgKiDov4fmu6TmnaHku7bnrqHnkIblmahcclxuICAgKi9cclxuICBwdWJsaWMgZmlsdGVyQ29uZGl0aW9uTWFuYWdlcjogRmlsdGVyQ29uZGl0aW9uTWFuYWdlcjtcclxuICAvLyAjZW5kcmVnaW9uXHJcblxyXG4gIC8vICNyZWdpb24gZ2V0L3NldOaWueazlVxyXG5cclxuICAvKipcclxuICAgKiDlrp7kvZPkuLvplK5cclxuICAgKi9cclxuICBwdWJsaWMgZ2V0IHByaW1hcnlLZXkoKTogc3RyaW5nIHtcclxuICAgIHJldHVybiB0aGlzLmVudGl0eUNvbGxlY3Rpb24ucHJpbWFyeUtleTtcclxuICB9XHJcbiAgcHVibGljIGdldCBjaGFuZ2VzKCk6IFN1YmplY3Q8TW9kaWZpY2F0aW9uPiB7XHJcbiAgICByZXR1cm4gdGhpcy5lbnRpdHlDb2xsZWN0aW9uLmNoYW5nZXM7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIOWunuS9k+WPmOabtOmbhuWQiFxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXQgZW50aXR5Q29sbGVjdGlvbkNoYW5nZSgpOiBTdWJqZWN0PE1vZGlmaWNhdGlvbj4ge1xyXG4gICAgcmV0dXJuIHRoaXMuZW50aXR5Q29sbGVjdGlvbi5jb2xsZWN0aW9uQ2hhbmdlZDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiOt+WPluWQjeensFxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXQgbmFtZSgpOiBzdHJpbmcge1xyXG5cclxuICAgIC8vIDHjgIHogIHooajljZXmsqHmnIluYW1l5bGe5oCnXHJcbiAgICAvLyAy44CB5LiN6IO95L2/55SoY29uc3RydWNvdHIubmFtZe+8jOWOi+e8qeiEmuacrOS8muaKim5hbWXmlLnmjonvvIzmiJbogIXljovnvKnmiJDnm7jlkIznmoTlkI3np7DvvIjnm67liY3lj5HnjrDlt7Lnn6XvvIlcclxuICAgIGlmICghdGhpcy5pbm5lck5hbWUpIHtcclxuICAgICAgY29uc3QgZ3VpZCA9IFVJRC5jcmVhdGUoKTtcclxuICAgICAgdGhpcy5pbm5lck5hbWUgPSBgUmVwb3NpdG9yeV8ke2d1aWR9YDtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdGhpcy5pbm5lck5hbWU7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIOiuvue9ruWQjeensFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzZXQgbmFtZSh2YWx1ZTogc3RyaW5nKSB7XHJcbiAgICB0aGlzLmlubmVyTmFtZSA9IHZhbHVlO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHBhZ2luYXRpb25NYW5hZ2VyOiBQYWdpbmF0aW9uTWFuYWdlcjxUPjtcclxuXHJcbiAgLy8gI2VuZHJlZ2lvblxyXG5cclxuICAvKipcclxuICAgKiDmnoTpgKDlh73mlbBcclxuICAgKi9cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHRoaXMucmVhZE1ldGFkYXRhKCk7XHJcbiAgICBpZiAodGhpcy5lbnRpdHlUeXBlKSB7XHJcbiAgICAgIHRoaXMuZW50aXR5VHlwZUluZm8gPSBuZXcgRGF0YVR5cGVJbmZvKHRoaXMuZW50aXR5VHlwZSk7XHJcbiAgICAgIHRoaXMuZW50aXR5Q29sbGVjdGlvbiA9IG5ldyBFbnRpdHlDb2xsZWN0aW9uPFQ+KHRoaXMuZW50aXR5VHlwZSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmRhdGFDaGFuZ2VIaXN0b3J5ID0gbmV3IERhdGFDaGFuZ2VIaXN0b3J5KCk7XHJcbiAgICB0aGlzLnNvcnRDb25kaXRpb25NYW5hZ2VyID0gbmV3IFNvcnRDb25kaXRpb25NYW5hZ2VyKCk7XHJcbiAgICB0aGlzLmZpbHRlckNvbmRpdGlvbk1hbmFnZXIgPSBuZXcgRmlsdGVyQ29uZGl0aW9uTWFuYWdlcigpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHVwZGF0ZUVudGl0eVR5cGUoZW50aXR5VHlwZTogYW55KSB7XHJcbiAgICB0aGlzLmVudGl0eVR5cGUgPSBlbnRpdHlUeXBlO1xyXG4gICAgdGhpcy5lbnRpdHlUeXBlSW5mbyA9IG5ldyBEYXRhVHlwZUluZm8odGhpcy5lbnRpdHlUeXBlKTtcclxuICAgIHRoaXMuZW50aXR5Q29sbGVjdGlvbiA9IG5ldyBFbnRpdHlDb2xsZWN0aW9uPFQ+KHRoaXMuZW50aXR5VHlwZSk7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICog6K+75Y+W5YWD5pWw5o2uXHJcbiAgICovXHJcbiAgcHJpdmF0ZSByZWFkTWV0YWRhdGEoKSB7XHJcbiAgICBjb25zdCByZXBvc2l0b3J5TWV0YWRhdGE6IE5nUmVwb3NpdG9yeSA9IE1ldGFkYXRhVXRpbC5nZXRDbGFzc01ldGFkYXRhQnlOYW1lKHRoaXMuY29uc3RydWN0b3IsICdOZ1JlcG9zaXRvcnknKTtcclxuICAgIGlmIChyZXBvc2l0b3J5TWV0YWRhdGEpIHtcclxuICAgICAgLy8gQVBJ5Zyw5Z2AXHJcbiAgICAgIHRoaXMuYXBpVXJpID0gcmVwb3NpdG9yeU1ldGFkYXRhLmFwaVVybDtcclxuXHJcbiAgICAgIC8vIOWunuS9k+exu+Wei1xyXG4gICAgICB0aGlzLmVudGl0eVR5cGUgPSByZXBvc2l0b3J5TWV0YWRhdGEuZW50aXR5VHlwZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyAvLyBBUEnlnLDlnYBcclxuICAgIC8vIHRoaXMuYXBpVXJpID0gcmVwb3NpdG9yeU1ldGFkYXRhLmFwaVVybDtcclxuXHJcbiAgICAvLyAvLyDlrp7kvZPnsbvlnotcclxuICAgIC8vIHRoaXMuZW50aXR5VHlwZSA9IHJlcG9zaXRvcnlNZXRhZGF0YS5lbnRpdHlUeXBlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5Yid5aeL5YyW5YiG6aG16YWN572uXHJcbiAgICogQHBhcmFtIGNvbmZpZyDnlKjmiLfliIbpobXphY3nva5cclxuICAgKi9cclxuICBzZXRQYWdpbmF0aW9uQ29uZmlnKGNvbmZpZzogYW55KSB7XHJcbiAgICB0aGlzLnBhZ2luYXRpb25NYW5hZ2VyID0gbmV3IFBhZ2luYXRpb25NYW5hZ2VyKHRoaXMuZW50aXR5VHlwZSwgY29uZmlnKTtcclxuICAgIGNvbnN0IHsgcGFnZVNpemUgPSAwIH0gPSB0aGlzLnBhZ2luYXRpb25NYW5hZ2VyLmdldFBhZ2luYXRpb25Db25maWdCeVBhdGgoJy8nKSB8fCB7fTtcclxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogbWF4LWxpbmUtbGVuZ3RoXHJcbiAgICB0aGlzLmVudGl0eUNvbGxlY3Rpb24ucGFnaW5hdGlvbkluZm8gPSBPYmplY3QuYXNzaWduKHsgcGFnZVNpemUgfSwgdGhpcy5wYWdpbmF0aW9uTWFuYWdlci5wYWdpbmF0aW9uLCB0aGlzLmVudGl0eUNvbGxlY3Rpb24ucGFnaW5hdGlvbkluZm8pO1xyXG4gICAgLy8g5peg6ZyA5YaN5Y2V54us6K6+572u5LiA5qyhcGFnZVNpemXvvIzlh4/lsJHkuIDmrKHlj5jmm7RcclxuICAgIC8vIHRoaXMuZW50aXR5Q29sbGVjdGlvbi5wYWdlU2l6ZSA9IHBhZ2VTaXplO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDph43nva7nirbmgIFcclxuICAgKi9cclxuICBwdWJsaWMgcmVzZXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLmVudGl0eUNvbGxlY3Rpb24ucmVzZXQoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWIm+W7uuWunuS9k1xyXG4gICAqL1xyXG4gIHB1YmxpYyBidWlsZEVudGl0eShkYXRhOiBhbnkpOiBUIHtcclxuICAgIGNvbnN0IGVudGl0eSA9IGNyZWF0ZUVudGl0eTxUPih0aGlzLmVudGl0eVR5cGUsIGRhdGEpO1xyXG4gICAgcmV0dXJuIGVudGl0eTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOaJuemHj+WIm+W7uuWunuS9k1xyXG4gICAqL1xyXG4gIHB1YmxpYyBidWlsZEVudGl0aWVzKGxpc3REYXRhOiBhbnlbXSk6IFRbXSB7XHJcbiAgICBjb25zdCBlbnRpdGllczogVFtdID0gY3JlYXRlRW50aXRpZXM8VD4odGhpcy5lbnRpdHlUeXBlLCBsaXN0RGF0YSk7XHJcbiAgICByZXR1cm4gZW50aXRpZXM7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDojrflj5blrp7kvZPliJfooahcclxuICAgKiBAcGFyYW0gZmlsdGVycyAgICDov4fmu6TmnaHku7ZcclxuICAgKiBAcGFyYW0gc29ydHMgICAgICDmjpLluo/mnaHku7ZcclxuICAgKiBAcGFyYW0gcGFnaW5hdGlvbiDliIbpobXkv6Hmga9cclxuICAgKi9cclxuICBhYnN0cmFjdCBnZXRFbnRpdGllcyhmaWx0ZXI6IGFueVtdLCBzb3J0czogYW55W10sIHBhZ2VTaXplOiBudW1iZXIgfCBudWxsLCBwYWdlSW5kZXg6IG51bWJlciB8IG51bGwpOiBPYnNlcnZhYmxlPFRbXT47XHJcbiAgLyoqXHJcbiAgICog6I635Y+W5a6e5L2T5YiX6KGoXHJcbiAgICogQHBhcmFtIGZpbHRlciDov4fmu6TmnaHku7ZcclxuICAgKiBAcGFyYW0gc29ydHMg5o6S5bqP5p2h5Lu2XHJcbiAgICogQHBhcmFtIHBhZ2VTaXplIOWIhumhteWkp+Wwj1xyXG4gICAqIEBwYXJhbSBwYWdlSW5kZXgg5b2T5YmN5YiG6aG1XHJcbiAgICovXHJcbiAgYWJzdHJhY3QgZmlsdGVyKGZpbHRlcj86IGFueVtdLCBzb3J0cz86IGFueVtdLCBwYWdlU2l6ZT86IG51bWJlciB8IG51bGwsIHBhZ2VJbmRleD86IG51bWJlciB8IG51bGwpOiBPYnNlcnZhYmxlPFRbXT47XHJcbiAgLyoqXHJcbiAgICog6I635Y+W5a6e5L2T5YiX6KGoXHJcbiAgICovXHJcbiAgYWJzdHJhY3QgZ2V0TGlzdCgpOiBPYnNlcnZhYmxlPFRbXT47XHJcbiAgLyoqXHJcbiAgICog5qC55o2uaWTojrflj5blrp7kvZNcclxuICAgKiBAcGFyYW0gaWQg5a6e5L2T5qCH6K+GXHJcbiAgICovXHJcbiAgYWJzdHJhY3QgZ2V0QnlJZChpZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxUPjtcclxuICAvKipcclxuICAgKiDmoLnmja5pZOiOt+WPluWunuS9k1xyXG4gICAqIEBwYXJhbSBpZCDkuLvlrp7kvZNpZFxyXG4gICAqL1xyXG4gIGFic3RyYWN0IGdldEVudGl0eUJ5SWQoaWQ6IHN0cmluZyk6IE9ic2VydmFibGU8VD47XHJcbiAgLyoqXHJcbiAgICog5YiG6aG15p+l6K+i5LuO6KGoL+S7juS7juihqOaVsOaNrlxyXG4gICAqIEBwYXJhbSBwYXRoIOe7keWumui3r+W+hFxyXG4gICAqIEBwYXJhbSBpZHMg57uR5a6a6Lev5b6E5a+55bqU55qE5Li76ZSuXHJcbiAgICogQHBhcmFtIGZpbHRlciDov4fmu6TmnaHku7ZcclxuICAgKiBAcGFyYW0gc29ydCDmjpLluo9cclxuICAgKi9cclxuICBhYnN0cmFjdCBxdWVyeUNoaWxkKHBhdGhzOiBzdHJpbmdbXSwgcGFnZUluZGV4OiBudW1iZXIsIHBhZ2VTaXplOiBudW1iZXIsIGZpbHRlcj86IHN0cmluZywgc29ydD86IHN0cmluZyk6IE9ic2VydmFibGU8VFtdPjtcclxuICAvKipcclxuICAgKiDmoLnmja5pZOabtOaWsOWunuS9k1xyXG4gICAqIEBwYXJhbSBpZCDlrp7kvZNpZFxyXG4gICAqL1xyXG4gIGFic3RyYWN0IHVwZGF0ZUJ5SWQoaWQ6IHN0cmluZyk6IE9ic2VydmFibGU8VD47XHJcbiAgLyoqXHJcbiAgICog5pu05paw5a6e5L2T5pWw5o2uKOWtkOihqOWIhumhtSlcclxuICAgKiBAcGFyYW0gaWQg5a6e5L2T5Li76ZSuXHJcbiAgICovXHJcbiAgYWJzdHJhY3QgdXBkYXRlRW50aXR5QnlJZChpZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxUPjtcclxuICAvKipcclxuICAgKiDliJvlu7rmlrDlrp7kvZPvvIzlsIbor6Xlrp7kvZPliqDovb3liLDliJfooahcclxuICAgKi9cclxuICBhYnN0cmFjdCBjcmVhdGUoKTogT2JzZXJ2YWJsZTxhbnk+O1xyXG5cclxuICAvLyAvKipcclxuICAvLyAgKiDliJvlu7rlkI7ku6Plrp7kvZPvvIzlsIbor6Xlrp7kvZPliqDovb3liLDlkI7ku6PliJfooajvvIjmmoLml6Dor6XlnLrmma/vvIlcclxuICAvLyAgKiBAcGFyYW0gcGF0aCDot6/lvoRcclxuICAvLyAgKi9cclxuICAvLyBhYnN0cmFjdCBjcmVhdGVCeVBhdGgocGF0aDogc3RyaW5nKTtcclxuXHJcbiAgLyoqXHJcbiAgICog5Yib5bu65paw5a6e5L2T77yM5bm26L+95Yqg5Yiw5a6e5L2T5YiX6KGoXHJcbiAgICovXHJcbiAgYWJzdHJhY3QgYXBwZW5kKCk6IE9ic2VydmFibGU8YW55PjtcclxuXHJcbiAgLyoqXHJcbiAgICog5Yib5bu65paw55qE5a2Q5a6e5L2T77yM5bm26L+95Yqg5Yiw5a6e5L2T5YiX6KGoXHJcbiAgICogQHBhcmFtIHBhdGgg5a6e5L2T6Lev5b6EXHJcbiAgICovXHJcbiAgYWJzdHJhY3QgYXBwZW5kQnlQYXRoKHBhdGg6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PjtcclxuICAvKipcclxuICAgKiDlho3mjIflrprkvY3nva7mj5LlhaXmlbDmja5cclxuICAgKi9cclxuICBhYnN0cmFjdCBpbnNlcnQocG9zaXRpb246IDEgfCAtMSwgZGVmYXVsdFZhbHVlPzogYW55KTogT2JzZXJ2YWJsZTxhbnk+O1xyXG4gIC8qKlxyXG4gICAqIOWcqOaMh+WumuWunuS9k+i3r+W+hOaPkuWFpeWunuS9k1xyXG4gICAqIEBwYXJhbSBwYXRoIOWunuS9k+i3r+W+hFxyXG4gICAqL1xyXG4gIGFic3RyYWN0IGluc2VydEJ5UGF0aChwYXRoOiBzdHJpbmcsIHBvc2l0aW9uOiAxIHwgLTEpOiBPYnNlcnZhYmxlPGFueT47XHJcbiAgLyoqXHJcbiAgICog5qC55o2uaWTliKDpmaTlr7nlupTlrp7kvZNcclxuICAgKiBAcGFyYW0gaWQg5YaF56CBXHJcbiAgICovXHJcbiAgYWJzdHJhY3QgcmVtb3ZlQnlJZChpZDogc3RyaW5nLCBpZlNhdmU/OiBib29sZWFuKTogT2JzZXJ2YWJsZTxhbnk+O1xyXG5cclxuICAvKipcclxuICAgKiDmoLnmja5pZHPmibnph4/liKDpmaTlrp7kvZNcclxuICAgKiBAcGFyYW0gaWQgaWRzXHJcbiAgICogQHBhcmFtIGlmU2F2ZSDmmK/lkKbkv53lrZhcclxuICAgKiBAZGVwcmVjYXRlZCDlt7Llup/lvIPvvIzor6XmjqXlj6Pkvb/nlKhxdWVyeXN0cmluZ+S8oOWPgu+8jOWtmOWcqOi2hemVv+mXrumimOOAguivt+S9v+eUqGJhdGNoUmVtb3Zl5o6l5Y+j5pu/5Luj44CCXHJcbiAgICovXHJcbiAgYWJzdHJhY3QgcmVtb3ZlQnlJZHMoaWRzOiBzdHJpbmdbXSwgaWZTYXZlPzogYm9vbGVhbik6IE9ic2VydmFibGU8YW55PjtcclxuICAvKipcclxuICAgKiDmoLnmja5pZHPmibnph4/liKDpmaTlrp7kvZNcclxuICAgKiBAcGFyYW0gaWRzIGlkc1xyXG4gICAqIEBwYXJhbSBpZlNhdmUg5piv5ZCm5L+d5a2YXHJcbiAgICovXHJcbiAgYWJzdHJhY3QgYmF0Y2hSZW1vdmUoaWRzOiBzdHJpbmdbXSwgaWZTYXZlPzogYm9vbGVhbik6IE9ic2VydmFibGU8YW55PjtcclxuICAvKipcclxuICAgKiDmoLnmja5pZOWIoOmZpHBhdGjlr7nlupTnmoTlkI7ku6Plrp7kvZNcclxuICAgKi9cclxuICBhYnN0cmFjdCByZW1vdmVCeVBhdGgocGF0aDogc3RyaW5nLCBpZDogc3RyaW5nKTtcclxuXHJcbiAgLyoqXHJcbiAgICog5o+Q5LqkaWTlr7nlupTnmoTmoLnlrp7kvZPlj5jmm7RcclxuICAgKi9cclxuICBhYnN0cmFjdCB1cGRhdGVDaGFuZ2VzQnlJZChpZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxib29sZWFuPjtcclxuXHJcbiAgLyoqXHJcbiAgICog5o+Q5LqkcGF0aOWvueW6lOeahOWunuS9k+WPmOabtFxyXG4gICAqL1xyXG4gIGFic3RyYWN0IHVwZGF0ZUNoYW5nZXNCeVBhdGgocGF0aDogc3RyaW5nLCBpZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxib29sZWFuPjtcclxuXHJcbiAgLyoqXHJcbiAgICog5pu05paw5omA5pyJ5Y+Y5pu0XHJcbiAgICovXHJcbiAgYWJzdHJhY3QgdXBkYXRlQWxsQ2hhbmdlcygpOiBPYnNlcnZhYmxlPGJvb2xlYW4+O1xyXG5cclxuICAvKipcclxuICAgKiDlupTnlKjmnI3liqHlmajnq6/lj5jmm7RcclxuICAgKi9cclxuICBhYnN0cmFjdCBhcHBseUNoYW5nZXMoKTogT2JzZXJ2YWJsZTxib29sZWFuPjtcclxuXHJcbiAgLyoqXHJcbiAgICog5L+d5a2YaWTlr7nlupTmlbDmja7nmoTlj5jmm7RcclxuICAgKi9cclxuICBhYnN0cmFjdCBhcHBseUNoYW5nZXNCeUlkKGlkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGJvb2xlYW4+O1xyXG5cclxuICAvKipcclxuICAgKiDlj5bmtojlj5jmm7Tpm4ZcclxuICAgKi9cclxuICBhYnN0cmFjdCBjYW5jZWxDaGFuZ2VzKG9wdGlvbnM/OiBhbnkpOiBPYnNlcnZhYmxlPGJvb2xlYW4+O1xyXG4gIC8qKlxyXG4gICAqIOaJuemHj+WIoOmZpOWtkOihqFxyXG4gICAqL1xyXG4gIGFic3RyYWN0IGJhdGNoUmVtb3ZlQnlQYXRoKHBhdGg6IHN0cmluZywgaWRzOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGJvb2xlYW4+O1xyXG4gIC8qKlxyXG4gICAqIOaJuemHj+aWsOWinuS7juihqC/ku47ku47ooajmlbDmja5cclxuICAgKiBAcGFyYW0gcGF0aCDlrp7kvZPnu5Hlrprot6/lvoTvvIxsaWtlIDEvY2hpbGRzIG9yIDEvY2hpbGRzLzExL2NoaWxkY2hpbGRzXHJcbiAgICogQHBhcmFtIGRlZmF1bHRWYWx1ZXMg6buY6K6k5a6e5L2T5pWw5o2u5pWw57uEXHJcbiAgICogQGRlc2NyaXB0aW9uIOWQjuerr+aOpeWPo+WPquaUr+aMgeaJuemHj+aWsOWinuWtkOihqO+8jOaJuemHj+aWsOWinuS4u+ihqOebruWJjeS4jeaUr+aMgVxyXG4gICAqL1xyXG4gIGFic3RyYWN0IGJhdGNoQXBwZW5kQnlQYXRoKHBhdGg6IHN0cmluZywgZGVmYXVsdFZhbHVlczogQXJyYXk8YW55Pik6IE9ic2VydmFibGU8YW55PjtcclxuICAvKipcclxuICAgKiDmibnph4/mlrDlop7kuLvooajmlbDmja5cclxuICAgKiBAcGFyYW0gZGVmYXVsdFZhbHVlcyDpu5jorqTlrp7kvZPmlbDmja7mlbDnu4RcclxuICAgKi9cclxuICBhYnN0cmFjdCBiYXRjaEFwcGVuZChkZWZhdWx0VmFsdWVzOiBBcnJheTxhbnk+KTogT2JzZXJ2YWJsZTxhbnk+O1xyXG5cclxufVxyXG4iXX0=