/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-08-06 07:43:53
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-11-19 20:31:27
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
var /*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-08-06 07:43:53
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-11-19 20:31:27
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
Utils = /** @class */ (function () {
    function Utils() {
    }
    /**
     * @return {?}
     */
    Utils.uuid = /**
     * @return {?}
     */
    function () {
        /**
         * @return {?}
         */
        function S4() {
            // tslint:disable-next-line: no-bitwise
            return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);
        }
        return (S4() + S4() + '-' + S4() + '-' + S4() + '-' + S4() + '-' + S4() + S4() + S4());
    };
    /**
     * 获取对象中指定字段的值。 field: 可以为带有层级结构的路径，如： user.firstName | name 等
     */
    /**
     * 获取对象中指定字段的值。 field: 可以为带有层级结构的路径，如： user.firstName | name 等
     * @param {?} field
     * @param {?} data
     * @param {?=} safe
     * @return {?}
     */
    Utils.getValue = /**
     * 获取对象中指定字段的值。 field: 可以为带有层级结构的路径，如： user.firstName | name 等
     * @param {?} field
     * @param {?} data
     * @param {?=} safe
     * @return {?}
     */
    function (field, data, safe) {
        if (safe === void 0) { safe = false; }
        if (!data) {
            return '';
        }
        /** @type {?} */
        var resultVal = '';
        if (field.indexOf('.') === -1 || data.hasOwnProperty(field)) {
            resultVal = data[field];
        }
        else {
            resultVal = field.split('.').reduce((/**
             * @param {?} obj
             * @param {?} key
             * @return {?}
             */
            function (obj, key) {
                if (obj) {
                    return obj[key];
                }
                else {
                    return null;
                }
            }), data);
        }
        if (safe) {
            return this.escapeValue(resultVal);
        }
        return resultVal;
    };
    /**
     * @param {?} field
     * @param {?} val
     * @param {?} obj
     * @param {?=} nest
     * @return {?}
     */
    Utils.setValue = /**
     * @param {?} field
     * @param {?} val
     * @param {?} obj
     * @param {?=} nest
     * @return {?}
     */
    function (field, val, obj, nest) {
        if (nest === void 0) { nest = true; }
        if (field) {
            if (field.indexOf('.') > -1 && nest) {
                /** @type {?} */
                var lastObj_1 = null;
                /** @type {?} */
                var _fields = field.split('.');
                _fields.reduce((/**
                 * @param {?} c
                 * @param {?} p
                 * @return {?}
                 */
                function (c, p) {
                    lastObj_1 = c;
                    return c[p];
                }), obj);
                if (lastObj_1) {
                    lastObj_1[_fields.pop()] = val;
                }
            }
            else {
                obj[field] = val;
            }
        }
    };
    /** 获取多语值 */
    /**
     * 获取多语值
     * @param {?} valObj
     * @param {?} localeId
     * @return {?}
     */
    Utils.getMultilingualValue = /**
     * 获取多语值
     * @param {?} valObj
     * @param {?} localeId
     * @return {?}
     */
    function (valObj, localeId) {
        if (valObj && typeof valObj === 'object' && Object.keys(valObj).length > 0) {
            localeId = localeId || 'zh-CHS';
            /** @type {?} */
            var val = valObj[localeId];
            if (val !== undefined) {
                return val;
            }
            else {
                console.log("can not find '" + localeId + "' in ", valObj);
                return '';
            }
        }
        else {
            return '';
        }
    };
    /**
     * @param {?} val
     * @return {?}
     */
    Utils.escapeValue = /**
     * @param {?} val
     * @return {?}
     */
    function (val) {
        if (val === null || val === undefined || val === '') {
            return '';
        }
        /** @type {?} */
        var escapeHTML = (/**
         * @param {?} unsafe_str
         * @return {?}
         */
        function (unsafe_str) {
            return unsafe_str
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/\"/g, '&quot;')
                .replace(/\'/g, '&#39;')
                .replace(/\//g, '&#x2F;');
            // .replace('src','drc');
        });
        if (typeof val === 'string') {
            return escapeHTML(val);
        }
        return val;
    };
    /**
     * @param {?} evt
     * @return {?}
     */
    Utils.eventPath = /**
     * @param {?} evt
     * @return {?}
     */
    function (evt) {
        /** @type {?} */
        var path = (evt.composedPath && evt.composedPath()) || evt.path;
        /** @type {?} */
        var target = evt.target;
        if (path != null) {
            return (path.indexOf(window) < 0) ? path.concat(window) : path;
        }
        if (target === window) {
            return [window];
        }
        /** @type {?} */
        var getParents = (/**
         * @param {?} node
         * @param {?=} memo
         * @return {?}
         */
        function (node, memo) {
            if (memo === void 0) { memo = undefined; }
            memo = memo || [];
            /** @type {?} */
            var parentNode = node.parentNode;
            if (!parentNode) {
                return memo;
            }
            else {
                return getParents(parentNode, memo.concat(parentNode));
            }
        });
        return [target].concat(getParents(target), window);
    };
    /**
     * @return {?}
     */
    Utils.hasDialogOpen = /**
     * @return {?}
     */
    function () {
        // return document.body.classList.value.indexOf('modal-open') > -1;
        // 兼容IE 11
        return document.body.className.indexOf('modal-open') > -1;
    };
    /**
     * @param {?} el
     * @param {?} evt
     * @param {?} fn
     * @param {?=} opts
     * @return {?}
     */
    Utils.on = /**
     * @param {?} el
     * @param {?} evt
     * @param {?} fn
     * @param {?=} opts
     * @return {?}
     */
    function (el, evt, fn, opts) {
        if (opts === void 0) { opts = {}; }
        /** @type {?} */
        var delegatorFn = (/**
         * @param {?} e
         * @return {?}
         */
        function (e) { return e.target.matches(opts.target) && fn.call(e.target, e); });
        el.addEventListener(evt, opts.target ? delegatorFn : fn, opts.options || false);
        return (/**
         * @return {?}
         */
        function () {
            el.removeEventListener(evt, delegatorFn, opts);
        });
    };
    /**
     * @param {?} el
     * @param {?} evt
     * @param {?=} fn
     * @param {?=} opts
     * @return {?}
     */
    Utils.off = /**
     * @param {?} el
     * @param {?} evt
     * @param {?=} fn
     * @param {?=} opts
     * @return {?}
     */
    function (el, evt, fn, opts) {
        if (fn === void 0) { fn = (/**
         * @return {?}
         */
        function () { }); }
        if (opts === void 0) { opts = {}; }
        el.removeEventListener(evt, fn, opts);
    };
    /** 获取字符长度，中文汉字占2个字符 */
    /**
     * 获取字符长度，中文汉字占2个字符
     * @param {?} str
     * @return {?}
     */
    Utils.getBLen = /**
     * 获取字符长度，中文汉字占2个字符
     * @param {?} str
     * @return {?}
     */
    function (str) {
        if (str == null) {
            return 0;
        }
        if (typeof str !== 'string') {
            str += '';
        }
        return str.replace(/[^\x00-\xff]/g, '01').length;
    };
    // static difference(first: any[], second: any[]): any[] {
    //     return first.filter(item => !second.includes(item));
    // }
    // static getDiffItems(arr1, arr2) {
    //     const diff1 = Utils.difference(arr1, arr2);
    //     const diff2 = Utils.difference(arr2, arr1);
    //     return diff1.concat(diff2);
    // }
    // static difference(first: any[], second: any[]): any[] {
    //     return first.filter(item => !second.includes(item));
    // }
    // static getDiffItems(arr1, arr2) {
    //     const diff1 = Utils.difference(arr1, arr2);
    //     const diff2 = Utils.difference(arr2, arr1);
    //     return diff1.concat(diff2);
    // }
    /**
     * @param {?} col
     * @param {?} localeId
     * @return {?}
     */
    Utils.getWhenEmptyText = 
    // static difference(first: any[], second: any[]): any[] {
    //     return first.filter(item => !second.includes(item));
    // }
    // static getDiffItems(arr1, arr2) {
    //     const diff1 = Utils.difference(arr1, arr2);
    //     const diff2 = Utils.difference(arr2, arr1);
    //     return diff1.concat(diff2);
    // }
    /**
     * @param {?} col
     * @param {?} localeId
     * @return {?}
     */
    function (col, localeId) {
        /** @type {?} */
        var EMPTY_INPUT_TEXT = {
            'zh-CHS': '请输入',
            'zh-CHT': '請輸入',
            en: 'Please input'
        };
        /** @type {?} */
        var EMPTY_SELECT_TEXT = {
            'zh-CHS': '请选择',
            'zh-CHT': '請選擇',
            en: 'Please select'
        };
        if (col.editor) {
            switch (col.editor.type) {
                case 'datepicker':
                case 'select':
                case 'lookup':
                case 'combolist':
                case 'combo-lookup':
                    return EMPTY_SELECT_TEXT[localeId];
                default:
                    return EMPTY_INPUT_TEXT[localeId];
            }
        }
        // 控制面板列
        if (col.field === '_datagrid-setting-control_') {
            return '';
        }
        return EMPTY_INPUT_TEXT[localeId];
    };
    return Utils;
}());
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-08-06 07:43:53
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-11-19 20:31:27
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
export { Utils };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLWRhdGFncmlkLyIsInNvdXJjZXMiOlsibGliL3V0aWxzL3V0aWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQVFBOzs7Ozs7Ozs7SUFBQTtJQW9NQSxDQUFDOzs7O0lBbE1VLFVBQUk7OztJQUFYOzs7O1FBQ0ksU0FBUyxFQUFFO1lBQ1AsdUNBQXVDO1lBQ3ZDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDM0UsQ0FBQztRQUNELE9BQU8sQ0FBQyxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsR0FBRyxHQUFHLEdBQUcsRUFBRSxFQUFFLEdBQUcsR0FBRyxHQUFHLEVBQUUsRUFBRSxHQUFHLEdBQUcsR0FBRyxFQUFFLEVBQUUsR0FBRyxHQUFHLEdBQUcsRUFBRSxFQUFFLEdBQUcsRUFBRSxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUMzRixDQUFDO0lBR0Q7O09BRUc7Ozs7Ozs7O0lBQ0ksY0FBUTs7Ozs7OztJQUFmLFVBQWdCLEtBQWEsRUFBRSxJQUFTLEVBQUUsSUFBWTtRQUFaLHFCQUFBLEVBQUEsWUFBWTtRQUNsRCxJQUFJLENBQUMsSUFBSSxFQUFFO1lBQ1AsT0FBUSxFQUFFLENBQUM7U0FDZDs7WUFDRyxTQUFTLEdBQUcsRUFBRTtRQUNsQixJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUN6RCxTQUFTLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1NBQzNCO2FBQU07WUFDSCxTQUFTLEdBQUcsS0FBSyxD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QU8sQ0FBQyxlQUFlLEVBQUUsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDO0lBQ3JELENBQUM7SUFFRCwwREFBMEQ7SUFDMUQsMkRBQTJEO0lBQzNELElBQUk7SUFFSixvQ0FBb0M7SUFDcEMsa0RBQWtEO0lBQ2xELGtEQUFrRDtJQUVsRCxrQ0FBa0M7SUFDbEMsSUFBSTs7Ozs7Ozs7Ozs7Ozs7SUFFRyxzQkFBZ0I7Ozs7Ozs7Ozs7Ozs7O0lBQXZCLFVBQXdCLEdBQVEsRUFBRSxRQUFROztZQUVoQyxnQkFBZ0IsR0FBRztZQUNyQixRQUFRLEVBQUUsS0FBSztZQUNmLFFBQVEsRUFBRSxLQUFLO1lBQ2YsRUFBRSxFQUFFLGNBQWM7U0FDckI7O1lBRUssaUJBQWlCLEdBQUc7WUFDdEIsUUFBUSxFQUFFLEtBQUs7WUFDZixRQUFRLEVBQUUsS0FBSztZQUNmLEVBQUUsRUFBRSxlQUFlO1NBQ3RCO1FBR0QsSUFBSSxHQUFHLENBQUMsTUFBTSxFQUFFO1lBQ1osUUFBUSxHQUFHLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRTtnQkFDckIsS0FBSyxZQUFZLENBQUM7Z0JBQ2xCLEtBQUssUUFBUSxDQUFDO2dCQUNkLEtBQUssUUFBUSxDQUFDO2dCQUNkLEtBQUssV0FBVyxDQUFDO2dCQUNqQixLQUFLLGNBQWM7b0JBQ2YsT0FBUSxpQkFBaUIsQ0FBQyxRQUFRLENBQUMsQ0FBQztnQkFDeEM7b0JBQ0ksT0FBTyxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsQ0FBQzthQUN6QztTQUNKO1FBRUQsUUFBUTtRQUNSLElBQUksR0FBRyxDQUFDLEtBQUssS0FBSyw0QkFBNEIsRUFBRTtZQUM1QyxPQUFPLEVBQUUsQ0FBQztTQUNiO1FBRUQsT0FBTyxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUN0QyxDQUFDO0lBQ0wsWUFBQztBQUFELENBQUMsQUFwTUQsSUFvTUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiBAQXV0aG9yOiDnlq/ni4Lnp4DmiY0oTHVjYXMgSHVhbmcpXHJcbiAqIEBEYXRlOiAyMDE5LTA4LTA2IDA3OjQzOjUzXHJcbiAqIEBMYXN0RWRpdG9yczog55av54uC56eA5omNKEx1Y2FzIEh1YW5nKVxyXG4gKiBATGFzdEVkaXRUaW1lOiAyMDE5LTExLTE5IDIwOjMxOjI3XHJcbiAqIEBRUTogMTA1NTgxODIzOVxyXG4gKiBAVmVyc2lvbjogdjAuMC4xXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgVXRpbHMge1xyXG5cclxuICAgIHN0YXRpYyB1dWlkKCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIFM0KCkge1xyXG4gICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6IG5vLWJpdHdpc2VcclxuICAgICAgICAgICAgcmV0dXJuICgoKDEgKyBNYXRoLnJhbmRvbSgpKSAqIDB4MTAwMDApIHwgMCkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIChTNCgpICsgUzQoKSArICctJyArIFM0KCkgKyAnLScgKyBTNCgpICsgJy0nICsgUzQoKSArICctJyArIFM0KCkgKyBTNCgpICsgUzQoKSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5a+56LGh5Lit5oyH5a6a5a2X5q6155qE5YC844CCIGZpZWxkOiDlj6/ku6XkuLrluKbmnInlsYLnuqfnu5PmnoTnmoTot6/lvoTvvIzlpoLvvJogdXNlci5maXJzdE5hbWUgfCBuYW1lIOetiVxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgZ2V0VmFsdWUoZmllbGQ6IHN0cmluZywgZGF0YTogYW55LCBzYWZlID0gZmFsc2UpIHtcclxuICAgICAgICBpZiAoIWRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuICAnJztcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IHJlc3VsdFZhbCA9ICcnO1xyXG4gICAgICAgIGlmIChmaWVsZC5pbmRleE9mKCcuJykgPT09IC0xIHx8IGRhdGEuaGFzT3duUHJvcGVydHkoZmllbGQpKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdFZhbCA9IGRhdGFbZmllbGRdO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlc3VsdFZhbCA9IGZpZWxkLnNwbGl0KCcuJykucmVkdWNlKChvYmosIGtleSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKG9iaikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvYmpba2V5XTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGRhdGEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHNhZmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZXNjYXBlVmFsdWUocmVzdWx0VmFsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdFZhbDtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgc2V0VmFsdWUoIGZpZWxkOiBzdHJpbmcsIHZhbDogYW55LCBvYmo6IHsgW2tleTogc3RyaW5nXTogYW55IH0sIG5lc3QgPSB0cnVlKSB7XHJcbiAgICAgICAgaWYgKGZpZWxkKSB7XHJcbiAgICAgICAgICAgIGlmIChmaWVsZC5pbmRleE9mKCcuJykgPiAtMSAmJiBuZXN0KSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgbGFzdE9iaiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBfZmllbGRzID0gZmllbGQuc3BsaXQoJy4nKTtcclxuICAgICAgICAgICAgICAgIF9maWVsZHMucmVkdWNlKCAoYywgcCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxhc3RPYmogPSBjO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjW3BdO1xyXG4gICAgICAgICAgICAgICAgfSwgb2JqKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAobGFzdE9iaikge1xyXG4gICAgICAgICAgICAgICAgICAgIGxhc3RPYmpbX2ZpZWxkcy5wb3AoKV0gPSB2YWw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBvYmpbZmllbGRdID0gdmFsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKiDojrflj5blpJror63lgLwgKi9cclxuICAgIHN0YXRpYyBnZXRNdWx0aWxpbmd1YWxWYWx1ZSh2YWxPYmosIGxvY2FsZUlkKSB7XHJcbiAgICAgICAgaWYgKHZhbE9iaiAmJiB0eXBlb2YgdmFsT2JqID09PSAnb2JqZWN0JyAmJiBPYmplY3Qua2V5cyh2YWxPYmopLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgbG9jYWxlSWQgPSBsb2NhbGVJZCB8fCAnemgtQ0hTJztcclxuICAgICAgICAgICAgY29uc3QgdmFsID0gdmFsT2JqW2xvY2FsZUlkXTtcclxuICAgICAgICAgICAgaWYgKHZhbCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYGNhbiBub3QgZmluZCAnJHtsb2NhbGVJZH0nIGluIGAsIHZhbE9iaik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBzdGF0aWMgZXNjYXBlVmFsdWUodmFsOiBhbnkpIHtcclxuICAgICAgICBpZiAodmFsID09PSBudWxsIHx8IHZhbCA9PT0gdW5kZWZpbmVkIHx8IHZhbCA9PT0gJycpIHtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgZXNjYXBlSFRNTCA9ICh1bnNhZmVfc3RyKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiB1bnNhZmVfc3RyXHJcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvJi9nLCAnJmFtcDsnKVxyXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoLzwvZywgJyZsdDsnKVxyXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoLz4vZywgJyZndDsnKVxyXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcXCIvZywgJyZxdW90OycpXHJcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFwnL2csICcmIzM5OycpXHJcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFwvL2csICcmI3gyRjsnKTtcclxuICAgICAgICAgICAgICAgIC8vIC5yZXBsYWNlKCdzcmMnLCdkcmMnKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGVzY2FwZUhUTUwodmFsKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB2YWw7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGV2ZW50UGF0aChldnQ6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHBhdGggPSAoZXZ0LmNvbXBvc2VkUGF0aCAmJiBldnQuY29tcG9zZWRQYXRoKCkpIHx8IGV2dC5wYXRoO1xyXG4gICAgICAgIGNvbnN0IHRhcmdldCA9IGV2dC50YXJnZXQ7XHJcblxyXG4gICAgICAgIGlmIChwYXRoICE9IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChwYXRoLmluZGV4T2Yod2luZG93KSA8IDApID8gcGF0aC5jb25jYXQod2luZG93KSA6IHBhdGg7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGFyZ2V0ID09PSB3aW5kb3cpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFt3aW5kb3ddO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgZ2V0UGFyZW50cyA9IChub2RlLCBtZW1vID0gdW5kZWZpbmVkKSA9PiB7XHJcbiAgICAgICAgICAgIG1lbW8gPSBtZW1vIHx8IFtdO1xyXG4gICAgICAgICAgICBjb25zdCBwYXJlbnROb2RlID0gbm9kZS5wYXJlbnROb2RlO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFwYXJlbnROb2RlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbWVtbztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBnZXRQYXJlbnRzKHBhcmVudE5vZGUsIG1lbW8uY29uY2F0KHBhcmVudE5vZGUpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiBbdGFyZ2V0XS5jb25jYXQoZ2V0UGFyZW50cyh0YXJnZXQpLCB3aW5kb3cpO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBoYXNEaWFsb2dPcGVuKCkge1xyXG4gICAgICAgIC8vIHJldHVybiBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC52YWx1ZS5pbmRleE9mKCdtb2RhbC1vcGVuJykgPiAtMTtcclxuICAgICAgICAvLyDlhbzlrrlJRSAxMVxyXG4gICAgICAgIHJldHVybiBkb2N1bWVudC5ib2R5LmNsYXNzTmFtZS5pbmRleE9mKCdtb2RhbC1vcGVuJykgPiAtMTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgb24oZWwsIGV2dCwgZm4sIG9wdHM6IGFueSA9IHt9KSB7XHJcbiAgICAgICAgY29uc3QgZGVsZWdhdG9yRm4gPSBlID0+IGUudGFyZ2V0Lm1hdGNoZXMob3B0cy50YXJnZXQpICYmIGZuLmNhbGwoZS50YXJnZXQsIGUpO1xyXG4gICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoZXZ0LCBvcHRzLnRhcmdldCA/IGRlbGVnYXRvckZuIDogZm4sIG9wdHMub3B0aW9ucyB8fCBmYWxzZSk7XHJcbiAgICAgICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihldnQsIGRlbGVnYXRvckZuLCBvcHRzKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBvZmYoZWwsIGV2dCwgZm49ICgpID0+IHt9LCBvcHRzOiBhbnkgPSB7fSkge1xyXG4gICAgICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZ0LCBmbiwgb3B0cyk7XHJcbiAgICB9XHJcbiAgICAvKiog6I635Y+W5a2X56ym6ZW/5bqm77yM5Lit5paH5rGJ5a2X5Y2gMuS4quWtl+espiAqL1xyXG4gICAgc3RhdGljIGdldEJMZW4oc3RyKSB7XHJcbiAgICAgICAgaWYgKHN0ciA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodHlwZW9mIHN0ciAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgIHN0ciArPSAnJztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHN0ci5yZXBsYWNlKC9bXlxceDAwLVxceGZmXS9nLCAnMDEnKS5sZW5ndGg7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gc3RhdGljIGRpZmZlcmVuY2UoZmlyc3Q6IGFueVtdLCBzZWNvbmQ6IGFueVtdKTogYW55W10ge1xyXG4gICAgLy8gICAgIHJldHVybiBmaXJzdC5maWx0ZXIoaXRlbSA9PiAhc2Vjb25kLmluY2x1ZGVzKGl0ZW0pKTtcclxuICAgIC8vIH1cclxuXHJcbiAgICAvLyBzdGF0aWMgZ2V0RGlmZkl0ZW1zKGFycjEsIGFycjIpIHtcclxuICAgIC8vICAgICBjb25zdCBkaWZmMSA9IFV0aWxzLmRpZmZlcmVuY2UoYXJyMSwgYXJyMik7XHJcbiAgICAvLyAgICAgY29uc3QgZGlmZjIgPSBVdGlscy5kaWZmZXJlbmNlKGFycjIsIGFycjEpO1xyXG5cclxuICAgIC8vICAgICByZXR1cm4gZGlmZjEuY29uY2F0KGRpZmYyKTtcclxuICAgIC8vIH1cclxuXHJcbiAgICBzdGF0aWMgZ2V0V2hlbkVtcHR5VGV4dChjb2w6IGFueSwgbG9jYWxlSWQpIHtcclxuXHJcbiAgICAgICAgY29uc3QgRU1QVFlfSU5QVVRfVEVYVCA9IHtcclxuICAgICAgICAgICAgJ3poLUNIUyc6ICfor7fovpPlhaUnLFxyXG4gICAgICAgICAgICAnemgtQ0hUJzogJ+iri+i8uOWFpScsXHJcbiAgICAgICAgICAgIGVuOiAnUGxlYXNlIGlucHV0J1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGNvbnN0IEVNUFRZX1NFTEVDVF9URVhUID0ge1xyXG4gICAgICAgICAgICAnemgtQ0hTJzogJ+ivt+mAieaLqScsXHJcbiAgICAgICAgICAgICd6aC1DSFQnOiAn6KuL6YG45pOHJyxcclxuICAgICAgICAgICAgZW46ICdQbGVhc2Ugc2VsZWN0J1xyXG4gICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICBpZiAoY29sLmVkaXRvcikge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGNvbC5lZGl0b3IudHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnZGF0ZXBpY2tlcic6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdzZWxlY3QnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnbG9va3VwJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2NvbWJvbGlzdCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjb21iby1sb29rdXAnOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAgRU1QVFlfU0VMRUNUX1RFWFRbbG9jYWxlSWRdO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfSU5QVVRfVEVYVFtsb2NhbGVJZF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIOaOp+WItumdouadv+WIl1xyXG4gICAgICAgIGlmIChjb2wuZmllbGQgPT09ICdfZGF0YWdyaWQtc2V0dGluZy1jb250cm9sXycpIHtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIEVNUFRZX0lOUFVUX1RFWFRbbG9jYWxlSWRdO1xyXG4gICAgfVxyXG59XHJcblxyXG4iXX0=