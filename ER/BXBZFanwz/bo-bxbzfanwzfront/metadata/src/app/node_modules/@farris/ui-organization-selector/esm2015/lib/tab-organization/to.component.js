/**
 * @fileoverview added by tsickle
 * Generated from: lib/tab-organization/to.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, EventEmitter, Output, ChangeDetectorRef, Injector, ViewChild, TemplateRef, HostBinding, NgZone } from '@angular/core';
import { ApiService } from '../../utils/api.service';
import * as _ from 'lodash-es';
import { of } from 'rxjs';
import { FavoritesTool } from '../../utils/favorites.tool';
import { ChangeType } from '../../utils/index.type';
import { CommonUtil } from '../../utils/common.tool';
import { TreeTableComponent } from '@farris/ui-treetable';
import { StateMgrTool } from '../../utils/state.mgr.tool';
import { switchMap } from 'rxjs/operators';
import { MessagerService } from '@farris/ui-messager';
export class OrganizationComponent {
    /**
     * @param {?} apiService
     * @param {?} cdr
     * @param {?} favoritesTool
     * @param {?} injector
     * @param {?} ngZone
     * @param {?} stateMgr
     * @param {?} msgService
     */
    constructor(apiService, cdr, favoritesTool, injector, ngZone, stateMgr, msgService) {
        this.apiService = apiService;
        this.cdr = cdr;
        this.favoritesTool = favoritesTool;
        this.injector = injector;
        this.ngZone = ngZone;
        this.stateMgr = stateMgr;
        this.msgService = msgService;
        this.baseCls = true;
        this.primaryField = 'orgId';
        this.pathLength = 4;
        this.selectionsChange = new EventEmitter();
        this.originalTreeData = [];
        this.locationOrgText = '';
        this.treeListData = [];
        this.treeTableCols = [];
        this.selections = [];
        this.favoritesList = [];
        this.initLoad = true;
        this.checkedOrgs = [];
        this.beforeClickNode = (/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            if (!this.enableHierarchicalLoading) {
                return of(true);
            }
            if (!this.multiSelect) {
                if (e.rowNode.isSelected) {
                    this.setSelections([]);
                }
                else {
                    this.setSelections(new Array(e.rowNode.node.data), ChangeType.ValueChanged, 'other');
                }
                return of(false);
            }
            /** @type {?} */
            const param = {
                absOrgType: this.absOrgType,
                notGetStopOrg: this.notGetStopOrg,
                getCurUser: false,
                parentID: e.rowNode.id,
                withAllSub: true,
                getOrgAllPath: true
            };
            return this.apiService.getOrganization(param).pipe(switchMap((/**
             * @param {?} data
             * @return {?}
             */
            (data) => {
                if (data['data'].length > this.selectedLimit && !e.rowNode.isChecked) {
                    this.msgService.show('warning', `亲，一次性选择了超过${this.selectedLimit}条数据~`, true);
                    return of(false);
                }
                if (!e.rowNode.isChecked) {
                    // todo 待验证，加入selection，
                    data.data.forEach((/**
                     * @param {?} item
                     * @return {?}
                     */
                    item => {
                        if (CommonUtil.findIndex(item[this.primaryField], this.primaryField, this.selections) === -1) {
                            this.setSelections(item, ChangeType.Append, 'other');
                        }
                    }));
                }
                else {
                    this.selections.forEach((/**
                     * @param {?} selection
                     * @param {?} index
                     * @return {?}
                     */
                    (selection, index) => {
                        data.data.forEach((/**
                         * @param {?} item
                         * @return {?}
                         */
                        item => {
                            if (selection[this.primaryField] === item[this.primaryField]) {
                                this.setSelections(item, ChangeType.Remove, 'other');
                            }
                        }));
                    }));
                }
                this.cdr.detectChanges();
                return of(false);
            })));
        });
        this.beforeCheckAll = (/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            if (!this.enableHierarchicalLoading) {
                return of(true);
            }
            /** @type {?} */
            const param = {
                absOrgType: this.absOrgType,
                notGetStopOrg: this.notGetStopOrg,
                getCurUser: false,
                parentID: e.instance.data[0].id,
                withAllSub: true,
                getOrgAllPath: true
            };
            return this.apiService.getOrganization(param).pipe(switchMap((/**
             * @param {?} data
             * @return {?}
             */
            (data) => {
                if (data['data'].length > this.selectedLimit) {
                    this.msgService.show('warning', `亲，一次性选择了超过${this.selectedLimit}条数据~`, true);
                    return of(false);
                }
                this.setSelections(data['data'], ChangeType.ValueChanged, 'other');
                return of(true);
            })));
        });
        this.cdr = this.injector.get(ChangeDetectorRef);
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.favoritesSub.unsubscribe();
        this.selectionsSub.unsubscribe();
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.treeTableCols = [
            { field: 'name', title: '组织名称', template: this.orgNameCell },
            { field: 'code', title: '组织编号' }
        ];
        if (this.enableFavorites) {
            this.treeTableCols.push({
                field: '',
                title: '收藏',
                template: this.favoritesCell
            });
            this.treeTableCols[0].width = 300;
            this.treeTableCols[1].width = 300;
        }
        this.favoritesSub = this.favoritesTool.favoritesSubject.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        data => {
            this.favoritesList = data;
            this.setFavorites(this.treeListData);
            this.farrisTree.detectChanges();
        }));
        this.selectionsSub = this.stateMgr.selectionsSubject.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        data => {
            if (data.changeType === ChangeType.ValueChanged) {
                this.selections = _.cloneDeep(data.value);
                if (this.selections.length === 0) {
                    this.farrisTree.clearCheckeds();
                    this.farrisTree.clearSelections();
                    this.farrisTree.detectChanges();
                }
                if (data.from === 'other') {
                    this.tickSelections();
                }
            }
            else if (data.changeType === ChangeType.Remove) {
                this.selections = this.selections.filter((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => item[this.primaryField] !== data.value[this.primaryField]));
                if (this.multiSelect) {
                    this.inTreeList(this.treeListData, data.value);
                    if (!!data.value.inTreeList) {
                        this.farrisTree.unCheckedNode(data.value[this.primaryField]);
                    }
                }
                else {
                    this.farrisTree.unSelectNode(data.value[this.primaryField]);
                }
            }
            else if (data.changeType === ChangeType.Append) {
                CommonUtil.findIndex(data.value[this.primaryField], this.primaryField, this.selections) === -1 ? this.selections.push(data.value) : null;
                if (this.multiSelect) {
                    this.inTreeList(this.treeListData, data.value);
                    if (!!data.value.inTreeList) {
                        this.farrisTree.checkedNode(data.value[this.primaryField]);
                    }
                }
                else {
                    this.farrisTree.selectNode(data.value[this.primaryField]);
                }
            }
            if (this.initLoad) {
                if (this.enableHierarchicalLoading) {
                    this.hlAssembleData();
                }
                else {
                    this.assembleData();
                }
                this.initLoad = false;
            }
        }));
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        /*
        const orgIdsChange = changes.orgIds;
        if (orgIdsChange && orgIdsChange.currentValue) {
            this.checkedOrgs = orgIdsChange.currentValue;
        }
        */
    }
    // 设置当前组织树各个节点的收藏状态
    /**
     * @private
     * @param {?} treeListData
     * @return {?}
     */
    setFavorites(treeListData) {
        for (let i = 0; i < treeListData.length; i++) {
            if (CommonUtil.findIndex(treeListData[i].id, this.primaryField, this.favoritesList) === -1) {
                treeListData[i].data.inFavorites = false;
            }
            else {
                treeListData[i].data.inFavorites = true;
            }
            if (treeListData[i].children.length) {
                this.setFavorites(treeListData[i].children);
            }
        }
    }
    /**
     * @private
     * @param {?} selections
     * @param {?=} changeType
     * @param {?=} from
     * @return {?}
     */
    setSelections(selections, changeType = ChangeType.ValueChanged, from = 'tree') {
        this.stateMgr.emitSelections(selections, changeType, from);
    }
    // 组织树全选事件
    /**
     * @return {?}
     */
    checkAll() {
        if (!this.enableHierarchicalLoading) {
            /** @type {?} */
            const checkeds = [];
            this.farrisTree.checkeds.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                checkeds.push(item.data);
            }));
            this.setSelections(checkeds);
        }
    }
    // 组织树取消全选事件
    /**
     * @return {?}
     */
    unCheckAll() {
        this.setSelections([]);
    }
    // 选中（取消选中、勾选、取消勾选）树节点时触发
    // todo 分层加载的时候咋处理数据，beforeUnCheckAll还未支持。
    /**
     * @param {?} e
     * @return {?}
     */
    changeSelections(e) {
        if (!this.enableHierarchicalLoading && !!e.originalEvent) {
            this.multiSelect ? this.toggleChecked(e) : this.toggleSelected(e);
        }
    }
    /**
     * @param {?} e
     * @return {?}
     */
    toggleChecked(e) {
        /** @type {?} */
        let checkeds = [];
        e && e.instance && e.instance.checkeds.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            checkeds.push(item.data);
        }));
        this.setSelections(checkeds);
    }
    /**
     * @param {?} e
     * @return {?}
     */
    toggleSelected(e) {
        /** @type {?} */
        let selected = [];
        e && e.instance && e.instance.selections.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            selected.push(item.data);
        }));
        this.setSelections(selected);
    }
    // 根据传入的组织id确定已选择组织
    /**
     * @private
     * @param {?} ids
     * @return {?}
     */
    assembleDataByOrgIds(ids) {
        if (!ids || ids.length === 0) {
            return;
        }
        if (ids && ids.length > 0 && !this.multiSelect) {
            console.warn('单选模式下，只允许选中一条数据~');
            return;
        }
        /** @type {?} */
        const param = {
            absOrgType: this.absOrgType,
            idList: ids,
            getCurUser: false,
            getOrgAllPath: true,
        };
        this.apiService.getOrganization(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            if (res && res.data && res.data.length > 0) {
                this.checkedOrgs = res.data;
                res.data.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => {
                    if (CommonUtil.findIndex(item[this.primaryField], this.primaryField, this.selections) === -1) {
                        this.setSelections(item, ChangeType.Append, 'other');
                    }
                }));
                this.tickSelections();
                this.cdr.detectChanges();
            }
        }));
    }
    // 分层加载组织树
    /**
     * @return {?}
     */
    hlAssembleData() {
        /** @type {?} */
        const param = {
            absOrgType: this.absOrgType,
            notGetStopOrg: this.notGetStopOrg,
            getOrgAllPath: true
        };
        /** @type {?} */
        const layerList = [];
        /** @type {?} */
        let layer = this.layer;
        while (layer > 0) {
            layerList.push(layer);
            layer -= 1;
        }
        param.layerList = layerList;
        this.apiService.getOrganization(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            if (!res || !res.data) {
                return;
            }
            if (this.orgIds.length == 0) {
                res.data.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => {
                    item.selectable = true;
                }));
            }
            if (this.enableFavorites) {
                res.data.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => {
                    if (CommonUtil.findIndex(item[this.primaryField], this.primaryField, this.favoritesList) === -1) {
                        item.inFavorites = false;
                    }
                    else {
                        item.inFavorites = true;
                    }
                }));
            }
            this.originalTreeData = res.data;
            if (res && res.curAbsUser && res.curAbsUser.orgAllPathInfo) {
                /** @type {?} */
                const curUserOrgPath = res.curAbsUser.orgAllPathInfo;
                curUserOrgPath.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => {
                    if (CommonUtil.findIndex(item[this.primaryField], this.primaryField, res.data) === -1) {
                        res.data.push(item);
                    }
                }));
            }
            this.treeListData = this.dataToTree(res.data, 1, res.curAbsUser.defaultOrgPath);
            this.farrisTree.loadData(this.treeListData);
            /*
            if(this.checkedOrgs && this.checkedOrgs.length) {
                this.assembleDataByOrgIds(this.checkedOrgs);
                return;
            }
            */
            this.tickSelections();
            this.cdr.detectChanges();
        }));
    }
    // 全加载组织树
    /**
     * @return {?}
     */
    assembleData() {
        /** @type {?} */
        const param = {
            absOrgType: this.absOrgType,
            notGetStopOrg: this.notGetStopOrg,
            getOrgAllPath: true
        };
        this.apiService.getOrganization(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            if (!res || !res.data) {
                return;
            }
            if (this.enableFavorites) {
                res.data.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => {
                    if (CommonUtil.findIndex(item[this.primaryField], this.primaryField, this.favoritesList) === -1) {
                        item.inFavorites = false;
                    }
                    else {
                        item.inFavorites = true;
                    }
                }));
            }
            this.originalTreeData = res.data;
            this.treeListData = this.dataToTree(res.data, 1, res.curAbsUser.defaultOrgPath);
            this.farrisTree.loadData(this.treeListData);
            /*
            if(this.checkedOrgs && this.checkedOrgs.length) {
                this.assembleDataByOrgIds(this.checkedOrgs);
                return;
            }
            */
            this.tickSelections();
            this.cdr.detectChanges();
        }));
    }
    // 确定已选组织是否在当前组织树内
    /**
     * @private
     * @param {?} treeListData
     * @param {?} item
     * @return {?}
     */
    inTreeList(treeListData, item) {
        for (let i = 0; i < treeListData.length; i++) {
            if (treeListData[i].id === item[this.primaryField]) {
                item.inTreeList = true;
                break;
            }
            if (treeListData[i].children.length) {
                this.inTreeList(treeListData[i].children, item);
            }
        }
    }
    // 在当前组织树内勾选所有已选择的组织
    /**
     * @private
     * @return {?}
     */
    tickSelections() {
        /** @type {?} */
        const ids = [];
        this.selections.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            this.inTreeList(this.treeListData, item);
            if (!!item.inTreeList) {
                ids.push(item[this.primaryField]);
            }
        }));
        /*
        if(this.checkedOrgs && this.checkedOrgs.length) {
            this.checkedOrgs.forEach(orgId => {
                if(CommonUtil.findIndex(orgId, this.primaryField, this.selections) === -1) {
                    ids.push(orgId);
                }
            });
        }
        */
        this.ngZone.runOutsideAngular((/**
         * @return {?}
         */
        () => {
            setTimeout((/**
             * @return {?}
             */
            () => {
                if (!ids.length) {
                    return;
                }
                if (this.multiSelect) {
                    this.farrisTree.checkedNodes(ids, true, true);
                }
                else {
                    if (ids.length > 1) {
                        this.msgService.show('warning', `亲，单选模式下，选中了${ids.length}条数据~`, true);
                        return;
                    }
                    this.farrisTree.clearSelections();
                    this.farrisTree.detectChanges();
                    this.farrisTree.selectNode(ids.join());
                }
            }));
        }));
    }
    /**
     * 组织数据转换
     * @private
     * @param {?} plainSource 接口原始数据
     * @param {?} layer 层级
     * @param {?=} expandedPath
     * @return {?} 返回树形接口的数据
     */
    dataToTree(plainSource, layer, expandedPath = '') {
        /** @type {?} */
        const treeSource = this.dealData(plainSource, expandedPath);
        /** @type {?} */
        const parents = treeSource.filter((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            return item.data.layer === layer;
        }));
        this.treeData(parents, treeSource, 1);
        return parents;
    }
    /**
     * 预处理组织数据
     * @private
     * @param {?} data
     * @param {?=} expandedPath
     * @return {?}
     */
    dealData(data, expandedPath = '') {
        /** @type {?} */
        const pathList = [];
        if (expandedPath != '') {
            /** @type {?} */
            let maxLength = expandedPath.length / this.pathLength;
            if (this.enableHierarchicalLoading) {
                maxLength -= 1;
            }
            for (let a = 0; a < maxLength; a++) {
                pathList.push({ path: expandedPath.substring(0, 4 * (a + 1)) });
            }
        }
        /** @type {?} */
        const newDatas = [];
        if (data.length) {
            data.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                /** @type {?} */
                const newsDataObj = {
                    data: {
                        orgId: item[this.primaryField],
                        name: item.name,
                        path: item.path,
                        code: item.code,
                        layer: Number(item.layer),
                        orgAllPath: item.orgAllPath,
                        inFavorites: item.inFavorites
                    },
                    expanded: true,
                    children: []
                };
                // let expanded = [];
                // if (this.enableHierarchicalLoading) {
                //     this.nodeExpanded(newsDataObj, this.treeListData, expanded);
                // }
                if (CommonUtil.findIndex(item.path, 'path', pathList) !== -1) {
                    newsDataObj.expanded = true;
                }
                else {
                    newsDataObj.expanded = false;
                    if (this.enableHierarchicalLoading && item.isDetail === '0') {
                        newsDataObj.leaf = false;
                    }
                }
                // todo 分层加载需要
                //if (this.enableHierarchicalLoading && item.isDetail === '0' && Number(item.layer) >= this.layer) {
                //newsDataObj.leaf = false;
                // newsDataObj.expanded = false;
                //}
                newDatas.push(newsDataObj);
            }));
        }
        return newDatas;
    }
    /**
     * 数据转换
     * @param {?} parents 父级节点信息
     * @param {?} treeSource 原始数据信息
     * @param {?} layer 层级
     * @return {?}
     */
    treeData(parents, treeSource, layer) {
        parents.forEach((/**
         * @param {?} parent
         * @return {?}
         */
        parent => {
            /** @type {?} */
            const parentPath = parent['data']['path'];
            /** @type {?} */
            const parentLayer = parent['data']['layer'];
            treeSource.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                if (item && item['data'] && item['data']['path']) {
                    /** @type {?} */
                    const itemPath = item['data']['path'];
                    /** @type {?} */
                    const itemLayer = item['data']['layer'];
                    /** @type {?} */
                    let targetPath;
                    if (itemPath && itemPath.length > parentPath.length) {
                        targetPath = itemPath.substr(0, Number(layer) * 4);
                    }
                    if (parentPath === targetPath && parentLayer === itemLayer - 1) {
                        parent['children'].push(item);
                    }
                    if (parentPath === targetPath) {
                        this.treeData([item], treeSource, Number(layer) + 1);
                    }
                }
            }));
        }));
    }
    // 收藏或取消收藏当前节点对应的组织
    /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    toggleFavorites(e, item) {
        this.favoritesTool.toggleFavorites(e, item);
    }
    // 监听组织树展开事件
    /**
     * @param {?} obj
     * @return {?}
     */
    listenTreeExpand(obj) {
        // todo 分层加载
        if (this.enableHierarchicalLoading && obj.children.length === 0) {
            this.getOrganizationByParentNode(obj);
        }
    }
    // 分层加载时，获取下级组织数据并为当前组织树添加子节点
    /**
     * @param {?} parentNode
     * @return {?}
     */
    getOrganizationByParentNode(parentNode) {
        /** @type {?} */
        const param = {
            absOrgType: this.absOrgType,
            parentID: parentNode.id,
            notGetStopOrg: this.notGetStopOrg,
            getCurUser: false,
            getOrgAllPath: true
        };
        this.apiService.getOrganization(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            if (res && res.data) {
                /** @type {?} */
                const newDatas = [];
                res.data.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => {
                    if (CommonUtil.findIndex(item[this.primaryField], this.primaryField, this.originalTreeData) === -1) {
                        item.selectable = true;
                        this.originalTreeData.push(item);
                    }
                    if (this.enableFavorites) {
                        item.inFavorites = true;
                        if (CommonUtil.findIndex(item[this.primaryField], this.primaryField, this.favoritesList) === -1) {
                            item.inFavorites = false;
                        }
                    }
                    newDatas.push(item);
                }));
                /** @type {?} */
                const nodes = this.dealData(newDatas);
                this.farrisTree.appendChildren(nodes, parentNode);
                this.farrisTree.detectChanges();
                this.tickSelections();
            }
        }));
    }
    // 返回已经该节点是否展开过
    /**
     * @private
     * @param {?} item
     * @param {?} arr
     * @param {?} expanded
     * @return {?}
     */
    nodeExpanded(item, arr, expanded) {
        for (let i = 0; i < arr.length; i++) {
            if (item.data.id === arr[i].data.id) {
                expanded[0] = arr[i].expanded;
            }
            else if (arr[i].children.length) {
                this.nodeExpanded(item, arr[i].children, expanded);
            }
        }
    }
    // 展开节点
    /**
     * @private
     * @param {?} treeData
     * @param {?} path
     * @param {?} layer
     * @return {?}
     */
    expandTreeNode(treeData, path, layer) {
        treeData.forEach((/**
         * @param {?} node
         * @return {?}
         */
        node => {
            if (path.includes(node.data.path)) {
                this.farrisTree.expandNode(node.data.id);
            }
            if (node.data.layer < layer && node.children.length) {
                this.expandTreeNode(node.children, path, layer);
            }
        }));
    }
}
OrganizationComponent.decorators = [
    { type: Component, args: [{
                selector: 'lib-org',
                template: "<farris-treetable #farristree style=\"cursor:pointer\" [width]=\"'100%'\" [data]=\"treeListData\" [idField]=\"primaryField\"\r\n    [columns]=\"treeTableCols\" [singleSelect]=\"!multiSelect\" [showBorder]=\"false\" [showCheckbox]=\"multiSelect\"\r\n    [showIcon]=\"false\" [showHeader]=\"true\" [fixedHeader]=\"true\" [disabled]=\"false\" [fit]=\"true\" [checkOnSelect]=\"true\"\r\n    [striped]=\"true\" [cascadeCheck]=\"cascadeCheck\" [cascadeDown]=\"cascadeDown\" [cascadeUp]=\"cascadeUp\"\r\n    [keepSelect]=\"keepSelect\" [showCheckAll]=\"showCheckAll\" [onlySelectSelf]=\"true\"\r\n    [beforeClickNode]=\"beforeClickNode\" [beforeCheckAll]=\"beforeCheckAll\"\r\n    (nodeChecked)=\"changeSelections($event)\" (nodeUnChecked)=\"changeSelections($event)\"\r\n    (nodeSelected)=\"changeSelections($event)\" (nodeUnSelect)=\"changeSelections($event)\"\r\n    (checkAll)=\"checkAll()\" (unCheckAll)=\"unCheckAll()\"\r\n    (expand)=\"listenTreeExpand($event)\" class=\"fos-treetable\">\r\n</farris-treetable>\r\n\r\n<!-- \u7EC4\u7EC7\u6811\u6A21\u677F -->\r\n<ng-template #orgNameCell let-ctx>\r\n    <span style=\"font-size: 13px;\" title=\"{{ctx.node.data.name}}\">{{ctx.node.data.name}}</span>\r\n</ng-template>\r\n\r\n<!-- \u7EC4\u7EC7\u6811\u6A21\u677F-\u6536\u85CF\u5217 -->\r\n<ng-template #favoritesCell let-ctx>\r\n    <span class=\"f-icon f-icon-star\" [class.default-light-color]=\"ctx.node.data.inFavorites\"\r\n        [class.default-dark-color]=\"!ctx.node.data.inFavorites\" (click)=\"toggleFavorites($event, ctx.node.data)\"></span>\r\n</ng-template>",
                styles: [""]
            }] }
];
/** @nocollapse */
OrganizationComponent.ctorParameters = () => [
    { type: ApiService },
    { type: ChangeDetectorRef },
    { type: FavoritesTool },
    { type: Injector },
    { type: NgZone },
    { type: StateMgrTool },
    { type: MessagerService }
];
OrganizationComponent.propDecorators = {
    enableFavorites: [{ type: Input }],
    baseCls: [{ type: HostBinding, args: ['class.f-utils-fill-flex-column',] }],
    farrisTree: [{ type: ViewChild, args: ['farristree',] }],
    orgNameCell: [{ type: ViewChild, args: ['orgNameCell',] }],
    favoritesCell: [{ type: ViewChild, args: ['favoritesCell',] }],
    primaryField: [{ type: Input }],
    enableHierarchicalLoading: [{ type: Input }],
    notGetStopOrg: [{ type: Input }],
    layer: [{ type: Input }],
    multiSelect: [{ type: Input }],
    absOrgType: [{ type: Input }],
    cascadeCheck: [{ type: Input }],
    cascadeUp: [{ type: Input }],
    cascadeDown: [{ type: Input }],
    showCheckAll: [{ type: Input }],
    keepSelect: [{ type: Input }],
    pathLength: [{ type: Input }],
    orgIds: [{ type: Input }],
    selectedLimit: [{ type: Input }],
    selectionsChange: [{ type: Output }]
};
if (false) {
    /** @type {?} */
    OrganizationComponent.prototype.enableFavorites;
    /** @type {?} */
    OrganizationComponent.prototype.baseCls;
    /** @type {?} */
    OrganizationComponent.prototype.farrisTree;
    /** @type {?} */
    OrganizationComponent.prototype.orgNameCell;
    /** @type {?} */
    OrganizationComponent.prototype.favoritesCell;
    /** @type {?} */
    OrganizationComponent.prototype.primaryField;
    /** @type {?} */
    OrganizationComponent.prototype.enableHierarchicalLoading;
    /** @type {?} */
    OrganizationComponent.prototype.notGetStopOrg;
    /** @type {?} */
    OrganizationComponent.prototype.layer;
    /** @type {?} */
    OrganizationComponent.prototype.multiSelect;
    /** @type {?} */
    OrganizationComponent.prototype.absOrgType;
    /** @type {?} */
    OrganizationComponent.prototype.cascadeCheck;
    /** @type {?} */
    OrganizationComponent.prototype.cascadeUp;
    /** @type {?} */
    OrganizationComponent.prototype.cascadeDown;
    /** @type {?} */
    OrganizationComponent.prototype.showCheckAll;
    /** @type {?} */
    OrganizationComponent.prototype.keepSelect;
    /** @type {?} */
    OrganizationComponent.prototype.pathLength;
    /** @type {?} */
    OrganizationComponent.prototype.orgIds;
    /** @type {?} */
    OrganizationComponent.prototype.selectedLimit;
    /** @type {?} */
    OrganizationComponent.prototype.selectionsChange;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.selectionsSub;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.favoritesSub;
    /** @type {?} */
    OrganizationComponent.prototype.originalTreeData;
    /** @type {?} */
    OrganizationComponent.prototype.locationOrgText;
    /** @type {?} */
    OrganizationComponent.prototype.treeListData;
    /** @type {?} */
    OrganizationComponent.prototype.treeTableCols;
    /** @type {?} */
    OrganizationComponent.prototype.selections;
    /** @type {?} */
    OrganizationComponent.prototype.favoritesList;
    /** @type {?} */
    OrganizationComponent.prototype.initLoad;
    /** @type {?} */
    OrganizationComponent.prototype.checkedOrgs;
    /** @type {?} */
    OrganizationComponent.prototype.beforeClickNode;
    /** @type {?} */
    OrganizationComponent.prototype.beforeCheckAll;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.apiService;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.cdr;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.favoritesTool;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.ngZone;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.stateMgr;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.msgService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG8uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1vcmdhbml6YXRpb24tc2VsZWN0b3IvIiwic291cmNlcyI6WyJsaWIvdGFiLW9yZ2FuaXphdGlvbi90by5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQ0gsU0FBUyxFQUFFLEtBQUssRUFBRSxZQUFZLEVBQUUsTUFBTSxFQUFtRCxpQkFBaUIsRUFBWSxRQUFRLEVBQUUsU0FBUyxFQUFFLFdBQVcsRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUM5SyxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDckQsT0FBTyxLQUFLLENBQUMsTUFBTSxXQUFXLENBQUM7QUFFL0IsT0FBTyxFQUFZLEVBQUUsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUNwQyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDM0QsT0FBTyxFQUFFLFVBQVUsRUFBbUIsTUFBTSx3QkFBd0IsQ0FBQztBQUNyRSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDckQsT0FBTyxFQUFZLGtCQUFrQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDcEUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBRTFELE9BQU8sRUFBRSxTQUFTLEVBQU8sTUFBTSxnQkFBZ0IsQ0FBQztBQUNoRCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFPdEQsTUFBTSxPQUFPLHFCQUFxQjs7Ozs7Ozs7OztJQWdIOUIsWUFDWSxVQUFzQixFQUN0QixHQUFzQixFQUN0QixhQUE0QixFQUM1QixRQUFrQixFQUNsQixNQUFjLEVBQ2QsUUFBc0IsRUFDdEIsVUFBMkI7UUFOM0IsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQUN0QixRQUFHLEdBQUgsR0FBRyxDQUFt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Q3pCLDZDQUErQjs7SUFDL0IsMENBQTRCOztJQUM1Qiw0Q0FBOEI7O0lBQzlCLDZDQUErQjs7SUFDL0IsMkNBQTZCOztJQUM3QiwyQ0FBd0I7O0lBRXhCLHVDQUEwQjs7SUFDMUIsOENBQStCOztJQUMvQixpREFBcUQ7Ozs7O0lBRXJELDhDQUFvQzs7Ozs7SUFDcEMsNkNBQW1DOztJQUNuQyxpREFBc0I7O0lBQ3RCLGdEQUFxQjs7SUFDckIsNkNBQThCOztJQUM5Qiw4Q0FBbUI7O0lBQ25CLDJDQUFnQjs7SUFDaEIsOENBQW1COztJQUNuQix5Q0FBZ0I7O0lBQ2hCLDRDQUFpQjs7SUFFakIsZ0RBaURFOztJQUVGLCtDQXdCQzs7Ozs7SUFHRywyQ0FBOEI7Ozs7O0lBQzlCLG9DQUE4Qjs7Ozs7SUFDOUIsOENBQW9DOzs7OztJQUNwQyx5Q0FBMEI7Ozs7O0lBQzFCLHVDQUFzQjs7Ozs7SUFDdEIseUNBQThCOzs7OztJQUM5QiwyQ0FBbUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gICAgQ29tcG9uZW50LCBJbnB1dCwgRXZlbnRFbWl0dGVyLCBPdXRwdXQsIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgU2ltcGxlQ2hhbmdlcywgT25DaGFuZ2VzLCBDaGFuZ2VEZXRlY3RvclJlZiwgT3B0aW9uYWwsIEluamVjdG9yLCBWaWV3Q2hpbGQsIFRlbXBsYXRlUmVmLCBIb3N0QmluZGluZywgTmdab25lLCBPbkRlc3Ryb3lcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQXBpU2VydmljZSB9IGZyb20gJy4uLy4uL3V0aWxzL2FwaS5zZXJ2aWNlJztcclxuaW1wb3J0ICogYXMgXyBmcm9tICdsb2Rhc2gtZXMnO1xyXG5pbXBvcnQgeyBub0RhdGFJbWcgfSBmcm9tICcuLi8uLi9hc3NldHMvcmVzb3VyY2UnO1xyXG5pbXBvcnQgeyBmb3JrSm9pbiwgb2YgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgRmF2b3JpdGVzVG9vbCB9IGZyb20gJy4uLy4uL3V0aWxzL2Zhdm9yaXRlcy50b29sJztcclxuaW1wb3J0IHsgQ2hhbmdlVHlwZSwgT3JnUmVxdWVzdFBhcmFtIH0gZnJvbSAnLi4vLi4vdXRpbHMvaW5kZXgudHlwZSc7XHJcbmltcG9ydCB7IENvbW1vblV0aWwgfSBmcm9tICcuLi8uLi91dGlscy9jb21tb24udG9vbCc7XHJcbmltcG9ydCB7IFRyZWVOb2RlLCBUcmVlVGFibGVDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLXRyZWV0YWJsZSc7XHJcbmltcG9ydCB7IFN0YXRlTWdyVG9vbCB9IGZyb20gJy4uLy4uL3V0aWxzL3N0YXRlLm1nci50b29sJztcclxuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IHN3aXRjaE1hcCwgdGFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdsaWItb3JnJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi90by5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBzdHlsZVVybHM6IFsnLi90by5jb21wb25lbnQuY3NzJ10sXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBPcmdhbml6YXRpb25Db21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIEFmdGVyVmlld0luaXQsIE9uQ2hhbmdlcywgT25EZXN0cm95IHtcclxuXHJcbiAgICBASW5wdXQoKSBlbmFibGVGYXZvcml0ZXM6IGJvb2xlYW47XHJcbiAgICBASG9zdEJpbmRpbmcoJ2NsYXNzLmYtdXRpbHMtZmlsbC1mbGV4LWNvbHVtbicpIGJhc2VDbHMgPSB0cnVlO1xyXG4gICAgQFZpZXdDaGlsZCgnZmFycmlzdHJlZScpIGZhcnJpc1RyZWU6IFRyZWVUYWJsZUNvbXBvbmVudDtcclxuICAgIEBWaWV3Q2hpbGQoJ29yZ05hbWVDZWxsJykgb3JnTmFtZUNlbGw6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgICBAVmlld0NoaWxkKCdmYXZvcml0ZXNDZWxsJykgZmF2b3JpdGVzQ2VsbDogVGVtcGxhdGVSZWY8YW55PjtcclxuICAgIEBJbnB1dCgpIHByaW1hcnlGaWVsZCA9ICdvcmdJZCc7XHJcbiAgICBASW5wdXQoKSBlbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgbm90R2V0U3RvcE9yZzogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGxheWVyOiBudW1iZXI7XHJcbiAgICBASW5wdXQoKSBtdWx0aVNlbGVjdDogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGFic09yZ1R5cGU6IGFueTtcclxuICAgIEBJbnB1dCgpIGNhc2NhZGVDaGVjazogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGNhc2NhZGVVcDogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGNhc2NhZGVEb3duOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgc2hvd0NoZWNrQWxsOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkga2VlcFNlbGVjdDogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIHBhdGhMZW5ndGggPSA0O1xyXG4gICAgLy8g5bey6YCJ5Lit57uE57uH55qEaWQsIOagueaNrue7hOe7h2lk6I635Y+W57uE57uH5a6M5pW05L+h5oGv77yM54S25ZCO6L+95Yqg5Yiwc2VsZWN0aW9ucy0tLXRvZG9cclxuICAgIEBJbnB1dCgpIG9yZ0lkczogc3RyaW5nW107XHJcbiAgICBASW5wdXQoKSBzZWxlY3RlZExpbWl0OiBudW1iZXI7XHJcbiAgICBAT3V0cHV0KCkgc2VsZWN0aW9uc0NoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICAgIHByaXZhdGUgc2VsZWN0aW9uc1N1YjogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSBmYXZvcml0ZXNTdWI6IFN1YnNjcmlwdGlvbjtcclxuICAgIG9yaWdpbmFsVHJlZURhdGEgPSBbXTtcclxuICAgIGxvY2F0aW9uT3JnVGV4dCA9ICcnO1xyXG4gICAgdHJlZUxpc3REYXRhOiBUcmVlTm9kZVtdID0gW107XHJcbiAgICB0cmVlVGFibGVDb2xzID0gW107XHJcbiAgICBzZWxlY3Rpb25zID0gW107XHJcbiAgICBmYXZvcml0ZXNMaXN0ID0gW107XHJcbiAgICBpbml0TG9hZCA9IHRydWU7XHJcbiAgICBjaGVja2VkT3JncyA9IFtdO1xyXG5cclxuICAgIGJlZm9yZUNsaWNrTm9kZSA9IChlKSA9PiB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG9mKHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMubXVsdGlTZWxlY3QpIHtcclxuICAgICAgICAgICAgaWYgKGUucm93Tm9kZS5pc1NlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGlvbnMoW10pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb25zKG5ldyBBcnJheShlLnJvd05vZGUubm9kZS5kYXRhKSwgQ2hhbmdlVHlwZS5WYWx1ZUNoYW5nZWQsICdvdGhlcicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBvZihmYWxzZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBwYXJhbTogT3JnUmVxdWVzdFBhcmFtID0ge1xyXG4gICAgICAgICAgICBhYnNPcmdUeXBlOiB0aGlzLmFic09yZ1R5cGUsXHJcbiAgICAgICAgICAgIG5vdEdldFN0b3BPcmc6IHRoaXMubm90R2V0U3RvcE9yZyxcclxuICAgICAgICAgICAgZ2V0Q3VyVXNlcjogZmFsc2UsXHJcbiAgICAgICAgICAgIHBhcmVudElEOiBlLnJvd05vZGUuaWQsXHJcbiAgICAgICAgICAgIHdpdGhBbGxTdWI6IHRydWUsXHJcbiAgICAgICAgICAgIGdldE9yZ0FsbFBhdGg6IHRydWVcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFwaVNlcnZpY2UuZ2V0T3JnYW5pemF0aW9uKHBhcmFtKS5waXBlKFxyXG4gICAgICAgICAgICBzd2l0Y2hNYXAoXHJcbiAgICAgICAgICAgICAgICAoZGF0YTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGFbJ2RhdGEnXS5sZW5ndGggPiB0aGlzLnNlbGVjdGVkTGltaXQgJiYgIWUucm93Tm9kZS5pc0NoZWNrZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tc2dTZXJ2aWNlLnNob3coJ3dhcm5pbmcnLCBg5Lqy77yM5LiA5qyh5oCn6YCJ5oup5LqG6LaF6L+HJHt0aGlzLnNlbGVjdGVkTGltaXR95p2h5pWw5o2ufmAsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2YoZmFsc2UpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZS5yb3dOb2RlLmlzQ2hlY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0b2RvIOW+hemqjOivge+8jOWKoOWFpXNlbGVjdGlvbu+8jFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmRhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChDb21tb25VdGlsLmZpbmRJbmRleChpdGVtW3RoaXMucHJpbWFyeUZpZWxkXSwgdGhpcy5wcmltYXJ5RmllbGQsIHRoaXMuc2VsZWN0aW9ucykgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb25zKGl0ZW0sIENoYW5nZVR5cGUuQXBwZW5kLCAnb3RoZXInKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvbnMuZm9yRWFjaCgoc2VsZWN0aW9uLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5kYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGlvblt0aGlzLnByaW1hcnlGaWVsZF0gPT09IGl0ZW1bdGhpcy5wcmltYXJ5RmllbGRdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9ucyhpdGVtLCBDaGFuZ2VUeXBlLlJlbW92ZSwgJ290aGVyJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9mKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICk7XHJcbiAgICB9O1xyXG5cclxuICAgIGJlZm9yZUNoZWNrQWxsID0gKGUpID0+IHtcclxuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZykge1xyXG4gICAgICAgICAgICByZXR1cm4gb2YodHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHBhcmFtOiBPcmdSZXF1ZXN0UGFyYW0gPSB7XHJcbiAgICAgICAgICAgIGFic09yZ1R5cGU6IHRoaXMuYWJzT3JnVHlwZSxcclxuICAgICAgICAgICAgbm90R2V0U3RvcE9yZzogdGhpcy5ub3RHZXRTdG9wT3JnLFxyXG4gICAgICAgICAgICBnZXRDdXJVc2VyOiBmYWxzZSxcclxuICAgICAgICAgICAgcGFyZW50SUQ6IGUuaW5zdGFuY2UuZGF0YVswXS5pZCxcclxuICAgICAgICAgICAgd2l0aEFsbFN1YjogdHJ1ZSxcclxuICAgICAgICAgICAgZ2V0T3JnQWxsUGF0aDogdHJ1ZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBpU2VydmljZS5nZXRPcmdhbml6YXRpb24ocGFyYW0pLnBpcGUoXHJcbiAgICAgICAgICAgIHN3aXRjaE1hcChcclxuICAgICAgICAgICAgICAgIChkYXRhOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YVsnZGF0YSddLmxlbmd0aCA+IHRoaXMuc2VsZWN0ZWRMaW1pdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1zZ1NlcnZpY2Uuc2hvdygnd2FybmluZycsIGDkurLvvIzkuIDmrKHmgKfpgInmi6nkuobotoXov4cke3RoaXMuc2VsZWN0ZWRMaW1pdH3mnaHmlbDmja5+YCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvZihmYWxzZSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb25zKGRhdGFbJ2RhdGEnXSwgQ2hhbmdlVHlwZS5WYWx1ZUNoYW5nZWQsICdvdGhlcicpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvZih0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSBhcGlTZXJ2aWNlOiBBcGlTZXJ2aWNlLFxyXG4gICAgICAgIHByaXZhdGUgY2RyOiBDaGFuZ2VEZXRlY3RvclJlZixcclxuICAgICAgICBwcml2YXRlIGZhdm9yaXRlc1Rvb2w6IEZhdm9yaXRlc1Rvb2wsXHJcbiAgICAgICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXHJcbiAgICAgICAgcHJpdmF0ZSBuZ1pvbmU6IE5nWm9uZSxcclxuICAgICAgICBwcml2YXRlIHN0YXRlTWdyOiBTdGF0ZU1nclRvb2wsXHJcbiAgICAgICAgcHJpdmF0ZSBtc2dTZXJ2aWNlOiBNZXNzYWdlclNlcnZpY2VcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMuY2RyID0gdGhpcy5pbmplY3Rvci5nZXQoQ2hhbmdlRGV0ZWN0b3JSZWYpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25EZXN0cm95KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZmF2b3JpdGVzU3ViLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25zU3ViLnVuc3Vic2NyaWJlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy50cmVlVGFibGVDb2xzID0gW1xyXG4gICAgICAgICAgICB7IGZpZWxkOiAnbmFtZScsIHRpdGxlOiAn57uE57uH5ZCN56ewJywgdGVtcGxhdGU6IHRoaXMub3JnTmFtZUNlbGwgfSxcclxuICAgICAgICAgICAgeyBmaWVsZDogJ2NvZGUnLCB0aXRsZTogJ+e7hOe7h+e8luWPtycgfVxyXG4gICAgICAgIF07XHJcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlRmF2b3JpdGVzKSB7XHJcbiAgICAgICAgICAgIHRoaXMudHJlZVRhYmxlQ29scy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGZpZWxkOiAnJyxcclxuICAgICAgICAgICAgICAgIHRpdGxlOiAn5pS26JePJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiB0aGlzLmZhdm9yaXRlc0NlbGxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMudHJlZVRhYmxlQ29sc1swXS53aWR0aCA9IDMwMDtcclxuICAgICAgICAgICAgdGhpcy50cmVlVGFibGVDb2xzWzFdLndpZHRoID0gMzAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmZhdm9yaXRlc1N1YiA9IHRoaXMuZmF2b3JpdGVzVG9vbC5mYXZvcml0ZXNTdWJqZWN0LnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgICAgICAgdGhpcy5mYXZvcml0ZXNMaXN0ID0gZGF0YTtcclxuICAgICAgICAgICAgdGhpcy5zZXRGYXZvcml0ZXModGhpcy50cmVlTGlzdERhdGEpO1xyXG4gICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0aW9uc1N1YiA9IHRoaXMuc3RhdGVNZ3Iuc2VsZWN0aW9uc1N1YmplY3Quc3Vic2NyaWJlKGRhdGEgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5jaGFuZ2VUeXBlID09PSBDaGFuZ2VUeXBlLlZhbHVlQ2hhbmdlZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zID0gXy5jbG9uZURlZXAoZGF0YS52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmFycmlzVHJlZS5jbGVhckNoZWNrZWRzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLmNsZWFyU2VsZWN0aW9ucygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmFycmlzVHJlZS5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5mcm9tID09PSAnb3RoZXInKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50aWNrU2VsZWN0aW9ucygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEuY2hhbmdlVHlwZSA9PT0gQ2hhbmdlVHlwZS5SZW1vdmUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IHRoaXMuc2VsZWN0aW9ucy5maWx0ZXIoaXRlbSA9PiBpdGVtW3RoaXMucHJpbWFyeUZpZWxkXSAhPT0gZGF0YS52YWx1ZVt0aGlzLnByaW1hcnlGaWVsZF0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubXVsdGlTZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmluVHJlZUxpc3QodGhpcy50cmVlTGlzdERhdGEsIGRhdGEudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghIWRhdGEudmFsdWUuaW5UcmVlTGlzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUudW5DaGVja2VkTm9kZShkYXRhLnZhbHVlW3RoaXMucHJpbWFyeUZpZWxkXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUudW5TZWxlY3ROb2RlKGRhdGEudmFsdWVbdGhpcy5wcmltYXJ5RmllbGRdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhLmNoYW5nZVR5cGUgPT09IENoYW5nZVR5cGUuQXBwZW5kKSB7XHJcbiAgICAgICAgICAgICAgICBDb21tb25VdGlsLmZpbmRJbmRleChkYXRhLnZhbHVlW3RoaXMucHJpbWFyeUZpZWxkXSwgdGhpcy5wcmltYXJ5RmllbGQsIHRoaXMuc2VsZWN0aW9ucykgPT09IC0xID8gdGhpcy5zZWxlY3Rpb25zLnB1c2goZGF0YS52YWx1ZSkgOiBudWxsO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubXVsdGlTZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmluVHJlZUxpc3QodGhpcy50cmVlTGlzdERhdGEsIGRhdGEudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghIWRhdGEudmFsdWUuaW5UcmVlTGlzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUuY2hlY2tlZE5vZGUoZGF0YS52YWx1ZVt0aGlzLnByaW1hcnlGaWVsZF0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLnNlbGVjdE5vZGUoZGF0YS52YWx1ZVt0aGlzLnByaW1hcnlGaWVsZF0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmluaXRMb2FkKSB7XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmhsQXNzZW1ibGVEYXRhKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXNzZW1ibGVEYXRhKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRMb2FkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyVmlld0luaXQoKTogdm9pZCB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcclxuICAgICAgICAvKlxyXG4gICAgICAgIGNvbnN0IG9yZ0lkc0NoYW5nZSA9IGNoYW5nZXMub3JnSWRzO1xyXG4gICAgICAgIGlmIChvcmdJZHNDaGFuZ2UgJiYgb3JnSWRzQ2hhbmdlLmN1cnJlbnRWYWx1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrZWRPcmdzID0gb3JnSWRzQ2hhbmdlLmN1cnJlbnRWYWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgKi9cclxuICAgIH1cclxuXHJcbiAgICAvLyDorr7nva7lvZPliY3nu4Tnu4fmoJHlkITkuKroioLngrnnmoTmlLbol4/nirbmgIFcclxuICAgIHByaXZhdGUgc2V0RmF2b3JpdGVzKHRyZWVMaXN0RGF0YTogVHJlZU5vZGVbXSkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdHJlZUxpc3REYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChDb21tb25VdGlsLmZpbmRJbmRleCh0cmVlTGlzdERhdGFbaV0uaWQsIHRoaXMucHJpbWFyeUZpZWxkLCB0aGlzLmZhdm9yaXRlc0xpc3QpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgdHJlZUxpc3REYXRhW2ldLmRhdGEuaW5GYXZvcml0ZXMgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRyZWVMaXN0RGF0YVtpXS5kYXRhLmluRmF2b3JpdGVzID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodHJlZUxpc3REYXRhW2ldLmNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRGYXZvcml0ZXModHJlZUxpc3REYXRhW2ldLmNoaWxkcmVuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNldFNlbGVjdGlvbnMoc2VsZWN0aW9uczogYW55LCBjaGFuZ2VUeXBlID0gQ2hhbmdlVHlwZS5WYWx1ZUNoYW5nZWQsIGZyb206IHN0cmluZyA9ICd0cmVlJykge1xyXG4gICAgICAgIHRoaXMuc3RhdGVNZ3IuZW1pdFNlbGVjdGlvbnMoc2VsZWN0aW9ucywgY2hhbmdlVHlwZSwgZnJvbSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g57uE57uH5qCR5YWo6YCJ5LqL5Lu2XHJcbiAgICBjaGVja0FsbCgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZykge1xyXG4gICAgICAgICAgICBjb25zdCBjaGVja2VkcyA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUuY2hlY2tlZHMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIGNoZWNrZWRzLnB1c2goaXRlbS5kYXRhKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb25zKGNoZWNrZWRzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8g57uE57uH5qCR5Y+W5raI5YWo6YCJ5LqL5Lu2XHJcbiAgICB1bkNoZWNrQWxsKCkge1xyXG4gICAgICAgIHRoaXMuc2V0U2VsZWN0aW9ucyhbXSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g6YCJ5Lit77yI5Y+W5raI6YCJ5Lit44CB5Yu+6YCJ44CB5Y+W5raI5Yu+6YCJ77yJ5qCR6IqC54K55pe26Kem5Y+RXHJcbiAgICAvLyB0b2RvIOWIhuWxguWKoOi9veeahOaXtuWAmeWSi+WkhOeQhuaVsOaNru+8jGJlZm9yZVVuQ2hlY2tBbGzov5jmnKrmlK/mjIHjgIJcclxuICAgIGNoYW5nZVNlbGVjdGlvbnMoZTogYW55KSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcgJiYgISFlLm9yaWdpbmFsRXZlbnQpIHtcclxuICAgICAgICAgICAgdGhpcy5tdWx0aVNlbGVjdCA/IHRoaXMudG9nZ2xlQ2hlY2tlZChlKSA6IHRoaXMudG9nZ2xlU2VsZWN0ZWQoZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHRvZ2dsZUNoZWNrZWQoZTogYW55KSB7XHJcbiAgICAgICAgbGV0IGNoZWNrZWRzID0gW107XHJcbiAgICAgICAgZSAmJiBlLmluc3RhbmNlICYmIGUuaW5zdGFuY2UuY2hlY2tlZHMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgY2hlY2tlZHMucHVzaChpdGVtLmRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc2V0U2VsZWN0aW9ucyhjaGVja2Vkcyk7XHJcbiAgICB9XHJcblxyXG4gICAgdG9nZ2xlU2VsZWN0ZWQoZTogYW55KSB7XHJcbiAgICAgICAgbGV0IHNlbGVjdGVkID0gW107XHJcbiAgICAgICAgZSAmJiBlLmluc3RhbmNlICYmIGUuaW5zdGFuY2Uuc2VsZWN0aW9ucy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBzZWxlY3RlZC5wdXNoKGl0ZW0uZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb25zKHNlbGVjdGVkKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDmoLnmja7kvKDlhaXnmoTnu4Tnu4dpZOehruWumuW3sumAieaLqee7hOe7h1xyXG4gICAgcHJpdmF0ZSBhc3NlbWJsZURhdGFCeU9yZ0lkcyhpZHM6IHN0cmluZ1tdKXtcclxuICAgICAgICBpZighaWRzIHx8IGlkcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihpZHMgJiYgaWRzLmxlbmd0aCA+IDAgJiYgIXRoaXMubXVsdGlTZWxlY3Qpe1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ+WNlemAieaooeW8j+S4i++8jOWPquWFgeiuuOmAieS4reS4gOadoeaVsOaNrn4nKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwYXJhbTogT3JnUmVxdWVzdFBhcmFtID0ge1xyXG4gICAgICAgICAgICBhYnNPcmdUeXBlOiB0aGlzLmFic09yZ1R5cGUsXHJcbiAgICAgICAgICAgIGlkTGlzdDogaWRzLFxyXG4gICAgICAgICAgICBnZXRDdXJVc2VyOiBmYWxzZSxcclxuICAgICAgICAgICAgZ2V0T3JnQWxsUGF0aDogdHJ1ZSxcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuYXBpU2VydmljZS5nZXRPcmdhbml6YXRpb24ocGFyYW0pLnN1YnNjcmliZSgocmVzOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlcyAmJiByZXMuZGF0YSAmJiByZXMuZGF0YS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZWRPcmdzID0gcmVzLmRhdGE7XHJcbiAgICAgICAgICAgICAgICByZXMuZGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChDb21tb25VdGlsLmZpbmRJbmRleChpdGVtW3RoaXMucHJpbWFyeUZpZWxkXSwgdGhpcy5wcmltYXJ5RmllbGQsIHRoaXMuc2VsZWN0aW9ucykgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9ucyhpdGVtLCBDaGFuZ2VUeXBlLkFwcGVuZCwgJ290aGVyJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpY2tTZWxlY3Rpb25zKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDliIblsYLliqDovb3nu4Tnu4fmoJFcclxuICAgIGhsQXNzZW1ibGVEYXRhKCkge1xyXG4gICAgICAgIGNvbnN0IHBhcmFtOiBPcmdSZXF1ZXN0UGFyYW0gPSB7XHJcbiAgICAgICAgICAgIGFic09yZ1R5cGU6IHRoaXMuYWJzT3JnVHlwZSxcclxuICAgICAgICAgICAgbm90R2V0U3RvcE9yZzogdGhpcy5ub3RHZXRTdG9wT3JnLFxyXG4gICAgICAgICAgICBnZXRPcmdBbGxQYXRoOiB0cnVlXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zdCBsYXllckxpc3QgPSBbXTtcclxuICAgICAgICBsZXQgbGF5ZXIgPSB0aGlzLmxheWVyO1xyXG4gICAgICAgIHdoaWxlIChsYXllciA+IDApIHtcclxuICAgICAgICAgICAgbGF5ZXJMaXN0LnB1c2gobGF5ZXIpO1xyXG4gICAgICAgICAgICBsYXllciAtPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBwYXJhbS5sYXllckxpc3QgPSBsYXllckxpc3Q7XHJcbiAgICAgICAgdGhpcy5hcGlTZXJ2aWNlLmdldE9yZ2FuaXphdGlvbihwYXJhbSkuc3Vic2NyaWJlKChyZXM6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXJlcyB8fCAhcmVzLmRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZih0aGlzLm9yZ0lkcy5sZW5ndGggPT0gMCl7XHJcbiAgICAgICAgICAgICAgICByZXMuZGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uc2VsZWN0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5lbmFibGVGYXZvcml0ZXMpIHtcclxuICAgICAgICAgICAgICAgIHJlcy5kYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKENvbW1vblV0aWwuZmluZEluZGV4KGl0ZW1bdGhpcy5wcmltYXJ5RmllbGRdLCB0aGlzLnByaW1hcnlGaWVsZCwgdGhpcy5mYXZvcml0ZXNMaXN0KSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5pbkZhdm9yaXRlcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uaW5GYXZvcml0ZXMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMub3JpZ2luYWxUcmVlRGF0YSA9IHJlcy5kYXRhO1xyXG4gICAgICAgICAgICBpZiAocmVzICYmIHJlcy5jdXJBYnNVc2VyICYmIHJlcy5jdXJBYnNVc2VyLm9yZ0FsbFBhdGhJbmZvKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJVc2VyT3JnUGF0aCA9IHJlcy5jdXJBYnNVc2VyLm9yZ0FsbFBhdGhJbmZvO1xyXG4gICAgICAgICAgICAgICAgY3VyVXNlck9yZ1BhdGguZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoQ29tbW9uVXRpbC5maW5kSW5kZXgoaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0sIHRoaXMucHJpbWFyeUZpZWxkLCByZXMuZGF0YSkgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5kYXRhLnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy50cmVlTGlzdERhdGEgPSB0aGlzLmRhdGFUb1RyZWUocmVzLmRhdGEsIDEsIHJlcy5jdXJBYnNVc2VyLmRlZmF1bHRPcmdQYXRoKTtcclxuICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLmxvYWREYXRhKHRoaXMudHJlZUxpc3REYXRhKTtcclxuICAgICAgICAgICAgLypcclxuICAgICAgICAgICAgaWYodGhpcy5jaGVja2VkT3JncyAmJiB0aGlzLmNoZWNrZWRPcmdzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hc3NlbWJsZURhdGFCeU9yZ0lkcyh0aGlzLmNoZWNrZWRPcmdzKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICB0aGlzLnRpY2tTZWxlY3Rpb25zKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDlhajliqDovb3nu4Tnu4fmoJFcclxuICAgIGFzc2VtYmxlRGF0YSgpIHtcclxuICAgICAgICBjb25zdCBwYXJhbTogT3JnUmVxdWVzdFBhcmFtID0ge1xyXG4gICAgICAgICAgICBhYnNPcmdUeXBlOiB0aGlzLmFic09yZ1R5cGUsXHJcbiAgICAgICAgICAgIG5vdEdldFN0b3BPcmc6IHRoaXMubm90R2V0U3RvcE9yZyxcclxuICAgICAgICAgICAgZ2V0T3JnQWxsUGF0aDogdHJ1ZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5hcGlTZXJ2aWNlLmdldE9yZ2FuaXphdGlvbihwYXJhbSkuc3Vic2NyaWJlKChyZXM6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXJlcyB8fCAhcmVzLmRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5lbmFibGVGYXZvcml0ZXMpIHtcclxuICAgICAgICAgICAgICAgIHJlcy5kYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKENvbW1vblV0aWwuZmluZEluZGV4KGl0ZW1bdGhpcy5wcmltYXJ5RmllbGRdLCB0aGlzLnByaW1hcnlGaWVsZCwgdGhpcy5mYXZvcml0ZXNMaXN0KSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5pbkZhdm9yaXRlcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uaW5GYXZvcml0ZXMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMub3JpZ2luYWxUcmVlRGF0YSA9IHJlcy5kYXRhO1xyXG4gICAgICAgICAgICB0aGlzLnRyZWVMaXN0RGF0YSA9IHRoaXMuZGF0YVRvVHJlZShyZXMuZGF0YSwgMSwgcmVzLmN1ckFic1VzZXIuZGVmYXVsdE9yZ1BhdGgpO1xyXG4gICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUubG9hZERhdGEodGhpcy50cmVlTGlzdERhdGEpO1xyXG4gICAgICAgICAgICAvKlxyXG4gICAgICAgICAgICBpZih0aGlzLmNoZWNrZWRPcmdzICYmIHRoaXMuY2hlY2tlZE9yZ3MubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFzc2VtYmxlRGF0YUJ5T3JnSWRzKHRoaXMuY2hlY2tlZE9yZ3MpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHRoaXMudGlja1NlbGVjdGlvbnMoKTtcclxuICAgICAgICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOehruWumuW3sumAiee7hOe7h+aYr+WQpuWcqOW9k+WJjee7hOe7h+agkeWGhVxyXG4gICAgcHJpdmF0ZSBpblRyZWVMaXN0KHRyZWVMaXN0RGF0YTogVHJlZU5vZGVbXSwgaXRlbTogYW55KSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmVlTGlzdERhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKHRyZWVMaXN0RGF0YVtpXS5pZCA9PT0gaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0pIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uaW5UcmVlTGlzdCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodHJlZUxpc3REYXRhW2ldLmNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pblRyZWVMaXN0KHRyZWVMaXN0RGF0YVtpXS5jaGlsZHJlbiwgaXRlbSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5Zyo5b2T5YmN57uE57uH5qCR5YaF5Yu+6YCJ5omA5pyJ5bey6YCJ5oup55qE57uE57uHXHJcbiAgICBwcml2YXRlIHRpY2tTZWxlY3Rpb25zKCkge1xyXG4gICAgICAgIGNvbnN0IGlkcyA9IFtdO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0aW9ucy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmluVHJlZUxpc3QodGhpcy50cmVlTGlzdERhdGEsIGl0ZW0pO1xyXG4gICAgICAgICAgICBpZiAoISFpdGVtLmluVHJlZUxpc3QpIHtcclxuICAgICAgICAgICAgICAgIGlkcy5wdXNoKGl0ZW1bdGhpcy5wcmltYXJ5RmllbGRdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvKlxyXG4gICAgICAgIGlmKHRoaXMuY2hlY2tlZE9yZ3MgJiYgdGhpcy5jaGVja2VkT3Jncy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGVja2VkT3Jncy5mb3JFYWNoKG9yZ0lkID0+IHtcclxuICAgICAgICAgICAgICAgIGlmKENvbW1vblV0aWwuZmluZEluZGV4KG9yZ0lkLCB0aGlzLnByaW1hcnlGaWVsZCwgdGhpcy5zZWxlY3Rpb25zKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZHMucHVzaChvcmdJZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWlkcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmFycmlzVHJlZS5jaGVja2VkTm9kZXMoaWRzLCB0cnVlLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlkcy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubXNnU2VydmljZS5zaG93KCd3YXJuaW5nJywgYOS6su+8jOWNlemAieaooeW8j+S4i++8jOmAieS4reS6hiR7aWRzLmxlbmd0aH3mnaHmlbDmja5+YCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLmNsZWFyU2VsZWN0aW9ucygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmFycmlzVHJlZS5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLnNlbGVjdE5vZGUoaWRzLmpvaW4oKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICog57uE57uH5pWw5o2u6L2s5o2iXHJcbiAgICAqIEBwYXJhbSBwbGFpblNvdXJjZSDmjqXlj6Pljp/lp4vmlbDmja5cclxuICAgICogQHBhcmFtIGxheWVyIOWxgue6p1xyXG4gICAgKiBAcmV0dXJucyDov5Tlm57moJHlvaLmjqXlj6PnmoTmlbDmja5cclxuICAgICovXHJcbiAgICBwcml2YXRlIGRhdGFUb1RyZWUocGxhaW5Tb3VyY2U6IGFueSwgbGF5ZXI6IG51bWJlciwgZXhwYW5kZWRQYXRoOiBzdHJpbmcgPSAnJykge1xyXG4gICAgICAgIGNvbnN0IHRyZWVTb3VyY2UgPSB0aGlzLmRlYWxEYXRhKHBsYWluU291cmNlLCBleHBhbmRlZFBhdGgpO1xyXG4gICAgICAgIGNvbnN0IHBhcmVudHMgPSB0cmVlU291cmNlLmZpbHRlcihpdGVtID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIGl0ZW0uZGF0YS5sYXllciA9PT0gbGF5ZXI7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy50cmVlRGF0YShwYXJlbnRzLCB0cmVlU291cmNlLCAxKTtcclxuICAgICAgICByZXR1cm4gcGFyZW50cztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOmihOWkhOeQhue7hOe7h+aVsOaNrlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGRlYWxEYXRhKGRhdGE6IGFueVtdLCBleHBhbmRlZFBhdGg6IHN0cmluZyA9ICcnKSB7XHJcbiAgICAgICAgY29uc3QgcGF0aExpc3QgPSBbXTtcclxuICAgICAgICBpZihleHBhbmRlZFBhdGggIT0gJycpIHtcclxuICAgICAgICAgICAgbGV0IG1heExlbmd0aCA9IGV4cGFuZGVkUGF0aC5sZW5ndGggLyB0aGlzLnBhdGhMZW5ndGg7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcpIHtcclxuICAgICAgICAgICAgICAgIG1heExlbmd0aCAtPSAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAobGV0IGEgPSAwOyBhIDwgbWF4TGVuZ3RoOyBhKyspIHtcclxuICAgICAgICAgICAgICAgIHBhdGhMaXN0LnB1c2goeyBwYXRoOiBleHBhbmRlZFBhdGguc3Vic3RyaW5nKDAsIDQgKiAoYSArIDEpKSB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBuZXdEYXRhcyA9IFtdO1xyXG4gICAgICAgIGlmIChkYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBkYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdzRGF0YU9iajogYW55ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3JnSWQ6IGl0ZW1bdGhpcy5wcmltYXJ5RmllbGRdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBpdGVtLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg6IGl0ZW0ucGF0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29kZTogaXRlbS5jb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXllcjogTnVtYmVyKGl0ZW0ubGF5ZXIpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmdBbGxQYXRoOiBpdGVtLm9yZ0FsbFBhdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluRmF2b3JpdGVzOiBpdGVtLmluRmF2b3JpdGVzXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBleHBhbmRlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW11cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAvLyBsZXQgZXhwYW5kZWQgPSBbXTtcclxuICAgICAgICAgICAgICAgIC8vIGlmICh0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICB0aGlzLm5vZGVFeHBhbmRlZChuZXdzRGF0YU9iaiwgdGhpcy50cmVlTGlzdERhdGEsIGV4cGFuZGVkKTtcclxuICAgICAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgICAgIGlmIChDb21tb25VdGlsLmZpbmRJbmRleChpdGVtLnBhdGgsICdwYXRoJywgcGF0aExpc3QpICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld3NEYXRhT2JqLmV4cGFuZGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3c0RhdGFPYmouZXhwYW5kZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5lbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nICYmIGl0ZW0uaXNEZXRhaWwgPT09ICcwJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdzRGF0YU9iai5sZWFmID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gdG9kbyDliIblsYLliqDovb3pnIDopoFcclxuICAgICAgICAgICAgICAgIC8vaWYgKHRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZyAmJiBpdGVtLmlzRGV0YWlsID09PSAnMCcgJiYgTnVtYmVyKGl0ZW0ubGF5ZXIpID49IHRoaXMubGF5ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAvL25ld3NEYXRhT2JqLmxlYWYgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgIC8vIG5ld3NEYXRhT2JqLmV4cGFuZGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAvL31cclxuICAgICAgICAgICAgICAgIG5ld0RhdGFzLnB1c2gobmV3c0RhdGFPYmopO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ld0RhdGFzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5pWw5o2u6L2s5o2iXHJcbiAgICAgKiBAcGFyYW0gcGFyZW50cyDniLbnuqfoioLngrnkv6Hmga9cclxuICAgICAqIEBwYXJhbSB0cmVlU291cmNlIOWOn+Wni+aVsOaNruS/oeaBr1xyXG4gICAgICogQHBhcmFtIGxheWVyIOWxgue6p1xyXG4gICAgICovXHJcbiAgICB0cmVlRGF0YShwYXJlbnRzOiBhbnksIHRyZWVTb3VyY2U6IGFueSwgbGF5ZXI6IG51bWJlcikge1xyXG4gICAgICAgIHBhcmVudHMuZm9yRWFjaChwYXJlbnQgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXJlbnRQYXRoID0gcGFyZW50WydkYXRhJ11bJ3BhdGgnXTtcclxuICAgICAgICAgICAgY29uc3QgcGFyZW50TGF5ZXIgPSBwYXJlbnRbJ2RhdGEnXVsnbGF5ZXInXTtcclxuICAgICAgICAgICAgdHJlZVNvdXJjZS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0gJiYgaXRlbVsnZGF0YSddICYmIGl0ZW1bJ2RhdGEnXVsncGF0aCddKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXRlbVBhdGggPSBpdGVtWydkYXRhJ11bJ3BhdGgnXTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVtTGF5ZXIgPSBpdGVtWydkYXRhJ11bJ2xheWVyJ107XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHRhcmdldFBhdGg6IHN0cmluZztcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbVBhdGggJiYgaXRlbVBhdGgubGVuZ3RoID4gcGFyZW50UGF0aC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0UGF0aCA9IGl0ZW1QYXRoLnN1YnN0cigwLCBOdW1iZXIobGF5ZXIpICogNCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnRQYXRoID09PSB0YXJnZXRQYXRoICYmIHBhcmVudExheWVyID09PSBpdGVtTGF5ZXIgLSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudFsnY2hpbGRyZW4nXS5wdXNoKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50UGF0aCA9PT0gdGFyZ2V0UGF0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyZWVEYXRhKFtpdGVtXSwgdHJlZVNvdXJjZSwgTnVtYmVyKGxheWVyKSArIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyDmlLbol4/miJblj5bmtojmlLbol4/lvZPliY3oioLngrnlr7nlupTnmoTnu4Tnu4dcclxuICAgIHRvZ2dsZUZhdm9yaXRlcyhlOiBhbnksIGl0ZW06IGFueSkge1xyXG4gICAgICAgIHRoaXMuZmF2b3JpdGVzVG9vbC50b2dnbGVGYXZvcml0ZXMoZSwgaXRlbSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g55uR5ZCs57uE57uH5qCR5bGV5byA5LqL5Lu2XHJcbiAgICBsaXN0ZW5UcmVlRXhwYW5kKG9iajogYW55KSB7XHJcbiAgICAgICAgLy8gdG9kbyDliIblsYLliqDovb1cclxuICAgICAgICBpZiAodGhpcy5lbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nICYmIG9iai5jaGlsZHJlbi5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5nZXRPcmdhbml6YXRpb25CeVBhcmVudE5vZGUob2JqKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5YiG5bGC5Yqg6L295pe277yM6I635Y+W5LiL57qn57uE57uH5pWw5o2u5bm25Li65b2T5YmN57uE57uH5qCR5re75Yqg5a2Q6IqC54K5XHJcbiAgICBnZXRPcmdhbml6YXRpb25CeVBhcmVudE5vZGUocGFyZW50Tm9kZTogYW55KSB7XHJcbiAgICAgICAgY29uc3QgcGFyYW06IE9yZ1JlcXVlc3RQYXJhbSA9IHtcclxuICAgICAgICAgICAgYWJzT3JnVHlwZTogdGhpcy5hYnNPcmdUeXBlLFxyXG4gICAgICAgICAgICBwYXJlbnRJRDogcGFyZW50Tm9kZS5pZCxcclxuICAgICAgICAgICAgbm90R2V0U3RvcE9yZzogdGhpcy5ub3RHZXRTdG9wT3JnLFxyXG4gICAgICAgICAgICBnZXRDdXJVc2VyOiBmYWxzZSxcclxuICAgICAgICAgICAgZ2V0T3JnQWxsUGF0aDogdHJ1ZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5hcGlTZXJ2aWNlLmdldE9yZ2FuaXphdGlvbihwYXJhbSkuc3Vic2NyaWJlKChyZXM6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzICYmIHJlcy5kYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdEYXRhcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgcmVzLmRhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoQ29tbW9uVXRpbC5maW5kSW5kZXgoaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0sIHRoaXMucHJpbWFyeUZpZWxkLCB0aGlzLm9yaWdpbmFsVHJlZURhdGEpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNlbGVjdGFibGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9yaWdpbmFsVHJlZURhdGEucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlRmF2b3JpdGVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uaW5GYXZvcml0ZXMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoQ29tbW9uVXRpbC5maW5kSW5kZXgoaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0sIHRoaXMucHJpbWFyeUZpZWxkLCB0aGlzLmZhdm9yaXRlc0xpc3QpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5pbkZhdm9yaXRlcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIG5ld0RhdGFzLnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVzID0gdGhpcy5kZWFsRGF0YShuZXdEYXRhcyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUuYXBwZW5kQ2hpbGRyZW4obm9kZXMsIHBhcmVudE5vZGUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudGlja1NlbGVjdGlvbnMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOi/lOWbnuW3sue7j+ivpeiKgueCueaYr+WQpuWxleW8gOi/h1xyXG4gICAgcHJpdmF0ZSBub2RlRXhwYW5kZWQoaXRlbTogYW55LCBhcnI6IFRyZWVOb2RlW10sIGV4cGFuZGVkOiBib29sZWFuW10pOiB2b2lkIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoaXRlbS5kYXRhLmlkID09PSBhcnJbaV0uZGF0YS5pZCkge1xyXG4gICAgICAgICAgICAgICAgZXhwYW5kZWRbMF0gPSBhcnJbaV0uZXhwYW5kZWQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYXJyW2ldLmNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlRXhwYW5kZWQoaXRlbSwgYXJyW2ldLmNoaWxkcmVuLCBleHBhbmRlZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5bGV5byA6IqC54K5XHJcbiAgICBwcml2YXRlIGV4cGFuZFRyZWVOb2RlKHRyZWVEYXRhOiBhbnksIHBhdGg6IGFueVtdLCBsYXllcjogbnVtYmVyKSB7XHJcbiAgICAgICAgdHJlZURhdGEuZm9yRWFjaChub2RlID0+IHtcclxuICAgICAgICAgICAgaWYgKHBhdGguaW5jbHVkZXMobm9kZS5kYXRhLnBhdGgpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUuZXhwYW5kTm9kZShub2RlLmRhdGEuaWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChub2RlLmRhdGEubGF5ZXIgPCBsYXllciAmJiBub2RlLmNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5leHBhbmRUcmVlTm9kZShub2RlLmNoaWxkcmVuLCBwYXRoLCBsYXllcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbn1cclxuIl19