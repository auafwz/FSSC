/**
 * @fileoverview added by tsickle
 * Generated from: lib/bill-tracker/mxgraph-ext/BillCell.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { mxCell, mxEvent, mxEventObject } from "../../ref/mxgraph";
import { BpmnModelJsonHelper } from "@edp-aif/common-api";
import { BillTrackingSettings, JointQueryMode } from '@edp-bif/common-api';
import { FieldNameAndValue } from "../../entity/tracking/FieldNameAndValue";
import { Events } from "./Events";
export class BillCell extends mxCell {
    /**
     * @param {?} billDataInfo
     * @param {?} billInfo
     * @param {?} entry
     * @param {?=} geometry
     * @param {?=} style
     */
    constructor(billDataInfo, billInfo, entry, geometry, style) {
        super(null, geometry, style);
        this.THUMB_SCALE = 0.6;
        this.billDataInfo = billDataInfo;
        this.billInfo = billInfo;
        /** @type {?} */
        let bts = new BillTrackingSettings();
        if (billInfo && billInfo.billTrackingSettings) {
            bts.LoadFromJson(billInfo.billTrackingSettings);
        }
        this.entry = entry;
        // this.value = this.billDataInfo.caption || bts.billNodeName || this.billInfo.voName || this.billDataInfo.dataId || this.billDataInfo.summary;
    }
    /**
     * @return {?}
     */
    getCaption() {
        /** @type {?} */
        let label = null;
        /** @type {?} */
        let bts = new BillTrackingSettings();
        if (this.billInfo && this.billInfo.billTrackingSettings) {
            bts.LoadFromJson(this.billInfo.billTrackingSettings);
        }
        label = this.billDataInfo.caption || bts.billNodeName || this.billInfo.voName || this.billDataInfo.dataId || this.billDataInfo.summary;
        return label;
    }
    /**
     * @return {?}
     */
    buildHtmlTooltip() {
        /** @type {?} */
        const tooltipHtml = `\
            <span>${this.billDataInfo.dataId}</span>\
        `;
        return tooltipHtml;
    }
    /**
     * 样式类在graph组件中定义
     * @param {?} graph
     * @return {?}
     */
    buildHtmlLabel(graph) {
        return this.buildHtmlLabelByDOM(graph);
    }
    /**
     * 通过操纵dom元素方式创建html
     * @private
     * @param {?} graph
     * @return {?}
     */
    buildHtmlLabelByDOM(graph) {
        /** @type {?} */
        const scale = graph.view.scale;
        /** @type {?} */
        const state = graph.view.getState(this);
        /** @type {?} */
        const width = this.geometry.width;
        /** @type {?} */
        const height = this.geometry.height;
        /** @type {?} */
        let bts = new BillTrackingSettings();
        if (this.billInfo && this.billInfo.billTrackingSettings) {
            bts.LoadFromJson(this.billInfo.billTrackingSettings);
        }
        /** @type {?} */
        const title = this.billDataInfo.caption || bts.billNodeName || this.billInfo.voName || this.billDataInfo.dataId || this.billDataInfo.summary;
        /** @type {?} */
        const isEntry = this.entry;
        // 节点框架
        /** @type {?} */
        const divNodeRoot = document.createElement("div");
        divNodeRoot.classList.add("bif-cell-node");
        divNodeRoot.style.width = width + "px";
        divNodeRoot.style.height = height + "px";
        if (isEntry) {
            // 当前节点标识
            /** @type {?} */
            const divNodeCurrent = document.createElement("div");
            divNodeRoot.appendChild(divNodeCurrent);
            divNodeCurrent.classList.add("bif-cell-node-current");
            /** @type {?} */
            const spanCurrent = document.createElement("span");
            divNodeCurrent.appendChild(spanCurrent);
            spanCurrent.classList.add("bif-cell-node-current-text");
            spanCurrent.innerHTML = "当前";
        }
        // 当比例小到指定值后仅显示单据名
        if (scale < this.THUMB_SCALE) {
            // // 使用图片+标题
            // const divNodeThumb = document.createElement("div");
            // divNodeRoot.appendChild(divNodeThumb);
            // divNodeThumb.classList.add("bif-cell-node-thumb");
            // const divNodeThumbImg = document.createElement("div");
            // divNodeThumb.appendChild(divNodeThumbImg);
            // divNodeThumbImg.classList.add("bif-cell-node-thumb-img-container");
            // const img = document.createElement("img");
            // divNodeThumbImg.appendChild(img);
            // img.classList.add("bif-cell-node-thumb-img");
            // img.src = "/platform/runtime/common/web/@edp-bif/runtime-api/images/non-entry-bill.png";
            // const divNodeThumbTitle = document.createElement("div");
            // divNodeThumb.appendChild(divNodeThumbTitle);
            // divNodeThumbTitle.classList.add("bif-cell-node-thumb-title");
            // const divNodeThumbTitleText = document.createElement("div");
            // divNodeThumbTitle.appendChild(divNodeThumbTitleText);
            // divNodeThumbTitleText.classList.add("bif-cell-node-thumb-title-text");
            // divNodeThumbTitleText.innerHTML = title;
            // // 判断是否需添加点击事件
            // const jqm = this.billInfo.jointQueryMode;
            // const jqp: JointQueryParameters = JSON.parse(this.billInfo.jointQueryParameters);
            // if ((jqm == JointQueryMode.APP && jqp.funcId) || (jqm == JointQueryMode.URL && jqp.url)) {
            //     divNodeThumbTitleText.classList.add("bif-cell-node-title-link");
            //     mxEvent.addListener(divNodeThumbTitleText, "click", () => {
            //         graph.fireEvent(new mxEventObject(Events.CLICK_FIRST_SUMMARY, "cell", this));
            //         event.stopPropagation();
            //         return false;
            //     });
            // }
            // 使用标题
            // 节点标题
            /** @type {?} */
            const divNodeTitleOnly = document.createElement("div");
            divNodeRoot.appendChild(divNodeTitleOnly);
            divNodeTitleOnly.classList.add("bif-cell-node-title-only");
            /** @type {?} */
            const divNodeTitleOnlyText = document.createElement("div");
            divNodeTitleOnly.appendChild(divNodeTitleOnlyText);
            divNodeTitleOnlyText.classList.add("bif-cell-node-title-only-text");
            divNodeTitleOnlyText.innerHTML = title;
            // 判断是否需添加点击事件
            /** @type {?} */
            const jqm = this.billInfo.jointQueryMode;
            /** @type {?} */
            const jqp = JSON.parse(this.billInfo.jointQueryParameters);
            if ((jqm == JointQueryMode.APP && jqp.funcId) || (jqm == JointQueryMode.URL && jqp.url)) {
                divNodeTitleOnlyText.classList.add("bif-cell-node-title-link");
                mxEvent.addListener(divNodeTitleOnlyText, "click", (/**
                 * @return {?}
                 */
                () => {
                    graph.fireEvent(new mxEventObject(Events.CLICK_FIRST_SUMMARY, "cell", this));
                    event.stopPropagation();
                    return false;
                }));
            }
        }
        else {
            // 节点主内容
            /** @type {?} */
            const divNodeMain = document.createElement("div");
            divNodeRoot.appendChild(divNodeMain);
            divNodeMain.classList.add("bif-cell-node-main");
            // 节点标题
            /** @type {?} */
            const divNodeTitle = document.createElement("div");
            divNodeMain.appendChild(divNodeTitle);
            divNodeTitle.classList.add("bif-cell-node-title");
            /** @type {?} */
            const divNodeTitleText = document.createElement("div");
            divNodeTitle.appendChild(divNodeTitleText);
            divNodeTitleText.classList.add("bif-cell-node-title-text");
            divNodeTitleText.innerHTML = title;
            // 节点摘要
            /** @type {?} */
            const divNodeSummaryList = document.createElement("div");
            divNodeMain.appendChild(divNodeSummaryList);
            divNodeSummaryList.classList.add("bif-cell-node-summary-list");
            // 46是标题栏高度
            divNodeSummaryList.style.minHeight = (height - 46) + "px";
            try {
                /** @type {?} */
                const fieldNameAndValues = BpmnModelJsonHelper.FromJson(this.billDataInfo.summary, FieldNameAndValue);
                fieldNameAndValues && fieldNameAndValues.forEach((/**
                 * @param {?} fv
                 * @param {?} idx
                 * @return {?}
                 */
                (fv, idx) => {
                    /** @type {?} */
                    const divNodeSummary = document.createElement("div");
                    divNodeSummaryList.appendChild(divNodeSummary);
                    divNodeSummary.classList.add("bif-cell-node-summary");
                    /** @type {?} */
                    const divNodeSummaryCaption = document.createElement("div");
                    divNodeSummary.appendChild(divNodeSummaryCaption);
                    divNodeSummaryCaption.classList.add("bif-cell-node-summary-caption");
                    /** @type {?} */
                    const divNodeSummaryCaptionText = document.createElement("div");
                    divNodeSummaryCaption.appendChild(divNodeSummaryCaptionText);
                    divNodeSummaryCaptionText.classList.add("bif-cell-node-summary-caption-text");
                    divNodeSummaryCaptionText.title = fv.name;
                    divNodeSummaryCaptionText.innerHTML = fv.name;
                    /** @type {?} */
                    const divNodeSummaryValue = document.createElement("div");
                    divNodeSummary.appendChild(divNodeSummaryValue);
                    divNodeSummaryValue.classList.add("bif-cell-node-summary-value");
                    /** @type {?} */
                    const divNodeSummaryValueText = document.createElement("div");
                    divNodeSummaryValue.appendChild(divNodeSummaryValueText);
                    divNodeSummaryValueText.classList.add("bif-cell-node-summary-value-text");
                    divNodeSummaryValueText.title = fv.value;
                    divNodeSummaryValueText.innerText = fv.value;
                    if (idx == 0) {
                        // 判断是否需添加点击事件
                        /** @type {?} */
                        const jqm = this.billInfo.jointQueryMode;
                        /** @type {?} */
                        const jqp = JSON.parse(this.billInfo.jointQueryParameters);
                        if ((jqm == JointQueryMode.APP && jqp.funcId) || (jqm == JointQueryMode.URL && jqp.url)) {
                            divNodeSummaryValueText.classList.add("bif-cell-node-title-link", "bif-cell-node-title-link-color");
                            mxEvent.addListener(divNodeSummaryValueText, "click", (/**
                             * @return {?}
                             */
                            () => {
                                graph.fireEvent(new mxEventObject(Events.CLICK_FIRST_SUMMARY, "cell", this));
                                event.stopPropagation();
                                return false;
                            }));
                        }
                    }
                }));
            }
            catch (e) {
                console.error(e);
            }
        }
        return divNodeRoot;
    }
    /**
     * 通过模板字符串方式创建html
     * @private
     * @param {?} graph
     * @return {?}
     */
    buildHtmlLabelByTemplateText(graph) {
        /** @type {?} */
        const state = graph.view.getState(this);
        /** @type {?} */
        const width = state && state.width ? state.width : this.geometry.width;
        /** @type {?} */
        const height = state && state.height ? state.height : this.geometry.height;
        /** @type {?} */
        let bts = new BillTrackingSettings();
        if (this.billInfo && this.billInfo.billTrackingSettings) {
            bts.LoadFromJson(this.billInfo.billTrackingSettings);
        }
        /** @type {?} */
        const title = this.billDataInfo.caption || bts.billNodeName || this.billInfo.voName || this.billDataInfo.dataId || this.billDataInfo.summary;
        /** @type {?} */
        const titleBackground = this.entry ? "rgba(86,160,255,0.08)" : "#FFFFFF";
        /** @type {?} */
        let summaryHtml = "";
        try {
            /** @type {?} */
            const fieldNameAndValues = BpmnModelJsonHelper.FromJson(this.billDataInfo.summary, FieldNameAndValue);
            fieldNameAndValues && fieldNameAndValues.forEach((/**
             * @param {?} fv
             * @param {?} idx
             * @return {?}
             */
            (fv, idx) => {
                /** @type {?} */
                let valueText = idx == 0 ? `<a href='javascript:void(0);'>${fv.value}</a>` : fv.value;
                summaryHtml += `\
                        <div class="bif-cell-node-summary">\
                            <div class="bif-cell-node-summary-caption">\
                                <div class="bif-cell-node-summary-caption-text" title="${fv.name}">${fv.name}</div>\
                            </div>\
                            <div class="bif-cell-node-summary-value">\
                                <div class="bif-cell-node-summary-value-text" title="${fv.value}">${valueText}</div>\
                            </div>\
                        </div>\
                    `;
            }));
        }
        catch (e) {
            console.error(e);
        }
        /** @type {?} */
        const html = `\
            <div class="bif-cell-node" style="width:${width}px;">\
                <div class="bif-cell-node-main" style="background: ${titleBackground};">\
                    <div class="bif-cell-node-title">\
                        <div class="bif-cell-node-title-text">${title}</div>\
                    </div>\
                    <div class="bif-cell-node-summary-list" style="min-height: ${height - 30}px;">\
                        ${summaryHtml}\
                    </div>\
                </div>\
            </div>\
        `;
        return html;
    }
}
if (false) {
    /** @type {?} */
    BillCell.prototype.THUMB_SCALE;
    /** @type {?} */
    BillCell.prototype.entry;
    /** @type {?} */
    BillCell.prototype.data;
    /** @type {?} */
    BillCell.prototype.billDataInfo;
    /** @type {?} */
    BillCell.prototype.billInfo;
    /** @type {?} */
    BillCell.prototype.downCellOverlay;
    /** @type {?} */
    BillCell.prototype.upCellOverlay;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQmlsbENlbGwuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZWRwLWJpZi9ydW50aW1lLWFwaS8iLCJzb3VyY2VzIjpbImxpYi9iaWxsLXRyYWNrZXIvbXhncmFwaC1leHQvQmlsbENlbGwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxhQUFhLEVBQWEsTUFBTSxtQkFBbUIsQ0FBQztBQUs5RSxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUMxRCxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsY0FBYyxFQUF3QixNQUFNLHFCQUFxQixDQUFDO0FBRWpHLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHlDQUF5QyxDQUFDO0FBRTVFLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFFbEMsTUFBTSxPQUFPLFFBQVMsU0FBUSxNQUFNOzs7Ozs7OztJQVNoQyxZQUFZLFlBQTBCLEVBQUUsUUFBK0MsRUFBRSxLQUFjLEVBQUUsUUFBUyxFQUFFLEtBQU07UUFDdEgsS0FBSyxDQUFDLElBQUksRUFBRSxRQUFRLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFUeEIsZ0JBQVcsR0FBVyxHQUFHLENBQUM7UUFXL0IsSUFBSSxDQUFDLFlBQVksR0FBRyxZQUFZLENBQUM7UUFDakMsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7O1lBQ3JCLEdBQUcsR0FBeUIsSUFBSSxvQkFBb0IsRUFBRTtRQUMxRCxJQUFJLFFBQVEsSUFBSSxRQUFRLENBQUMsb0JBQW9CLEVBQUU7WUFDM0MsR0FBRyxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUMsb0JBQW9CLENBQUMsQ0FBQztTQUNuRDtRQUNELElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO1FBQ25CLCtJQUErSTtJQUNuSixDQUFDOzs7O0lBRUQsVUFBVTs7WUFDRixLQUFLLEdBQVcsSUFBSTs7WUFDcEIsR0FBRyxHQUF5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RUFBRTtZQUNSLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDcEI7O2NBQ0ssSUFBSSxHQUFHO3NEQUNpQyxLQUFLO3FFQUNVLGVBQWU7O2dFQUVwQixLQUFLOztpRkFFWSxNQUFNLEdBQUcsRUFBRTswQkFDbEUsV0FBVzs7OztTQUk1QjtRQUNELE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7Q0FDSjs7O0lBelFHLCtCQUFtQzs7SUFFbkMseUJBQWU7O0lBQ2Ysd0JBQWU7O0lBQ2YsZ0NBQTJCOztJQUMzQiw0QkFBZ0Q7O0lBQ2hELG1DQUE2Qjs7SUFDN0IsaUNBQTJCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgbXhDZWxsLCBteEV2ZW50LCBteEV2ZW50T2JqZWN0LCBNeEdyYXBoTlMgfSBmcm9tIFwiLi4vLi4vcmVmL214Z3JhcGhcIjtcclxuaW1wb3J0IHsgQmlsbERhdGFJbmZvIH0gZnJvbSAnLi4vLi4vZW50aXR5L3RyYWNraW5nL0JpbGxEYXRhSW5mbyc7XHJcbmltcG9ydCB7IERvd25CaWxsSW5mb1Jlc3VsdCB9IGZyb20gJy4uL2FyZ3MvRG93bkJpbGxJbmZvUmVzdWx0JztcclxuaW1wb3J0IHsgVXBCaWxsSW5mb1Jlc3VsdCB9IGZyb20gJy4uL2FyZ3MvVXBCaWxsSW5mb1Jlc3VsdCc7XHJcbmltcG9ydCB7IENlbGxEYXRhIH0gZnJvbSAnLi4vLi4vZW50aXR5L3RyYWNraW5nL2NlbGwtZGF0YS9DZWxsRGF0YSc7XHJcbmltcG9ydCB7IEJwbW5Nb2RlbEpzb25IZWxwZXIgfSBmcm9tIFwiQGVkcC1haWYvY29tbW9uLWFwaVwiO1xyXG5pbXBvcnQgeyBCaWxsVHJhY2tpbmdTZXR0aW5ncywgSm9pbnRRdWVyeU1vZGUsIEpvaW50UXVlcnlQYXJhbWV0ZXJzIH0gZnJvbSAnQGVkcC1iaWYvY29tbW9uLWFwaSc7XHJcbmltcG9ydCB7IEdyYXBoIH0gZnJvbSBcIi4vR3JhcGhcIjtcclxuaW1wb3J0IHsgRmllbGROYW1lQW5kVmFsdWUgfSBmcm9tIFwiLi4vLi4vZW50aXR5L3RyYWNraW5nL0ZpZWxkTmFtZUFuZFZhbHVlXCI7XHJcbmltcG9ydCB7IENlbGxPdmVybGF5IH0gZnJvbSBcIi4vQ2VsbE92ZXJsYXlcIjtcclxuaW1wb3J0IHsgRXZlbnRzIH0gZnJvbSBcIi4vRXZlbnRzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgQmlsbENlbGwgZXh0ZW5kcyBteENlbGwge1xyXG4gICAgcmVhZG9ubHkgVEhVTUJfU0NBTEU6IG51bWJlciA9IDAuNjtcclxuXHJcbiAgICBlbnRyeTogYm9vbGVhbjtcclxuICAgIGRhdGE6IENlbGxEYXRhO1xyXG4gICAgYmlsbERhdGFJbmZvOiBCaWxsRGF0YUluZm87XHJcbiAgICBiaWxsSW5mbzogRG93bkJpbGxJbmZvUmVzdWx0IHwgVXBCaWxsSW5mb1Jlc3VsdDtcclxuICAgIGRvd25DZWxsT3ZlcmxheTogQ2VsbE92ZXJsYXk7XHJcbiAgICB1cENlbGxPdmVybGF5OiBDZWxsT3ZlcmxheTtcclxuICAgIGNvbnN0cnVjdG9yKGJpbGxEYXRhSW5mbzogQmlsbERhdGFJbmZvLCBiaWxsSW5mbzogRG93bkJpbGxJbmZvUmVzdWx0IHwgVXBCaWxsSW5mb1Jlc3VsdCwgZW50cnk6IGJvb2xlYW4sIGdlb21ldHJ5Pywgc3R5bGU/KSB7XHJcbiAgICAgICAgc3VwZXIobnVsbCwgZ2VvbWV0cnksIHN0eWxlKTtcclxuXHJcbiAgICAgICAgdGhpcy5iaWxsRGF0YUluZm8gPSBiaWxsRGF0YUluZm87XHJcbiAgICAgICAgdGhpcy5iaWxsSW5mbyA9IGJpbGxJbmZvO1xyXG4gICAgICAgIGxldCBidHM6IEJpbGxUcmFja2luZ1NldHRpbmdzID0gbmV3IEJpbGxUcmFja2luZ1NldHRpbmdzKCk7XHJcbiAgICAgICAgaWYgKGJpbGxJbmZvICYmIGJpbGxJbmZvLmJpbGxUcmFja2luZ1NldHRpbmdzKSB7XHJcbiAgICAgICAgICAgIGJ0cy5Mb2FkRnJvbUpzb24oYmlsbEluZm8uYmlsbFRyYWNraW5nU2V0dGluZ3MpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmVudHJ5ID0gZW50cnk7XHJcbiAgICAgICAgLy8gdGhpcy52YWx1ZSA9IHRoaXMuYmlsbERhdGFJbmZvLmNhcHRpb24gfHwgYnRzLmJpbGxOb2RlTmFtZSB8fCB0aGlzLmJpbGxJbmZvLnZvTmFtZSB8fCB0aGlzLmJpbGxEYXRhSW5mby5kYXRhSWQgfHwgdGhpcy5iaWxsRGF0YUluZm8uc3VtbWFyeTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRDYXB0aW9uKCkge1xyXG4gICAgICAgIGxldCBsYWJlbDogc3RyaW5nID0gbnVsbDtcclxuICAgICAgICBsZXQgYnRzOiBCaWxsVHJhY2tpbmdTZXR0aW5ncyA9IG5ldyBCaWxsVHJhY2tpbmdTZXR0aW5ncygpO1xyXG4gICAgICAgIGlmICh0aGlzLmJpbGxJbmZvICYmIHRoaXMuYmlsbEluZm8uYmlsbFRyYWNraW5nU2V0dGluZ3MpIHtcclxuICAgICAgICAgICAgYnRzLkxvYWRGcm9tSnNvbih0aGlzLmJpbGxJbmZvLmJpbGxUcmFja2luZ1NldHRpbmdzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGFiZWwgPSB0aGlzLmJpbGxEYXRhSW5mby5jYXB0aW9uIHx8IGJ0cy5iaWxsTm9kZU5hbWUgfHwgdGhpcy5iaWxsSW5mby52b05hbWUgfHwgdGhpcy5iaWxsRGF0YUluZm8uZGF0YUlkIHx8IHRoaXMuYmlsbERhdGFJbmZvLnN1bW1hcnk7XHJcbiAgICAgICAgcmV0dXJuIGxhYmVsO1xyXG4gICAgfVxyXG5cclxuICAgIGJ1aWxkSHRtbFRvb2x0aXAoKTogc3RyaW5nIHtcclxuICAgICAgICBjb25zdCB0b29sdGlwSHRtbCA9IGBcXFxyXG4gICAgICAgICAgICA8c3Bhbj4ke3RoaXMuYmlsbERhdGFJbmZvLmRhdGFJZH08L3NwYW4+XFxcclxuICAgICAgICBgO1xyXG4gICAgICAgIHJldHVybiB0b29sdGlwSHRtbDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOagt+W8j+exu+WcqGdyYXBo57uE5Lu25Lit5a6a5LmJXHJcbiAgICAgKiBAcGFyYW0gZ3JhcGggXHJcbiAgICAgKiBAcmV0dXJucyBcclxuICAgICAqL1xyXG4gICAgYnVpbGRIdG1sTGFiZWwoZ3JhcGg6IEdyYXBoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYnVpbGRIdG1sTGFiZWxCeURPTShncmFwaCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDpgJrov4fmk43nurVkb23lhYPntKDmlrnlvI/liJvlu7podG1sXHJcbiAgICAgKiBAcGFyYW0gZ3JhcGggXHJcbiAgICAgKiBAcmV0dXJucyBcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBidWlsZEh0bWxMYWJlbEJ5RE9NKGdyYXBoOiBHcmFwaCkge1xyXG4gICAgICAgIGNvbnN0IHNjYWxlID0gZ3JhcGgudmlldy5zY2FsZTtcclxuICAgICAgICBjb25zdCBzdGF0ZSA9IGdyYXBoLnZpZXcuZ2V0U3RhdGUodGhpcyk7XHJcbiAgICAgICAgY29uc3Qgd2lkdGggPSB0aGlzLmdlb21ldHJ5LndpZHRoO1xyXG4gICAgICAgIGNvbnN0IGhlaWdodCA9IHRoaXMuZ2VvbWV0cnkuaGVpZ2h0O1xyXG4gICAgICAgIGxldCBidHM6IEJpbGxUcmFja2luZ1NldHRpbmdzID0gbmV3IEJpbGxUcmFja2luZ1NldHRpbmdzKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuYmlsbEluZm8gJiYgdGhpcy5iaWxsSW5mby5iaWxsVHJhY2tpbmdTZXR0aW5ncykge1xyXG4gICAgICAgICAgICBidHMuTG9hZEZyb21Kc29uKHRoaXMuYmlsbEluZm8uYmlsbFRyYWNraW5nU2V0dGluZ3MpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB0aXRsZSA9IHRoaXMuYmlsbERhdGFJbmZvLmNhcHRpb24gfHwgYnRzLmJpbGxOb2RlTmFtZSB8fCB0aGlzLmJpbGxJbmZvLnZvTmFtZSB8fCB0aGlzLmJpbGxEYXRhSW5mby5kYXRhSWQgfHwgdGhpcy5iaWxsRGF0YUluZm8uc3VtbWFyeTtcclxuICAgICAgICBjb25zdCBpc0VudHJ5ID0gdGhpcy5lbnRyeTtcclxuXHJcbiAgICAgICAgLy8g6IqC54K55qGG5p62XHJcbiAgICAgICAgY29uc3QgZGl2Tm9kZVJvb3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIGRpdk5vZGVSb290LmNsYXNzTGlzdC5hZGQoXCJiaWYtY2VsbC1ub2RlXCIpO1xyXG4gICAgICAgIGRpdk5vZGVSb290LnN0eWxlLndpZHRoID0gd2lkdGggKyBcInB4XCI7XHJcbiAgICAgICAgZGl2Tm9kZVJvb3Quc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgXCJweFwiO1xyXG5cclxuICAgICAgICBpZiAoaXNFbnRyeSkge1xyXG4gICAgICAgICAgICAvLyDlvZPliY3oioLngrnmoIfor4ZcclxuICAgICAgICAgICAgY29uc3QgZGl2Tm9kZUN1cnJlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAgICBkaXZOb2RlUm9vdC5hcHBlbmRDaGlsZChkaXZOb2RlQ3VycmVudCk7XHJcbiAgICAgICAgICAgIGRpdk5vZGVDdXJyZW50LmNsYXNzTGlzdC5hZGQoXCJiaWYtY2VsbC1ub2RlLWN1cnJlbnRcIik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzcGFuQ3VycmVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xyXG4gICAgICAgICAgICBkaXZOb2RlQ3VycmVudC5hcHBlbmRDaGlsZChzcGFuQ3VycmVudCk7XHJcbiAgICAgICAgICAgIHNwYW5DdXJyZW50LmNsYXNzTGlzdC5hZGQoXCJiaWYtY2VsbC1ub2RlLWN1cnJlbnQtdGV4dFwiKTtcclxuICAgICAgICAgICAgc3BhbkN1cnJlbnQuaW5uZXJIVE1MID0gXCLlvZPliY1cIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIOW9k+avlOS+i+Wwj+WIsOaMh+WumuWAvOWQjuS7heaYvuekuuWNleaNruWQjVxyXG4gICAgICAgIGlmIChzY2FsZSA8IHRoaXMuVEhVTUJfU0NBTEUpIHtcclxuICAgICAgICAgICAgLy8gLy8g5L2/55So5Zu+54mHK+agh+mimFxyXG4gICAgICAgICAgICAvLyBjb25zdCBkaXZOb2RlVGh1bWIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAgICAvLyBkaXZOb2RlUm9vdC5hcHBlbmRDaGlsZChkaXZOb2RlVGh1bWIpO1xyXG4gICAgICAgICAgICAvLyBkaXZOb2RlVGh1bWIuY2xhc3NMaXN0LmFkZChcImJpZi1jZWxsLW5vZGUtdGh1bWJcIik7XHJcblxyXG4gICAgICAgICAgICAvLyBjb25zdCBkaXZOb2RlVGh1bWJJbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAgICAvLyBkaXZOb2RlVGh1bWIuYXBwZW5kQ2hpbGQoZGl2Tm9kZVRodW1iSW1nKTtcclxuICAgICAgICAgICAgLy8gZGl2Tm9kZVRodW1iSW1nLmNsYXNzTGlzdC5hZGQoXCJiaWYtY2VsbC1ub2RlLXRodW1iLWltZy1jb250YWluZXJcIik7XHJcblxyXG4gICAgICAgICAgICAvLyBjb25zdCBpbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xyXG4gICAgICAgICAgICAvLyBkaXZOb2RlVGh1bWJJbWcuYXBwZW5kQ2hpbGQoaW1nKTtcclxuICAgICAgICAgICAgLy8gaW1nLmNsYXNzTGlzdC5hZGQoXCJiaWYtY2VsbC1ub2RlLXRodW1iLWltZ1wiKTtcclxuICAgICAgICAgICAgLy8gaW1nLnNyYyA9IFwiL3BsYXRmb3JtL3J1bnRpbWUvY29tbW9uL3dlYi9AZWRwLWJpZi9ydW50aW1lLWFwaS9pbWFnZXMvbm9uLWVudHJ5LWJpbGwucG5nXCI7XHJcblxyXG4gICAgICAgICAgICAvLyBjb25zdCBkaXZOb2RlVGh1bWJUaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICAgIC8vIGRpdk5vZGVUaHVtYi5hcHBlbmRDaGlsZChkaXZOb2RlVGh1bWJUaXRsZSk7XHJcbiAgICAgICAgICAgIC8vIGRpdk5vZGVUaHVtYlRpdGxlLmNsYXNzTGlzdC5hZGQoXCJiaWYtY2VsbC1ub2RlLXRodW1iLXRpdGxlXCIpO1xyXG5cclxuICAgICAgICAgICAgLy8gY29uc3QgZGl2Tm9kZVRodW1iVGl0bGVUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICAgICAgLy8gZGl2Tm9kZVRodW1iVGl0bGUuYXBwZW5kQ2hpbGQoZGl2Tm9kZVRodW1iVGl0bGVUZXh0KTtcclxuICAgICAgICAgICAgLy8gZGl2Tm9kZVRodW1iVGl0bGVUZXh0LmNsYXNzTGlzdC5hZGQoXCJiaWYtY2VsbC1ub2RlLXRodW1iLXRpdGxlLXRleHRcIik7XHJcbiAgICAgICAgICAgIC8vIGRpdk5vZGVUaHVtYlRpdGxlVGV4dC5pbm5lckhUTUwgPSB0aXRsZTtcclxuXHJcbiAgICAgICAgICAgIC8vIC8vIOWIpOaWreaYr+WQpumcgOa3u+WKoOeCueWHu+S6i+S7tlxyXG4gICAgICAgICAgICAvLyBjb25zdCBqcW0gPSB0aGlzLmJpbGxJbmZvLmpvaW50UXVlcnlNb2RlO1xyXG4gICAgICAgICAgICAvLyBjb25zdCBqcXA6IEpvaW50UXVlcnlQYXJhbWV0ZXJzID0gSlNPTi5wYXJzZSh0aGlzLmJpbGxJbmZvLmpvaW50UXVlcnlQYXJhbWV0ZXJzKTtcclxuICAgICAgICAgICAgLy8gaWYgKChqcW0gPT0gSm9pbnRRdWVyeU1vZGUuQVBQICYmIGpxcC5mdW5jSWQpIHx8IChqcW0gPT0gSm9pbnRRdWVyeU1vZGUuVVJMICYmIGpxcC51cmwpKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBkaXZOb2RlVGh1bWJUaXRsZVRleHQuY2xhc3NMaXN0LmFkZChcImJpZi1jZWxsLW5vZGUtdGl0bGUtbGlua1wiKTtcclxuICAgICAgICAgICAgLy8gICAgIG14RXZlbnQuYWRkTGlzdGVuZXIoZGl2Tm9kZVRodW1iVGl0bGVUZXh0LCBcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAgICAgLy8gICAgICAgICBncmFwaC5maXJlRXZlbnQobmV3IG14RXZlbnRPYmplY3QoRXZlbnRzLkNMSUNLX0ZJUlNUX1NVTU1BUlksIFwiY2VsbFwiLCB0aGlzKSk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAvLyAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgICAgIC8vIOS9v+eUqOagh+mimFxyXG4gICAgICAgICAgICAvLyDoioLngrnmoIfpophcclxuICAgICAgICAgICAgY29uc3QgZGl2Tm9kZVRpdGxlT25seSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICAgIGRpdk5vZGVSb290LmFwcGVuZENoaWxkKGRpdk5vZGVUaXRsZU9ubHkpO1xyXG4gICAgICAgICAgICBkaXZOb2RlVGl0bGVPbmx5LmNsYXNzTGlzdC5hZGQoXCJiaWYtY2VsbC1ub2RlLXRpdGxlLW9ubHlcIik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBkaXZOb2RlVGl0bGVPbmx5VGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICAgIGRpdk5vZGVUaXRsZU9ubHkuYXBwZW5kQ2hpbGQoZGl2Tm9kZVRpdGxlT25seVRleHQpO1xyXG4gICAgICAgICAgICBkaXZOb2RlVGl0bGVPbmx5VGV4dC5jbGFzc0xpc3QuYWRkKFwiYmlmLWNlbGwtbm9kZS10aXRsZS1vbmx5LXRleHRcIik7XHJcbiAgICAgICAgICAgIGRpdk5vZGVUaXRsZU9ubHlUZXh0LmlubmVySFRNTCA9IHRpdGxlO1xyXG5cclxuICAgICAgICAgICAgLy8g5Yik5pat5piv5ZCm6ZyA5re75Yqg54K55Ye75LqL5Lu2XHJcbiAgICAgICAgICAgIGNvbnN0IGpxbSA9IHRoaXMuYmlsbEluZm8uam9pbnRRdWVyeU1vZGU7XHJcbiAgICAgICAgICAgIGNvbnN0IGpxcDogSm9pbnRRdWVyeVBhcmFtZXRlcnMgPSBKU09OLnBhcnNlKHRoaXMuYmlsbEluZm8uam9pbnRRdWVyeVBhcmFtZXRlcnMpO1xyXG4gICAgICAgICAgICBpZiAoKGpxbSA9PSBKb2ludFF1ZXJ5TW9kZS5BUFAgJiYganFwLmZ1bmNJZCkgfHwgKGpxbSA9PSBKb2ludFF1ZXJ5TW9kZS5VUkwgJiYganFwLnVybCkpIHtcclxuICAgICAgICAgICAgICAgIGRpdk5vZGVUaXRsZU9ubHlUZXh0LmNsYXNzTGlzdC5hZGQoXCJiaWYtY2VsbC1ub2RlLXRpdGxlLWxpbmtcIik7XHJcbiAgICAgICAgICAgICAgICBteEV2ZW50LmFkZExpc3RlbmVyKGRpdk5vZGVUaXRsZU9ubHlUZXh0LCBcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBncmFwaC5maXJlRXZlbnQobmV3IG14RXZlbnRPYmplY3QoRXZlbnRzLkNMSUNLX0ZJUlNUX1NVTU1BUlksIFwiY2VsbFwiLCB0aGlzKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyDoioLngrnkuLvlhoXlrrlcclxuICAgICAgICAgICAgY29uc3QgZGl2Tm9kZU1haW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAgICBkaXZOb2RlUm9vdC5hcHBlbmRDaGlsZChkaXZOb2RlTWFpbik7XHJcbiAgICAgICAgICAgIGRpdk5vZGVNYWluLmNsYXNzTGlzdC5hZGQoXCJiaWYtY2VsbC1ub2RlLW1haW5cIik7XHJcblxyXG4gICAgICAgICAgICAvLyDoioLngrnmoIfpophcclxuICAgICAgICAgICAgY29uc3QgZGl2Tm9kZVRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICAgICAgZGl2Tm9kZU1haW4uYXBwZW5kQ2hpbGQoZGl2Tm9kZVRpdGxlKTtcclxuICAgICAgICAgICAgZGl2Tm9kZVRpdGxlLmNsYXNzTGlzdC5hZGQoXCJiaWYtY2VsbC1ub2RlLXRpdGxlXCIpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZGl2Tm9kZVRpdGxlVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICAgIGRpdk5vZGVUaXRsZS5hcHBlbmRDaGlsZChkaXZOb2RlVGl0bGVUZXh0KTtcclxuICAgICAgICAgICAgZGl2Tm9kZVRpdGxlVGV4dC5jbGFzc0xpc3QuYWRkKFwiYmlmLWNlbGwtbm9kZS10aXRsZS10ZXh0XCIpO1xyXG4gICAgICAgICAgICBkaXZOb2RlVGl0bGVUZXh0LmlubmVySFRNTCA9IHRpdGxlO1xyXG5cclxuICAgICAgICAgICAgLy8g6IqC54K55pGY6KaBXHJcbiAgICAgICAgICAgIGNvbnN0IGRpdk5vZGVTdW1tYXJ5TGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICAgIGRpdk5vZGVNYWluLmFwcGVuZENoaWxkKGRpdk5vZGVTdW1tYXJ5TGlzdCk7XHJcbiAgICAgICAgICAgIGRpdk5vZGVTdW1tYXJ5TGlzdC5jbGFzc0xpc3QuYWRkKFwiYmlmLWNlbGwtbm9kZS1zdW1tYXJ5LWxpc3RcIik7XHJcbiAgICAgICAgICAgIC8vIDQ25piv5qCH6aKY5qCP6auY5bqmXHJcbiAgICAgICAgICAgIGRpdk5vZGVTdW1tYXJ5TGlzdC5zdHlsZS5taW5IZWlnaHQgPSAoaGVpZ2h0IC0gNDYpICsgXCJweFwiO1xyXG5cclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTmFtZUFuZFZhbHVlczogRmllbGROYW1lQW5kVmFsdWVbXSA9IEJwbW5Nb2RlbEpzb25IZWxwZXIuRnJvbUpzb24odGhpcy5iaWxsRGF0YUluZm8uc3VtbWFyeSwgRmllbGROYW1lQW5kVmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgZmllbGROYW1lQW5kVmFsdWVzICYmIGZpZWxkTmFtZUFuZFZhbHVlcy5mb3JFYWNoKFxyXG4gICAgICAgICAgICAgICAgICAgIChmdiwgaWR4KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRpdk5vZGVTdW1tYXJ5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGl2Tm9kZVN1bW1hcnlMaXN0LmFwcGVuZENoaWxkKGRpdk5vZGVTdW1tYXJ5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGl2Tm9kZVN1bW1hcnkuY2xhc3NMaXN0LmFkZChcImJpZi1jZWxsLW5vZGUtc3VtbWFyeVwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRpdk5vZGVTdW1tYXJ5Q2FwdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpdk5vZGVTdW1tYXJ5LmFwcGVuZENoaWxkKGRpdk5vZGVTdW1tYXJ5Q2FwdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpdk5vZGVTdW1tYXJ5Q2FwdGlvbi5jbGFzc0xpc3QuYWRkKFwiYmlmLWNlbGwtbm9kZS1zdW1tYXJ5LWNhcHRpb25cIik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkaXZOb2RlU3VtbWFyeUNhcHRpb25UZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGl2Tm9kZVN1bW1hcnlDYXB0aW9uLmFwcGVuZENoaWxkKGRpdk5vZGVTdW1tYXJ5Q2FwdGlvblRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXZOb2RlU3VtbWFyeUNhcHRpb25UZXh0LmNsYXNzTGlzdC5hZGQoXCJiaWYtY2VsbC1ub2RlLXN1bW1hcnktY2FwdGlvbi10ZXh0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXZOb2RlU3VtbWFyeUNhcHRpb25UZXh0LnRpdGxlID0gZnYubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGl2Tm9kZVN1bW1hcnlDYXB0aW9uVGV4dC5pbm5lckhUTUwgPSBmdi5uYW1lO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGl2Tm9kZVN1bW1hcnlWYWx1ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpdk5vZGVTdW1tYXJ5LmFwcGVuZENoaWxkKGRpdk5vZGVTdW1tYXJ5VmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXZOb2RlU3VtbWFyeVZhbHVlLmNsYXNzTGlzdC5hZGQoXCJiaWYtY2VsbC1ub2RlLXN1bW1hcnktdmFsdWVcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkaXZOb2RlU3VtbWFyeVZhbHVlVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpdk5vZGVTdW1tYXJ5VmFsdWUuYXBwZW5kQ2hpbGQoZGl2Tm9kZVN1bW1hcnlWYWx1ZVRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXZOb2RlU3VtbWFyeVZhbHVlVGV4dC5jbGFzc0xpc3QuYWRkKFwiYmlmLWNlbGwtbm9kZS1zdW1tYXJ5LXZhbHVlLXRleHRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpdk5vZGVTdW1tYXJ5VmFsdWVUZXh0LnRpdGxlID0gZnYudmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpdk5vZGVTdW1tYXJ5VmFsdWVUZXh0LmlubmVyVGV4dCA9IGZ2LnZhbHVlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkeCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDliKTmlq3mmK/lkKbpnIDmt7vliqDngrnlh7vkuovku7ZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGpxbSA9IHRoaXMuYmlsbEluZm8uam9pbnRRdWVyeU1vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBqcXA6IEpvaW50UXVlcnlQYXJhbWV0ZXJzID0gSlNPTi5wYXJzZSh0aGlzLmJpbGxJbmZvLmpvaW50UXVlcnlQYXJhbWV0ZXJzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoanFtID09IEpvaW50UXVlcnlNb2RlLkFQUCAmJiBqcXAuZnVuY0lkKSB8fCAoanFtID09IEpvaW50UXVlcnlNb2RlLlVSTCAmJiBqcXAudXJsKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpdk5vZGVTdW1tYXJ5VmFsdWVUZXh0LmNsYXNzTGlzdC5hZGQoXCJiaWYtY2VsbC1ub2RlLXRpdGxlLWxpbmtcIiwgXCJiaWYtY2VsbC1ub2RlLXRpdGxlLWxpbmstY29sb3JcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXhFdmVudC5hZGRMaXN0ZW5lcihkaXZOb2RlU3VtbWFyeVZhbHVlVGV4dCwgXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyYXBoLmZpcmVFdmVudChuZXcgbXhFdmVudE9iamVjdChFdmVudHMuQ0xJQ0tfRklSU1RfU1VNTUFSWSwgXCJjZWxsXCIsIHRoaXMpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRpdk5vZGVSb290O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6YCa6L+H5qih5p2/5a2X56ym5Liy5pa55byP5Yib5bu6aHRtbFxyXG4gICAgICogQHBhcmFtIGdyYXBoIFxyXG4gICAgICogQHJldHVybnMgXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgYnVpbGRIdG1sTGFiZWxCeVRlbXBsYXRlVGV4dChncmFwaDogR3JhcGgpIHtcclxuICAgICAgICBjb25zdCBzdGF0ZSA9IGdyYXBoLnZpZXcuZ2V0U3RhdGUodGhpcyk7XHJcbiAgICAgICAgY29uc3Qgd2lkdGggPSBzdGF0ZSAmJiBzdGF0ZS53aWR0aCA/IHN0YXRlLndpZHRoIDogdGhpcy5nZW9tZXRyeS53aWR0aDtcclxuICAgICAgICBjb25zdCBoZWlnaHQgPSBzdGF0ZSAmJiBzdGF0ZS5oZWlnaHQgPyBzdGF0ZS5oZWlnaHQgOiB0aGlzLmdlb21ldHJ5LmhlaWdodDtcclxuICAgICAgICBsZXQgYnRzOiBCaWxsVHJhY2tpbmdTZXR0aW5ncyA9IG5ldyBCaWxsVHJhY2tpbmdTZXR0aW5ncygpO1xyXG4gICAgICAgIGlmICh0aGlzLmJpbGxJbmZvICYmIHRoaXMuYmlsbEluZm8uYmlsbFRyYWNraW5nU2V0dGluZ3MpIHtcclxuICAgICAgICAgICAgYnRzLkxvYWRGcm9tSnNvbih0aGlzLmJpbGxJbmZvLmJpbGxUcmFja2luZ1NldHRpbmdzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgdGl0bGUgPSB0aGlzLmJpbGxEYXRhSW5mby5jYXB0aW9uIHx8IGJ0cy5iaWxsTm9kZU5hbWUgfHwgdGhpcy5iaWxsSW5mby52b05hbWUgfHwgdGhpcy5iaWxsRGF0YUluZm8uZGF0YUlkIHx8IHRoaXMuYmlsbERhdGFJbmZvLnN1bW1hcnk7XHJcbiAgICAgICAgY29uc3QgdGl0bGVCYWNrZ3JvdW5kID0gdGhpcy5lbnRyeSA/IFwicmdiYSg4NiwxNjAsMjU1LDAuMDgpXCIgOiBcIiNGRkZGRkZcIjtcclxuXHJcbiAgICAgICAgbGV0IHN1bW1hcnlIdG1sID0gXCJcIjtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBmaWVsZE5hbWVBbmRWYWx1ZXM6IEZpZWxkTmFtZUFuZFZhbHVlW10gPSBCcG1uTW9kZWxKc29uSGVscGVyLkZyb21Kc29uKHRoaXMuYmlsbERhdGFJbmZvLnN1bW1hcnksIEZpZWxkTmFtZUFuZFZhbHVlKTtcclxuICAgICAgICAgICAgZmllbGROYW1lQW5kVmFsdWVzICYmIGZpZWxkTmFtZUFuZFZhbHVlcy5mb3JFYWNoKFxyXG4gICAgICAgICAgICAgICAgKGZ2LCBpZHgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWVUZXh0ID0gaWR4ID09IDAgPyBgPGEgaHJlZj0namF2YXNjcmlwdDp2b2lkKDApOyc+JHtmdi52YWx1ZX08L2E+YCA6IGZ2LnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHN1bW1hcnlIdG1sICs9IGBcXFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYmlmLWNlbGwtbm9kZS1zdW1tYXJ5XCI+XFxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJiaWYtY2VsbC1ub2RlLXN1bW1hcnktY2FwdGlvblwiPlxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImJpZi1jZWxsLW5vZGUtc3VtbWFyeS1jYXB0aW9uLXRleHRcIiB0aXRsZT1cIiR7ZnYubmFtZX1cIj4ke2Z2Lm5hbWV9PC9kaXY+XFxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYmlmLWNlbGwtbm9kZS1zdW1tYXJ5LXZhbHVlXCI+XFxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYmlmLWNlbGwtbm9kZS1zdW1tYXJ5LXZhbHVlLXRleHRcIiB0aXRsZT1cIiR7ZnYudmFsdWV9XCI+JHt2YWx1ZVRleHR9PC9kaXY+XFxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcXHJcbiAgICAgICAgICAgICAgICAgICAgYDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGh0bWwgPSBgXFxcclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImJpZi1jZWxsLW5vZGVcIiBzdHlsZT1cIndpZHRoOiR7d2lkdGh9cHg7XCI+XFxcclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJiaWYtY2VsbC1ub2RlLW1haW5cIiBzdHlsZT1cImJhY2tncm91bmQ6ICR7dGl0bGVCYWNrZ3JvdW5kfTtcIj5cXFxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJiaWYtY2VsbC1ub2RlLXRpdGxlXCI+XFxcclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImJpZi1jZWxsLW5vZGUtdGl0bGUtdGV4dFwiPiR7dGl0bGV9PC9kaXY+XFxcclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXFxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJiaWYtY2VsbC1ub2RlLXN1bW1hcnktbGlzdFwiIHN0eWxlPVwibWluLWhlaWdodDogJHtoZWlnaHQgLSAzMH1weDtcIj5cXFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAke3N1bW1hcnlIdG1sfVxcXHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxcclxuICAgICAgICAgICAgICAgIDwvZGl2PlxcXHJcbiAgICAgICAgICAgIDwvZGl2PlxcXHJcbiAgICAgICAgYDtcclxuICAgICAgICByZXR1cm4gaHRtbDtcclxuICAgIH1cclxufVxyXG4iXX0=