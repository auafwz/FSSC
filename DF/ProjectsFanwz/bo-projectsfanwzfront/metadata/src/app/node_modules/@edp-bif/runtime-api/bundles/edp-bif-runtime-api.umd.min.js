!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("mxgraph"),require("@edp-aif/runtime-api"),require("@ngx-translate/core"),require("@angular/common"),require("@angular/common/http"),require("@ecp-caf/caf-common"),require("@farris/ui-draggable"),require("@farris/ui-text"),require("@farris/ui-section"),require("@farris/ui-dialog"),require("@farris/ui-datagrid"),require("rxjs/operators"),require("@gsp-sys/rtf-common"),require("@edp-aif/common-api"),require("@edp-bif/common-api"),require("@farris/ui-loading"),require("@farris/ui-modal"),require("@farris/ui-notify"),require("@angular/forms"),require("rxjs"),require("@farris/ui-messager"),require("@farris/devkit"),require("@farris/command-services"),require("@angular/core")):"function"==typeof define&&define.amd?define("@edp-bif/runtime-api",["exports","mxgraph","@edp-aif/runtime-api","@ngx-translate/core","@angular/common","@angular/common/http","@ecp-caf/caf-common","@farris/ui-draggable","@farris/ui-text","@farris/ui-section","@farris/ui-dialog","@farris/ui-datagrid","rxjs/operators","@gsp-sys/rtf-common","@edp-aif/common-api","@edp-bif/common-api","@farris/ui-loading","@farris/ui-modal","@farris/ui-notify","@angular/forms","rxjs","@farris/ui-messager","@farris/devkit","@farris/command-services","@angular/core"],t):t((e["edp-bif"]=e["edp-bif"]||{},e["edp-bif"]["runtime-api"]={}),e.mxgraphFactory,e.runtimeApi,e.core,e.ng.common,e.ng.common.http,e.cafCommon,e.uiDraggable,e.uiText,e.uiSection,e.uiDialog,e.uiDatagrid,e.rxjs.operators,e.rtfCommon,e.commonApi,e.commonApi$1,e.uiLoading,e.uiModal,e.uiNotify,e.ng.forms,e.rxjs,e.uiMessager,e.devkit,e.commandServices,e.ng.core)}(this,function(exports,mxgraphFactory,runtimeApi,core,common,http,cafCommon,uiDraggable,uiText,uiSection,uiDialog,uiDatagrid,operators,rtfCommon,commonApi,commonApi$1,uiLoading,uiModal,uiNotify,forms,rxjs,uiMessager,devkit,commandServices,core$1){"use strict";mxgraphFactory=mxgraphFactory&&mxgraphFactory.hasOwnProperty("default")?mxgraphFactory["default"]:mxgraphFactory,window.mxBasePath=window.mxBasePath||"/platform/runtime/common/web/@edp-pmf/mxgraph",window.mxLoadResources=window.mxLoadResources||undefined,window.mxForceIncludes=window.mxForceIncludes||undefined,window.mxResourceExtension=window.mxResourceExtension||undefined,window.mxLoadStylesheets=window.mxLoadStylesheets||undefined,window.imageBasePath=window.imageBasePath||undefined,window.mxLanguage=window.mxLanguage||undefined,window.mxDefaultLanguage=window.mxDefaultLanguage||undefined,window.mxLanguages=window.mxLanguages||undefined;var mxgraph=mxgraphFactory({}),mxDefaultKeyHandlerType=mxgraph.mxDefaultKeyHandler,mxDefaultPopupMenuType=mxgraph.mxDefaultPopupMenu,mxDefaultToolbarType=mxgraph.mxDefaultToolbar,mxEditorType=mxgraph.mxEditor,mxCellHighlightType=mxgraph.mxCellHighlight,mxCellMarkerType=mxgraph.mxCellMarker,mxCellTrackerType=mxgraph.mxCellTracker,mxConnectionHandlerType=mxgraph.mxConnectionHandler,mxConstraintHandlerType=mxgraph.mxConstraintHandler,mxEdgeHandlerType=mxgraph.mxEdgeHandler,mxEdgeSegmentHandlerType=mxgraph.mxEdgeSegmentHandler,mxElbowEdgeHandlerType=mxgraph.mxElbowEdgeHandler,mxGraphHandlerType=mxgraph.mxGraphHandler,mxHandleType=mxgraph.mxHandle,mxKeyHandlerType=mxgraph.mxKeyHandler,mxPanningHandlerType=mxgraph.mxPanningHandler,mxPopupMenuHandlerType=mxgraph.mxPopupMenuHandler,mxRubberbandType=mxgraph.mxRubberband,mxSelectionCellsHandlerType=mxgraph.mxSelectionCellsHandler,mxTooltipHandlerType=mxgraph.mxTooltipHandler,mxVertexHandlerType=mxgraph.mxVertexHandler,mxCellCodecType=mxgraph.mxCellCodec,mxChildChangeCodecType=mxgraph.mxChildChangeCodec,mxDefaultKeyHandlerCodecType=mxgraph.mxDefaultKeyHandlerCodec,mxDefaultPopupMenuCodecType=mxgraph.mxDefaultPopupMenuCodec,mxDefaultToolbarCodecType=mxgraph.mxDefaultToolbarCodec,mxEditorCodecType=mxgraph.mxEditorCodec,mxGenericChangeCodecType=mxgraph.mxGenericChangeCodec,mxGraphCodecType=mxgraph.mxGraphCodec,mxGraphViewCodecType=mxgraph.mxGraphViewCodec,mxModelCodecType=mxgraph.mxModelCodec,mxObjectCodecType=mxgraph.mxObjectCodec,mxRootChangeCodecType=mxgraph.mxRootChangeCodec,mxStylesheetCodecType=mxgraph.mxStylesheetCodec,mxTerminalChangeCodecType=mxgraph.mxTerminalChangeCodec,mxCircleLayoutType=mxgraph.mxCircleLayout,mxCompactTreeLayoutType=mxgraph.mxCompactTreeLayout,mxCompositeLayoutType=mxgraph.mxCompositeLayout,mxEdgeLabelLayoutType=mxgraph.mxEdgeLabelLayout,mxFastOrganicLayoutType=mxgraph.mxFastOrganicLayout,mxGraphLayoutType=mxgraph.mxGraphLayout,mxParallelEdgeLayoutType=mxgraph.mxParallelEdgeLayout,mxPartitionLayoutType=mxgraph.mxPartitionLayout,mxRadialTreeLayoutType=mxgraph.mxRadialTreeLayout,mxStackLayoutType=mxgraph.mxStackLayout,mxHierarchicalLayoutType=mxgraph.mxHierarchicalLayout,mxSwimlaneLayoutType=mxgraph.mxSwimlaneLayout,mxGraphAbstractHierarchyCellType=mxgraph.mxGraphAbstractHierarchyCell,mxGraphHierarchyEdgeType=mxgraph.mxGraphHierarchyEdge,mxGraphHierarchyModelType=mxgraph.mxGraphHierarchyModel,mxGraphHierarchyNodeType=mxgraph.mxGraphHierarchyNode,mxSwimlaneModelType=mxgraph.mxSwimlaneModel,mxCoordinateAssignmentType=mxgraph.mxCoordinateAssignment,mxHierarchicalLayoutStageType=mxgraph.mxHierarchicalLayoutStage,mxMedianHybridCrossingReductionType=mxgraph.mxMedianHybridCrossingReduction,mxMinimumCycleRemoverType=mxgraph.mxMinimumCycleRemover,mxSwimlaneOrderingType=mxgraph.mxSwimlaneOrdering,mxCellType=mxgraph.mxCell,mxCellPathType=mxgraph.mxCellPath,mxGeometryType=mxgraph.mxGeometry,mxGraphModelType=mxgraph.mxGraphModel,renderingHintType=mxgraph.renderingHint,mxActorType=mxgraph.mxActor,mxArrowType=mxgraph.mxArrow,mxArrowConnectorType=mxgraph.mxArrowConnector,mxCloudType=mxgraph.mxCloud,mxConnectorType=mxgraph.mxConnector,mxCylinderType=mxgraph.mxCylinder,mxDoubleEllipseType=mxgraph.mxDoubleEllipse,mxEllipseType=mxgraph.mxEllipse,mxHexagonType=mxgraph.mxHexagon,mxImageShapeType=mxgraph.mxImageShape,mxLabelType=mxgraph.mxLabel,mxLineType=mxgraph.mxLine,mxMarkerType=mxgraph.mxMarker,mxPolylineType=mxgraph.mxPolyline,mxRectangleShapeType=mxgraph.mxRectangleShape,mxRhombusType=mxgraph.mxRhombus,mxShapeType=mxgraph.mxShape,mxStencilType=mxgraph.mxStencil,mxStencilRegistryType=mxgraph.mxStencilRegistry,mxSwimlaneType=mxgraph.mxSwimlane,mxTextType=mxgraph.mxText,mxTriangleType=mxgraph.mxTriangle,mxAbstractCanvas2DType=mxgraph.mxAbstractCanvas2D,mxAnimationType=mxgraph.mxAnimation,mxAutoSaveManagerType=mxgraph.mxAutoSaveManager,mxClipboardType=mxgraph.mxClipboard,mxConstantsType=mxgraph.mxConstants,mxDictionaryType=mxgraph.mxDictionary,mxDivResizerType=mxgraph.mxDivResizer,mxDragSourceType=mxgraph.mxDragSource,mxEffectsType=mxgraph.mxEffects,mxEventType=mxgraph.mxEvent,mxEventObjectType=mxgraph.mxEventObject,mxEventSourceType=mxgraph.mxEventSource,mxFormType=mxgraph.mxForm,mxGuideType=mxgraph.mxGuide,mxImageType=mxgraph.mxImage,mxImageBundleType=mxgraph.mxImageBundle,mxImageExportType=mxgraph.mxImageExport,mxLogType=mxgraph.mxLog,mxMorphingType=mxgraph.mxMorphing,mxMouseEventType=mxgraph.mxMouseEvent,mxObjectIdentityType=mxgraph.mxObjectIdentity,mxPanningManagerType=mxgraph.mxPanningManager,mxPointType=mxgraph.mxPoint,mxPopupMenuType=mxgraph.mxPopupMenu,mxRectangleType=mxgraph.mxRectangle,mxResourcesType=mxgraph.mxResources,mxSvgCanvas2DType=mxgraph.mxSvgCanvas2D,mxToolbarType=mxgraph.mxToolbar,mxUndoableEditType=mxgraph.mxUndoableEdit,mxUndoManagerType=mxgraph.mxUndoManager,mxUrlConverterType=mxgraph.mxUrlConverter,mxUtilsType=mxgraph.mxUtils,mxVmlCanvas2DType=mxgraph.mxVmlCanvas2D,mxWindowType=mxgraph.mxWindow,mxXmlCanvas2DType=mxgraph.mxXmlCanvas2D,mxXmlRequestType=mxgraph.mxXmlRequest,mxCellEditorType=mxgraph.mxCellEditor,mxCellOverlayType=mxgraph.mxCellOverlay,mxCellRendererType=mxgraph.mxCellRenderer,mxCellStateType=mxgraph.mxCellState,mxCellStatePreviewType=mxgraph.mxCellStatePreview,mxConnectionConstraintType=mxgraph.mxConnectionConstraint,mxEdgeStyleType=mxgraph.mxEdgeStyle,mxGraphType=mxgraph.mxGraph,mxGraphSelectionModelType=mxgraph.mxGraphSelectionModel,mxGraphViewType=mxgraph.mxGraphView,mxLayoutManagerType=mxgraph.mxLayoutManager,mxMultiplicityType=mxgraph.mxMultiplicity,mxOutlineType=mxgraph.mxOutline,mxPerimeterType=mxgraph.mxPerimeter,mxPrintPreviewType=mxgraph.mxPrintPreview,mxStyleRegistryType=mxgraph.mxStyleRegistry,mxStylesheetType=mxgraph.mxStylesheet,mxSwimlaneManagerType=mxgraph.mxSwimlaneManager,mxTemporaryCellStatesType=mxgraph.mxTemporaryCellStates,mxClientType=mxgraph.mxClient;exports.MxGraphNS||(exports.MxGraphNS={});var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function __extends(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var __assign=function(){return(__assign=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function __values(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,i,n=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=n.next()).done;)a.push(o.value)}catch(l){i={error:l}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(i)throw i.error}}return a}function __spread(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e}var BillData=(K=commonApi.JsonConvertableImpl,__extends(L,K),L.prototype.ResetBeforeLoadFrom=function(){K.prototype.ResetBeforeLoadFrom.call(this),this.name=null,this.value=null},L.prototype.ConvertToJsonObject=function(){var e=K.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"name",this.name),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"value",this.value),e},L.prototype.LoadFromJsonObject=function(e){K.prototype.LoadFromJsonObject.call(this,e),this.name=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"name"),this.value=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"value")},L),K;function L(){return null!==K&&K.apply(this,arguments)||this}var FormBillCreationProcessExecutorArgs=(O=runtimeApi.FormCreationRuleExecutorArgs,__extends(P,O),P.prototype.ResetBeforeLoadFrom=function(){O.prototype.ResetBeforeLoadFrom.call(this),this.billCreationProcessId=null},P.prototype.ConvertToJsonObject=function(){var e=O.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"billCreationProcessId",this.billCreationProcessId),e},P.prototype.LoadFromJsonObject=function(e){O.prototype.LoadFromJsonObject.call(this,e),this.billCreationProcessId=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"billCreationProcessId")},P),O;function P(){return null!==O&&O.apply(this,arguments)||this}var ConditionResult=(S=commonApi.JsonConvertableImpl,__extends(T,S),T.prototype.ResetBeforeLoadFrom=function(){S.prototype.ResetBeforeLoadFrom.call(this),this.conditionExecutionResult=!1,this.message=null},T.prototype.ConvertToJsonObject=function(){var e=S.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"conditionExecutionResult",this.conditionExecutionResult),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"message",this.message),e},T.prototype.LoadFromJsonObject=function(e){S.prototype.LoadFromJsonObject.call(this,e),this.conditionExecutionResult=commonApi.BpmnModelJsonHelper.GetAttributeValueAsBoolean(e,"conditionExecutionResult"),this.message=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"message")},T),S;function T(){return null!==S&&S.apply(this,arguments)||this}var FormBillCreationProcessExecutorResult=(W=commonApi.JsonConvertableImpl,__extends(X,W),X.prototype.ResetBeforeLoadFrom=function(){W.prototype.ResetBeforeLoadFrom.call(this),this.conditionResult=null,this.creationRuleExecutorResult=null},X.prototype.ConvertToJsonObject=function(){var e=W.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"conditionResult",this.conditionResult),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"creationRuleExecutorResult",this.creationRuleExecutorResult),e},X.prototype.LoadFromJsonObject=function(e){W.prototype.LoadFromJsonObject.call(this,e),this.conditionResult=commonApi.BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(e,"conditionResult",ConditionResult),this.creationRuleExecutorResult=commonApi.BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(e,"creationRuleExecutorResult",runtimeApi.RpcCreationRuleExecutorResult)},X),W;function X(){return null!==W&&W.apply(this,arguments)||this}var ManualCreationMode={Push:"Push",Pull:"Pull",SpecificPush:"SpecificPush",SpecificPull:"SpecificPull"},FormGetBillCreationProcessEntityExArgs=($=commonApi.JsonConvertableImpl,__extends(_,$),_.prototype.ResetBeforeLoadFrom=function(){$.prototype.ResetBeforeLoadFrom.call(this),this.upBillVoId=null,this.downBillVoId=null,this.manualCreationMode=null},_.prototype.ConvertToJsonObject=function(){var e=$.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"upBillVoId",this.upBillVoId),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"downBillVoId",this.downBillVoId),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"manualCreationMode",this.manualCreationMode),e},_.prototype.LoadFromJsonObject=function(e){$.prototype.LoadFromJsonObject.call(this,e),this.upBillVoId=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"upBillVoId"),this.downBillVoId=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"downBillVoId"),this.manualCreationMode=ManualCreationMode[commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"manualCreationMode")]},_),$;function _(){return null!==$&&$.apply(this,arguments)||this}var FormGetBillCreationProcessEntityExResult=(ca=commonApi.JsonConvertableImpl,__extends(da,ca),da.prototype.ResetBeforeLoadFrom=function(){ca.prototype.ResetBeforeLoadFrom.call(this),this.billCreationProcessEntityExes=new Array},da.prototype.ConvertToJsonObject=function(){var e=ca.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"billCreationProcessEntityExes",this.billCreationProcessEntityExes),e},da.prototype.LoadFromJsonObject=function(e){ca.prototype.LoadFromJsonObject.call(this,e),this.billCreationProcessEntityExes=commonApi.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billCreationProcessEntityExes",commonApi$1.RtSlimBillCreationProcessEntityEx)},da),ca;function da(){return null!==ca&&ca.apply(this,arguments)||this}var BillDetailInfo=(ga=commonApi.JsonConvertableImpl,__extends(ha,ga),ha.prototype.ResetBeforeLoadFrom=function(){ga.prototype.ResetBeforeLoadFrom.call(this),this.detailCode=null,this.detailIds=[]},ha.prototype.ConvertToJsonObject=function(){var e=ga.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"detailCode",this.detailCode),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"detailIds",commonApi.BpmnModelJsonHelper.StringListToJson(this.detailIds)),e},ha.prototype.LoadFromJsonObject=function(e){ga.prototype.LoadFromJsonObject.call(this,e),this.detailCode=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"detailCode"),this.detailIds=commonApi.BpmnModelJsonHelper.StringListFromJson(commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"detailIds"))},ha),ga;function ha(){var e=null!==ga&&ga.apply(this,arguments)||this;return e.detailIds=[],e}var BillItemInfo=(la=commonApi.JsonConvertableImpl,__extends(ma,la),ma.prototype.ResetBeforeLoadFrom=function(){la.prototype.ResetBeforeLoadFrom.call(this),this.itemId=null,this.billDetailInfos=[]},ma.prototype.ConvertToJsonObject=function(){var e=la.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"itemId",this.itemId),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"billDetailInfos",this.billDetailInfos),e},ma.prototype.LoadFromJsonObject=function(e){la.prototype.LoadFromJsonObject.call(this,e),this.itemId=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"itemId"),this.billDetailInfos=commonApi.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billDetailInfos",BillDetailInfo)},ma),la;function ma(){var e=null!==la&&la.apply(this,arguments)||this;return e.billDetailInfos=[],e}var BillChildInfo=(qa=commonApi.JsonConvertableImpl,__extends(ra,qa),ra.prototype.ResetBeforeLoadFrom=function(){qa.prototype.ResetBeforeLoadFrom.call(this),this.itemCode=null,this.billItemInfos=[]},ra.prototype.ConvertToJsonObject=function(){var e=qa.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"itemCode",this.itemCode),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"billItemInfos",this.billItemInfos),e},ra.prototype.LoadFromJsonObject=function(e){qa.prototype.LoadFromJsonObject.call(this,e),this.itemCode=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"itemCode"),this.billItemInfos=commonApi.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billItemInfos",BillItemInfo)},ra),qa;function ra(){var e=null!==qa&&qa.apply(this,arguments)||this;return e.billItemInfos=[],e}var TrackingMappingAssociation=(va=commonApi.JsonConvertableImpl,__extends(wa,va),wa.prototype.ResetBeforeLoadFrom=function(){va.prototype.ResetBeforeLoadFrom.call(this),this.upBillTableCodePath=null,this.upBillDataIdPath=null,this.downBillTableCodePath=null,this.downBillDataIdPath=null},wa.prototype.ConvertToJsonObject=function(){var e=va.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"upBillTableCodePath",this.upBillTableCodePath),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"upBillDataIdPath",this.upBillDataIdPath),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"downBillTableCodePath",this.downBillTableCodePath),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"downBillDataIdPath",this.downBillDataIdPath),e},wa.prototype.LoadFromJsonObject=function(e){va.prototype.LoadFromJsonObject.call(this,e),this.upBillTableCodePath=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"upBillTableCodePath"),this.upBillDataIdPath=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"upBillDataIdPath"),this.downBillTableCodePath=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"downBillTableCodePath"),this.downBillDataIdPath=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"downBillDataIdPath")},wa),va;function wa(){return null!==va&&va.apply(this,arguments)||this}var BillDataInfo=(za=commonApi.JsonConvertableImpl,__extends(Aa,za),Aa.prototype.ResetBeforeLoadFrom=function(){za.prototype.ResetBeforeLoadFrom.call(this),this.dataId=null,this.caption=null,this.summary=null,this.canContinueTracking=!1,this.trackingMappingAssociations=null,this.billChildInfos=[],this.curYear=null},Aa.prototype.ConvertToJsonObject=function(){var e=za.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"dataId",this.dataId),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"caption",this.caption),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"summary",this.summary),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"canContinueTracking",this.canContinueTracking),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"trackingMappingAssociations",this.trackingMappingAssociations),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"billChildInfos",this.billChildInfos),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"curYear",this.curYear),e},Aa.prototype.LoadFromJsonObject=function(e){za.prototype.LoadFromJsonObject.call(this,e),this.dataId=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"dataId"),this.caption=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"caption"),this.summary=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"summary"),this.canContinueTracking=commonApi.BpmnModelJsonHelper.GetAttributeValueAsBoolean(e,"canContinueTracking"),this.trackingMappingAssociations=commonApi.BpmnModelJsonHelper.GetAttributeValueAsList(e,"trackingMappingAssociations",TrackingMappingAssociation),this.billChildInfos=commonApi.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billChildInfos",BillChildInfo),this.curYear=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"curYear")},Aa),za;function Aa(){var e=null!==za&&za.apply(this,arguments)||this;return e.billChildInfos=[],e}var BillInfo=(Ea=commonApi.JsonConvertableImpl,__extends(Fa,Ea),Fa.prototype.ResetBeforeLoadFrom=function(){Ea.prototype.ResetBeforeLoadFrom.call(this),this.billTrackingSettings=null,this.schemaId=null,this.suCode=null,this.documentTypeId=null,this.bizKind=null,this.bizType=null,this.billDataInfos=[],this.jointQueryMode=commonApi$1.JointQueryMode.DEFAULT,this.jointQueryParameters=null,this.trackingSourceType=null},Fa.prototype.ConvertToJsonObject=function(){var e=Ea.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"billTrackingSettings",this.billTrackingSettings),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"schemaId",this.schemaId),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"suCode",this.suCode),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"documentTypeId",this.documentTypeId),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"bizKind",this.bizKind),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"bizType",this.bizType),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"billDataInfos",this.billDataInfos),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"jointQueryMode",this.jointQueryMode),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"jointQueryParameters",this.jointQueryParameters),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"trackingSourceType",this.trackingSourceType),e},Fa.prototype.LoadFromJsonObject=function(e){Ea.prototype.LoadFromJsonObject.call(this,e),this.billTrackingSettings=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"billTrackingSettings"),this.schemaId=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"schemaId"),this.suCode=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"suCode"),this.documentTypeId=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"documentTypeId"),this.bizKind=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"bizKind"),this.bizType=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"bizType"),this.billDataInfos=commonApi.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billDataInfos",BillDataInfo),this.jointQueryMode=commonApi$1.JointQueryMode[commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"jointQueryMode")],this.jointQueryParameters=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"jointQueryParameters"),this.trackingSourceType=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"trackingSourceType")},Fa),Ea;function Fa(){var e=null!==Ea&&Ea.apply(this,arguments)||this;return e.billDataInfos=[],e.jointQueryMode=commonApi$1.JointQueryMode.DEFAULT,e}var CanTrackingInfo=(Ja=commonApi.JsonConvertableImpl,__extends(Ka,Ja),Ka.prototype.ResetBeforeLoadFrom=function(){Ja.prototype.ResetBeforeLoadFrom.call(this),this.canUpTracking=!1,this.canDownTracking=!1,this.documentTypeId=null,this.bizKind=null,this.bizType=null,this.dataId=null,this.caption=null,this.summary=null,this.suCode=null,this.schemaId=null,this.billChildInfos=[],this.jointQueryMode=commonApi$1.JointQueryMode.DEFAULT,this.jointQueryParameters=null,this.trackingSourceType=null,this.curYear=null},Ka.prototype.ConvertToJsonObject=function(){var e=Ja.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"canUpTracking",this.canUpTracking),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"canDownTracking",this.canDownTracking),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"documentTypeId",this.documentTypeId),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"bizKind",this.bizKind),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"bizType",this.bizType),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"dataId",this.dataId),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"caption",this.caption),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"summary",this.summary),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"suCode",this.suCode),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"schemaId",this.schemaId),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"billChildInfos",this.billChildInfos),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"jointQueryMode",this.jointQueryMode),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"jointQueryParameters",this.jointQueryParameters),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"trackingSourceType",this.trackingSourceType),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"curYear",this.curYear),e},Ka.prototype.LoadFromJsonObject=function(e){Ja.prototype.LoadFromJsonObject.call(this,e),this.canUpTracking=commonApi.BpmnModelJsonHelper.GetAttributeValueAsBoolean(e,"canUpTracking"),this.canDownTracking=commonApi.BpmnModelJsonHelper.GetAttributeValueAsBoolean(e,"canDownTracking"),this.documentTypeId=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"documentTypeId"),this.bizKind=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"bizKind"),this.bizType=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"bizType"),this.dataId=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"dataId"),this.caption=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"caption"),this.summary=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"summary"),this.suCode=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"suCode"),this.schemaId=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"schemaId"),this.billChildInfos=commonApi.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billChildInfos",BillChildInfo),this.jointQueryMode=commonApi$1.JointQueryMode[commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"jointQueryMode")],this.jointQueryParameters=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"jointQueryParameters"),this.trackingSourceType=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"trackingSourceType"),this.curYear=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"curYear")},Ka),Ja;function Ka(){var e=null!==Ja&&Ja.apply(this,arguments)||this;return e.billChildInfos=[],e.jointQueryMode=commonApi$1.JointQueryMode.DEFAULT,e}var DownBillInfo=(Oa=BillInfo,__extends(Pa,Oa),Pa),Oa;function Pa(){return null!==Oa&&Oa.apply(this,arguments)||this}var GetBillsInfoArgs=(Qa=commonApi.JsonConvertableImpl,__extends(Ra,Qa),Ra.prototype.ResetBeforeLoadFrom=function(){Qa.prototype.ResetBeforeLoadFrom.call(this),this.documentTypeId=null,this.bizKind=null,this.bizType=null,this.billDataId=null,this.billChildInfos=[],this.curYear=null},Ra.prototype.ConvertToJsonObject=function(){var e=Qa.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"documentTypeId",this.documentTypeId),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"bizKind",this.bizKind),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"bizType",this.bizType),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"billDataId",this.billDataId),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"billChildInfos",this.billChildInfos),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"curYear",this.curYear),e},Ra.prototype.LoadFromJsonObject=function(e){Qa.prototype.LoadFromJsonObject.call(this,e),this.documentTypeId=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"documentTypeId"),this.bizKind=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"bizKind"),this.bizType=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"bizType"),this.billDataId=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"billDataId"),this.billChildInfos=commonApi.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billChildInfos",BillChildInfo),this.curYear=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"curYear")},Ra),Qa;function Ra(){var e=null!==Qa&&Qa.apply(this,arguments)||this;return e.billChildInfos=[],e}var GetDownBillsInfoArgs=(Va=GetBillsInfoArgs,__extends(Wa,Va),Wa),Va;function Wa(){return null!==Va&&Va.apply(this,arguments)||this}var GetUpBillsInfoArgs=(Xa=GetBillsInfoArgs,__extends(Ya,Xa),Ya),Xa;function Ya(){return null!==Xa&&Xa.apply(this,arguments)||this}var TrackingHelper=(Za.concatDownBillInfos=function(e,t){var r,o,i,n;if(null==e&&(e=new Array),null==t||0==t.length)return e;var a=new Array;e.forEach(function(e){return a.push(e.schemaId)});try{for(var l=__values(t),s=l.next();!s.done;s=l.next()){var M=s.value;if(a.includes(M.schemaId))try{for(var c=__values(e),p=c.next();!p.done;p=c.next())!function(e){var t,r,o,i,n,a,l,s;if(e.schemaId==M.schemaId){var c=e.billDataInfos,p=new Array;c.forEach(function(e){return p.push(e.dataId)});try{for(var d=__values(M.billDataInfos),u=d.next();!u.done;u=d.next()){var m=u.value;if(p.includes(m.dataId))try{for(var h=__values(c),y=h.next();!y.done;y=h.next()){var f=y.value;if(f.dataId==m.dataId){var g=f.trackingMappingAssociations;try{for(var x=__values(m.trackingMappingAssociations),v=x.next();!v.done;v=x.next()){var b=v.value,T=0;try{for(var C=__values(g),S=C.next();!S.done;S=C.next()){var A=S.value;b.downBillDataIdPath==A.downBillDataIdPath&&b.downBillTableCodePath==A.downBillTableCodePath&&b.upBillDataIdPath==A.upBillDataIdPath&&b.upBillTableCodePath==A.upBillTableCodePath||T++}}catch(I){l={error:I}}finally{try{S&&!S.done&&(s=C["return"])&&s.call(C)}finally{if(l)throw l.error}}T==g.length&&g.push(b)}}catch(B){n={error:B}}finally{try{v&&!v.done&&(a=x["return"])&&a.call(x)}finally{if(n)throw n.error}}}}}catch(E){o={error:E}}finally{try{y&&!y.done&&(i=h["return"])&&i.call(h)}finally{if(o)throw o.error}}else c.push(m)}}catch(w){t={error:w}}finally{try{u&&!u.done&&(r=d["return"])&&r.call(d)}finally{if(t)throw t.error}}}}(p.value)}catch(d){i={error:d}}finally{try{p&&!p.done&&(n=c["return"])&&n.call(c)}finally{if(i)throw i.error}}else a.push(M.schemaId),e.push(M)}}catch(u){r={error:u}}finally{try{s&&!s.done&&(o=l["return"])&&o.call(l)}finally{if(r)throw r.error}}return e},Za.concatUpBillInfos=function(e,t){var r,o,i,n;if(null==e&&(e=new Array),null==t||0==t.length)return e;var a=new Array;e.forEach(function(e){a.push(e.schemaId)});try{for(var l=__values(t),s=l.next();!s.done;s=l.next()){var M=s.value;if(a.includes(M.schemaId))try{for(var c=__values(e),p=c.next();!p.done;p=c.next())!function(e){var t,r,o,i,n,a,l,s;if(e.schemaId==M.schemaId){var c=e.billDataInfos,p=new Array;c.forEach(function(e){return p.push(e.dataId)});try{for(var d=__values(M.billDataInfos),u=d.next();!u.done;u=d.next()){var m=u.value;if(p.includes(m.dataId))try{for(var h=__values(c),y=h.next();!y.done;y=h.next()){var f=y.value;if(f.dataId==m.dataId){var g=f.trackingMappingAssociations;try{for(var x=__values(m.trackingMappingAssociations),v=x.next();!v.done;v=x.next()){var b=v.value,T=0;try{for(var C=__values(g),S=C.next();!S.done;S=C.next()){var A=S.value;b.downBillDataIdPath==A.downBillDataIdPath&&b.downBillTableCodePath==A.downBillTableCodePath&&b.upBillDataIdPath==A.upBillDataIdPath&&b.upBillTableCodePath==A.upBillTableCodePath||T++}}catch(I){l={error:I}}finally{try{S&&!S.done&&(s=C["return"])&&s.call(C)}finally{if(l)throw l.error}}T==g.length&&g.push(b)}}catch(B){n={error:B}}finally{try{v&&!v.done&&(a=x["return"])&&a.call(x)}finally{if(n)throw n.error}}}}}catch(E){o={error:E}}finally{try{y&&!y.done&&(i=h["return"])&&i.call(h)}finally{if(o)throw o.error}}else c.push(m)}}catch(w){t={error:w}}finally{try{u&&!u.done&&(r=d["return"])&&r.call(d)}finally{if(t)throw t.error}}}}(p.value)}catch(d){i={error:d}}finally{try{p&&!p.done&&(n=c["return"])&&n.call(c)}finally{if(i)throw i.error}}else a.push(M.schemaId),e.push(M)}}catch(u){r={error:u}}finally{try{s&&!s.done&&(o=l["return"])&&o.call(l)}finally{if(r)throw r.error}}return e},Za);function Za(){}var UpBillInfo=(Yc=BillInfo,__extends(Zc,Yc),Zc),Yc;function Zc(){return null!==Yc&&Yc.apply(this,arguments)||this}var TypeToFormat={DEFAULT:"DEFAULT",DATE:"DATE",DECIMAL:"DECIMAL"},FieldsWithOrder=($c=commonApi.JsonConvertableImpl,__extends(_c,$c),_c.prototype.ResetBeforeLoadFrom=function(){$c.prototype.ResetBeforeLoadFrom.call(this),this.order=0,this.fieldName=null,this.fieldPath=null,this.name=null,this.customName=null,this.colI18nValues=null,this.typeToFormat=TypeToFormat.DEFAULT,this.formatInfo=null,this.version=0},_c.prototype.ConvertToJsonObject=function(){var e=$c.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"order",this.order),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"name",this.name),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"fieldName",this.fieldName),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"fieldPath",this.fieldPath),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"customName",this.customName),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"colI18nValues",this.colI18nValues),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"typeToFormat",this.typeToFormat),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"formatInfo",this.formatInfo),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"version",this.version),e},_c.prototype.LoadFromJsonObject=function(e){$c.prototype.LoadFromJsonObject.call(this,e),this.order=commonApi.BpmnModelJsonHelper.GetAttributeValueAsNumber(e,"order"),this.name=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"name"),this.fieldName=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"fieldName"),this.fieldPath=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"fieldPath"),this.customName=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"customName"),this.colI18nValues=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"colI18nValues"),this.typeToFormat=TypeToFormat[commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"typeToFormat")],this.formatInfo=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"formatInfo"),this.version=commonApi.BpmnModelJsonHelper.GetAttributeValueAsNumber(e,"version")},_c),$c;function _c(){var e=null!==$c&&$c.apply(this,arguments)||this;return e.typeToFormat=TypeToFormat.DEFAULT,e}var SummaryFieldsInfo=(dd=commonApi.JsonConvertableImpl,__extends(ed,dd),ed.prototype.ResetBeforeLoadFrom=function(){dd.prototype.ResetBeforeLoadFrom.call(this),this.code=null,this.fields=[],this.childFieldInfos=[]},ed.prototype.ConvertToJsonObject=function(){var e=dd.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"code",this.code),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"fields",this.fields),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"childFieldInfos",this.childFieldInfos),e},ed.prototype.LoadFromJsonObject=function(e){dd.prototype.LoadFromJsonObject.call(this,e),this.code=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"code"),this.fields=commonApi.BpmnModelJsonHelper.GetAttributeValueAsList(e,"fields",FieldsWithOrder),this.childFieldInfos=commonApi.BpmnModelJsonHelper.GetAttributeValueAsList(e,"childFieldInfos",ed)},ed),dd;function ed(){var e=null!==dd&&dd.apply(this,arguments)||this;return e.fields=[],e.childFieldInfos=[],e}var FieldNameAndValue=(id=commonApi.JsonConvertableImpl,__extends(jd,id),jd.prototype.ResetBeforeLoadFrom=function(){id.prototype.ResetBeforeLoadFrom.call(this),this.name=null,this.value=null},jd.prototype.ConvertToJsonObject=function(){var e=id.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"name",this.name),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"value",this.value),e},jd.prototype.LoadFromJsonObject=function(e){id.prototype.LoadFromJsonObject.call(this,e),this.name=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"name"),this.value=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"value")},jd),id;function jd(){return null!==id&&id.apply(this,arguments)||this}var DateTypeFormatInfo=(md=commonApi.JsonConvertableImpl,__extends(nd,md),nd.prototype.ResetBeforeLoadFrom=function(){md.prototype.ResetBeforeLoadFrom.call(this),this.displayFormat=null},nd.prototype.ConvertToJsonObject=function(){var e=md.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"displayFormat",this.displayFormat),e},nd.prototype.LoadFromJsonObject=function(e){md.prototype.LoadFromJsonObject.call(this,e),this.displayFormat=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"displayFormat")},nd),md;function nd(){return null!==md&&md.apply(this,arguments)||this}var ScaleMode={DEFAULT:"DEFAULT",NUMBER:"NUMBER",FIELD:"FIELD",EXPRESSION:"EXPRESSION"},DecimalTypeFormatInfo=(qd=commonApi.JsonConvertableImpl,__extends(rd,qd),rd.prototype.ResetBeforeLoadFrom=function(){qd.prototype.ResetBeforeLoadFrom.call(this),this.scale=0,this.scaleMode=ScaleMode.DEFAULT,this.fieldPath=null,this.version=0},rd.prototype.ConvertToJsonObject=function(){var e=qd.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"scale",this.scale),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"scale",this.scale),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"scaleMode",this.scaleMode),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"fieldPath",this.fieldPath),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"version",this.version),e},rd.prototype.LoadFromJsonObject=function(e){qd.prototype.LoadFromJsonObject.call(this,e),this.scale=commonApi.BpmnModelJsonHelper.GetAttributeValueAsNumber(e,"scale");var t=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"scaleMode");this.scaleMode=null==t?ScaleMode.DEFAULT:ScaleMode[t],this.fieldPath=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"fieldPath"),this.version=commonApi.BpmnModelJsonHelper.GetAttributeValueAsNumber(e,"version")},rd),qd;function rd(){var e=null!==qd&&qd.apply(this,arguments)||this;return e.scaleMode=ScaleMode.DEFAULT,e}var TypeToFormat$1={DEFAULT:"DEFAULT",DATE:"DATE",DECIMAL:"DECIMAL"},JointQueryParameterContent=(wd=commonApi.JsonConvertableImpl,__extends(xd,wd),xd.prototype.ResetBeforeLoadFrom=function(){wd.prototype.ResetBeforeLoadFrom.call(this),this.parameterCode=null},xd.prototype.ConvertToJsonObject=function(){var e=wd.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"parameterCode",this.parameterCode),e},xd.prototype.LoadFromJsonObject=function(e){wd.prototype.LoadFromJsonObject.call(this,e),this.parameterCode=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"parameterCode")},xd),wd;function xd(){return null!==wd&&wd.apply(this,arguments)||this}var ExpressionJointQueryParameterContent=(Ad=JointQueryParameterContent,__extends(Bd,Ad),Bd.prototype.ResetBeforeLoadFrom=function(){Ad.prototype.ResetBeforeLoadFrom.call(this),this.expressionContent=null},Bd.prototype.ConvertToJsonObject=function(){var e=Ad.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"expressionContent",this.expressionContent),e},Bd.prototype.LoadFromJsonObject=function(e){Ad.prototype.LoadFromJsonObject.call(this,e),this.expressionContent=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"expressionContent")},Bd),Ad;function Bd(){return null!==Ad&&Ad.apply(this,arguments)||this}var FieldJointQueryParameterContent=(Ed=JointQueryParameterContent,__extends(Fd,Ed),Fd.prototype.ResetBeforeLoadFrom=function(){Ed.prototype.ResetBeforeLoadFrom.call(this),this.fieldContent=null},Fd.prototype.ConvertToJsonObject=function(){var e=Ed.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"fieldContent",this.fieldContent),e},Fd.prototype.LoadFromJsonObject=function(e){Ed.prototype.LoadFromJsonObject.call(this,e),this.fieldContent=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"fieldContent")},Fd),Ed;function Fd(){return null!==Ed&&Ed.apply(this,arguments)||this}var JointQueryParameterMode={FIELD:"FIELD",EXPRESSION:"EXPRESSION",COMPONENT:"COMPONENT"},JointQueryParameterResult=(Id=commonApi.JsonConvertableImpl,__extends(Jd,Id),Jd.prototype.ResetBeforeLoadFrom=function(){Id.prototype.ResetBeforeLoadFrom.call(this),this.code=null,this.value=null},Jd.prototype.ConvertToJsonObject=function(){var e=Id.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"code",this.code),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"value",this.value),e},Jd.prototype.LoadFromJsonObject=function(e){Id.prototype.LoadFromJsonObject.call(this,e),this.code=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"code"),this.value=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"value")},Jd),Id;function Jd(){return null!==Id&&Id.apply(this,arguments)||this}var JointQueryParametersContent=(Md=commonApi.JsonConvertableImpl,__extends(Nd,Md),Nd.prototype.ResetBeforeLoadFrom=function(){Md.prototype.ResetBeforeLoadFrom.call(this),this.jointQueryParameterMode=JointQueryParameterMode.FIELD,this.content=null},Nd.prototype.ConvertToJsonObject=function(){var e=Md.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"jointQueryParameterMode",this.jointQueryParameterMode),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"content",this.content),e},Nd.prototype.LoadFromJsonObject=function(e){Md.prototype.LoadFromJsonObject.call(this,e),this.jointQueryParameterMode=JointQueryParameterMode[commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"jointQueryParameterMode")],this.content=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"content")},Nd),Md;function Nd(){var e=null!==Md&&Md.apply(this,arguments)||this;return e.jointQueryParameterMode=JointQueryParameterMode.FIELD,e}var BIF_UISTATE_KEY_OPEN_TYPE="abdbaec8-0bbe-4894-acee-b8d493bc4e1c",BIF_UISTATE_KEY_CREATION_RESULT="5eb32009-1d86-43df-96c8-8d685aea4e66",ModuleConfig=function(){},SELECTOR_ARGS_INJECTOR=new core$1.InjectionToken("SELECTOR_ARGS_INJECTOR"),DEFAULT_SELECTOR_ARGS={upBillVoId:null,downBillVoId:null,manaualCreationMode:null},BifDataService=(Sd.prototype.getSlimBillCreationProcessEntityExesByUpBillVoId4Push=function(e){var t=new FormGetBillCreationProcessEntityExArgs;return t.upBillVoId=e,t.manualCreationMode=ManualCreationMode.Push,this.getSlimBillCreationProcessEntityExes(t).pipe(operators.map(function(e){return e.billCreationProcessEntityExes}))},Sd.prototype.getSlimBillCreationProcessEntityExesByDownBillVoId4Pull=function(e){var t=new FormGetBillCreationProcessEntityExArgs;return t.downBillVoId=e,t.manualCreationMode=ManualCreationMode.Pull,this.getSlimBillCreationProcessEntityExes(t).pipe(operators.map(function(e){return e.billCreationProcessEntityExes}))},Sd.prototype.getSlimBillCreationProcessEntityExesByUpBillVoIdAndDownBillVoId4SpecificPush=function(e,t){var r=new FormGetBillCreationProcessEntityExArgs;return r.upBillVoId=e,r.downBillVoId=t,r.manualCreationMode=ManualCreationMode.SpecificPush,this.getSlimBillCreationProcessEntityExes(r).pipe(operators.map(function(e){return e.billCreationProcessEntityExes}))},Sd.prototype.getSlimBillCreationProcessEntityExesByUpBillVoIdAndDownBillVoId4SpecificPull=function(e,t){var r=new FormGetBillCreationProcessEntityExArgs;return r.upBillVoId=e,r.downBillVoId=t,r.manualCreationMode=ManualCreationMode.SpecificPull,this.getSlimBillCreationProcessEntityExes(r).pipe(operators.map(function(e){return e.billCreationProcessEntityExes}))},Sd.prototype.getSlimBillCreationProcessEntityExById=function(e){return this.repository.proxy.request(this.getBillCreationProcessEntityExByIdUrl+"/"+e,this.getBillCreationProcessEntityExByIdMethod,null)},Sd.prototype.getFormSettingsById=function(e){if(null==e||""==e.trim())throw"FormSettingsId为空";return this.repository.proxy.request(this.generalTextUrl+"/"+e,this.generalTextMethod,null,{responseType:"text"}).pipe(operators.map(function(e){var t=new commonApi$1.GeneralTextEntity;t.LoadFromJson(e);var r=new commonApi$1.FormSettings;return r.LoadFromJson(t.text),r}))},Sd.prototype.executeBillCreationProcess=function(e){var t=e.ConvertToJson();return this.repository.proxy.request(this.executeBillCreationProcessUrl,this.executeBillCreationProcessMethod,null,{body:t,responseType:"text"}).pipe(operators.map(function(e){var t=new FormBillCreationProcessExecutorResult;return t.LoadFromJson(e),t}))},Sd.prototype.createEntityDatas=function(e){var i=this,t={body:e.ConvertToJson(),responseType:"text"};return this.repository.proxy.request(this.formCreateUrl,this.formCreateMethod,null,t).pipe(operators.switchMap(function(e){var t=new runtimeApi.FormCreateResult;t.LoadFromJson(e);var r=t.entityDataList.map(function(e){var t=i.repository.buildEntity(JSON.parse(e));return i.appendInitialData(t,t),t}),o=i.repository.entityCollection.getAllEntities();return null==o||0==o.length?i.repository.entityCollection.loadEntities(r):i.repository.entityCollection.addEntities(r),rxjs.of(t)}))},Sd.prototype.updateEntityDatas=function(e){var t={body:e.ConvertToJson(),responseType:"text"};return this.repository.proxy.request(this.formUpdateUrl,this.formUpdateMethod,null,t).pipe(operators.map(function(e){var t=new runtimeApi.FormUpdateResult;return t.LoadFromJson(e),t}))},Sd.prototype.getSlimBillCreationProcessEntityExes=function(e){if(null==e)throw"args不可为空";if("string"==typeof e){if(""==e)throw"args不可为空";var t=new FormGetBillCreationProcessEntityExArgs;t.LoadFromJson(e),e=t}return this.repository.proxy.request(this.getBillCreationProcessEntityExUrl,this.getBillCreationProcessEntityExMethod,null,{body:e.ConvertToJson(),responseType:"text"}).pipe(operators.map(function(e){var t=new FormGetBillCreationProcessEntityExResult;return t.LoadFromJson(e),t}))},Sd.prototype.appendInitialData=function(e,t){var r=Object.assign({},t);delete r.id,delete r.parentID,e.initialData=r},Sd.decorators=[{type:core$1.Injectable}],Sd.ctorParameters=function(){return[{type:http.HttpClient},{type:devkit.Repository}]},Sd);function Sd(e,t){this.httpClient=e,this.getBillCreationProcessEntityExByIdUrl="/api/runtime/aif/v1.0/manualcreationbill/getbillcreationprocessentityex",this.getBillCreationProcessEntityExByIdMethod="GET",this.getBillCreationProcessEntityExUrl="/api/runtime/aif/v1.0/manualcreationbill/getbillcreationprocessentityexes",this.getBillCreationProcessEntityExMethod="POST",this.executeBillCreationProcessUrl="/api/runtime/aif/v1.0/manualcreationbill/executebillcreationprocess",this.executeBillCreationProcessMethod="POST",this.formCreateUrl="/api/runtime/aif/v1.0/form/create",this.formCreateMethod="POST",this.formUpdateUrl="/api/runtime/aif/v1.0/form/update",this.formUpdateMethod="POST",this.generalTextUrl="/api/runtime/aif/v1.0/generaltext",this.generalTextMethod="GET",this.repository=t}var AbstractBifDataSelectorService=(Se.decorators=[{type:core$1.Injectable}],Se);function Se(){this.subject4EntityDatas=new rxjs.Subject}var DefaultBifDataSelectorService=(Te=AbstractBifDataSelectorService,__extends(Ue,Te),Ue.decorators=[{type:core$1.Injectable}],Ue.ctorParameters=function(){return[{type:devkit.FrameContext},{type:devkit.ViewModel},{type:core$1.ComponentFactoryResolver},{type:core$1.Injector}]},Ue),Te;function Ue(e,t,r,o){var i=Te.call(this)||this;return i.frameContext=e,i.viewModel=t,i.cfr=r,i.injector=o,i.subject4EntityDatas=new rxjs.Subject,i.clickOk4BifSelector=function(){i.viewModel.frameContext.repository.getById(i.viewModel.bindingData.getObject().id).subscribe(function(e){i.subject4EntityDatas.next([e]),i.subject4EntityDatas.complete(),i.bsModalRef4BifSelector.close()})},i.clickClose4BifSelector=function(){i.subject4EntityDatas.complete(),i.bsModalRef4BifSelector.close()},i}var LANG_RESOURCES={"zh-CHS":{confirm:"确定",cancel:"取消",emptyResult:"查询结果为空",selectUpstreamBill:"请选择上游单据",selectDownstreamBill:"请选择下游单据",selectCreationProcess:"请选择生单流程",processDesciption:"流程描述",creationProcessSelector:"生单流程选择",upstreamBillSelector:"上游单据选择",creationExecutionError:"生单规则执行错误",creationResultEmpty:"生单结果为空"},en:{confirm:"confirm",cancel:"cancel",emptyResult:"The result is empty",selectUpstreamBill:"Select upstream bill",selectDownstreamBill:"Select downstream bill",selectCreationProcess:"Select creation process",processDesciption:"Desciption",creationProcessSelector:"CreationRule Selector",upstreamBillSelector:"Upstream Bill Selector",creationExecutionError:"Creation Process Execution Error",creationResultEmpty:"Creation result is empty"},"zh-CHT":{confirm:"確定",cancel:"取消",emptyResult:"查詢結果為空",selectUpstreamBill:"請選擇上遊單據",selectDownstreamBill:"請選擇下遊單據",selectCreationProcess:"請選擇生單流程",processDesciption:"流程描述",creationProcessSelector:"生單流程選擇",upstreamBillSelector:"上遊單據選擇",creationExecutionError:"生單規則執行錯誤",creationResultEmpty:"生單結果為空"}},LocalePipe=(_e.prototype.transform=function(e){return this.lang[e]||e},_e.decorators=[{type:core$1.Pipe,args:[{name:"locale"}]}],_e.ctorParameters=function(){return[{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]}]},_e);function _e(e){this.langCode=e||"zh-CHS",this.lang=LANG_RESOURCES[this.langCode]}var AbstractUiService=(cf.prototype.openBillCreationProcessSelector=function(e,t,r,o,i){var n=this;if("string"==typeof r){if(""==r)throw"modalOptions不可为空";r=JSON.parse(r)}(r=null==r?this.defaultModalOptions:r).title=null==r.title?this.localePipe.transform("creationProcessSelector"):r.title;var a=null;if(null!=o&&""!=o.trim())return rxjs.from(this.loader.load(o)).pipe(operators.switchMap(function(e){var t=e.create(n.frameContext.root.injector).instance.createCreationProcessSelector(n.frameContext.root.injector,i);return t instanceof rxjs.Observable?t.pipe(operators.switchMap(function(e){return a=e,n.configModalButtons(r,a),a.instance.bsModalRef4BifSelector=n.modalService.show(a,r),a.instance.subject4CreationProcess.asObservable()})):t instanceof core$1.ComponentRef?(a=t,n.configModalButtons(r,a),a.instance.bsModalRef4BifSelector=n.modalService.show(a,r),a.instance.subject4CreationProcess.asObservable()):void 0}));var l=this.cfr.resolveComponentFactory(t),s=core$1.ReflectiveInjector.resolveAndCreate([{provide:SELECTOR_ARGS_INJECTOR,useValue:e.ConvertToJsonObject()},uiLoading.LoadingService],this.injector),a=l.create(s);return this.configModalButtons(r,a),a.instance.bsModalRef4BifSelector=this.modalService.show(a,r),a.instance.subject4CreationProcess.asObservable()},cf.prototype.configModalButtons=function(e,t){e.buttons=[{text:this.localePipe.transform("confirm"),cls:"btn btn-primary",handle:t.instance.clickOk4BifSelector},{text:this.localePipe.transform("cancel"),cls:"btn btn-secondary",handle:t.instance.clickClose4BifSelector}],e.showButtons=!0},cf.ctorParameters=function(){return[{type:devkit.FrameContext},{type:uiModal.BsModalService},{type:uiMessager.MessagerService},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.NgModuleFactoryLoader},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:commandServices.RuntimeFrameworkService,decorators:[{type:core$1.Optional}]}]},cf);function cf(e,t,r,o,i,n,a,l){this.frameContext=e,this.modalService=t,this.messager=r,this.injector=o,this.cfr=i,this.loader=n,this.localeId=a,this.defaultModalOptions={title:null,width:650,height:415,buttons:null,showButtons:null},this.runtimeFrameworkService=l||o.get(commandServices.RuntimeFrameworkService),this.localePipe=new LocalePipe(a)}var PushSelectorComponent=(Object.defineProperty(Bf.prototype,"selectedVoId",{get:function(){return this._selectedVoId},set:function(e){null!=(this._selectedVoId=e)&&(this.selectedEntity=this.entityDict[this._selectedVoId][0])},enumerable:!0,configurable:!0}),Bf.prototype.ngOnInit=function(){this.loadItems()},Bf.prototype.loadItems=function(){var t=this;this.loading.show({container:this.elementRef}),(null==this.args.downBillVoId?this.dataService.getSlimBillCreationProcessEntityExesByUpBillVoId4Push(this.args.upBillVoId):this.dataService.getSlimBillCreationProcessEntityExesByUpBillVoIdAndDownBillVoId4SpecificPush(this.args.upBillVoId,this.args.downBillVoId)).subscribe(function(e){e.forEach(function(e){!1===t.voIdList.includes(e.downBillVoId)&&(t.voIdList.push(e.downBillVoId),t.entityDict[e.downBillVoId]=new Array),t.nameDict[e.downBillVoId]=e.downBillVoName,t.entityDict[e.downBillVoId].push(e)}),t.selectedVoId=0<t.voIdList.length?t.voIdList[0]:null,t.loading.close()},function(e){throw t.loading.close(),e})},Bf.decorators=[{type:core$1.Component,args:[{selector:"lib-bif-push-selector",template:'<div class="g-main px-3 py-2">\r\n  \x3c!--  --\x3e\r\n  <div class="form-group" style="height: 150px;overflow-y: auto;">\r\n    <div [hidden]="voIdList.length != 0"><span style="color: red;">{{ \'emptyResult\' | locale }}</span></div>\r\n    <div>{{ \'selectDownstreamBill\' | locale }}</div>\r\n    <div *ngFor="let voId of voIdList;let i=index" class="col-sm-12 col-md-5 form-check form-check-inline">\r\n      <input class="form-check-input" type="radio" [name]="\'voId\'+i" [id]="voId" [value]="voId"\r\n        [(ngModel)]="selectedVoId" />\r\n      <label class="form-check-label" [for]="\'voId\'+i">{{nameDict[voId]}}</label>\r\n    </div>\r\n  </div>\r\n\r\n  \x3c!--  --\x3e\r\n  <div class="form-group" style="">\r\n    <div>{{ \'selectCreationProcess\' | locale }}</div>\r\n    <select class="form-control" name="selectedEntity" [(ngModel)]="selectedEntity">\r\n      <option *ngFor="let cr of entityDict[selectedVoId];" [ngValue]="cr">\r\n        {{cr.name}}({{cr.code}})</option>\r\n    </select>\r\n  </div>\r\n\r\n  \x3c!--  --\x3e\r\n  <div class="form-group" style="">\r\n    <div>{{ \'processDesciption\' | locale }}</div>\r\n    <textarea readonly class="form-control" name="description" rows="3"\r\n      [ngModel]="selectedEntity&&selectedEntity.description"></textarea>\r\n  </div>\r\n</div>',styles:[""]}]}],Bf.ctorParameters=function(){return[{type:undefined,decorators:[{type:core$1.Inject,args:[SELECTOR_ARGS_INJECTOR]}]},{type:BifDataService},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:uiLoading.LoadingService},{type:core$1.ElementRef}]},Bf);function Bf(e,t,r,o,i){var n=this;this.dataService=t,this.loading=o,this.elementRef=i,this.voIdList=[],this.nameDict={},this.entityDict={},this.bsModalRef4BifSelector=null,this.subject4CreationProcess=new rxjs.Subject,this.clickOk4BifSelector=function(){n.subject4CreationProcess.next(n.selectedEntity),n.subject4CreationProcess.complete(),n.bsModalRef4BifSelector.close()},this.clickClose4BifSelector=function(){n.bsModalRef4BifSelector.close()},this.args=new FormGetBillCreationProcessEntityExArgs,this.args.LoadFromJsonObject(e)}function judgeBrowserType(){var e,t={type:"Unknown",IEVersion:undefined},r=navigator.userAgent,o=-1<r.indexOf("Opera"),i=(i=-1<r.indexOf("compatible")&&-1<r.indexOf("MSIE")&&!o)||!!window.ActiveXObject||"ActiveXObject"in window,n=-1<r.indexOf("Windows NT 6.1; Trident/7.0;")&&!i,a=-1<r.indexOf("Firefox"),l=-1<r.indexOf("Safari")&&-1==r.indexOf("Chrome"),s=-1<r.indexOf("Chrome")&&-1<r.indexOf("Safari");return i&&(t.type="IE",null!=navigator.userAgent&&navigator.userAgent.match(/Trident\/7\./)?t.IEVersion="IE11":(new RegExp("MSIE (\\d+\\.\\d+);").test(r),e=parseFloat(RegExp.$1),t.IEVersion=7==e?"IE7":8==e?"IE8":9==e?"IE9":10==e?"IE10":11==e?"IE11":"Unknown")),a&&(t.type="FF"),o&&(t.type="Opera"),l&&(t.type="Safari"),s&&(t.type="Chrome"),n&&(t.type="Edge"),t}var BifSourceUiService=(Zf=AbstractUiService,__extends($f,Zf),$f.prototype.openBillCreationProcessSelector4Push=function(e,t,r,o,i){var n=new FormGetBillCreationProcessEntityExArgs;return n.upBillVoId=e,n.manualCreationMode=ManualCreationMode.Push,this.openBillCreationProcessSelector(n,PushSelectorComponent,r,o,i)},$f.prototype.openBillCreationProcessSelector4SpecificPush=function(e,t,r,o,i,n){var a=new FormGetBillCreationProcessEntityExArgs;return a.upBillVoId=e,a.downBillVoId=t,a.manualCreationMode=ManualCreationMode.SpecificPush,this.openBillCreationProcessSelector(a,PushSelectorComponent,o,i,n)},$f.prototype.openTargetForm=function(e,t,r){var o,i,n;if(null==e)throw"参数formSettings不可为空";if(null==t)throw"参数creationResult不可为空";if("string"==typeof t){if(""==t)throw"参数creationResult不可为空";var a=new FormBillCreationProcessExecutorResult;a.LoadFromJson(t),t=a}if(t instanceof FormBillCreationProcessExecutorResult==0&&((n=new FormBillCreationProcessExecutorResult).LoadFromJsonObject(t),t=n),0!=t.conditionResult.conditionExecutionResult)if(null!=t.creationRuleExecutorResult&&null!=t.creationRuleExecutorResult.mappingResults&&0!=t.creationRuleExecutorResult.mappingResults.length)if(1==t.creationRuleExecutorResult.mappingResults.length)this.openApp(t.creationRuleExecutorResult.mappingResults[0].associations[0].tarDataId,e.targetCardAppId,e.targetCardAppEntrance,t,r,!1);else{if(null!=e.targetListAppId)throw"暂不支持打开批量编辑界面";try{for(var l=__values(t.creationRuleExecutorResult.mappingResults),s=l.next();!s.done;s=l.next()){var c=s.value,p=new FormBillCreationProcessExecutorResult;p.conditionResult=t.conditionResult,p.creationRuleExecutorResult=new runtimeApi.RpcCreationRuleExecutorResult,p.creationRuleExecutorResult.bizFlowchartId=t.creationRuleExecutorResult.bizFlowchartId,p.creationRuleExecutorResult.creationRuleId=t.creationRuleExecutorResult.creationRuleId,p.creationRuleExecutorResult.creationRuleInstanceId=t.creationRuleExecutorResult.creationRuleInstanceId,p.creationRuleExecutorResult.mappingResults=[c],this.openApp(c.associations[0].tarDataId,e.targetCardAppId,e.targetCardAppEntrance,p,r,!1)}}catch(d){o={error:d}}finally{try{s&&!s.done&&(i=l["return"])&&i.call(l)}finally{if(o)throw o.error}}}else this.messager.error(this.localePipe.transform("creationResultEmpty"));else this.messager.error(t.conditionResult.message||this.localePipe.transform("creationExecutionError"))},$f.prototype.openApp=function(e,t,r,o,i,n,a,l,s){var c=judgeBrowserType();"IE"==c.type&&"IE11"==c.IEVersion?(window.top.localStorage.setItem(e,o.ConvertToJson()),this.navigationService.openApp(e,t,r,i,n,a,l,s)):this.navigationService.openApp(e,t,r,this.buildRouteParams(o,i),n,a,l,s)},$f.prototype.buildRouteParams=function(e,t){var r=t;return r[this.uiStateKeyCreationResult]=e.ConvertToJson(),r},$f.decorators=[{type:core$1.Injectable}],$f.ctorParameters=function(){return[{type:commandServices.NavigationService},{type:devkit.FrameContext},{type:uiModal.BsModalService},{type:uiMessager.MessagerService},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.NgModuleFactoryLoader},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:commandServices.RuntimeFrameworkService,decorators:[{type:core$1.Optional}]}]},$f),Zf;function $f(e,t,r,o,i,n,a,l,s){var c=Zf.call(this,t,r,o,i,n,a,l,s)||this;return c.navigationService=e,c.frameContext=t,c.modalService=r,c.messager=o,c.injector=i,c.cfr=n,c.loader=a,c.localeId=l,c.uiStateKeyCreationResult=BIF_UISTATE_KEY_CREATION_RESULT,c}var PullSelectorComponent=(Object.defineProperty(Wg.prototype,"selectedVoId",{get:function(){return this._selectedVoId},set:function(e){null!=(this._selectedVoId=e)&&(this.selectedEntity=this.entityDict[this._selectedVoId][0])},enumerable:!0,configurable:!0}),Wg.prototype.ngOnInit=function(){this.loadItems()},Wg.prototype.loadItems=function(){var t=this;this.loading.show({container:this.elementRef}),(null==this.args.upBillVoId?this.dataService.getSlimBillCreationProcessEntityExesByDownBillVoId4Pull(this.args.downBillVoId):this.dataService.getSlimBillCreationProcessEntityExesByUpBillVoIdAndDownBillVoId4SpecificPull(this.args.upBillVoId,this.args.downBillVoId)).subscribe(function(e){e.forEach(function(e){!1===t.voIdList.includes(e.upBillVoId)&&(t.voIdList.push(e.upBillVoId),t.entityDict[e.upBillVoId]=new Array),t.nameDict[e.upBillVoId]=e.upBillVoName,t.entityDict[e.upBillVoId].push(e)}),t.selectedVoId=0<t.voIdList.length?t.voIdList[0]:null,t.loading.close()},function(e){throw t.loading.close(),e})},Wg.decorators=[{type:core$1.Component,args:[{selector:"lib-bif-pull-selector",template:'<div class="g-main px-3 py-2">\r\n  \x3c!--  --\x3e\r\n  <div class="form-group" style="height: 150px;overflow-y: auto;">\r\n    <div [hidden]="voIdList.length != 0"><span style="color: red;">{{ \'emptyResult\' | locale }}</span></div>\r\n    <div>{{ \'selectUpstreamBill\' | locale }}</div>\r\n    <div *ngFor="let voId of voIdList;let i=index" class="col-sm-12 col-md-5 form-check form-check-inline">\r\n      <input class="form-check-input" type="radio" [name]="\'voId\'+i" [id]="voId" [value]="voId"\r\n        [(ngModel)]="selectedVoId" />\r\n      <label class="form-check-label" [for]="\'voId\'+i">{{nameDict[voId]}}</label>\r\n    </div>\r\n  </div>\r\n\r\n  \x3c!--  --\x3e\r\n  <div class="form-group" style="">\r\n    <div>{{ \'selectCreationProcess\' | locale }}</div>\r\n    <select class="form-control" name="selectedEntity" [(ngModel)]="selectedEntity">\r\n      <option *ngFor="let cr of entityDict[selectedVoId];" [ngValue]="cr">\r\n        {{cr.name}}({{cr.code}})</option>\r\n    </select>\r\n  </div>\r\n\r\n  \x3c!--  --\x3e\r\n  <div class="form-group" style="">\r\n    <div>{{ \'processDesciption\' | locale }}</div>\r\n    <textarea readonly class="form-control" name="description" rows="3"\r\n      [ngModel]="selectedEntity&&selectedEntity.description"></textarea>\r\n  </div>\r\n</div>',styles:[""]}]}],Wg.ctorParameters=function(){return[{type:undefined,decorators:[{type:core$1.Inject,args:[SELECTOR_ARGS_INJECTOR]}]},{type:BifDataService},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:uiLoading.LoadingService},{type:core$1.ElementRef}]},Wg);function Wg(e,t,r,o,i){var n=this;this.dataService=t,this.loading=o,this.elementRef=i,this.voIdList=[],this.nameDict={},this.entityDict={},this.bsModalRef4BifSelector=null,this.subject4CreationProcess=new rxjs.Subject,this.clickOk4BifSelector=function(){n.subject4CreationProcess.next(n.selectedEntity),n.subject4CreationProcess.complete(),n.bsModalRef4BifSelector.close()},this.clickClose4BifSelector=function(){n.bsModalRef4BifSelector.close()},this.args=new FormGetBillCreationProcessEntityExArgs,this.args.LoadFromJsonObject(e)}var BifTargetUiService=(ih=AbstractUiService,__extends(jh,ih),jh.prototype.openBillCreationProcessSelector4Pull=function(e,t,r,o,i){var n=new FormGetBillCreationProcessEntityExArgs;return n.downBillVoId=e,n.manualCreationMode=ManualCreationMode.Pull,this.openBillCreationProcessSelector(n,PullSelectorComponent,r,o,i)},jh.prototype.openBillCreationProcessSelector4SpecificPull=function(e,t,r,o,i,n){var a=new FormGetBillCreationProcessEntityExArgs;return a.upBillVoId=e,a.downBillVoId=t,a.manualCreationMode=ManualCreationMode.SpecificPull,this.openBillCreationProcessSelector(a,PullSelectorComponent,o,i,n)},jh.prototype.openSourceDataSelector4Pull=function(i,n,a){var l=this;(n=null==n?this.defaultModalOptions:n).title=null==n.title?this.localePipe.transform("sourceDataSelector"):n.title;var s=null;if(null==i||null==i.sourceDataSelectorModuleUrl)throw"暂无默认实现，请使用自定义来源单据选择器";return(null!=i.sourceDataSelectorAppId?rxjs.from(System["import"](i.sourceDataSelectorModuleUrl.toLowerCase()).then(function(e){return e})).pipe(operators.switchMap(function(e){for(var t in e)return rxjs.of(e[t]);return rxjs.of(null)})):rxjs.from(this.loader.load(i.sourceDataSelectorModuleUrl))).pipe(operators.switchMap(function(e){var t=e.create(l.frameContext.root.injector);if(!(t.instance.createSourceDataSelector&&t.instance.createSourceDataSelector instanceof Function)){var r=t.injector.get(core.TranslateService);return r.getTranslation(l.localeId).pipe(operators.switchMap(function(e){return r.setTranslation(l.localeId,e),r.defaultLang=l.localeId,r.currentLang=l.localeId,l.getEntityData(t,i,n,a)}),operators.catchError(function(e){return console.error(e),l.getEntityData(t,i,n,a)}))}var o=t.instance.createSourceDataSelector(l.frameContext.root.injector,null,a);return o instanceof rxjs.Observable?o.pipe(operators.switchMap(function(e){return s=e,l.configModalButtons(n,s),s.instance.bsModalRef4BifSelector=l.modalService.show(s,n),s.instance.subject4EntityDatas.asObservable()})):o instanceof core$1.ComponentRef?(s=o,l.configModalButtons(n,s),s.instance.bsModalRef4BifSelector=l.modalService.show(s,n),s.instance.subject4EntityDatas.asObservable()):void 0}))},jh.prototype.getFormBillCreationProcessExecutorResult=function(){var e,t=this.runtimeFrameworkService.tabId,r=t.substr(t.length-36),o=judgeBrowserType();"IE"==o.type&&"IE11"==o.IEVersion&&(e=window.top.localStorage.getItem(r),window.top.localStorage.removeItem(r),this.frameContext.root.uiState.setPropertyValue(this.uiStateKeyCreationResult,e));var i=this.frameContext.root.uiState[this.uiStateKeyCreationResult];if(null==i)throw"FormBillCreationProcessExecutorResult is null";var n=new FormBillCreationProcessExecutorResult;if("string"==typeof i)n.LoadFromJson(i);else{if("object"!=typeof i)throw"不合法的类型";n.LoadFromJsonObject(i)}return n},jh.prototype.configModalButtonsByService=function(e,t){e.buttons=[{text:this.localePipe.transform("confirm"),cls:"btn btn-primary",handle:t.clickOk4BifSelector},{text:this.localePipe.transform("cancel"),cls:"btn btn-secondary",handle:t.clickClose4BifSelector}],e.showButtons=!0},jh.prototype.getEntityData=function(i,e,t,r){var n=null,a=null,l="app-rootcomponent",o=null,s=i.componentFactoryResolver._factories;r&&r.bootstrapComponentSelector?(l=r.bootstrapComponentSelector,s.forEach(function(e,t,r){var o=e.selector;l==o&&(n=i.componentFactoryResolver.resolveComponentFactory(t),a=n.create(i.injector))})):(o=i._bootstrapComponents[0])?(n=i.componentFactoryResolver.resolveComponentFactory(o),a=n.create(i.injector)):s.forEach(function(e,t,r){var o=e.selector;l==o&&(n=i.componentFactoryResolver.resolveComponentFactory(t),a=n.create(i.injector))});var c=a.injector.get(AbstractBifDataSelectorService,null);return null!=c?(this.configModalButtonsByService(t,c),c.bsModalRef4BifSelector=this.modalService.show(a,t),c.subject4EntityDatas.asObservable()):(this.configModalButtons(t,a),a.instance.bsModalRef4BifSelector=this.modalService.show(a,t),a.instance.subject4EntityDatas.asObservable())},jh.decorators=[{type:core$1.Injectable}],jh.ctorParameters=function(){return[{type:BifDataService},{type:devkit.FrameContext},{type:uiModal.BsModalService},{type:uiMessager.MessagerService},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.NgModuleFactoryLoader},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:commandServices.RuntimeFrameworkService,decorators:[{type:core$1.Optional}]}]},jh),ih;function jh(e,t,r,o,i,n,a,l,s){var c=ih.call(this,t,r,o,i,n,a,l,s)||this;return c.dataService=e,c.frameContext=t,c.modalService=r,c.messager=o,c.injector=i,c.cfr=n,c.loader=a,c.localeId=l,c.uiStateKeyCreationResult=BIF_UISTATE_KEY_CREATION_RESULT,c}var ɵ0=localStorage.getItem("languageCode")||"zh-CHS",ɵ1={},BifManualCreationModule=(vi.forRoot=function(e){return{ngModule:vi,providers:[{provide:ModuleConfig,useValue:e||{}},BifDataService,BifSourceUiService,BifTargetUiService]}},vi.decorators=[{type:core$1.NgModule,args:[{declarations:[PushSelectorComponent,PullSelectorComponent,LocalePipe],imports:[common.CommonModule,forms.FormsModule,http.HttpClientModule,uiModal.ModalModule.forRoot(),uiNotify.NotifyModule.forRoot(),uiMessager.MessagerModule.forRoot(),uiDialog.FarrisDialogModule.forRoot(),uiLoading.LoadingModule.forRoot()],providers:[{provide:core$1.LOCALE_ID,useValue:ɵ0},{provide:ModuleConfig,useValue:ɵ1},{provide:core$1.NgModuleFactoryLoader,useClass:core$1.SystemJsNgModuleLoader},BifDataService,BifSourceUiService,BifTargetUiService],exports:[PushSelectorComponent,PullSelectorComponent],entryComponents:[PushSelectorComponent,PullSelectorComponent]}]}],vi);function vi(){}var CanTrackingResult=(yi=CanTrackingInfo,__extends(zi,yi),zi.prototype.ResetBeforeLoadFrom=function(){yi.prototype.ResetBeforeLoadFrom.call(this),this.billTrackingSettings=null,this.voName=null},zi.prototype.ConvertToJsonObject=function(){var e=yi.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"billTrackingSettings",this.billTrackingSettings),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"voName",this.voName),e},zi.prototype.LoadFromJsonObject=function(e){yi.prototype.LoadFromJsonObject.call(this,e),this.billTrackingSettings=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"billTrackingSettings"),this.voName=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"voName")},zi),yi;function zi(){return null!==yi&&yi.apply(this,arguments)||this}var GetChildrenEntityDataArgs=(Ci=commonApi.JsonConvertableImpl,__extends(Di,Ci),Di.prototype.ResetBeforeLoadFrom=function(){Ci.prototype.ResetBeforeLoadFrom.call(this),this.voId=null,this.voMetadataId=null,this.suCode=null,this.nodeCodes=null,this.hierachyIdList=null},Di.prototype.ConvertToJsonObject=function(){var e=Ci.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"voId",this.voId),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"voMetadataId",this.voMetadataId),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"suCode",this.suCode),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"nodeCodes",commonApi.BpmnModelJsonHelper.StringListToJson(this.nodeCodes)),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"hierachyIdList",commonApi.BpmnModelJsonHelper.StringListToJson(this.hierachyIdList)),e},Di.prototype.LoadFromJsonObject=function(e){Ci.prototype.LoadFromJsonObject.call(this,e),this.voId=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"voId"),this.voMetadataId=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"voMetadataId"),this.suCode=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"suCode"),this.nodeCodes=commonApi.BpmnModelJsonHelper.StringListFromJson(commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"nodeCodes")),this.hierachyIdList=commonApi.BpmnModelJsonHelper.StringListFromJson(commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"hierachyIdList"))},Di),Ci;function Di(){return null!==Ci&&Ci.apply(this,arguments)||this}var DownBillInfoResult=(Gi=DownBillInfo,__extends(Hi,Gi),Hi.prototype.ResetBeforeLoadFrom=function(){Gi.prototype.ResetBeforeLoadFrom.call(this),this.voName=null},Hi.prototype.ConvertToJsonObject=function(){var e=Gi.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"voName",this.voName),e},Hi.prototype.LoadFromJsonObject=function(e){Gi.prototype.LoadFromJsonObject.call(this,e),this.voName=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"voName")},Hi),Gi;function Hi(){return null!==Gi&&Gi.apply(this,arguments)||this}var EntityDataResult=(Ki=commonApi.JsonConvertableImpl,__extends(Li,Ki),Li.prototype.ResetBeforeLoadFrom=function(){Ki.prototype.ResetBeforeLoadFrom.call(this),this.billSchema=null,this.billData=null},Li.prototype.ConvertToJsonObject=function(){var e=Ki.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"billSchema",this.billSchema),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"billData",this.billData),e},Li.prototype.LoadFromJsonObject=function(e){Ki.prototype.LoadFromJsonObject.call(this,e),this.billSchema=commonApi.BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(e,"billSchema",commonApi.BillSchema),this.billData=commonApi.BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(e,"billData",commonApi.BillData)},Li),Ki;function Li(){return null!==Ki&&Ki.apply(this,arguments)||this}var GetEntityDataArgs=(Oi=commonApi.JsonConvertableImpl,__extends(Pi,Oi),Pi.prototype.ResetBeforeLoadFrom=function(){Oi.prototype.ResetBeforeLoadFrom.call(this),this.schemaId=null,this.dataId=null,this.suCode=null,this.voMetadataId=null,this.billChildInfos=[],this.trackingSourceType=null,this.curYear=null},Pi.prototype.ConvertToJsonObject=function(){var e=Oi.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"schemaId",this.schemaId),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"dataId",this.dataId),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"suCode",this.suCode),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"voMetadataId",this.voMetadataId),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"billChildInfos",this.billChildInfos),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"trackingSourceType",this.trackingSourceType),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"curYear",this.curYear),e},Pi.prototype.LoadFromJsonObject=function(e){Oi.prototype.LoadFromJsonObject.call(this,e),this.schemaId=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"schemaId"),this.dataId=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"dataId"),this.suCode=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"suCode"),this.voMetadataId=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"voMetadataId"),this.billChildInfos=commonApi.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billChildInfos",BillChildInfo),this.trackingSourceType=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"trackingSourceType"),this.curYear=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"curYear")},Pi),Oi;function Pi(){var e=null!==Oi&&Oi.apply(this,arguments)||this;return e.billChildInfos=[],e}var GetMainEntityDataArgs=(Ti=GetEntityDataArgs,__extends(Ui,Ti),Ui),Ti;function Ui(){return null!==Ti&&Ti.apply(this,arguments)||this}var UpBillInfoResult=(Vi=UpBillInfo,__extends(Wi,Vi),Wi.prototype.ResetBeforeLoadFrom=function(){Vi.prototype.ResetBeforeLoadFrom.call(this),this.voName=null},Wi.prototype.ConvertToJsonObject=function(){var e=Vi.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"voName",this.voName),e},Wi.prototype.LoadFromJsonObject=function(e){Vi.prototype.LoadFromJsonObject.call(this,e),this.voName=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"voName")},Wi),Vi;function Wi(){return null!==Vi&&Vi.apply(this,arguments)||this}var GetJointQueryParametersArgs=(Zi=commonApi.JsonConvertableImpl,__extends($i,Zi),$i.prototype.ResetBeforeLoadFrom=function(){Zi.prototype.ResetBeforeLoadFrom.call(this),this.trackingSourceType=null,this.suCode=null,this.schemaId=null,this.dataId=null,this.contents=[]},$i.prototype.ConvertToJsonObject=function(){var e=Zi.prototype.ConvertToJsonObject.call(this);return commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"trackingSourceType",this.trackingSourceType),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"suCode",this.suCode),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"schemaId",this.schemaId),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"dataId",this.dataId),commonApi.BpmnModelJsonHelper.SetAttributeValue(e,"contents",this.contents),e},$i.prototype.LoadFromJsonObject=function(e){Zi.prototype.LoadFromJsonObject.call(this,e),this.trackingSourceType=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"trackingSourceType"),this.suCode=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"suCode"),this.schemaId=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"schemaId"),this.dataId=commonApi.BpmnModelJsonHelper.GetAttributeValueAsString(e,"dataId"),this.contents=commonApi.BpmnModelJsonHelper.GetAttributeValueAsList(e,"contents",JointQueryParametersContent)},$i),Zi;function $i(){var e=null!==Zi&&Zi.apply(this,arguments)||this;return e.contents=[],e}var BillTrackerArgs=(cj.decorators=[{type:core$1.Injectable}],cj.ctorParameters=function(){return[]},cj);function cj(){this.getBillsInfoArgs=null,this.canTrackingResult=null,this.direction=null,this.graphOptions=null,this.gridOptions=null}var BillTrackerConstant=(dj.IMAGE_PATH="/platform/runtime/common/web/@edp-bif/runtime-api/images",dj.DEFAULT_FUNC_ID="DefaultBillTracker",dj.DEFAULT_APP_ID="BillIntegrationFrameworkRT",dj.DEFAULT_APP_ENTRANCE="default-bill-tracker",dj.BILL_VIEWER_FUNC_ID="BifBillViewer",dj.BILL_VIEWER_APP_ID="BillIntegrationFrameworkRT",dj.BILL_VIEWER_APP_ENTRANCE="bif-bill-viewer",dj);function dj(){}var BillTrackerModuleConfig=function(){},BillTrackerDirection={Down:"Down",Up:"Up",Both:"Both"},BillTrackerGraphOptions=function(){this.nodeWidth=100,this.nodeHeight=60,this.overlayWidth=10,this.overlayHeight=10,this.showDownBills=!0,this.showUpBills=!0},BillTrackerGridOptions=function(){this.showEntryData=!0,this.defaultHeight=180},GraphView=(hj=mxGraphViewType,__extends(ij,hj),ij.prototype.validate=function(e){var t,r,o=this.graph;null!=o&&null!=o.container&&mxUtilsType.hasScrollbars(o.container)&&(t=o.getPagePadding(),r=o.getPageSize(),this.translate.x,this.translate.y,this.translate.x=t.x/this.scale-(this.x0||0)*r.width,this.translate.y=t.y/this.scale-(this.y0||0)*r.height),hj.prototype.validate.call(this,e)},ij.prototype.getBackgroundPageBounds=function(){var e=this.graph,t=e.getPageLayout(),r=e.getPageSize();return new mxRectangleType(this.scale*(this.translate.x+t.x*r.width),this.scale*(this.translate.y+t.y*r.height),this.scale*t.width*r.width,this.scale*t.height*r.height)},ij),hj;function ij(e){var t=hj.call(this,e)||this;return t.gridSteps=4,t.minGridSize=4,t.gridImage=mxClientType.IS_SVG?"data:image/gif;base64,R0lGODlhCgAKAJEAAAAAAP///8zMzP///yH5BAEAAAMALAAAAAAKAAoAAAIJ1I6py+0Po2wFADs=":BillTrackerConstant.IMAGE_PATH+"/grid.gif",t.gridColor="#e0e0e0",t}var BillNodeShape=(uj=mxRectangleShapeType,__extends(vj,uj),vj.prototype.init=function(e){uj.prototype.init.call(this,e),this.fill="none",this.stroke="#000000"},vj),uj;function vj(e,t,r,o){return e=e||new mxRectangleType(0,0,0,0),t=t||"none",r=r||"#000000",o=o||undefined,uj.call(this,e,t,r,o)||this}var BillAssociationLine=(Cj=mxLineType,__extends(Dj,Cj),Dj),Cj;function Dj(e,t,r){return Cj.call(this,e,t,r)||this}var Events=(Hj.RESET_GRAPH_VIEW="resetGraphView",Hj.CLICK_FIRST_SUMMARY="clickFirstSummary",Hj.BILL_CELLS_ADDED_AND_MOVED="billCellsAddedAndMoved",Hj);function Hj(){}var BillCell=(Ij=mxCellType,__extends(Jj,Ij),Jj.prototype.getCaption=function(){var e=new commonApi$1.BillTrackingSettings;return this.billInfo&&this.billInfo.billTrackingSettings&&e.LoadFromJson(this.billInfo.billTrackingSettings),this.billDataInfo.caption||e.billNodeName||this.billInfo.voName||this.billDataInfo.dataId||this.billDataInfo.summary},Jj.prototype.buildHtmlTooltip=function(){return"            <span>"+this.billDataInfo.dataId+"</span>        "},Jj.prototype.buildHtmlLabel=function(e){return this.buildHtmlLabelByDOM(e)},Jj.prototype.buildHtmlLabelByDOM=function(c){var p=this,e=c.view.scale,t=(c.view.getState(this),this.geometry.width),r=this.geometry.height,o=new commonApi$1.BillTrackingSettings;this.billInfo&&this.billInfo.billTrackingSettings&&o.LoadFromJson(this.billInfo.billTrackingSettings);var i,n,a=this.billDataInfo.caption||o.billNodeName||this.billInfo.voName||this.billDataInfo.dataId||this.billDataInfo.summary,l=this.entry,s=document.createElement("div");if(s.classList.add("bif-cell-node"),s.style.width=t+"px",s.style.height=r+"px",l&&(i=document.createElement("div"),s.appendChild(i),i.classList.add("bif-cell-node-current"),n=document.createElement("span"),i.appendChild(n),n.classList.add("bif-cell-node-current-text"),n.innerHTML="当前"),e<this.THUMB_SCALE){var d=document.createElement("div");s.appendChild(d),d.classList.add("bif-cell-node-title-only");var u=document.createElement("div");d.appendChild(u),u.classList.add("bif-cell-node-title-only-text"),u.innerHTML=a;var m=this.billInfo.jointQueryMode,h=JSON.parse(this.billInfo.jointQueryParameters);(m==commonApi$1.JointQueryMode.APP&&h.funcId||m==commonApi$1.JointQueryMode.URL&&h.url)&&(u.classList.add("bif-cell-node-title-link"),mxEventType.addListener(u,"click",function(){return c.fireEvent(new mxEventObjectType(Events.CLICK_FIRST_SUMMARY,"cell",p)),event.stopPropagation(),!1}))}else{var y=document.createElement("div");s.appendChild(y),y.classList.add("bif-cell-node-main");var f=document.createElement("div");y.appendChild(f),f.classList.add("bif-cell-node-title");var g=document.createElement("div");f.appendChild(g),g.classList.add("bif-cell-node-title-text"),g.innerHTML=a;var x=document.createElement("div");y.appendChild(x),x.classList.add("bif-cell-node-summary-list"),x.style.minHeight=r-46+"px";try{var v=commonApi.BpmnModelJsonHelper.FromJson(this.billDataInfo.summary,FieldNameAndValue);v&&v.forEach(function(e,t){var r=document.createElement("div");x.appendChild(r),r.classList.add("bif-cell-node-summary");var o=document.createElement("div");r.appendChild(o),o.classList.add("bif-cell-node-summary-caption");var i=document.createElement("div");o.appendChild(i),i.classList.add("bif-cell-node-summary-caption-text"),i.title=e.name,i.innerHTML=e.name;var n=document.createElement("div");r.appendChild(n),n.classList.add("bif-cell-node-summary-value");var a,l,s=document.createElement("div");n.appendChild(s),s.classList.add("bif-cell-node-summary-value-text"),s.title=e.value,s.innerText=e.value,0==t&&(a=p.billInfo.jointQueryMode,l=JSON.parse(p.billInfo.jointQueryParameters),(a==commonApi$1.JointQueryMode.APP&&l.funcId||a==commonApi$1.JointQueryMode.URL&&l.url)&&(s.classList.add("bif-cell-node-title-link","bif-cell-node-title-link-color"),mxEventType.addListener(s,"click",function(){return c.fireEvent(new mxEventObjectType(Events.CLICK_FIRST_SUMMARY,"cell",p)),event.stopPropagation(),!1})))})}catch(b){console.error(b)}}return s},Jj.prototype.buildHtmlLabelByTemplateText=function(e){var t=e.view.getState(this),r=t&&t.width?t.width:this.geometry.width,o=t&&t.height?t.height:this.geometry.height,i=new commonApi$1.BillTrackingSettings;this.billInfo&&this.billInfo.billTrackingSettings&&i.LoadFromJson(this.billInfo.billTrackingSettings);var n=this.billDataInfo.caption||i.billNodeName||this.billInfo.voName||this.billDataInfo.dataId||this.billDataInfo.summary,a=this.entry?"rgba(86,160,255,0.08)":"#FFFFFF",l="";try{var s=commonApi.BpmnModelJsonHelper.FromJson(this.billDataInfo.summary,FieldNameAndValue);s&&s.forEach(function(e,t){var r=0==t?"<a href='javascript:void(0);'>"+e.value+"</a>":e.value;l+='                        <div class="bif-cell-node-summary">                            <div class="bif-cell-node-summary-caption">                                <div class="bif-cell-node-summary-caption-text" title="'+e.name+'">'+e.name+'</div>                            </div>                            <div class="bif-cell-node-summary-value">                                <div class="bif-cell-node-summary-value-text" title="'+e.value+'">'+r+"</div>                            </div>                        </div>                    "})}catch(c){console.error(c)}return'            <div class="bif-cell-node" style="width:'+r+'px;">                <div class="bif-cell-node-main" style="background: '+a+';">                    <div class="bif-cell-node-title">                        <div class="bif-cell-node-title-text">'+n+'</div>                    </div>                    <div class="bif-cell-node-summary-list" style="min-height: '+(o-30)+'px;">                        '+l+"                    </div>                </div>            </div>        "},Jj),Ij;function Jj(e,t,r,o,i){var n=Ij.call(this,null,o,i)||this;n.THUMB_SCALE=.6,n.billDataInfo=e,n.billInfo=t;var a=new commonApi$1.BillTrackingSettings;return t&&t.billTrackingSettings&&a.LoadFromJson(t.billTrackingSettings),n.entry=r,n}var Base64=(Ok.encode=function(e,t){var r,o,i,n,a,l,s,c="",p=0;for((t=null!=t&&t)||(e=Ok._utf8_encode(e));p<e.length;)n=(r=e.charCodeAt(p++))>>2,a=(3&r)<<4|(o=e.charCodeAt(p++))>>4,l=(15&o)<<2|(i=e.charCodeAt(p++))>>6,s=63&i,isNaN(o)?l=s=64:isNaN(i)&&(s=64),c=c+Ok._keyStr.charAt(n)+Ok._keyStr.charAt(a)+Ok._keyStr.charAt(l)+Ok._keyStr.charAt(s);return c},Ok._utf8_encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var o=e.charCodeAt(r);o<128?t+=String.fromCharCode(o):(127<o&&o<2048?t+=String.fromCharCode(o>>6|192):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128)),t+=String.fromCharCode(63&o|128))}return t},Ok.decode=function(e,t){t=null!=t&&t;var r,o,i,n,a,l,s="",c=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)r=this._keyStr.indexOf(e.charAt(c++))<<2|(n=this._keyStr.indexOf(e.charAt(c++)))>>4,o=(15&n)<<4|(a=this._keyStr.indexOf(e.charAt(c++)))>>2,i=(3&a)<<6|(l=this._keyStr.indexOf(e.charAt(c++))),s+=String.fromCharCode(r),64!=a&&(s+=String.fromCharCode(o)),64!=l&&(s+=String.fromCharCode(i));return t||(s=Ok._utf8_decode(s)),s},Ok._utf8_decode=function(e){for(var t="",r=0,o=0,i=0,n=0;r<e.length;)(o=e.charCodeAt(r))<128?(t+=String.fromCharCode(o),r++):191<o&&o<224?(i=e.charCodeAt(r+1),t+=String.fromCharCode((31&o)<<6|63&i),r+=2):(i=e.charCodeAt(r+1),n=e.charCodeAt(r+2),t+=String.fromCharCode((15&o)<<12|(63&i)<<6|63&n),r+=3);return t},Ok._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Ok);function Ok(){}var VertexHandler=(tl=mxVertexHandlerType,__extends(ul,tl),ul.prototype.getSelectionBounds=function(e){return tl.prototype.getSelectionBounds.call(this,e)},ul.prototype.redrawHandles=function(){tl.prototype.redrawHandles.call(this),null!=this.sizers&&7<this.sizers.length&&(this.sizers[1].node.style.display="none",this.sizers[3].node.style.display="none",this.sizers[4].node.style.display="none",this.sizers[6].node.style.display="none")},ul.prototype.createSelectionShape=function(e){if(this.state.cell instanceof BillCell){var t=new mxRectangleShapeType(mxRectangleType.fromRectangle(e),null,this.getSelectionColor());return t.strokewidth=this.getSelectionStrokeWidth(),t.isDashed=this.isSelectionDashed(),t.isRounded=!0,t.style=t.style||[],t.style[mxConstantsType.STYLE_ARCSIZE]=4*this.state.view.scale,t}return tl.prototype.createSelectionShape.call(this,e)},ul),tl;function ul(e){return tl.call(this,e)||this}var Styles=(zl.STYLE_BILL_NODE_NAME="billNode",zl.STYLE_BILL_NODE_ENTRY_NAME="billNodeEntry",zl.STYLE_BILL_ASSOCIATION_NAME="billAssociation",zl);function zl(){}mxCellRendererType.registerShape("billNodeShape",BillNodeShape),mxCellRendererType.registerShape("billAssociationLine",BillAssociationLine);var Graph=(Al=mxGraphType,__extends(Bl,Al),Bl.prototype.createGraphView=function(){return new GraphView(this)},Bl.prototype.createVertexHandler=function(e){return new VertexHandler(e)},Bl.prototype.getPagePadding=function(){return new mxPointType(Math.max(0,Math.round(this.container.offsetWidth-34)),Math.max(0,Math.round(this.container.offsetHeight-34)))},Bl.prototype.getPageSize=function(){return this.pageVisible?new mxRectangleType(0,0,this.pageFormat.width*this.pageScale,this.pageFormat.height*this.pageScale):this.getScrollTileSize()},Bl.prototype.getPageLayout=function(){var e=this.pageVisible?this.getPageSize():this.getScrollTileSize(),t=this.getGraphBounds();if(0==t.width||0==t.height)return new mxRectangleType(0,0,1,1);var r=Math.ceil(t.x/this.view.scale-this.view.translate.x),o=Math.ceil(t.y/this.view.scale-this.view.translate.y),i=Math.floor(t.width/this.view.scale),n=Math.floor(t.height/this.view.scale),a=Math.floor(r/e.width),l=Math.floor(o/e.height),s=Math.ceil((r+i)/e.width)-a,c=Math.ceil((o+n)/e.height)-l;return new mxRectangleType(a,l,s,c)},Bl.prototype.getScrollTileSize=function(){return null==this.scrollTileSize&&(this.scrollTileSize=new mxRectangleType(0,0,400,600)),this.scrollTileSize},Bl.prototype.getPreferredPageSize=function(e,t,r){var o=this.getPageLayout(),i=this.getPageSize();return new mxRectangleType(0,0,o.width*i.width,o.height*i.height)},Bl.prototype.sizeDidChange=function(){if(null!=this.container&&mxUtilsType.hasScrollbars(this.container)){var e=this.getPageLayout(),t=this.getPagePadding(),r=this.getPageSize(),o=Math.ceil(2*t.x/this.view.scale+e.width*r.width),i=Math.ceil(2*t.y/this.view.scale+e.height*r.height),n=this.minimumGraphSize;null!=n&&n.width==o&&n.height==i||(this.minimumGraphSize=new mxRectangleType(0,0,o,i));var a=t.x/this.view.scale-e.x*r.width,l=t.y/this.view.scale-e.y*r.height;if(!this.autoTranslate&&(this.view.translate.x!=a||this.view.translate.y!=l)){this.autoTranslate=!0,this.view.x0=e.x,this.view.y0=e.y;var s=this.view.translate.x,c=this.view.translate.y;return this.view.setTranslate(a,l),this.container.scrollLeft+=(a-s)*this.view.scale,this.container.scrollTop+=(l-c)*this.view.scale,void(this.autoTranslate=!1)}Al.prototype.sizeDidChange.call(this)}},Bl.prototype.resetGraphView=function(){var e=this.getGraphBounds(),t=0;this.gridOptions.showEntryData&&(t="string"==typeof this.gridOptions.defaultHeight?0:this.gridOptions.defaultHeight);var r=Math.min(this.container.clientWidth/e.width,(this.container.clientHeight-t-20)/e.height);r=(r=1<=r?1:r)<=.6?.6:r,this.zoomTo(r,!0),e=this.getGraphBounds(),Math.max(e.width,this.scrollTileSize.width*this.view.scale),Math.max(e.height,this.scrollTileSize.height*this.view.scale),this.container.scrollTop=Math.floor(Math.max(0,e.y-(this.container.clientHeight-e.height)/2+79)),this.container.scrollLeft=Math.floor(Math.max(0,e.x-(this.container.clientWidth-e.width)/2))},Bl.prototype.insertBillCell=function(e,t,r,o,i,n,a,l,s,c,p){var d=this.createBillCell(e,t,r,o,i,n,a,l,s,c,p);return this.addCell(d,e)},Bl.prototype.createBillCell=function(e,t,r,o,i,n,a,l,s,c,p){var d=new mxGeometryType(n,a,l,s);d.relative=null!=p&&p;var u=new BillCell(r,o,i,d,c);return u.setId(t),u.setVertex(!0),u.setConnectable(!0),u},Bl.prototype.getTooltipForCell=function(e){return e instanceof BillCell?e.buildHtmlTooltip():Al.prototype.getTooltipForCell.call(this,e)},Bl.prototype.getLabel=function(e){return Al.prototype.getLabel.call(this,e)},Bl.prototype.convertValueToString=function(e){return e instanceof BillCell?e.buildHtmlLabel(this):Al.prototype.convertValueToString.call(this,e)},Bl.prototype.defineInnerStylesNewBTS=function(){var e=Object.assign({},this.getStylesheet().getDefaultVertexStyle());e[mxConstantsType.STYLE_FILLCOLOR]="none",e[mxConstantsType.STYLE_STROKE_OPACITY]="0",e[mxConstantsType.STYLE_STROKEWIDTH]="1",e[mxConstantsType.STYLE_FONTCOLOR]="black",e[mxConstantsType.STYLE_FONTSIZE]="12",e[mxConstantsType.STYLE_FONTSTYLE]="1",e[mxConstantsType.STYLE_ROUNDED]="1",e[mxConstantsType.STYLE_SPACING]=8,e[mxConstantsType.STYLE_WHITE_SPACE]="wrap",e[mxConstantsType.STYLE_IMAGE_ASPECT]="0",e[mxConstantsType.STYLE_PERIMETER]=mxPerimeterType.RectanglePerimeter,e[mxConstantsType.STYLE_ALIGN]=mxConstantsType.ALIGN_CENTER,e[mxConstantsType.STYLE_VERTICAL_ALIGN]=mxConstantsType.ALIGN_MIDDLE,this.getStylesheet().putCellStyle(Styles.STYLE_BILL_NODE_NAME,e),e=Object.assign({},e),this.getStylesheet().putCellStyle(Styles.STYLE_BILL_NODE_ENTRY_NAME,e),(e=Object.assign({},this.getStylesheet().getDefaultEdgeStyle()))[mxConstantsType.STYLE_SHAPE]=mxConstantsType.SHAPE_CONNECTOR,e[mxConstantsType.STYLE_STROKECOLOR]="#2A87FF",e[mxConstantsType.STYLE_ENDARROW]=mxConstantsType.ARROW_CLASSIC,e[mxConstantsType.STYLE_VERTICAL_ALIGN]=mxConstantsType.ALIGN_MIDDLE,e[mxConstantsType.STYLE_ALIGN]=mxConstantsType.ALIGN_CENTER,e[mxConstantsType.STYLE_EDGE]=mxConstantsType.EDGESTYLE_ELBOW,e[mxConstantsType.STYLE_ELBOW]=mxConstantsType.ELBOW_HORIZONTAL,e[mxConstantsType.STYLE_STROKEWIDTH]=1.8,e[mxConstantsType.STYLE_DASHED]=1,e[mxConstantsType.STYLE_OPACITY]=80,this.getStylesheet().putCellStyle(Styles.STYLE_BILL_ASSOCIATION_NAME,e)},Bl.createSvgImage=function(e,t,r){var o=unescape(encodeURIComponent('<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+e+'px" height="'+t+'px" version="1.1">'+r+"</svg>"));return new mxImageType("data:image/svg+xml;base64,"+(window.btoa?btoa(o):Base64.encode(o,!0)),e,t)},Bl.handleFill="#29b6f2",Bl),Al;function Bl(e,t,r,o){var i=Al.call(this,e,t,r,o)||this;return i.background="#ffffff",i.autoScroll=!1,i.autoExtend=!0,i.setCellsResizable(!1),i.setCellsEditable(!1),i.setTooltips(!1),i.setHtmlLabels(!0),i.setVertexLabelsMovable(!1),i.setAllowDanglingEdges(!1),i.defineInnerStylesNewBTS(),i.setPanning(!0),i.panningHandler.useLeftButtonForPanning=!0,i.container.style.cursor="grab",i.scrollTileSize=new mxRectangleType(0,0,400,400),i.addListener(Events.RESET_GRAPH_VIEW,i.resetGraphView),i}var CompactTreeLayout=(Rm=mxCompactTreeLayoutType,__extends(Sm,Rm),Sm.prototype.dfs=function(e,t){var r=mxCellPathType.create(e),o=null;if(null!=e&&null==this.visited[r]&&!this.isVertexIgnored(e)){this.visited[r]=e,o=this.createNode(e);var i=this.graph.getModel(),n=null,a=this.graph.getEdges(e,t,this.invert,!this.invert,!1,!0),l=this.graph.getView();this.sortEdges&&this.sortOutgoingEdges(e,a);for(var s=0;s<a.length;s++){var c,p,d,u=a[s];this.isEdgeIgnored(u)||(this.resetEdges&&this.setEdgePoints(u,null),this.edgeRouting&&(this.setEdgeStyleEnabled(u,!1),this.setEdgePoints(u,null)),p=null!=(c=l.getState(u))?c.getVisibleTerminal(this.invert):l.getVisibleTerminal(u,this.invert),null!=(d=this.dfs(p,t))&&null!=i.getGeometry(p)&&(null==n?o.child=d:n.next=d,n=d))}}return o},Sm.prototype.sortIngoingEdges=function(a,e){var l=new mxDictionaryType;e.sort(function(e,t){var r=e.getTerminal(e.getTerminal(!0)==a),o=l.get(r);null==o&&(o=mxCellPathType.create(r).split(mxCellPathType.PATH_SEPARATOR),l.put(r,o));var i=t.getTerminal(t.getTerminal(!0)==a),n=l.get(i);return null==n&&(n=mxCellPathType.create(i).split(mxCellPathType.PATH_SEPARATOR),l.put(i,n)),mxCellPathType.compare(o,n)})},Sm.prototype.execute=function(e,t){this.parent=e;var r,o,i,n,a,l,s,c=this.graph.getModel();if(null==t)if(0<this.graph.getEdges(e,c.getParent(e),this.invert,!this.invert,!1).length)this.root=e;else{var p=this.graph.findTreeRoots(e,!0,this.invert);if(0<p.length)for(var d=0;d<p.length;d++)if(!this.isVertexIgnored(p[d])&&0<this.graph.getEdges(p[d],null,this.invert,!this.invert,!1).length){this.root=p[d];break}}else this.root=t;if(null!=this.root){this.resizeParent?this.parentsChanged=new Object:this.parentsChanged=null,this.parentX=null,this.parentY=null,e!=this.root&&null!=c.isVertex(e)&&this.maintainParentLocation&&null!=(l=this.graph.getCellGeometry(e))&&(this.parentX=l.x,this.parentY=l.y),c.beginUpdate();try{this.visited={},this.node=this.dfs(this.root,e),this.alignRanks&&(this.maxRankHeight=[],this.findRankHeights(this.node,0),this.setCellHeights(this.node,0)),null!=this.node&&(this.layout(this.node),o=r=this.graph.gridSize,this.moveTree||null!=(i=this.getVertexBounds(this.root))&&(r=i.x,o=i.y),(s=null)!=(s=this.isHorizontal()?this.horizontalLayout(this.node,r,o):this.verticalLayout(this.node,null,r,o))&&((a=n=0)<s.x&&(n=-1*Math.abs(r-s.x)),0<s.y&&(a=-1*Math.abs(o-s.y)),0==n&&0==a||this.moveNode(this.node,n,a),this.resizeParent&&this.adjustParents(),this.edgeRouting&&this.localEdgeProcessing(this.node)),null!=this.parentX&&null!=this.parentY&&null!=(l=this.graph.getCellGeometry(e))&&((l=l.clone()).x=this.parentX,l.y=this.parentY,c.setGeometry(e,l)))}finally{c.endUpdate()}}},Sm.prototype.horizontalLayout=function(e,t,r,o){e.x+=t+e.offsetX,e.y+=r+e.offsetY,o=this.apply(e,o);var i=e.child;if(null!=i){o=this.horizontalLayout(i,e.x,e.y,o);for(var n=e.y+i.offsetY,a=i.next;null!=a;)o=this.horizontalLayout(a,e.x+i.offsetX,n,o),n+=a.offsetY,a=a.next}return o},Sm),Rm;function Sm(e,t,r){var o=Rm.call(this,e,t,r)||this;return o.useBoundingBox=!1,o}var RevertCompactTreeLayout=(Ln=mxCompactTreeLayoutType,__extends(Mn,Ln),Mn.prototype.dfs=function(e,t){var r=mxCellPathType.create(e),o=null;if(null!=e&&null==this.visited[r]&&!this.isVertexIgnored(e)){this.visited[r]=e,o=this.createNode(e);var i=this.graph.getModel(),n=null,a=this.graph.getEdges(e,t,!this.invert,this.invert,!1,!0),l=this.graph.getView();this.sortEdges&&this.sortIngoingEdges(e,a);for(var s=0;s<a.length;s++){var c,p,d,u=a[s];this.isEdgeIgnored(u)||(this.resetEdges&&this.setEdgePoints(u,null),this.edgeRouting&&(this.setEdgeStyleEnabled(u,!1),this.setEdgePoints(u,null)),p=null!=(c=l.getState(u))?c.getVisibleTerminal(!this.invert):l.getVisibleTerminal(u,!this.invert),null!=(d=this.dfs(p,t))&&null!=i.getGeometry(p)&&(null==n?o.child=d:n.next=d,n=d))}}return o},Mn.prototype.sortIngoingEdges=function(a,e){var l=new mxDictionaryType;e.sort(function(e,t){var r=e.getTerminal(e.getTerminal(!0)==a),o=l.get(r);null==o&&(o=mxCellPathType.create(r).split(mxCellPathType.PATH_SEPARATOR),l.put(r,o));var i=t.getTerminal(t.getTerminal(!0)==a),n=l.get(i);return null==n&&(n=mxCellPathType.create(i).split(mxCellPathType.PATH_SEPARATOR),l.put(i,n)),mxCellPathType.compare(o,n)})},Mn.prototype.execute=function(e,t){this.parent=e;var r,o,i,n,a,l,s,c=this.graph.getModel();if(null==t)if(0<this.graph.getEdges(e,c.getParent(e),!this.invert,this.invert,!1).length)this.root=e;else{var p=this.graph.findTreeRoots(e,!0,!0);if(0<p.length)for(var d=0;d<p.length;d++)if(!this.isVertexIgnored(p[d])&&0<this.graph.getEdges(p[d],null,!this.invert,this.invert,!1).length){this.root=p[d];break}}else this.root=t;if(null!=this.root){this.resizeParent?this.parentsChanged=new Object:this.parentsChanged=null,this.parentX=null,this.parentY=null,e!=this.root&&null!=c.isVertex(e)&&this.maintainParentLocation&&null!=(l=this.graph.getCellGeometry(e))&&(this.parentX=l.x,this.parentY=l.y),c.beginUpdate();try{this.visited={},this.node=this.dfs(this.root,e),this.alignRanks&&(this.maxRankHeight=[],this.findRankHeights(this.node,0),this.setCellHeights(this.node,0)),null!=this.node&&(this.layout(this.node),o=r=this.graph.gridSize,this.moveTree||null!=(i=this.getVertexBounds(this.root))&&(r=i.x,o=i.y),(s=null)!=(s=this.isHorizontal()?this.horizontalLayout(this.node,-r,o):this.verticalLayout(this.node,null,r,o))&&((a=n=0)<s.x&&(n=-1*Math.abs(r-s.x)),0<s.y&&(a=-1*Math.abs(o-s.y)),0==n&&0==a||this.moveNode(this.node,n,a),this.resizeParent&&this.adjustParents(),this.edgeRouting&&this.localEdgeProcessing(this.node)),null!=this.parentX&&null!=this.parentY&&null!=(l=this.graph.getCellGeometry(e))&&((l=l.clone()).x=this.parentX,l.y=this.parentY,c.setGeometry(e,l)))}finally{c.endUpdate()}}},Mn.prototype.horizontalLayout=function(e,t,r,o){e.x+=t-e.offsetX,e.y+=r+e.offsetY,o=this.apply(e,o);var i=e.child;if(null!=i){o=this.horizontalLayout(i,e.x,e.y,o);for(var n=e.y+i.offsetY,a=i.next;null!=a;)o=this.horizontalLayout(a,e.x-i.offsetX,n,o),n+=a.offsetY,a=a.next}return o},Mn),Ln;function Mn(e,t,r){var o=Ln.call(this,e,t,r)||this;return o.useBoundingBox=!1,o}var CellOverlayState={Search:"Search",Fold:"Fold"},CellOverlay=(Fo=mxCellOverlayType,__extends(Go,Fo),Go),Fo;function Go(e,t,r,o,i,n,a){var l=Fo.call(this,e,t,r,o,i,n)||this;return l.state=a||CellOverlayState.Search,l}var Outline=(Po=mxOutlineType,__extends(Qo,Po),Qo.prototype.createGraph=function(e){var t=new mxGraphType(e,this.source.getModel(),this.graphRenderHint);return t.foldingEnabled=!1,t.autoScroll=!1,this.extendStyleSheets(t,this.source),t},Qo.prototype.extendStyleSheets=function(e,t){var r=Object.assign({},t.getStylesheet().getCellStyle(Styles.STYLE_BILL_NODE_NAME,t.getStylesheet().getDefaultVertexStyle()));r[mxConstantsType.STYLE_FILLCOLOR]="#2A87FF",e.getStylesheet().putCellStyle(Styles.STYLE_BILL_NODE_NAME,r),(r=Object.assign({},t.getStylesheet().getCellStyle(Styles.STYLE_BILL_NODE_ENTRY_NAME,t.getStylesheet().getDefaultVertexStyle())))[mxConstantsType.STYLE_FILLCOLOR]="#F5A144",e.getStylesheet().putCellStyle(Styles.STYLE_BILL_NODE_ENTRY_NAME,r),r=Object.assign({},t.getStylesheet().getCellStyle(Styles.STYLE_BILL_ASSOCIATION_NAME,t.getStylesheet().getDefaultEdgeStyle())),e.getStylesheet().putCellStyle(Styles.STYLE_BILL_ASSOCIATION_NAME,r)},Qo),Po;function Qo(e,t){return Po.call(this,e,t)||this}var BillTrackerDataService=(Yo.prototype.getJointQueryParameters=function(e){var t=e.ConvertToJson(),r=this.httpService.setHeader({body:t});return this.httpService.request(this.jointQueryParserMethod,this.jointQueryParserUrl,r).pipe(operators.switchMap(function(e){var t=commonApi.BpmnModelJsonHelper.FromJson(e.value,JointQueryParameterResult);return rxjs.of(t)}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},Yo.prototype.canTracking=function(e){var t=this.httpService.setHeader({body:e.ConvertToJson(),responseType:"text"});return this.httpService.request(this.canTrackingMethod,this.canTrackingUrl,t).pipe(operators.switchMap(function(e){var t=new CanTrackingResult;return t.LoadFromJson(e),rxjs.of(t)}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},Yo.prototype.getDownBillsInfo=function(e){var t=this.httpService.setHeader({body:e.ConvertToJson(),responseType:"text"});return this.httpService.request(this.getDownBillsInfoMethod,this.getDownBillsInfoUrl,t).pipe(operators.switchMap(function(e){var t=commonApi.BpmnModelJsonHelper.FromJson(e,DownBillInfoResult);return rxjs.of(t)}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},Yo.prototype.getUpBillsInfo=function(e){var t=this.httpService.setHeader({body:e.ConvertToJson(),responseType:"text"});return this.httpService.request(this.getUpBillsInfoMethod,this.getUpBillsInfoUrl,t).pipe(operators.switchMap(function(e){var t=commonApi.BpmnModelJsonHelper.FromJson(e,UpBillInfoResult);return rxjs.of(t)}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},Yo.prototype.getEntityData=function(e){var t=this.httpService.setHeader({body:e.ConvertToJson(),responseType:"text"});return this.httpService.request(this.getEntityDataMethod,this.getEntityDataUrl,t).pipe(operators.switchMap(function(e){var t=new EntityDataResult;return t.LoadFromJson(e),rxjs.of(t)}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},Yo.prototype.buildEntryBillInfo=function(e){var t=new DownBillInfoResult;t.schemaId=e.schemaId,t.suCode=e.suCode,t.voName=e.voName,t.billTrackingSettings=e.billTrackingSettings,t.bizKind=e.bizKind,t.bizType=e.bizType,t.jointQueryMode=e.jointQueryMode,t.jointQueryParameters=e.jointQueryParameters,t.trackingSourceType=e.trackingSourceType;var r=new BillDataInfo;return r.caption=e.caption,r.dataId=e.dataId,r.summary=e.summary,r.trackingMappingAssociations=[],r.billChildInfos=e.billChildInfos,r.curYear=e.curYear,t.billDataInfos=[r],t.documentTypeId=e.documentTypeId,t},Yo.prototype.buildGetBillsInfoArgs=function(e){var t=new GetBillsInfoArgs;return t.billDataId=e.billDataInfo.dataId,t.documentTypeId=e.billInfo.documentTypeId,t.bizKind=e.billInfo.bizKind,t.bizType=e.billInfo.bizType,t.billChildInfos=e.billDataInfo.billChildInfos,t.curYear=e.billDataInfo.curYear,t},Yo.prototype.buildGetUpBillsInfoArgs=function(e){var t=new GetUpBillsInfoArgs;return t.LoadFromJsonObject(this.buildGetBillsInfoArgs(e).ConvertToJsonObject()),t},Yo.prototype.buildGetDownBillsInfoArgs=function(e){var t=new GetDownBillsInfoArgs;return t.LoadFromJsonObject(this.buildGetBillsInfoArgs(e).ConvertToJsonObject()),t},Yo.prototype.buildGetMainEntityDataArgs=function(e,t){var r=new GetMainEntityDataArgs;return r.dataId=t.dataId,r.suCode=e.suCode,r.schemaId=e.schemaId,r.trackingSourceType=e.trackingSourceType,r.billChildInfos=t.billChildInfos,r.curYear=t.curYear,r},Yo.prototype.hasDynamicParams=function(e){return!!e.params&&!!Array.isArray(e.params)&&null!=e.params.find(function(e){return e.type!=commonApi$1.JointQueryParameterType.Constant})},Yo.prototype.buildGetJointQueryParametersArgs=function(e,t,r){var o=new GetJointQueryParametersArgs;return o.dataId=r.dataId,o.suCode=t.suCode,o.schemaId=t.schemaId,o.trackingSourceType=t.trackingSourceType,o.contents=[],Array.isArray(e.params)&&e.params.forEach(function(e){var t,r;e.type!=commonApi$1.JointQueryParameterType.Constant&&(t=new JointQueryParametersContent,e.type==commonApi$1.JointQueryParameterType.Field?(t.jointQueryParameterMode=JointQueryParameterMode.FIELD,(r=new FieldJointQueryParameterContent).parameterCode=e.code,r.fieldContent=e.value,t.content=r.ConvertToJson()):e.type==commonApi$1.JointQueryParameterType.Expression&&(t.jointQueryParameterMode=JointQueryParameterMode.EXPRESSION,(r=new ExpressionJointQueryParameterContent).parameterCode=e.code,r.expressionContent=e.value,t.content=r.ConvertToJson()),o.contents.push(t))}),o},Yo.decorators=[{type:core$1.Injectable}],Yo.ctorParameters=function(){return[{type:cafCommon.HttpService},{type:http.HttpClient}]},Yo);function Yo(e,t){this.httpService=e,this.httpClient=t,this.baseUrl="/api/runtime/aif/v1.0/billtracking",this.canTrackingUrl=this.baseUrl+"/cantracking",this.canTrackingMethod="POST",this.getDownBillsInfoUrl=this.baseUrl+"/getdownbillsinfo",this.getDownBillsInfoMethod="POST",this.getUpBillsInfoUrl=this.baseUrl+"/getupbillsinfo",this.getUpBillsInfoMethod="POST",this.getEntityDataUrl=this.baseUrl+"/getentitydata",this.getEntityDataMethod="POST",this.jointQueryParserUrl="/api/runtime/aif/v1.0/jointquery",this.jointQueryParserMethod="POST"}var BillTrackerDataInfoService=(dq.prototype.isNewBTS=function(e){var t;return"string"==typeof e&&((t=new commonApi$1.BillTrackingSettings).LoadFromJson(e),e=t),null!=e&&"1.0"===e.version},dq.prototype.extractDataRows=function(e,i,n,a){var t,r,l=this,s=[];try{for(var o=__values(e),c=o.next();!c.done;c=o.next())!function(t){var r={};r[a]=t.dataId;var o=[];i.forEach(function(e){e.dataType==commonApi.DataType.Decimal?o.push(e):r[e.fieldPath]=l.getFieldValue(e,t.GetFieldMap(),n)}),o.forEach(function(e){r[e.fieldPath]=l.getFieldValue(e,t.GetFieldMap(),n)}),s.push(r)}(c.value)}catch(p){t={error:p}}finally{try{c&&!c.done&&(r=o["return"])&&r.call(o)}finally{if(t)throw t.error}}return s},dq.prototype.extractCaptionPath=function(e){for(var t=e.caption,r=e;null!=r.attachedField;)t=r.attachedField.caption+"."+t,r=r.attachedField;return t},dq.prototype.extractFieldPath=function(e){for(var t=e.fieldName,r=e;null!=r.attachedField;)t=r.attachedField.fieldName+"."+t,r=r.attachedField;return t},dq.prototype.extractFFields=function(e,i,n){var a=this,l=[];return e.forEach(function(e){var t,r,o;e.show=!0,"Enum"==e.fieldType||"EnumSingleUdt"==e.fieldType?(t=a.extractFieldPath(e),o=null,n&&null==(o=i.find(function(e){return e.fieldPath==t}))&&(e.show=!1),e=a.setExtendProps(e,o,t+".Name"),l.push(e)):null!=e.GetSubFieldList()&&0<e.GetSubFieldList().length?l.push.apply(l,__spread(a.extractFFields(e.GetSubFieldList(),i,n))):(r=a.extractFieldPath(e),o=null,n&&null==(o=i.find(function(e){return e.fieldPath==r}))&&(e.show=!1),e=a.setExtendProps(e,o,r),l.push(e))}),l},dq.prototype.hasChildData=function(e,t){var r,o,i=!1,n=this.getBillTrackerSchema(t),a=e.GetChildTableList();try{for(var l=__values(a),s=l.next();!s.done;s=l.next()){var c=s.value,p=!1,d=!1,u=n&&n[c.tableName],p=null==u||null==u.show||u.show;if(c.GetRowList()&&0<c.GetRowList().length&&(d=!0),1==(i=p&&d))break}}catch(m){r={error:m}}finally{try{s&&!s.done&&(o=l["return"])&&o.call(l)}finally{if(r)throw r.error}}return i},dq.prototype.getFieldValue=function(e,t,r){for(var o=e.fieldPath?e.fieldPath.split("."):[e.fieldName],i=o&&t[o[0]],n=1;null!=i&&n<o.length;n++){var a=i.GetSubFieldMap();if(null==a)break;i=a[o[n]]}var l=i?i.GetTextValue():"";if(null==l)return null;if(e.dataType==commonApi.DataType.String)return(e.fieldValue=l)||"";if(e.dataType==commonApi.DataType.Decimal){var s,c,p=e.scale;return null!=e.formatInfo&&(null!=e.formatInfo.scale&&(p=e.formatInfo.scale),e.formatInfo.enableScaleExpression&&null!=e.formatInfo.scaleExpression&&(null==(c=(s=this.getFieldInFields(r,e.formatInfo.scaleExpression))&&parseInt(String(this.getFieldValue(s,t))))||isNaN(c)||(p=c))),e.fieldValue=parseFloat(String(l)),parseFloat(String(l)).toFixed(p).toString()||""}if(e.dataType==commonApi.DataType.Boolean)return""==l?(e.fieldValue=null,l):(e.fieldValue=JSON.parse(l),JSON.parse(l));if(e.dataType!=commonApi.DataType.DateTime)return(e.fieldValue=l)||"";var d=commonApi.BpmnModelJsonHelper.DateTimeFromString(l),u="yyyy-MM-dd",u="DateTime"==e.fieldType?e.formatInfo&&e.formatInfo.dateFormatter||"yyyy-MM-dd HH:mm:ss.SSS":(e.fieldType,e.formatInfo&&e.formatInfo.dateFormatter||"yyyy-MM-dd");return e.fieldValue=d,this.dateFormat(d,u)},dq.prototype.getFieldInFields=function(e,t){var r,o,i=null;try{for(var n=__values(e),a=n.next();!a.done;a=n.next()){for(var l=a.value;l.attachedField;)l=l.attachedField;var s=l;if(s.fullPath=commonApi$1.fullPathPrefix+s.attachedTable.tableName+"."+s.fieldPath,t==s.fullPath){i=s;break}}}catch(c){r={error:c}}finally{try{a&&!a.done&&(o=n["return"])&&o.call(n)}finally{if(r)throw r.error}}return i},dq.prototype.getFieldValueInFieldsWithValue=function(e,t){var r,o,i=null;try{for(var n=__values(e),a=n.next();!a.done;a=n.next()){for(var l=a.value;l.attachedField;)l=l.attachedField;var s=l;if(s.fullPath=commonApi$1.fullPathPrefix+s.attachedTable.tableName+"."+s.fieldPath,t==s.fullPath){i=s.fieldValue;break}}}catch(c){r={error:c}}finally{try{a&&!a.done&&(o=n["return"])&&o.call(n)}finally{if(r)throw r.error}}return i},dq.prototype.getBasicInfoFieldsWithValue=function(e,t,r,o){var i=this;void 0===o&&(o=!0);var n=[],a=new commonApi$1.BillTrackingSettings;e&&e.billTrackingSettings&&a.LoadFromJson(e.billTrackingSettings);var l=this.getBillTrackerSchema(e),s=(s=l&&l[t.tableName]&&l[t.tableName].fields)||[],c=a.billTrackingDataShownMode===commonApi$1.BillTrackingDataShownMode.CUSTOMFIELD,p=t.getFieldList(),d=r.GetRowList()[0].GetFieldMap(),u=this.extractFFields(p,s,c),m=[];return u.forEach(function(e){e.dataType==commonApi.DataType.Decimal?m.push(e):e.fieldValue=i.getFieldValue(e,d)}),m.forEach(function(e){e.fieldValue=i.getFieldValue(e,d,p)}),n.push.apply(n,__spread(u)),n},dq.prototype.setExtendProps=function(e,t,r,o){return e.captionPath=this.extractCaptionPath(e),e.fieldPath=r,t&&(e.displayName=t.displayName,e.i18nCols=t.i18nCols,e.formatInfo=t.formatInfo,e.order=t.order),o&&(e.fieldValue=this.getFieldValue(e,o)),e},dq.prototype.sortFieldsByOrder=function(e){return e.sort(function(e,t){return null!=e.order&&null!=t.order?e.order-t.order:null!=e.order&&null==t.order?-1:null==e.order&&null!=t.order?1:0})},dq.prototype.dateFormat=function(e,t){var r,o={"y+":e.getUTCFullYear().toString(),"M+":(e.getUTCMonth()+1).toString(),"d+":e.getUTCDate().toString(),"H+":e.getUTCHours().toString(),"m+":e.getUTCMinutes().toString(),"s+":e.getUTCSeconds().toString(),"S+":e.getUTCMilliseconds().toString()};for(var i in o)(r=new RegExp("("+i+")").exec(t))&&(t=String.prototype.padStart?t.replace(r[1],1==r[1].length?o[i]:o[i].padStart(r[1].length,"0")):t.replace(r[1],1==r[1].length?o[i]:this.myPadStart(o[i],r[1].length,"0")));return t},dq.prototype.myPadStart=function(e,t,r){return t>>=0,r=String(void 0!==r?r:" "),e.length>t?String(e):((t-=e.length)>r.length&&(r+=r.repeat(t/r.length)),r.slice(0,t)+String(e))},dq.prototype.getFieldLabel=function(e,t){return t&&e.i18nCols&&e.i18nCols.colI18nValues.displayName&&e.i18nCols.colI18nValues.displayName[t]||e.displayName||e.captionPath||e.caption},dq.prototype.getTableLabel=function(e,t,r){var o=this.getBillTrackerSchema(e),i=o&&o[t.tableName];if(null==i)return t.caption;var n=i.i18nCols;return r&&n&&n.colI18nValues.displayName&&n.colI18nValues.displayName[r]||i.displayName||i.caption||i.code},dq.prototype.getChildTables=function(e,t){var r=[],o=this.getBillTrackerSchema(e),i=t.GetChildTableList();return i&&i.forEach(function(e){var t=o&&o[e.tableName];null!=t&&null!=t.show?1==t.show&&(e.order=t.order,r.push(e)):r.push(e)}),r=this.sortTablesByOrder(r)},dq.prototype.sortTablesByOrder=function(e){return e.sort(function(e,t){return null!=e.order&&null!=t.order?e.order-t.order:null!=e.order&&null==t.order?-1:null==e.order&&null!=t.order?1:0})},dq.prototype.getBillTrackerSchema=function(e){var t=new commonApi$1.BillTrackingSettings;e&&e.billTrackingSettings&&t.LoadFromJson(e.billTrackingSettings);var r=t.customFieldContent,o=r&&("object"==typeof r?r:JSON.parse(r));return o&&o.schema},dq.decorators=[{type:core$1.Injectable}],dq);function dq(){}var BILL_TRACKER_LANG_RESOURCES={"zh-CHS":{billTracker:"单据追踪",noAssoBill:"没有关联的业务单据",modalOptionsCantBeEmpty:"模态框配置不可为空",downSearch:"下查",upSearch:"上查",folder:"折叠",caption:"标题",summary:"摘要",basicInfo:"基本信息",lineNumber:"序号",childData:"明细",selectOneFirst:"请先选择一条数据",noChildData:"没有明细数据",zoomIn:"放大",zoomOut:"缩小",zoomReset:"还原",print:"打印",expandUp:"向上展开",expandUpAll:"向上展开全部",expandDown:"向下展开",expandDownAll:"向下展开全部",loading:"正在加载",yes:"是",no:"否"},en:{billTracker:"Bill Tracker",noAssoBill:"There is no associated business bill.",modalOptionsCantBeEmpty:"Modal options cant be empty",downSearch:"Down search",upSearch:"Up search",folder:"Folder",caption:"Caption",summary:"Summary",basicInfo:"Basic Information",lineNumber:"No",childData:"Detail",selectOneFirst:"Please select an item at first",noChildData:"No detail data",zoomIn:"Zoom In",zoomOut:"Zoom Out",zoomReset:"Zoom Reset",print:"Print",expandUp:"Expand Upward",expandUpAll:"Expand All Upward",expandDown:"Expand Downward",expandDownAll:"Expand All Downward",loading:"Loading...",yes:"Yes",no:"No"},"zh-CHT":{billTracker:"單據追蹤",noAssoBill:"沒有關聯的業務單據",modalOptionsCantBeEmpty:"模態框配置不可為空",downSearch:"下查",upSearch:"上查",folder:"折疊",caption:"標題",summary:"摘要",basicInfo:"基本信息",lineNumber:"序號",childData:"明細",selectOneFirst:"請先選擇壹條數據",noChildData:"沒有明細數據",zoomIn:"放大",zoomOut:"縮小",zoomReset:"還原",print:"打印",expandUp:"向上展開",expandUpAll:"向上展開全部",expandDown:"向下展開",expandDownAll:"向下展開全部",loading:"正在加載",yes:"是",no:"否"}},BillTrackerLocalePipe=(Ps.prototype.transform=function(e){return this.lang[e]||e},Ps.decorators=[{type:core$1.Pipe,args:[{name:"billTrackerLocale"}]}],Ps.ctorParameters=function(){return[{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]}]},Ps);function Ps(e){this.defaultLang="zh-CHS",this.langCode=e||this.defaultLang,this.lang=BILL_TRACKER_LANG_RESOURCES[this.langCode]||BILL_TRACKER_LANG_RESOURCES[this.defaultLang]}var BillTrackerInternalUiService=function(){function BillTrackerInternalUiService(e,t,r,o,i,n,a,l,s,c){this.framework=e,this.messager=t,this.loading=r,this.dataService=i,this.dataInfoService=n,this.modalService=a,this.cfr=l,this.injector=s,this.localePipe=c}return BillTrackerInternalUiService.prototype.openBillDetail=function(e,t){var r,o=this,i=e.jointQueryMode,n=JSON.parse(e.jointQueryParameters),a=t.dataId;this.dataService.hasDynamicParams(n)?(r=this.dataService.buildGetJointQueryParametersArgs(n,e,t),this.dataService.getJointQueryParameters(r).subscribe(function(e){i==commonApi$1.JointQueryMode.APP?o.openMenu(n,a,e):i==commonApi$1.JointQueryMode.URL&&o.openUrl(n,a,e)})):i==commonApi$1.JointQueryMode.APP?this.openMenu(n,a):i==commonApi$1.JointQueryMode.URL&&this.openUrl(n,a)},BillTrackerInternalUiService.prototype.openBillDetailWithFields=function(e,t,r){var o,i=this,n=t.dataId,a=e.jointQueryMode,l=JSON.parse(e.jointQueryParameters);this.dataService.hasDynamicParams(l)?(o=this.dataService.buildGetJointQueryParametersArgs(l,e,t),this.dataService.getJointQueryParameters(o).subscribe(function(e){a==commonApi$1.JointQueryMode.APP?i.openMenu(l,n,e):a==commonApi$1.JointQueryMode.URL&&i.openUrl(l,n,e)})):a==commonApi$1.JointQueryMode.APP?this.openMenu(l,n):a==commonApi$1.JointQueryMode.URL&&this.openUrl(l,n)},BillTrackerInternalUiService.prototype.openMenu=function(e,t,r){var o={};o.id=t,o.action="LoadAndView1";var i=new Map;i.set("id",t),i.set("action","LoadAndView1"),this.buildOpenMenuParams(e,i,o,r);var n=encodeURIComponent(JSON.stringify(o));i.set("WEB_FORM_ROUTE_PARAMS",n);var a={appType:rtfCommon.AppType.Menu,funcId:e.funcId,appEntrance:null,appId:null,tabId:t,entityParams:o,queryStringParams:i};this.framework.openMenu(a)},BillTrackerInternalUiService.prototype.openUrl=function(t,e,o){var i=this,n=this.appendQueryParam(t.url,"id",e);Array.isArray(t.params)?t.params.forEach(function(t){var e,r=t.value;t.type!=commonApi$1.JointQueryParameterType.Field&&t.type!=commonApi$1.JointQueryParameterType.Expression||(r=(e=o.find(function(e){return e.code==t.code}))&&e.value),n=i.appendQueryParam(n,t.code,r)}):Object.keys(t.params).forEach(function(e){n=i.appendQueryParam(n,e,t.params[e])});var r=t.params||{};r.id=e,r.url=n,r.action="LoadAndView1";var a=new Map;a.set("url",n),a.set("id",e),a.set("action","LoadAndView1"),this.buildOpenMenuParams(t,a,undefined,o);var l={appType:rtfCommon.AppType.Menu,funcId:BillTrackerConstant.BILL_VIEWER_FUNC_ID,appEntrance:null,appId:null,tabId:e,entityParams:r,queryStringParams:a};this.framework.openMenu(l)},BillTrackerInternalUiService.prototype.buildOpenMenuParams=function(t,r,o,i){void 0===o&&(o={}),Array.isArray(t.params)?t.params.forEach(function(t){var e=t.value;t.type!=commonApi$1.JointQueryParameterType.Field&&t.type!=commonApi$1.JointQueryParameterType.Expression||i&&(e=i.find(function(e){return e.code==t.code}).value),o[t.code]=e,r.set(t.code,e)}):Object.keys(t.params).forEach(function(e){o[e]=t.params[e],r.set(e,t.params[e])})},BillTrackerInternalUiService.prototype.appendQueryParam=function(url,k,v){var re1,re2,paraStr,idx;return-1<url.indexOf(k)?(re1=eval("/(\\?)("+k+"=)([^&]*)/gi"),url=url.replace(re1,"?"+k+"="+v),re2=eval("/(&)("+k+"=)([^&]*)/gi"),url=url.replace(re2,"&"+k+"="+v)):(paraStr=k+"="+v,idx=url.indexOf("?"),idx<0?url+="?":0<=idx&&idx!=url.length-1&&(url+="&"),url+=paraStr),url},BillTrackerInternalUiService.decorators=[{type:core$1.Injectable}],BillTrackerInternalUiService.ctorParameters=function(){return[{type:rtfCommon.FrameworkService},{type:uiMessager.MessagerService},{type:rtfCommon.LoadingService},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:BillTrackerDataService},{type:BillTrackerDataInfoService},{type:uiModal.BsModalService},{type:core$1.ComponentFactoryResolver},{type:core$1.Injector},{type:BillTrackerLocalePipe}]},BillTrackerInternalUiService}(),BillTrackerComponent=(Ut.prototype.ngOnInit=function(){},Ut.prototype.ngAfterViewInit=function(){var e=this;setTimeout(function(){e.paintGraph()},0)},Ut.prototype.paintGraph=function(){var r=this;this.billGraph.paint(),this.graphZoomScale=this.billGraph.getZoomScale(),this.billGraph.graph.view.addListener(mxEventType.SCALE,function(e,t){r.graphZoomScale=r.billGraph.getZoomScale()})},Ut.prototype.selectHandler=function(e){if(e){var t=e.billInfo,r=e.billDataInfo;if(t==this.lastBillInfo&&r==this.lastBillDataInfo&&1==this.showData)return;var o=this.dataService.buildGetMainEntityDataArgs(t,r);this.billData.showDataGrid(o,t,r,null),this.showData=!0,this.lastBillInfo=t,this.lastBillDataInfo=r}else this.billData.clearDataRegion(),this.showData=!1},Ut.prototype.stateChangeHandler=function(e){e.type==Events.CLICK_FIRST_SUMMARY&&this.openBillDetail(e.data)},Ut.prototype.setModalRef=function(e){this.modalRef=e,null!=this.billGraph&&this.billGraph.setModalRef(e)},Ut.prototype.resetGraphHeight=function(e){var t=this;e.host.style.top="",e.host.style.left="",this.graphContainerER.nativeElement.style.height=this.mainContainerER.nativeElement.clientHeight-e.size.height+"px",setTimeout(function(){t.billGraph.refresh()})},Ut.prototype.expandDataRegion=function(){this.dataFullScreen=!0,this.divDataWrapperER.nativeElement.style.height="100%",this.divDataWrapperER.nativeElement.style.top="0"},Ut.prototype.collapseDataRegion=function(){this.dataFullScreen=!1,this.divDataWrapperER.nativeElement.style.height=this.defaultDataWrapperHeight+"px",this.divDataWrapperER.nativeElement.style.top=null},Ut.prototype.onRzResized=function(e){},Ut.prototype.graphZoomIn=function(){this.billGraph.zoomIn()},Ut.prototype.graphZoomOut=function(){this.billGraph.zoomOut()},Ut.prototype.graphZoomActual=function(){this.billGraph.zoomActual()},Ut.prototype.graphPrint=function(){this.billGraph.print()},Ut.prototype.graphExpand=function(e,t){void 0===t&&(t=!1),this.billGraph.expand(e,t)},Ut.prototype.graphExpandUpAll=function(){this.graphExpand(BillTrackerDirection.Up,!0)},Ut.prototype.graphExpandUp=function(){this.graphExpand(BillTrackerDirection.Up,!1)},Ut.prototype.graphExpandDown=function(){this.graphExpand(BillTrackerDirection.Down,!1)},Ut.prototype.graphExpandDownAll=function(){this.graphExpand(BillTrackerDirection.Down,!0)},Ut.prototype.openBillDetail=function(e){this.internalUiService.openBillDetail(e.billInfo,e.billDataInfo)},Ut.decorators=[{type:core$1.Component,args:[{selector:"lib-bill-tracker",template:'<div class="g-main" style="height: 100%; background-color: #ffffff;" #mainContainer>\r\n    <div class="bill-tracker-toolbar-wrapper" *ngIf="modalRef!=null">\r\n        <button class="btn btn-secondary bill-tracker-toolbar-btn mr-1" (click)="graphExpandUpAll()">\r\n            {{\'expandUpAll\'|billTrackerLocale}}\r\n        </button>\r\n        <button class="btn btn-secondary bill-tracker-toolbar-btn mr-1" (click)="graphExpandUp()">\r\n            {{\'expandUp\'|billTrackerLocale}}\r\n        </button>\r\n        <button class="btn btn-secondary bill-tracker-toolbar-btn mr-1" (click)="graphExpandDown()">\r\n            {{\'expandDown\'|billTrackerLocale}}\r\n        </button>\r\n        <button class="btn btn-secondary bill-tracker-toolbar-btn mr-1" (click)="graphExpandDownAll()">\r\n            {{\'expandDownAll\'|billTrackerLocale}}\r\n        </button>\r\n        <div class="bill-tracker-toolbar-icon" (click)="graphZoomOut()">\r\n            <i class="f-icon f-icon-minus" title="{{\'zoomOut\' | billTrackerLocale}}"></i>\r\n        </div>\r\n        <div class="bill-tracker-toolbar-input">\r\n            <input *ngIf="false" type="text" style="border: 0; width: 30px; text-align: right;" readonly\r\n                [(ngModel)]="graphZoomScale">\r\n            <span style="border: 0; width: 30px; text-align: right;">{{graphZoomScale}}</span>\r\n            <span>%</span>\r\n        </div>\r\n        <div class="bill-tracker-toolbar-icon" (click)="graphZoomIn()">\r\n            <i class="f-icon f-icon-add" title="{{\'zoomIn\' | billTrackerLocale}}"></i>\r\n        </div>\r\n        <div class="bill-tracker-toolbar-icon" (click)="graphZoomActual()">\r\n            <i class="f-icon f-icon-reset" title="{{\'zoomReset\' | billTrackerLocale}}"></i>\r\n        </div>\r\n        <div class="bill-tracker-toolbar-icon" (click)="graphPrint()" *ngIf="false">\r\n            <i class="f-icon f-icon-print" title="{{\'print\' | billTrackerLocale}}"></i>\r\n        </div>\r\n    </div>\r\n    <div class="bill-tracker-graph-wrapper" #graphContainer>\r\n        <lib-bill-tracker-graph #billGraph [billTrackerArgs]="billTrackerArgs" (select)="selectHandler($event)"\r\n            (stateChange)="stateChangeHandler($event)">\r\n        </lib-bill-tracker-graph>\r\n    </div>\r\n</div>\r\n\x3c!-- todo: 分割条暂未加最大高度限制 --\x3e\r\n<div #divDataWrapper class="bill-tracker-data-wrapper" [style.height]="defaultDataWrapperHeight + \'px\'"\r\n    [style.display]="showData ? null : \'none\'" ngResizable rzAspectRatio="false" [rzHandles]="\'n\'" [rzMinHeight]="40"\r\n    (rzStop)="onRzResized($event)">\r\n    <div class="bill-tracker-divider-wrapper">\r\n        <div class="bill-tracker-divider bill-tracker-divider-transparent bill-tracker-divider-img">\r\n        </div>\r\n    </div>\r\n    <div class="bill-tracker-fold-wrapper">\r\n        <div class="bill-tracker-fold-icon">\r\n            <i class="f-icon f-icon-arrow-seek-up" *ngIf="dataFullScreen==false" (click)="expandDataRegion()"></i>\r\n            <i class="f-icon f-icon-arrow-seek-down" *ngIf="dataFullScreen==true" (click)="collapseDataRegion()"></i>\r\n        </div>\r\n    </div>\r\n    <div #divDataTable class="bill-tracker-data-table-wrapper">\r\n        <lib-bill-tracker-data #billData></lib-bill-tracker-data>\r\n    </div>\r\n</div>',providers:[BillTrackerDataService],changeDetection:core$1.ChangeDetectionStrategy.Default,styles:['.bill-tracker-divider{position:relative;height:1px}.bill-tracker-divider-transparent:before{content:"";position:absolute;top:0;left:0;width:100%;height:1px;background-color:#e9ecf3}.bill-tracker-divider-transparent:hover:before{content:"";position:absolute;top:0;left:0;width:100%;height:1px;background-color:#3f65ff}.bill-tracker-divider-img:after{content:"";position:absolute;top:-1px;left:50%;width:60px;height:5px;background-image:url(/platform/runtime/common/web/@edp-bif/runtime-api/images/separator.svg);background-repeat:no-repeat}.bill-tracker-divider-img:hover:after{content:"";position:absolute;top:-1px;left:50%;width:60px;height:5px;background-image:url(/platform/runtime/common/web/@edp-bif/runtime-api/images/separator-hover.svg);background-repeat:no-repeat}.bill-tracker-graph-wrapper{height:100%;position:relative}.bill-tracker-data-wrapper{z-index:2;overflow-y:auto;position:absolute;left:0;width:100%;bottom:0;height:200px;background-color:#fff;border-top:1px solid #e9ecf3}.bill-tracker-data-table-wrapper{position:relative;width:100%;padding-top:6px}.bill-tracker-fold-wrapper{z-index:1;position:absolute;right:0;top:0;width:2rem;height:2rem}.bill-tracker-fold-icon{display:inline-flex;width:1.5em;height:1.5em;line-height:1.5em;text-align:center;color:#848c9a;background:#fff;border-radius:1.5em;border:1px solid #e9ecf3;justify-content:center;align-items:center;flex-shrink:0;overflow:hidden;margin:.5em .5em 0 0}.bill-tracker-fold-icon:hover{background-image:linear-gradient(214deg,#3f65ff 0,#4d9aff 100%);box-shadow:0 3px 8px 0 rgba(78,148,255,.4);color:#fff}.bill-tracker-toolbar-wrapper{z-index:1;position:absolute;right:0;top:0;display:flex;margin-right:14px;margin-top:14px;background-color:#fff}.bill-tracker-toolbar-icon{background:#fff;width:22px;height:22px;line-height:22px;text-align:center;color:#595d63;border:1px solid #e8ebf2;box-shadow:0 2px 6px 0 rgba(31,35,41,.06);border-radius:22px;justify-content:center;align-items:center;flex-shrink:0;overflow:hidden}.bill-tracker-toolbar-icon:hover{background-image:linear-gradient(214deg,#3f65ff 0,#4d9aff 100%);box-shadow:0 3px 8px 0 rgba(78,148,255,.4);color:#fff}.bill-tracker-toolbar-btn:hover{background-color:#fff}']}]}],Ut.ctorParameters=function(){return[{type:BillTrackerArgs},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:BillTrackerDataService},{type:uiNotify.NotifyService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:uiModal.BsModalService},{type:core$1.ChangeDetectorRef},{type:core$1.ViewContainerRef},{type:core$1.ApplicationRef},{type:core$1.Injector,decorators:[{type:core$1.Optional}]},{type:core$1.ComponentFactoryResolver,decorators:[{type:core$1.Optional}]}]},Ut.propDecorators={billGraph:[{type:core$1.ViewChild,args:["billGraph"]}],billGraphVCR:[{type:core$1.ViewChild,args:["billGraph",{read:core$1.ViewContainerRef}]}],mainContainerER:[{type:core$1.ViewChild,args:["mainContainer"]}],graphContainerER:[{type:core$1.ViewChild,args:["graphContainer"]}],billData:[{type:core$1.ViewChild,args:["billData"]}],billDataVCR:[{type:core$1.ViewChild,args:["billData",{read:core$1.ViewContainerRef}]}],divDataTableER:[{type:core$1.ViewChild,args:["divDataTable"]}],divDataWrapperER:[{type:core$1.ViewChild,args:["divDataWrapper"]}],billTrackerArgs:[{type:core$1.Input,args:["billTrackerArgs"]}]},Ut);function Ut(e,t,r,o,i,n,a,l,s,c,p,d){this.localeId=t,this.dataService=r,this.notify=o,this.messager=i,this.loading=n,this.modal=a,this.cdf=l,this.vcr=s,this.appr=c,this.inj=p,this.cfr=d,this.defaultDataWrapperHeight=180,this.showData=!1,this.dataFullScreen=!1,this.billTrackerArgs=e,this.dataInfoService=new BillTrackerDataInfoService,this.newBTS=this.dataInfoService.isNewBTS(this.billTrackerArgs.canTrackingResult.billTrackingSettings);var u=core$1.ReflectiveInjector.resolveAndCreate([BillTrackerInternalUiService],this.inj);this.internalUiService=u.get(BillTrackerInternalUiService,null),this.defaultDataWrapperHeight=e&&e.gridOptions&&e.gridOptions.defaultHeight?e.gridOptions.defaultHeight:this.defaultDataWrapperHeight}var BillTrackerUiService=(wu.prototype.openDefaultBillTrackerDialog=function(a,l,e,s,c){var p=this;if(void 0===l&&(l=!0),"string"==typeof e){if(""==e)return this.messager.info(this.localePipe.transform("modalOptionsCantBeEmpty")),rxjs.of(null);e=JSON.parse(e)}var d={title:this.localePipe.transform("billTracker")},d=Object.assign(d,this.defaultModalOptions,e);"string"==typeof s&&(s=""!=s?JSON.parse(s):null),"string"==typeof c&&(c=""!=c?JSON.parse(c):null);var t=new GetDownBillsInfoArgs;return t.billDataId=a.billDataId,t.documentTypeId=a.documentTypeId,t.bizKind=a.bizKind,t.bizType=a.bizType,t.billChildInfos=a.billChildInfos,t.curYear=a.curYear,this.loading.show({message:this.localePipe.transform("loading")}),this.dataService.canTracking(t).pipe(operators.switchMap(function(e){if(!e.canDownTracking&&!e.canUpTracking)return p.messager.info(p.localePipe.transform("noAssoBill")),p.loading.close(),rxjs.of(null);var t=new BillTrackerArgs;t.canTrackingResult=e,t.getBillsInfoArgs=a;var r=new BillTrackerGraphOptions,r=Object.assign(r,s);t.graphOptions=r;var o=new BillTrackerGridOptions,o=Object.assign(o,c);t.gridOptions=o;var i=p.createBillTrackerComponent(t);p.loading.close();var n=p.modalService.show(i,d);return l&&n.dialog.instance.maxDialog(),i.instance.setModalRef(n),rxjs.of(i.instance)}),operators.catchError(function(e){throw p.loading.close(),p.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),e}))},wu.prototype.openDefaultBillTrackerApp=function(n,a,l){var s=this;if("string"==typeof a){if(""==a)return void this.messager.info(this.localePipe.transform("modalOptionsCantBeEmpty"));a=JSON.parse(a)}if("string"==typeof l){if(""==l)return void this.messager.info(this.localePipe.transform("modalOptionsCantBeEmpty"));l=JSON.parse(l)}var e=new GetDownBillsInfoArgs;e.documentTypeId=n.documentTypeId,e.billDataId=n.billDataId,e.bizKind=n.bizKind,e.bizType=n.bizType,e.billChildInfos=n.billChildInfos,e.curYear=n.curYear,this.loading.show({message:this.localePipe.transform("loading")}),this.dataService.canTracking(e).subscribe(function(e){if(!e.canDownTracking&&!e.canUpTracking)return s.messager.info(s.localePipe.transform("noAssoBill")),void s.loading.close();var t=new BillTrackerArgs;t.canTrackingResult=e,t.getBillsInfoArgs=n;var r=new BillTrackerGraphOptions,r=Object.assign(r,a);t.graphOptions=r;var o=new BillTrackerGridOptions,o=Object.assign(o,l);t.gridOptions=o;var i={appId:BillTrackerConstant.DEFAULT_APP_ID,appEntrance:BillTrackerConstant.DEFAULT_APP_ENTRANCE,funcId:BillTrackerConstant.DEFAULT_FUNC_ID,tabId:"billTracker"+Date.now(),tabName:s.localePipe.transform("billTracker"),appType:rtfCommon.AppType.App,entityParams:t,queryStringParams:s.buildQueryMap(t),isReload:undefined};s.frameworkService.openMenu(i),s.loading.close()},function(e){throw s.loading.close(),s.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),e})},wu.prototype.createBillTrackerComponent=function(e,t,r,o){t=null==t?this.cfr:t,r=null==r?this.injector:r,o=null==o||0==Array.isArray(o)?[]:o;var i=core$1.ReflectiveInjector.resolveAndCreate(__spread([{provide:BillTrackerArgs,useValue:e}],o),r);return t.resolveComponentFactory(BillTrackerComponent).create(i)},wu.prototype.canTracking=function(e){return this.dataService.canTracking(e)},wu.prototype.getDownBillsInfo=function(e){return this.dataService.getDownBillsInfo(e)},wu.prototype.getUpBillsInfo=function(e){return this.dataService.getUpBillsInfo(e)},wu.prototype.getEntityData=function(e){return this.dataService.getEntityData(e)},wu.prototype.buildQueryMap=function(e){var t=new Map;for(var r in e){var o=e[r];"object"==typeof o&&(o=o&&JSON.stringify(o)),t.set(r,o)}return t},wu.decorators=[{type:core$1.Injectable}],wu.ctorParameters=function(){return[{type:rtfCommon.FrameworkService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:BillTrackerDataService},{type:uiModal.BsModalService},{type:core$1.ComponentFactoryResolver},{type:core$1.Injector}]},wu);function wu(e,t,r,o,i,n,a,l){this.frameworkService=e,this.messager=t,this.loading=r,this.dataService=i,this.modalService=n,this.cfr=a,this.injector=l,this.defaultModalOptions={title:null,width:1100,height:480,buttons:null,showButtons:null},this.localePipe=new BillTrackerLocalePipe(o)}var CellData=function(){this.diagramInfo={x:null,y:null,width:null,height:null,extProps:{}}},EntryCellData=(tv=CellData,__extends(uv,tv),uv),tv;function uv(){var e=null!==tv&&tv.apply(this,arguments)||this;return e.ups=[],e.downs=[],e}var UpCellData=(wv=CellData,__extends(xv,wv),xv),wv;function xv(){var e=null!==wv&&wv.apply(this,arguments)||this;return e.ups=[],e}var DownCellData=(zv=CellData,__extends(Av,zv),Av),zv;function Av(){var e=null!==zv&&zv.apply(this,arguments)||this;return e.downs=[],e}var billTrackerCellCss="\n.bif-cell-node { \n    position: relative;\n    height: 100%;\n    font-weight: normal;\n    font-family: PingFangSC-Regular;\n    display:block;\n    text-align: left;\n}\n.bif-cell-node-main { \n    height: 100%;\n    background: #FFFFFF;\n    border: 1px solid rgba(230,233,240,1);\n    box-shadow: 0px 2px 10px 0px rgba(3,18,51,0.08);\n    border-radius: 8px;\n    border-left-width: 4px;\n    border-left-color: #2A87FF;\n}\n.bif-cell-node-current {\n    position: absolute;\n    right: 0;\n    top: 0;\n    width: 50px;\n    height: 28px;\n    background-image: linear-gradient(39deg, #F5A144 0%, #FFC527 100%);\n    box-shadow: 0px 2px 6px 0px rgba(245,161,68,0.4);\n    border-radius: 0px 8px 0px 64px;\n    color: white;\n    text-align: center;\n}\n.bif-cell-node-current-text {\n    display: block;\n    margin: auto;\n    line-height: 28px;\n}\n.bif-cell-node-title {\n    padding-left:19px;\n    padding-right:12px;\n    padding-top: 16px;\n    padding-bottom: 6px;\n}\n.bif-cell-node-title-text { \n    font-size: 16px;\n    color: #2D2F33;\n    letter-spacing: 0;\n    line-height: 24px;\n    font-weight: 400;\n}\n.bif-cell-node-summary-list { \n    \n}\n.bif-cell-node-summary { \n    display: flex;\n    padding-left: 19px;\n    padding-right:12px;\n    font-size: 13px;\n    color: #5A5E66;\n    line-height: 24px;\n    font-weight: 400;\n}\n.bif-cell-node-summary-caption { \n    letter-spacing: 0;\n    margin-right: 4px;\n    width: 52px;\n    min-width: 52px;\n    text-align: right;\n}\n.bif-cell-node-summary-caption-text { \n    white-space: normal;\n    text-overflow: ellipsis;\n    overflow: hidden;\n    word-break: break-all;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n    -webkit-line-clamp: 1;\n}\n.bif-cell-node-summary-value { \n    \n}\n.bif-cell-node-summary-value-text { \n    font-family: PingFangSC-Regular,HelveticaNeue,Helvetica,Arial,sans-serif;\n    color: rgba(0,0,0,0.85);\n    text-align: left;\n    white-space: normal;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n    overflow: hidden;\n    -webkit-line-clamp: 1;\n    word-break: break-all;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n.bif-cell-node-title-link { \n}\n.bif-cell-node-title-link:hover { \n    text-decoration: underline;\n    cursor: pointer;\n}\n.bif-cell-node-title-link-color {\n    color: #56A0FF;\n}\n.bif-cell-node-title-only {\n    justify-content: center;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    border: 1px solid rgb(193,195,199,1);\n}\n.bif-cell-node-title-only-text {\n    font-size: xx-large;\n}\n.bif-cell-node-thumb {\n    height: 100%;\n    background: #FFFFFF;\n}\n.bif-cell-node-thumb-img-container {\n    height: 80%;\n}\n.bif-cell-node-thumb-img {\n    height: 100%;\n    width: 100%;\n}\n.bif-cell-node-thumb-title {\n    height: 20%;\n    display: flex;\n    justify-content: center;\n    display: flex;\n    align-items: center;\n}\n.bif-cell-node-thumb-title-text {\n    font-size: x-large;\n}\n";function addCustomCSS(t){var e,r,o=document.createElement("style"),i=document.head||document.getElementsByTagName("head")[0];o.type="text/css",o.styleSheet?(e=function(){try{o.styleSheet.cssText=t}catch(e){}},o.styleSheet.disabled?setTimeout(e,10):e()):(r=document.createTextNode(t),o.appendChild(r)),i.appendChild(o)}addCustomCSS(billTrackerCellCss);var BillTrackerGraphComponent=(Jv.prototype.ngOnInit=function(){this.graph=this.createGraph(),this.createLayout(this.graph),this.layoutManager=new mxLayoutManagerType(this.graph),this.outline=new Outline(this.graph,this.mxOutlineContainer.nativeElement)},Jv.prototype.ngAfterViewInit=function(){},Jv.prototype.refresh=function(e){void 0===e&&(e=!0),e&&null!=this.graph&&this.graph.sizeDidChange()},Jv.prototype.paint=function(){this.paintGraph(this.graph)},Jv.prototype.setModalRef=function(e){var t,r=this;this.modalRef=e,null!=this.modalRef&&(this.modalRef.dialog.instance.closed.subscribe(function(e){r.graph&&r.graph.destroy()}),t=0,this.modalRef.dialog.instance.resized.subscribe(function(e){2<=t&&r.refresh(),t++}))},Jv.prototype.createGraph=function(){mxGraphHandlerType.prototype.guidesEnabled=!0,mxEventType.disableContextMenu(this.mxContainerER.nativeElement),mxGraphHandlerType.prototype.scrollOnMove=!1,mxGraphHandlerType.prototype.scaleGrid=!0,mxConstantsType.HANDLE_FILLCOLOR="#29b6f2",mxHandleType.prototype.createShape=function(e){var t=new mxEllipseType(0,0,mxConstantsType.HANDLE_SIZE,mxConstantsType.HANDLE_SIZE);return new mxEllipseType(t,mxConstantsType.HANDLE_FILLCOLOR,mxConstantsType.HANDLE_STROKECOLOR)},mxVertexHandlerType.prototype.handleImage=mxClientType.IS_SVG?Graph.createSvgImage(18,18,'<circle cx="9" cy="9" r="3" stroke="#fff" fill="'+Graph.handleFill+'" stroke-width="1"/>'):new mxImageType(BillTrackerConstant.IMAGE_PATH+"/handle-main.png",mxConstantsType.HANDLE_SIZE,mxConstantsType.HANDLE_SIZE),mxConstantsType.DEFAULT_VALID_COLOR="#FFFFFF",mxConstantsType.HIGHLIGHT_STROKEWIDTH=1,mxConstantsType.GUIDE_COLOR="#0088cf",mxGuideType.prototype.createGuideShape=function(e){return new mxPolylineType([],mxConstantsType.GUIDE_COLOR,mxConstantsType.GUIDE_STROKEWIDTH)},mxConstantsType.VERTEX_SELECTION_STROKEWIDTH=1,mxConstantsType.VERTEX_SELECTION_COLOR="#3E8DFF",mxConstantsType.VERTEX_SELECTION_DASHED=!1,mxConnectionHandlerType.prototype.getEdgeWidth=function(e){return 1},mxConstantsType.VALID_COLOR="#00CD66";var e=new Graph(this.mxContainerER.nativeElement,undefined,undefined,undefined);return e.graphOptions=this.graphOptions,e.gridOptions=this.gridOptions,this.addListener(e),e},Jv.prototype.createLayout=function(e){var t=new RevertCompactTreeLayout(e,!0);t.levelDistance=this.hspace,t.edgeRouting=!1,t.resetEdges=!1,this.upLayout=t;var r=new CompactTreeLayout(e,!0);r.levelDistance=this.hspace,r.edgeRouting=!1,r.resetEdges=!0,this.downLayout=r},Jv.prototype.addListener=function(e){var o=this;mxEventType.addListener(window,"resize",function(){window.setTimeout(function(){null!=o.graph&&o.refresh()},0)}),mxEventType.addMouseWheelListener(function(e,t){if(mxEventType.isControlDown(e)||mxClientType.IS_MAC&&e.metaKey)return t?o.zoomIn():o.zoomOut(),mxEventType.consume(e),!1},this.mxContainerER.nativeElement),e.getSelectionModel().addListener(mxEventType.CHANGE,function(e,t){var r;e instanceof mxGraphSelectionModelType&&(null!=e.cells&&1==e.cells.length?!(r=e.cells[0]).edge&&r.vertex&&o.selectEventEmitter.emit(r):o.selectEventEmitter.emit(null))}),e.addListener(Events.CLICK_FIRST_SUMMARY,function(e,t){var r=t.getProperty("cell");o.stateChangeEventEmitter.emit({type:Events.CLICK_FIRST_SUMMARY,data:r})})},Jv.prototype.paintGraph=function(e){e.getModel().beginUpdate(),this.entry=this.paintEntry(e),this.afterPaintGraph(this.graph,this.entry),e.getModel().endUpdate()},Jv.prototype.afterPaintGraph=function(e,t){var r;null!=t&&(this.billTrackerArgs.gridOptions.showEntryData&&e.setSelectionCell(this.entry),r=this.billTrackerArgs.canTrackingResult,1==this.billTrackerArgs.graphOptions.showDownBills&&r.canDownTracking&&this.entry.downCellOverlay&&this.entry.downCellOverlay.fireEvent(new mxEventObjectType(mxEventType.CLICK)),1==this.billTrackerArgs.graphOptions.showUpBills&&r.canUpTracking&&this.entry.upCellOverlay&&this.entry.upCellOverlay.fireEvent(new mxEventObjectType(mxEventType.CLICK)))},Jv.prototype.paintEntry=function(e){var t=null;if(null==this.billTrackerArgs||null==this.billTrackerArgs.canTrackingResult)return t;var r=this.billTrackerArgs.canTrackingResult,o=this.dataService.buildEntryBillInfo(r),i=o.billDataInfos[0];(new commonApi$1.BillTrackingSettings).LoadFromJson(r.billTrackingSettings);var n=e.getDefaultParent();e.getModel().beginUpdate();try{var a=new commonApi$1.BillTrackingSettings;o&&o.billTrackingSettings&&a.LoadFromJson(o.billTrackingSettings);var l,t=e.insertBillCell(n,null,i,o,!0,0,0,this.nodeWidth,this.nodeHeight,"billNode;billNodeEntry;");e.getModel().getGeometry(t),e.getPreferredSizeForCell(t),this.entryCellData=new EntryCellData,this.setCellData(this.entryCellData,t),this.entryCellData.canTrackingResult=r,t.data=this.entryCellData,r.canDownTracking&&(l=this.addDownOverlay(e,t,!0),t.downCellOverlay=l),r.canUpTracking&&(l=this.addUpOverlay(e,t,!0),t.upCellOverlay=l),this.upParent=n.clone(),this.downParent=n.clone(),e.addCells([this.upParent,this.downParent],n)}finally{e.getModel().endUpdate()}return t},Jv.prototype.addUpOverlay=function(r,o,i){var n=this;void 0===i&&(i=!1);var a=new CellOverlay(this.upSearchImage,this.localePipe.transform("upSearch"),mxConstantsType.ALIGN_LEFT,mxConstantsType.ALIGN_MIDDLE,this.upSearchOffset,"hand");a.state=CellOverlayState.Search;var l=function(e,t){r.getModel().beginUpdate(),n.addUpAssoCell(r,o,i),a.removeListener(l),a.tooltip=n.localePipe.transform("folder"),a.image=n.upFolderImage,a.state=CellOverlayState.Fold,a.addListener(mxEventType.CLICK,s),r.removeCellOverlay(o,a),r.addCellOverlay(o,a),r.getModel().endUpdate()},s=function(e,t){r.getModel().beginUpdate(),n.removeAssoCell(r,o,BillTrackerDirection.Up),a.removeListener(s),a.tooltip=n.localePipe.transform("upSearch"),a.image=n.upSearchImage,a.state=CellOverlayState.Search,a.addListener(mxEventType.CLICK,l),r.removeCellOverlay(o,a),r.addCellOverlay(o,a),r.model.endUpdate()};return a.addListener(mxEventType.CLICK,l),r.removeCellOverlay(o,a),r.addCellOverlay(o,a),a},Jv.prototype.addDownOverlay=function(r,o,i){var n=this;void 0===i&&(i=!1);var a=new CellOverlay(this.downSearchImage,this.localePipe.transform("downSearch"),mxConstantsType.ALIGN_RIGHT,mxConstantsType.ALIGN_MIDDLE,this.downSearchOffset,"hand");a.state=CellOverlayState.Search;var l=function(e,t){r.getModel().beginUpdate(),n.addDownAssoCell(r,o,i),a.image=n.downFolderImage,a.tooltip=n.localePipe.transform("folder"),a.state=CellOverlayState.Fold,a.removeListener(l),a.addListener(mxEventType.CLICK,s),r.removeCellOverlay(o,a),r.addCellOverlay(o,a),r.getModel().endUpdate()},s=function(e,t){r.getModel().beginUpdate(),n.removeAssoCell(r,o,BillTrackerDirection.Down),a.image=n.downSearchImage,a.tooltip=n.localePipe.transform("downSearch"),a.state=CellOverlayState.Search,a.removeListener(s),a.addListener(mxEventType.CLICK,l),r.removeCellOverlay(o,a),r.addCellOverlay(o,a),r.getModel().endUpdate()};return a.addListener(mxEventType.CLICK,l),r.removeCellOverlay(o,a),r.addCellOverlay(o,a),a},Jv.prototype.addUpAssoCell=function(O,k,J){var _=this;void 0===J&&(J=!1),O.getModel().beginUpdate();var e=this.dataService.buildGetUpBillsInfoArgs(k);this.loading.show({message:this.localePipe.transform("loading")}),this.numCellsAddingReq++,this.dataService.getUpBillsInfo(e).subscribe(function(e){var t,r,o,i,n,a,l,s,c=O.getDefaultParent(),p=[];try{try{for(var d=__values(e),u=d.next();!u.done;u=d.next()){var m=u.value;try{for(var h=__values(m.billDataInfos),y=h.next();!y.done;y=h.next()){var f=y.value,g=new commonApi$1.BillTrackingSettings;m&&m.billTrackingSettings&&g.LoadFromJson(m.billTrackingSettings);var x=O.insertBillCell(_.upParent,null,f,m,!1,k.geometry.x-_.hspace,k.geometry.y,_.nodeWidth,_.nodeHeight,"billNode;");p.push(x)}}catch(R){o={error:R}}finally{try{y&&!y.done&&(i=h["return"])&&i.call(h)}finally{if(o)throw o.error}}}}catch(L){t={error:L}}finally{try{u&&!u.done&&(r=d["return"])&&r.call(d)}finally{if(t)throw t.error}}_.calCellsPosition(O,k,p,BillTrackerDirection.Up);try{for(var v,b=__values(p),T=b.next();!T.done;T=b.next())(M=T.value).billDataInfo.canContinueTracking&&(v=_.addUpOverlay(O,M),M.upCellOverlay=v),O.insertEdge(c,null,"",M,k,"billAssociation;")}catch(P){n={error:P}}finally{try{T&&!T.done&&(a=b["return"])&&a.call(b)}finally{if(n)throw n.error}}var C=_.entry.getGeometry().clone();_.upLayout.execute(_.upParent,_.entry);var S=_.entry.getGeometry().clone(),A=C.x-S.x,I=C.y-S.y;_.restoreEntryPosition(O,_.entry,A,I);var B=k.data;B.ups.length=0;try{for(var E=__values(p),w=E.next();!w.done;w=E.next()){var M=w.value,D=new UpCellData;_.setCellData(D,M),((M.data=D).down=B).ups.push(D)}}catch(F){l={error:F}}finally{try{w&&!w.done&&(s=E["return"])&&s.call(E)}finally{if(l)throw l.error}}}finally{O.getModel().endUpdate()}J&&O.fireEvent(new mxEventObjectType(Events.RESET_GRAPH_VIEW)),_.numCellsAddingReq--,_.graph.fireEvent(new mxEventObjectType(Events.BILL_CELLS_ADDED_AND_MOVED,"cells",p,"parent",_.upParent)),_.loading.close()},function(e){throw _.numCellsAddingReq--,_.loading.close(),_.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),e})},Jv.prototype.addDownAssoCell=function(O,k,J){var _=this;void 0===J&&(J=!1),O.getModel().beginUpdate();var e=this.dataService.buildGetDownBillsInfoArgs(k);this.loading.show({message:this.localePipe.transform("loading")}),this.numCellsAddingReq++,this.dataService.getDownBillsInfo(e).subscribe(function(e){O.getModel();var t,r,o,i,n,a,l,s,c=O.getDefaultParent(),p=[];try{try{for(var d=__values(e),u=d.next();!u.done;u=d.next()){var m=u.value;try{for(var h=__values(m.billDataInfos),y=h.next();!y.done;y=h.next()){var f=y.value,g=new commonApi$1.BillTrackingSettings;m&&m.billTrackingSettings&&g.LoadFromJson(m.billTrackingSettings);var x=O.insertBillCell(_.downParent,null,f,m,!1,k.geometry.x+_.hspace,k.geometry.y,_.nodeWidth,_.nodeHeight,"billNode;");p.push(x)}}catch(R){o={error:R}}finally{try{y&&!y.done&&(i=h["return"])&&i.call(h)}finally{if(o)throw o.error}}}}catch(L){t={error:L}}finally{try{u&&!u.done&&(r=d["return"])&&r.call(d)}finally{if(t)throw t.error}}_.calCellsPosition(O,k,p,BillTrackerDirection.Down);try{for(var v,b=__values(p),T=b.next();!T.done;T=b.next())(M=T.value).billDataInfo.canContinueTracking&&(v=_.addDownOverlay(O,M),M.downCellOverlay=v),O.insertEdge(c,null,"",k,M,"billAssociation;")}catch(P){n={error:P}}finally{try{T&&!T.done&&(a=b["return"])&&a.call(b)}finally{if(n)throw n.error}}var C=_.entry.getGeometry().clone();_.downLayout.execute(_.downParent,_.entry);var S=_.entry.getGeometry().clone(),A=C.x-S.x,I=C.y-S.y;_.restoreEntryPosition(O,_.entry,A,I);var B=k.data;B.downs.length=0;try{for(var E=__values(p),w=E.next();!w.done;w=E.next()){var M=w.value,D=new DownCellData;_.setCellData(D,M),((M.data=D).up=B).downs.push(D)}}catch(F){l={error:F}}finally{try{w&&!w.done&&(s=E["return"])&&s.call(E)}finally{if(l)throw l.error}}}finally{O.getModel().endUpdate()}J&&O.fireEvent(new mxEventObjectType(Events.RESET_GRAPH_VIEW)),_.numCellsAddingReq--,_.graph.fireEvent(new mxEventObjectType(Events.BILL_CELLS_ADDED_AND_MOVED,"cells",p,"parent",_.downParent)),_.loading.close()},function(e){throw _.numCellsAddingReq--,_.loading.close(),_.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),e})},Jv.prototype.removeAssoCell=function(e,t,r){var o=e.getModel();e.getDefaultParent(),e.getModel().beginUpdate();try{var i=[];if(r==BillTrackerDirection.Down)for(var n=o.getOutgoingEdges(t),a=0;n&&0<n.length&&a<n.length;)n[a].target&&n[a].target!=this.entry&&(i.push(n[a].target),n.push.apply(n,__spread(o.getOutgoingEdges(n[a].target)))),a++;else if(r==BillTrackerDirection.Up)for(n=o.getIncomingEdges(t),a=0;n&&0<n.length&&a<n.length;)n[a].source&&n[a].source!=this.entry&&(i.push(n[a].source),n.push.apply(n,__spread(o.getIncomingEdges(n[a].source)))),a++;r==BillTrackerDirection.Down?t.data.downs.length=0:r==BillTrackerDirection.Up&&(t.data.ups.length=0),e.removeCells(i);var l=this.entry.getGeometry().clone();this.upLayout.execute(this.upParent,this.entry);var s=this.entry.getGeometry().clone(),c=l.x-s.x,p=l.y-s.y;this.restoreEntryPosition(e,this.entry,c,p);var d=this.entry.getGeometry().clone();this.downLayout.execute(this.downParent,this.entry);var u=this.entry.getGeometry().clone(),m=d.x-u.x,h=d.y-u.y;this.restoreEntryPosition(e,this.entry,m,h)}finally{e.getModel().endUpdate()}},Jv.prototype.restoreEntryPosition=function(e,t,r,o){e.getModel().beginUpdate();try{var i=__spread([t],e.getChildCells(this.upParent,!0,!1),e.getChildCells(this.downParent,!0,!1));e.moveCells(i,r,o)}finally{e.getModel().endUpdate()}},Jv.prototype.calCellsPosition=function(e,t,r,o){o==BillTrackerDirection.Down?this.resetDownCellsPosition(e,t,r):o==BillTrackerDirection.Up&&this.resetUpCellsPosition(e,t,r)},Jv.prototype.resetDownCellsPosition=function(t,e,r){t.getModel().beginUpdate();try{for(var o=t.getOutgoingEdges(e).map(function(e){return e.target}),i=o.sort(function(e,t){return e.geometry&&t.geometry?t.geometry.y-e.geometry.y:Number.MIN_VALUE}),n=0<i.length?i[i.length-1].geometry.y:e.geometry.y,a=0<i.length?i[0].geometry.y:e.geometry.y,l=0;l<r.length;l++)a=0<o.length?a+this.vspace:a,t.translateCell(r[l],0,a-r[l].geometry.y),o.push(r[l]);var s,c,p=(a+n)/2,d=e.geometry.y-p;for(var u in o.forEach(function(e){t.translateCell(e,0,d)}),n+=d,a+=d,p+=d,t.model.cells)t.model.cells[u]!=t.model.root&&null!=t.model.cells[u].geometry&&1!=t.model.cells[u].edge&&t.model.cells[u]!=e&&-1==r.indexOf(t.model.cells[u])&&t.model.cells[u]!=this.entry&&(t.model.cells[u].geometry.x<this.entry.geometry.x||(c=(s=t.model.cells[u]).geometry,t.translateCell(s,0,c.y<=e.geometry.y?n-(e.geometry.y-c.y)-c.y:a+(c.y-e.geometry.y)-c.y)))}finally{t.getModel().endUpdate()}},Jv.prototype.resetUpCellsPosition=function(t,e,r){t.getModel().beginUpdate();try{for(var o=t.getIncomingEdges(e).map(function(e){return e.source}),i=o.sort(function(e,t){return e.geometry&&t.geometry?t.geometry.y-e.geometry.y:Number.MIN_VALUE}),n=0<i.length?i[i.length-1].geometry.y:e.geometry.y,a=0<i.length?i[0].geometry.y:e.geometry.y,l=0;l<r.length;l++)a=0<o.length?a+this.vspace:a,t.translateCell(r[l],0,a-r[l].geometry.y),o.push(r[l]);var s,c,p=(a+n)/2,d=e.geometry.y-p;for(var u in o.forEach(function(e){t.translateCell(e,0,d)}),n+=d,a+=d,p+=d,t.model.cells)t.model.cells[u]!=t.model.root&&null!=t.model.cells[u].geometry&&1!=t.model.cells[u].edge&&t.model.cells[u]!=e&&-1==r.indexOf(t.model.cells[u])&&t.model.cells[u]!=this.entry&&(t.model.cells[u].geometry.x>this.entry.geometry.x||(c=(s=t.model.cells[u]).geometry,t.translateCell(s,0,c.y<=e.geometry.y?n-(e.geometry.y-c.y)-c.y:a+(c.y-e.geometry.y)-c.y)))}finally{t.getModel().endUpdate()}},Jv.prototype.setCellData=function(e,t){e.billInfo=t.billInfo,e.billDataInfo=t.billDataInfo,e.visible=!0,e.diagramInfo.x=t.geometry.x,e.diagramInfo.y=t.geometry.y,e.diagramInfo.width=t.geometry.width,e.diagramInfo.height=t.geometry.height,e.diagramInfo.extProps={style:t.style}},Jv.prototype.zoomOut=function(){this.graph.zoomOut()},Jv.prototype.zoomIn=function(){this.graph.zoomIn()},Jv.prototype.zoomActual=function(){this.graph.zoomActual()},Jv.prototype.getZoomScale=function(){return Math.round(100*this.graph.view.scale)},Jv.prototype.print=function(){var e=new mxPrintPreviewType(this.graph,1);e.printOverlays=!0,e.printControls=!0,e.printBackgroundImage=!0,e.open(billTrackerCellCss)},Jv.prototype.expand=function(e,t){var r;void 0===t&&(t=!1),t?this.expandAll(e):e==BillTrackerDirection.Up?(r=[this.entry],this.upParent.children&&r.push.apply(r,__spread(this.upParent.children)),r.forEach(function(e){e.upCellOverlay&&e.upCellOverlay.state==CellOverlayState.Search&&e.upCellOverlay.fireEvent(new mxEventObjectType(mxEventType.CLICK))})):e==BillTrackerDirection.Down&&(r=[this.entry],this.downParent.children&&r.push.apply(r,__spread(this.downParent.children)),r.forEach(function(e){e.downCellOverlay&&e.downCellOverlay.state==CellOverlayState.Search&&e.downCellOverlay.fireEvent(new mxEventObjectType(mxEventType.CLICK))}))},Jv.prototype.expandAll=function(e){var r,o=this;e!=BillTrackerDirection.Up&&e!=BillTrackerDirection.Down||(r=null,e==BillTrackerDirection.Up?r=function(){var e=[o.entry];o.upParent.children&&e.push.apply(e,__spread(o.upParent.children));var t=e.filter(function(e){return e.upCellOverlay&&e.upCellOverlay.state==CellOverlayState.Search});null==t||0==t.length?0===o.numCellsAddingReq&&(o.graph.removeListener(r),console.timeEnd("ExpandAll")):t.forEach(function(e){e.upCellOverlay&&e.upCellOverlay.state==CellOverlayState.Search&&e.upCellOverlay.fireEvent(new mxEventObjectType(mxEventType.CLICK))})}:e==BillTrackerDirection.Down&&(r=function(){var e=[o.entry];o.downParent.children&&e.push.apply(e,__spread(o.downParent.children));var t=e.filter(function(e){return e.downCellOverlay&&e.downCellOverlay.state==CellOverlayState.Search});null==t||0==t.length?0===o.numCellsAddingReq&&(o.graph.removeListener(r),console.timeEnd("ExpandAll")):t.forEach(function(e){e.downCellOverlay&&e.downCellOverlay.state==CellOverlayState.Search&&e.downCellOverlay.fireEvent(new mxEventObjectType(mxEventType.CLICK))})}),console.time("ExpandAll"),this.graph.addListener("billCellsAddedAndMoved",r),r())},Jv.decorators=[{type:core$1.Component,args:[{selector:"lib-bill-tracker-graph",template:'<div #mxContainer id="mx-container" class="mx-container-ng">\r\n\r\n</div>\r\n\r\n<div #mxOutlineContainer id="mx-outline-container" class="mx-outline-container" [style.top]="modalRef?\'50px\':null">\r\n\r\n</div>',styles:[".mx-container-ng{position:absolute;top:0;left:0;bottom:0;right:0;cursor:default;overflow:auto;padding-right:16px;padding-bottom:16px;margin:4px}.mx-outline-container{z-index:1;position:absolute;overflow:hidden;top:20px;right:20px;width:160px;height:120px;background:#fff;border:1px solid #d3d3d3}"]}]}],Jv.ctorParameters=function(){return[{type:BillTrackerArgs},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:BillTrackerDataService},{type:uiNotify.NotifyService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:uiModal.BsModalService},{type:core$1.ViewContainerRef},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.ChangeDetectorRef}]},Jv.propDecorators={mxContainerER:[{type:core$1.ViewChild,args:["mxContainer"]}],mxOutlineContainer:[{type:core$1.ViewChild,args:["mxOutlineContainer"]}],selectEventEmitter:[{type:core$1.Output,args:["select"]}],stateChangeEventEmitter:[{type:core$1.Output,args:["stateChange"]}],billTrackerArgs:[{type:core$1.Input,args:["billTrackerArgs"]}]},Jv);function Jv(e,t,r,o,i,n,a,l,s,c,p){this.dataService=r,this.notify=o,this.messager=i,this.loading=n,this.modal=a,this.vcr=l,this.inj=s,this.cfr=c,this.cdr=p,this.selectEventEmitter=new core$1.EventEmitter,this.stateChangeEventEmitter=new core$1.EventEmitter,this.hspace=80,this.vspace=28,this.defaultWidth=250,this.defaultHeight=138,this.nodeWidth=this.defaultWidth,this.nodeHeight=this.defaultHeight,this.defaultNonEntryImage=mxClientType.IS_SVG?BillTrackerConstant.IMAGE_PATH+"/non-entry-bill.svg":BillTrackerConstant.IMAGE_PATH+"/non-entry-bill.png",this.defaultEntryImage=mxClientType.IS_SVG?BillTrackerConstant.IMAGE_PATH+"/entry-bill.svg":BillTrackerConstant.IMAGE_PATH+"/entry-bill.png",this.defaultOverlayWidth=26,this.defaultOverlayHeight=26,this.overlayWidth=this.defaultOverlayWidth,this.overlayHeight=this.defaultOverlayHeight,this.defaultUpSearchImage=new mxImageType(BillTrackerConstant.IMAGE_PATH+"/tracker-plus.svg",this.overlayWidth,this.overlayHeight),this.defaultDownSearchImage=new mxImageType(BillTrackerConstant.IMAGE_PATH+"/tracker-plus.svg",this.overlayWidth,this.overlayHeight),this.defaultUpFolderImage=new mxImageType(BillTrackerConstant.IMAGE_PATH+"/tracker-minus.svg",this.overlayWidth,this.overlayHeight),this.defaultDownFolderImage=new mxImageType(BillTrackerConstant.IMAGE_PATH+"/tracker-minus.svg",this.overlayWidth,this.overlayHeight),this.upSearchImage=this.defaultUpSearchImage,this.downSearchImage=this.defaultDownSearchImage,this.upFolderImage=this.defaultUpFolderImage,this.downFolderImage=this.defaultDownFolderImage,this.upSearchOffset=new mxPointType(-50,0),this.downSearchOffset=new mxPointType(50,0),this.numCellsAddingReq=0,this.localePipe=new BillTrackerLocalePipe(t),this.dataInfoService=new BillTrackerDataInfoService,this.billTrackerArgs=e;var d=this.billTrackerArgs.graphOptions;this.graphOptions=d;var u=this.billTrackerArgs.gridOptions;this.gridOptions=u,this.upSearchImage=d&&d.upSearchImage?new mxImageType(d.upSearchImage,this.overlayWidth,this.overlayHeight):this.upSearchImage,this.downSearchImage=d&&d.downSearchImage?new mxImageType(d.downSearchImage,this.overlayWidth,this.overlayHeight):this.downSearchImage,this.upFolderImage=d&&d.upFolderImage?new mxImageType(d.upFolderImage,this.overlayWidth,this.overlayHeight):this.upFolderImage,this.downFolderImage=d&&d.downFolderImage?new mxImageType(d.downFolderImage,this.overlayWidth,this.overlayHeight):this.downFolderImage}var BillFrontField=function(){},BillFrontDataRow=function(){},BasicTableComponent=(vA.prototype.ngOnInit=function(){},vA.prototype.clickHandler=function(e,t){e.expanded=!e.expanded},vA.prototype.showMainTable=function(e){this.showTable(e.billSchema.mainTable,e.billData.mainTable)},vA.prototype.showTable=function(e,t){this.billSchemaTable=e,this.billDataTable=t,this.loadData(e.getFieldList(),t.GetRowList()),this.cdr.detectChanges()},vA.prototype.loadData=function(e,t){this.fields=e,this.rows=t;var r=new commonApi$1.BillTrackingSettings;this.billInfo&&this.billInfo.billTrackingSettings&&r.LoadFromJson(this.billInfo.billTrackingSettings),r.billTrackingDataShownMode==commonApi$1.BillTrackingDataShownMode.CUSTOMFIELD?this.ffields=this.extractFFieldsWithCustomFields(e,r.customFieldContent):this.ffields=this.extractFFields(e),this.frows=this.extractFRows(t,this.ffields)},vA.prototype.extractFFields=function(e){var t,r,o=[];try{for(var i=__values(e),n=i.next();!n.done;n=i.next()){var a,l=n.value;"Enum"==l.fieldType||"EnumSingleUdt"==l.fieldType?((a=new BillFrontField).fieldName=l.fieldName,a.dataType=l.dataType,a.caption=l.caption,a.fieldType=l.fieldType,a.length=l.length,a.precision=l.precision,a.scale=l.scale,a.captionPath=this.extractCaptionPath(l),a.fieldPath=this.extractFieldPath(l)+".Name",o.push(a)):null!=l.GetSubFieldList()&&0<l.GetSubFieldList().length?o.push.apply(o,__spread(this.extractFSubFields(l.GetSubFieldList()))):((a=new BillFrontField).fieldName=l.fieldName,a.dataType=l.dataType,a.caption=l.caption,a.fieldType=l.fieldType,a.length=l.length,a.precision=l.precision,a.scale=l.scale,a.captionPath=this.extractCaptionPath(l),a.fieldPath=this.extractFieldPath(l),o.push(a))}}catch(s){t={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}return o},vA.prototype.extractFSubFields=function(e,t){var r,o,i=[];try{for(var n=__values(e),a=n.next();!a.done;a=n.next()){var l,s=a.value;"Enum"==s.fieldType||"EnumSingleUdt"==s.fieldType?((l=new BillFrontField).fieldName=s.fieldName,l.dataType=s.dataType,l.caption=s.caption,l.fieldType=s.fieldType,l.length=s.length,l.precision=s.precision,l.scale=s.scale,l.captionPath=this.extractCaptionPath(s),l.fieldPath=this.extractFieldPath(s)+".Name",i.push(l)):null!=s.GetSubFieldList()&&0<s.GetSubFieldList().length?i.push.apply(i,__spread(this.extractFSubFields(s.GetSubFieldList()))):((l=new BillFrontField).fieldName=s.fieldName,l.dataType=s.dataType,l.caption=s.caption,l.fieldType=s.fieldType,l.length=s.length,l.precision=s.precision,l.scale=s.scale,l.captionPath=this.extractCaptionPath(s),l.fieldPath=this.extractFieldPath(s),i.push(l))}}catch(c){r={error:c}}finally{try{a&&!a.done&&(o=n["return"])&&o.call(n)}finally{if(r)throw r.error}}return i},vA.prototype.extractFFieldsWithCustomFields=function(e,a){var t,r,l=this.billSchemaTable.tableName,o=new commonApi$1.BillTrackingSettings;this.billInfo&&this.billInfo.billTrackingSettings&&o.LoadFromJson(this.billInfo.billTrackingSettings);var s="object"==typeof a?a:JSON.parse(a),c=[],p=this;try{for(var i=__values(e),n=i.next();!n.done;n=i.next())!function(e){var t,r=p.extractFieldPath(e),o=null;for(var i in s.schema)if("selectedAll"!=i&&i==l){var n=s.schema[i],o=n&&n.fields.find(function(e){return e.fieldPath==r});break}null!=o&&("Enum"==e.fieldType||"EnumSingleUdt"==e.fieldType?((t=new BillFrontField).fieldName=e.fieldName,t.dataType=e.dataType,t.caption=e.caption,t.fieldType=e.fieldType,t.length=e.length,t.precision=e.precision,t.scale=e.scale,t.captionPath=o.displayName||e.caption,t.fieldPath=p.extractFieldPath(e)+".Name",c.push(t)):null!=e.GetSubFieldList()&&0<e.GetSubFieldList().length?c.push.apply(c,__spread(p.extractFSubFieldsWithCustomFields(e.GetSubFieldList(),a,e))):((t=new BillFrontField).fieldName=e.fieldName,t.dataType=e.dataType,t.caption=e.caption,t.fieldType=e.fieldType,t.length=e.length,t.precision=e.precision,t.scale=e.scale,t.captionPath=o.displayName||e.caption,t.fieldPath=p.extractFieldPath(e),c.push(t)))}(n.value)}catch(d){t={error:d}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}return c},vA.prototype.extractFSubFieldsWithCustomFields=function(e,a,t){var r,o,l=this.billSchemaTable.tableName,i=new commonApi$1.BillTrackingSettings;this.billInfo&&this.billInfo.billTrackingSettings&&i.LoadFromJson(this.billInfo.billTrackingSettings);var s="object"==typeof a?a:JSON.parse(a),c=[],p=this;try{for(var n=__values(e),d=n.next();!d.done;d=n.next())!function(e){var t,r=p.extractFieldPath(e),o=null;for(var i in s.schema)if("selectedAll"!=i&&i==l){var n=s.schema[i],o=n&&n.fields.find(function(e){return e.fieldPath==r});break}null!=o&&("Enum"==e.fieldType||"EnumSingleUdt"==e.fieldType?((t=new BillFrontField).fieldName=e.fieldName,t.dataType=e.dataType,t.caption=e.caption,t.fieldType=e.fieldType,t.length=e.length,t.precision=e.precision,t.scale=e.scale,t.captionPath=o.displayName||e.caption,t.fieldPath=p.extractFieldPath(e)+".Name",c.push(t)):null!=e.GetSubFieldList()&&0<e.GetSubFieldList().length?c.push.apply(c,__spread(p.extractFSubFieldsWithCustomFields(e.GetSubFieldList(),a,e))):((t=new BillFrontField).fieldName=e.fieldName,t.dataType=e.dataType,t.caption=e.caption,t.fieldType=e.fieldType,t.length=e.length,t.precision=e.precision,t.scale=e.scale,t.captionPath=o.displayName||e.caption,t.fieldPath=p.extractFieldPath(e),c.push(t)))}(d.value)}catch(u){r={error:u}}finally{try{d&&!d.done&&(o=n["return"])&&o.call(n)}finally{if(r)throw r.error}}return c},vA.prototype.extractCaptionPath=function(e){for(var t=e.caption,r=e;null!=r.attachedField;)t=r.attachedField.caption+"."+t,r=r.attachedField;return t},vA.prototype.extractFieldPath=function(e){for(var t=e.fieldName,r=e;null!=r.attachedField;)t=r.attachedField.fieldName+"."+t,r=r.attachedField;return t},vA.prototype.extractFRows=function(e,t){var r,o,i,n,a=[];try{for(var l=__values(e),s=l.next();!s.done;s=l.next()){var c=s.value,p=new BillFrontDataRow;p.expanded=0==c.GetChildTableList().length?null:!(!c.attachedTable||null!=c.attachedTable.attachedRow),p.hasChildren=this.hasChildren(c),p.data={};try{for(var d=__values(t),u=d.next();!u.done;u=d.next()){var m=u.value;p.data[m.fieldPath]=this.extractFieldPathValue(c.GetFieldMap(),m.fieldPath)}}catch(h){i={error:h}}finally{try{u&&!u.done&&(n=d["return"])&&n.call(d)}finally{if(i)throw i.error}}a.push(p)}}catch(y){r={error:y}}finally{try{s&&!s.done&&(o=l["return"])&&o.call(l)}finally{if(r)throw r.error}}return a},vA.prototype.hasChildren=function(e){var t,r,o=e.GetChildTableList()&&0<e.GetChildTableList().length;if(o){var i=!1;try{for(var n=__values(e.GetChildTableList()),a=n.next();!a.done;a=n.next()){var l=a.value;if(l.GetRowList()&&0<l.GetRowList().length){i=!0;break}}}catch(s){t={error:s}}finally{try{a&&!a.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}o=i}return o},vA.prototype.extractFieldPathValue=function(e,t){for(var r=t.split("."),o=e[r[0]],i=1;null!=o&&i<r.length;i++){var n=o.GetSubFieldMap();if(null==n)break;o=n[r[i]]}return o?o.GetTextValue():""},vA.prototype.getShownText=function(e,t){if(null==e[t.fieldPath])return"";if(t.dataType==commonApi.DataType.String)return e[t.fieldPath]||"";if(t.dataType==commonApi.DataType.Decimal)return parseFloat(String(e[t.fieldPath])).toFixed(t.scale).toString()||"";if(t.dataType!=commonApi.DataType.DateTime)return e[t.fieldPath]||"";var r=commonApi.BpmnModelJsonHelper.DateTimeFromString(e[t.fieldPath]);return"DateTime"==t.fieldType?this.dateFormat(r,"yyyy-MM-dd HH:mm:ss.SSS"):(t.fieldType,this.dateFormat(r,"yyyy-MM-dd"))},vA.prototype.isObject=function(e){return"object"==typeof e},vA.prototype.isArray=function(e){return Array.isArray(e)},vA.prototype.dateFormat=function(e,t){var r,o={"y+":e.getUTCFullYear().toString(),"M+":(e.getUTCMonth()+1).toString(),"d+":e.getUTCDate().toString(),"H+":e.getUTCHours().toString(),"m+":e.getUTCMinutes().toString(),"s+":e.getUTCSeconds().toString(),"S+":e.getUTCMilliseconds().toString()};for(var i in o)(r=new RegExp("("+i+")").exec(t))&&(t=String.prototype.padStart?t.replace(r[1],1==r[1].length?o[i]:o[i].padStart(r[1].length,"0")):t.replace(r[1],1==r[1].length?o[i]:this.myPadStart(o[i],r[1].length,"0")));return t},vA.prototype.myPadStart=function(e,t,r){return t>>=0,r=String(void 0!==r?r:" "),e.length>t?String(e):((t-=e.length)>r.length&&(r+=r.repeat(t/r.length)),r.slice(0,t)+String(e))},vA.decorators=[{type:core$1.Component,args:[{selector:"app-basic-table",template:'<table class="table table-striped table-hover text-nowrap" [ngStyle]="{\'margin-left\': isMain ? null : \'24px\'}"\r\n    style="min-width: 100%; width: auto;" *ngIf="ffields && ffields.length > 0 && frows && frows.length > 0">\r\n    <thead class="thead-light">\r\n        <tr>\r\n            <th style="width: 40px;"><span></span></th>\r\n            <th *ngFor="let ffield of ffields">\r\n                <span>{{ffield.captionPath}}</span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n        <ng-container *ngFor="let frow of frows;let rowIdx = index;">\r\n            <tr #tr>\r\n                <td>\r\n                    <span *ngIf="frow.hasChildren" style="cursor:pointer;" (click)="clickHandler(frow, $event)"\r\n                        [ngClass]="{\'k-icon\': true, \'k-i-plus-outline\': !frow.expanded, \'k-i-minus-outline\': frow.expanded}"></span>\r\n                </td>\r\n                <ng-container *ngFor="let ffield of ffields">\r\n                    <td>\r\n                        <span>{{getShownText(frow.data, ffield)}}</span>\r\n                        <span *ngIf="ffield.showMore" class="f-icon f-icon-more"></span>\r\n                    </td>\r\n                </ng-container>\r\n            </tr>\r\n            <tr *ngIf="frow.expanded&&frow.hasChildren">\r\n                <td [attr.colspan]="tr.cells.length">\r\n                    <ng-container appChildRowTable [parentRow]="rows[rowIdx]" [parentSchemaTable]="billSchemaTable"\r\n                        [parentDataTable]="billDataTable" [billInfo]="billInfo" [expanded]="frow.expanded"\r\n                        [colspan]="tr.cells.length">\r\n                    </ng-container>\r\n                </td>\r\n            </tr>\r\n        </ng-container>\r\n    </tbody>\r\n    <tfoot>\r\n    </tfoot>\r\n</table>',changeDetection:core$1.ChangeDetectionStrategy.OnPush,styles:["./basic-table.component.css"]}]}],vA.ctorParameters=function(){return[{type:core$1.ViewContainerRef},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.ChangeDetectorRef}]},vA.propDecorators={childTrTable:[{type:core$1.ViewChild,args:["childTrTable"]}],childTrTableVCR:[{type:core$1.ViewChild,args:["childTrTable",{read:core$1.ViewContainerRef}]}]},vA);function vA(e,t,r,o){this.viewContainerRef=e,this.inj=t,this.cfr=r,this.cdr=o}var BasicInfoComponent=(UC.prototype.ngOnInit=function(){this.secTitle=this.localePipe.transform("basicInfo"),this.secTitle=this.dataInfoService.getTableLabel(this.billInfo,this.schemaTable,this.localeId),this.fieldsWithValue=this.dataInfoService.getBasicInfoFieldsWithValue(this.billInfo,this.schemaTable,this.dataTable),this.fieldsWithValue=this.dataInfoService.sortFieldsByOrder(this.fieldsWithValue);var e,t=this.dataTable.GetRowList()[0];this.childSchemaTables=this.dataInfoService.getChildTables(this.billInfo,this.schemaTable),this.childDataTableMap=t.GetChildTableMap(),null!=this.billInfo.jointQueryParameters?(e=JSON.parse(this.billInfo.jointQueryParameters),this.hasLink=this.billInfo.jointQueryMode==commonApi$1.JointQueryMode.APP&&null!=e.funcId||this.billInfo.jointQueryMode==commonApi$1.JointQueryMode.URL&&null!=e.url):this.hasLink=!1},UC.prototype.clickLink=function(){return this.internalUiService.openBillDetailWithFields(this.billInfo,this.billDataInfo,this.fieldsWithValue),event.stopPropagation(),!1},UC.decorators=[{type:core$1.Component,args:[{selector:"lib-bill-tracker-main-table",template:'<farris-section class="f-section-form f-section-in-mainsubcard" [mainTitle]="secTitle">\r\n    <div class="f-form-layout farris-form farris-form-controls-inline">\r\n        <ng-container *ngFor="let field of fieldsWithValue; let i = index">\r\n            <div class="col-12 col-md-6 col-xl-3 col-el-2" *ngIf="field.show">\r\n                \x3c!-- 仅显示show属性为true的字段 --\x3e\r\n                \x3c!-- <div class="farris-group-wrap" *ngIf="!(hasLink && i==0); else linkTemp"> --\x3e\r\n                <div class="farris-group-wrap">\r\n                    \x3c!-- 非布尔值使用文本框 --\x3e\r\n                    <div class="form-group farris-form-group" *ngIf="field.dataType!=dateType.Boolean">\r\n                        <label class="col-form-label">\r\n                            <span class="farris-label-text" title="{{field | billTrackerFieldLabel}}">\r\n                                {{field | billTrackerFieldLabel}}\r\n                            </span>\r\n                        </label>\r\n                        <div class="farris-input-wrap">\r\n                            <div class="f-component-text" *ngIf="field.dataType!=dateType.Boolean">\r\n                                <span class="f-form-control-text" title="{{field.fieldValue}}">\r\n                                    {{field.fieldValue}}\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    \x3c!-- 布尔值使用复选框 --\x3e\r\n                    <div class="form-group farris-form-group" *ngIf="field.dataType==dateType.Boolean">\r\n                        <label class="col-form-label">\r\n                            <span class="farris-label-text" title="{{field | billTrackerFieldLabel}}">\r\n                                {{field | billTrackerFieldLabel}}\r\n                            </span>\r\n                        </label>\r\n                        <div class="farris-input-wrap">\r\n                            <div class="custom-control custom-checkbox">\r\n                                <input class="custom-control-input" type="checkbox" readonly\r\n                                    [checked]="field.fieldValue" />\r\n                                <label class="custom-control-label"></label>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                \x3c!-- 有联查配置时，默认取第一个字段作为超链接 --\x3e\r\n                \x3c!-- <ng-template #linkTemp> --\x3e\r\n                \x3c!-- <div class="farris-group-wrap"> --\x3e\r\n                \x3c!-- 非布尔值链接在value上 --\x3e\r\n                \x3c!-- <div class="form-group farris-form-group" *ngIf="field.dataType!=dateType.Boolean">\r\n                            <label class="col-form-label">\r\n                                <span class="farris-label-text" title="{{field | billTrackerFieldLabel}}">\r\n                                    {{field | billTrackerFieldLabel}}\r\n                                </span>\r\n                            </label>\r\n                            <div class="farris-input-wrap">\r\n                                <div class="f-component-text">\r\n                                    <span class="f-form-control-text" title="{{field.fieldValue}}">\r\n                                        <a href="javascript:void(0);" (click)="clickLink()">{{field.fieldValue}}</a>\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n                        </div> --\x3e\r\n\r\n                \x3c!-- 布尔值链接在label上 --\x3e\r\n                \x3c!-- <div class="form-group farris-form-group" *ngIf="field.dataType==dateType.Boolean">\r\n                            <label class="col-form-label">\r\n                                <span class="farris-label-text" title="{{field | billTrackerFieldLabel}}">\r\n                                    <a href="javascript:void(0);" (click)="clickLink()">\r\n                                        {{field | billTrackerFieldLabel}}\r\n                                    </a>\r\n                                </span>\r\n                            </label>\r\n                            <div class="farris-input-wrap">\r\n                                <div class="farris-input-wrap">\r\n                                    <div class="custom-control custom-checkbox">\r\n                                        <input class="custom-control-input" type="checkbox" readonly\r\n                                            [checked]="field.fieldValue" />\r\n                                        <label class="custom-control-label"></label>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div> --\x3e\r\n                \x3c!-- </div> --\x3e\r\n                \x3c!-- </ng-template> --\x3e\r\n            </div>\r\n        </ng-container>\r\n    </div>\r\n</farris-section>\r\n<lib-bill-tracker-child-info-list [childSchemaTables]="childSchemaTables" [childDataTableMap]="childDataTableMap"\r\n    [billInfo]="billInfo">\r\n</lib-bill-tracker-child-info-list>'}]}],UC.ctorParameters=function(){return[{type:rtfCommon.FrameworkService},{type:BillTrackerDataInfoService},{type:uiNotify.NotifyService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:uiModal.BsModalService},{type:BillTrackerLocalePipe},{type:core$1.ViewContainerRef},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.ChangeDetectorRef},{type:String,decorators:[{type:core$1.Optional},{type:core$1.Inject,args:[core$1.LOCALE_ID]}]}]},UC.propDecorators={schemaTable:[{type:core$1.Input,args:["schemaTable"]}],dataTable:[{type:core$1.Input,args:["dataTable"]}],billInfo:[{type:core$1.Input,args:["billInfo"]}],billDataInfo:[{type:core$1.Input,args:["billDataInfo"]}]},UC);function UC(e,t,r,o,i,n,a,l,s,c,p,d){this.framework=e,this.dataInfoService=t,this.notify=r,this.messager=o,this.loading=i,this.modal=n,this.localePipe=a,this.vcr=l,this.inj=s,this.cfr=c,this.cdr=p,this.localeId=d,this.fieldsWithValue=[],this.childSchemaTables=[],this.childDataTableMap={},this.dateType=commonApi.DataType,this.secTitle="",this.localeId=d||this.inj.get(core$1.LOCALE_ID);var u=core$1.ReflectiveInjector.resolveAndCreate([BillTrackerInternalUiService],this.inj);this.internalUiService=u.get(BillTrackerInternalUiService,null)}var BillTrackerDataComponent=(iD.prototype.ngOnInit=function(){},iD.prototype.ngAfterViewInit=function(){},iD.prototype.clearDataRegion=function(){this.dataRegion.clear()},iD.prototype.showDataGrid=function(e,t,r,o){var i=new commonApi$1.BillTrackingSettings;t&&t.billTrackingSettings&&i.LoadFromJson(t.billTrackingSettings),i.billTrackingDataShownMode==commonApi$1.BillTrackingDataShownMode.CUSTOMFORM?this.showCustomForm(e,t,r):this.showGeneralForm(e,t,r,o)},iD.prototype.showGeneralForm=function(e,t,r,o,i){var n,a=this;null!=o?this.createDataComp(o,t,r):(n=this.loading.show({message:this.localePipe.transform("loading")}),this.dataService.getEntityData(e).subscribe(function(e){a.createDataComp(e,t,r),n.close()},function(e){throw n.close(),a.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),e}))},iD.prototype.showCustomForm=function(r,e,t){var o=this,i=new commonApi$1.BillTrackingSettings;e&&e.billTrackingSettings&&i.LoadFromJson(e.billTrackingSettings);var n=JSON.parse(i.customFormContent);(n.form.endsWith(".js")?rxjs.from(System["import"](n.form.toLowerCase()).then(function(e){return e})).pipe(operators.switchMap(function(e){for(var t in e)return rxjs.of(e[t]);return rxjs.of(null)})):rxjs.from(this.loader.load(n.form))).subscribe(function(e){var t=e.create(o.inj).instance.createDataShownComponent(o.inj,r);t instanceof core$1.ComponentRef&&(t=rxjs.of(t)),t.subscribe(function(e){o.dataRegion.element.nativeElement.parentElement.scrollTo({left:0}),o.dataRegion.clear(),o.dataRegion.insert(e.hostView)})})},iD.prototype.createDataComp=function(e,t,r){this.dataInfoService.isNewBTS(t.billTrackingSettings);try{this.createNewDataComp(e,t,r)}catch(a){var o=this.dataRegion.element.nativeElement.parentElement;o&&o.scrollTo({left:0}),this.dataRegion.clear();var i=this.cfr.resolveComponentFactory(BasicTableComponent),n=this.dataRegion.createComponent(i);n.instance.billInfo=t,n.instance.isMain=!0,n.instance.showMainTable(e),this.dataRegion.insert(n.hostView)}},iD.prototype.createNewDataComp=function(e,t,r){var o=this.dataRegion.element.nativeElement.parentElement;o&&o.scrollTo({left:0}),this.dataRegion.clear();var i=this.cfr.resolveComponentFactory(BasicInfoComponent),n=this.dataRegion.createComponent(i);n.instance.schemaTable=e.billSchema.mainTable,n.instance.dataTable=e.billData.mainTable,n.instance.billInfo=t,n.instance.billDataInfo=r,this.dataRegion.insert(n.hostView)},iD.decorators=[{type:core$1.Component,args:[{selector:"lib-bill-tracker-data",template:'<div style="">\r\n    <ng-container #dataRegion></ng-container>\r\n</div>',styles:[""]}]}],iD.ctorParameters=function(){return[{type:uiNotify.NotifyService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:uiModal.BsModalService},{type:BillTrackerDataService},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.ChangeDetectorRef},{type:core$1.NgModuleFactoryLoader},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]}]},iD.propDecorators={dataRegion:[{type:core$1.ViewChild,args:["dataRegion",{read:core$1.ViewContainerRef}]}]},iD);function iD(e,t,r,o,i,n,a,l,s,c){this.notify=e,this.messager=t,this.loading=r,this.modal=o,this.dataService=i,this.inj=n,this.cfr=a,this.cdf=l,this.loader=s,this.dataInfoService=new BillTrackerDataInfoService,this.localeId=c||this.inj.get(core$1.LOCALE_ID,null)||"zh-CHS",this.localePipe=new BillTrackerLocalePipe(c)}var ChildRowTableDirective=(Object.defineProperty(jE.prototype,"expanded",{get:function(){return this._expanded},set:function(e){(this._expanded=e)?this.showChildTable():this.clearChildTable()},enumerable:!0,configurable:!0}),jE.prototype.showChildTable=function(){var e,t;if(null!=this.parentRow){this.clearChildTable();var r=this.cfr.resolveComponentFactory(BasicTableComponent);try{for(var o=__values(this.parentRow.GetChildTableList()),i=o.next();!i.done;i=o.next()){var n=i.value,a=this.vcRef.createComponent(r);a.instance.billInfo=this.billInfo,a.instance.isMain=!1,a.instance.showTable(this.parentSchemaTable.GetChildTableMap()[n.tableName],n),this.vcRef.insert(a.hostView)}}catch(l){e={error:l}}finally{try{i&&!i.done&&(t=o["return"])&&t.call(o)}finally{if(e)throw e.error}}this.cdr.markForCheck()}},jE.prototype.clearChildTable=function(){this.vcRef.clear()},jE.decorators=[{type:core$1.Directive,args:[{selector:"[appChildRowTable]"}]}],jE.ctorParameters=function(){return[{type:core$1.ComponentFactoryResolver},{type:core$1.ViewContainerRef},{type:core$1.ChangeDetectorRef}]},jE.propDecorators={billInfo:[{type:core$1.Input,args:["billInfo"]}],colspan:[{type:core$1.Input,args:["colspan"]}],parentRow:[{type:core$1.Input,args:["parentRow"]}],parentSchemaTable:[{type:core$1.Input,args:["parentSchemaTable"]}],parentDataTable:[{type:core$1.Input,args:["parentDataTable"]}],expanded:[{type:core$1.Input,args:["expanded"]}],hasChildren:[{type:core$1.Output,args:["hasChildren"]}]},jE);function jE(e,t,r){this.cfr=e,this.vcRef=t,this.cdr=r,this.hasChildren=new core$1.EventEmitter}var ChildInfoListComponent=(xE.prototype.ngOnInit=function(){},xE.decorators=[{type:core$1.Component,args:[{selector:"lib-bill-tracker-child-info-list",template:'<ng-container *ngFor="let childTable of childSchemaTables">\r\n    <lib-bill-tracker-child-info [schemaTable]="childTable" [dataTable]="childDataTableMap[childTable.tableName]"\r\n        [billInfo]="billInfo">\r\n    </lib-bill-tracker-child-info>\r\n</ng-container>'}]}],xE.ctorParameters=function(){return[{type:BillTrackerDataInfoService},{type:uiNotify.NotifyService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:uiModal.BsModalService},{type:BillTrackerLocalePipe},{type:core$1.ViewContainerRef},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.ChangeDetectorRef}]},xE.propDecorators={childSchemaTables:[{type:core$1.Input,args:["childSchemaTables"]}],childDataTableMap:[{type:core$1.Input,args:["childDataTableMap"]}],billInfo:[{type:core$1.Input,args:["billInfo"]}]},xE);function xE(e,t,r,o,i,n,a,l,s,c){this.dataInfoService=e,this.notify=t,this.messager=r,this.loading=o,this.modal=i,this.localePipe=n,this.vcr=a,this.inj=l,this.cfr=s,this.cdr=c}var ChildInfoComponent=(IE.prototype.ngOnInit=function(){var o=this;this.secTitle=this.localePipe.transform("basicInfo"),this.secTitle=this.dataInfoService.getTableLabel(this.billInfo,this.schemaTable,this.localeId);var e=new commonApi$1.BillTrackingSettings;this.billInfo&&this.billInfo.billTrackingSettings&&e.LoadFromJson(this.billInfo.billTrackingSettings);var t=e.customFieldContent,r=t&&("object"==typeof t?t:JSON.parse(t)),i=(i=r&&r.schema&&r.schema[this.schemaTable.tableName]&&r.schema[this.schemaTable.tableName].fields)||[],n=e.billTrackingDataShownMode===commonApi$1.BillTrackingDataShownMode.CUSTOMFIELD,a=this.schemaTable.getFieldList(),l=(l=this.dataInfoService.extractFFields(a,i,n)).filter(function(e){return e.show});l=this.dataInfoService.sortFieldsByOrder(l),this.dgCols=[],l.forEach(function(e){var t={field:e.fieldPath||e.fieldName,title:o.dataInfoService.getFieldLabel(e,o.localeId),width:120};e.dataType==commonApi.DataType.Boolean&&(t.formatter=function(e,t,r){return 1==e?o.localePipe.transform("yes"):0==e?o.localePipe.transform("no"):"-"}),o.dgCols.push(t)});var s=this.dataTable.GetRowList();this.dgData=__spread(this.dataInfoService.extractDataRows(s,l,a,this.dgIdField)),0<this.dgData.length&&setTimeout(function(){o.dg&&o.dg.selectRow(o.dgData[0][o.dgIdField])},500)},IE.prototype.selectChanged=function(e){var t=this.dataTable.GetRowMap()[e.id];this.showDetail=this.dataInfoService.hasChildData(t,this.billInfo),this.cdr.detectChanges()},IE.prototype.viewChildData=function(){var e,t,r,o;null!=this.dg.selectedRow?(e=this.dataTable.GetRowMap()[this.dg.selectedRow.id],this.dataInfoService.hasChildData(e,this.billInfo)?(t=this.cfr.resolveComponentFactory(ChildInfoListComponent).create(this.inj,[]),r=this.dataInfoService.getChildTables(this.billInfo,this.schemaTable),t.instance.childSchemaTables=r,t.instance.childDataTableMap=e.GetChildTableMap(),t.instance.billInfo=this.billInfo,o=this.modal.show(t,{title:this.localePipe.transform("childData"),width:900,height:600,showButtons:!1}),t.instance.bsModalRef=o):this.notify.info(this.localePipe.transform("noChildData"))):this.notify.warning(this.localePipe.transform("selectOneFirst"))},IE.decorators=[{type:core$1.Component,args:[{selector:"lib-bill-tracker-child-info",template:'<div class="f-struct-wrapper" *ngIf="dgCols&&dgCols.length>0&&dgData&&dgData.length>0">\r\n    <farris-section class="f-section-tabs f-section-in-mainsubcard" [mainTitle]="secTitle">\r\n        <ng-template farrisSectionToolbar [toolbarCls]="\'section-test-toolbar\'">\r\n            <button class="btn btn-secondary f-btn-ml" *ngIf="showDetail" (click)="viewChildData()">\r\n                {{ "childData" | billTrackerLocale}}\r\n            </button>\r\n        </ng-template>\r\n        <div class="">\r\n            <div class="f-utils-fill">\r\n                <farris-datagrid #dg class="f-component-grid f-utils-fill" [data]="dgData" [idField]="dgIdField"\r\n                    [fields]="dgCols" [showLineNumber]="true" [striped]="true" [virtualized]="false"\r\n                    [pagination]="false" [virtualizedAsyncLoad]="false" [multiSelect]="false" [fit]="true"\r\n                    [showCheckbox]="false" [showAllCheckbox]="false" [lineNumberTitle]="dgLineNumberTitle"\r\n                    [mergeCell]="false" [showBorder]="true" [checkOnSelect]="false" [selectOnCheck]="false"\r\n                    [nowrap]="true" [autoFitColumns]="true" [fitColumns]="true" [autoHeight]="true"\r\n                    [height]="dgData && dgData.length>0 ? undefined : 72" (selectChanged)="selectChanged($event)">\r\n                </farris-datagrid>\r\n            </div>\r\n        </div>\r\n    </farris-section>\r\n</div>'}]}],IE.ctorParameters=function(){return[{type:uiNotify.NotifyService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:uiModal.BsModalService},{type:BillTrackerDataInfoService},{type:BillTrackerLocalePipe},{type:core$1.ViewContainerRef},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.ChangeDetectorRef},{type:String,decorators:[{type:core$1.Optional},{type:core$1.Inject,args:[core$1.LOCALE_ID]}]}]},IE.propDecorators={schemaTable:[{type:core$1.Input,args:["schemaTable"]}],dataTable:[{type:core$1.Input,args:["dataTable"]}],billInfo:[{type:core$1.Input,args:["billInfo"]}],dg:[{type:core$1.ViewChild,args:["dg"]}]},IE);function IE(e,t,r,o,i,n,a,l,s,c,p){this.notify=e,this.messager=t,this.loading=r,this.modal=o,this.dataInfoService=i,this.localePipe=n,this.vcr=a,this.inj=l,this.cfr=s,this.cdr=c,this.localeId=p,this.secTitle=null,this.showDetail=!1,this.dgCols=[],this.dgData=[],this.dgLineNumberTitle=this.localePipe.transform("lineNumber"),this.dgIdField="bifDgId0d63",this.localeId=p||this.inj.get(core$1.LOCALE_ID)}var BillTrackerFieldLabelPipe=(oF.prototype.transform=function(e,t){return this.dataInfoService.getFieldLabel(e,t||this.localeId)},oF.decorators=[{type:core$1.Pipe,args:[{name:"billTrackerFieldLabel"}]}],oF.ctorParameters=function(){return[{type:BillTrackerDataInfoService},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]}]},oF);function oF(e,t){this.dataInfoService=e,this.localeId=t}var ɵ0$1=localStorage.getItem("languageCode")||"zh-CHS",ɵ1$1={},BillTrackerModule=(tF.forRoot=function(e){return{ngModule:tF,providers:[{provide:BillTrackerModuleConfig,useValue:e||{}}]}},tF.decorators=[{type:core$1.NgModule,args:[{declarations:[BillTrackerComponent,BillTrackerGraphComponent,BillTrackerDataComponent,BasicTableComponent,ChildRowTableDirective,BillTrackerLocalePipe,BasicInfoComponent,ChildInfoComponent,ChildInfoListComponent,BillTrackerFieldLabelPipe],imports:[common.CommonModule,http.HttpClientModule,forms.FormsModule,uiDraggable.AngularDraggableModule,uiMessager.MessagerModule.forRoot(),uiLoading.LoadingModule.forRoot(),uiNotify.NotifyModule,uiText.TextModule,uiSection.FarrisSectionModule,uiDatagrid.DatagridModule.forRoot(),uiDialog.FarrisDialogModule],providers:[{provide:core$1.LOCALE_ID,useValue:ɵ0$1},{provide:BillTrackerModuleConfig,useValue:ɵ1$1},{provide:core$1.NgModuleFactoryLoader,useClass:core$1.SystemJsNgModuleLoader},cafCommon.CacheService,cafCommon.SessionService,cafCommon.HttpService,rtfCommon.FrmEventBus,rtfCommon.FuncsService,rtfCommon.LoadingService,rtfCommon.AppService,rtfCommon.FrameworkService,BillTrackerDataService,BillTrackerUiService,BillTrackerLocalePipe,BillTrackerDataInfoService],bootstrap:[BillTrackerComponent],exports:[BillTrackerComponent],entryComponents:[BillTrackerComponent,BasicTableComponent,BasicInfoComponent,ChildInfoComponent,ChildInfoListComponent]}]}],tF);function tF(){}function canJSONParse(e){try{if("object"==typeof JSON.parse(e))return 1}catch(t){}}var BifBillTrackerWebCmpService=(yF.prototype.openDialog=function(e,t,r,o,i){e="string"==typeof e&&canJSONParse(e)?JSON.parse(e):e,t=""===t||null==t?undefined:t,r=""===r||null==r?undefined:r,o=""===o||null==o?undefined:o,i=""===i||null==i?undefined:i;var n=new GetBillsInfoArgs;return"string"==typeof e?n.billDataId=e:n.LoadFromJsonObject(e),this.trackerUiService.openDefaultBillTrackerDialog(n,t,r,o,i)},yF.prototype.openApp=function(e,t,r){e="string"==typeof e&&canJSONParse(e)?JSON.parse(e):e,t=""===t||null==t?undefined:t,r=""===r||null==r?undefined:r;var o=new GetBillsInfoArgs;"string"==typeof e?o.billDataId=e:o.LoadFromJsonObject(e),this.trackerUiService.openDefaultBillTrackerApp(o,t,r)},yF.decorators=[{type:core$1.Injectable}],yF.ctorParameters=function(){return[{type:BillTrackerUiService},{type:devkit.BindingData,decorators:[{type:core$1.Optional}]},{type:devkit.ViewModel,decorators:[{type:core$1.Optional}]},{type:devkit.FrameContext,decorators:[{type:core$1.Optional}]}]},yF);function yF(e,t,r,o){this.trackerUiService=e,this.bindingData=t,this.viewModel=r,this.frameContext=o}var BifManualCreationDataWebCmpService=(NF.prototype.getSlimBillCreationProcessEntityExById=function(e){return this.dataService.getSlimBillCreationProcessEntityExById(e)},NF.prototype.getFormSettingsById=function(e){return this.dataService.getFormSettingsById(e)},NF.prototype.executeBillCreationProcess=function(e,t,r,o){if(null==e)throw"entities is null.";e instanceof Map&&(e=Array.from(e.values())),e=Array.isArray(e)?e:[e];var i=new FormBillCreationProcessExecutorArgs;return i.billCreationProcessId=t,i.creationRuleId=r,i.sourceVoEntityDatas=e.map(function(e){return JSON.stringify(e.toJSON(!1,!0))}),i.targetVoDataIds=o,this.dataService.executeBillCreationProcess(i)},NF.prototype.createEntityDatas=function(e,t){var r=new runtimeApi.FormCreateArgs;return r.formVoId=e,r.rpcCreationRuleExecutorResult=t.creationRuleExecutorResult.ConvertToJson(),this.dataService.createEntityDatas(r)},NF.prototype.updateEntityDatas=function(e){var t=new runtimeApi.FormUpdateArgs;return 1==e.conditionResult.conditionExecutionResult?e.creationRuleExecutorResult&&e.creationRuleExecutorResult.mappingResults&&0<e.creationRuleExecutorResult.mappingResults.length?(t.rpcCreationRuleExecutorResult=e.creationRuleExecutorResult.ConvertToJson(),this.dataService.updateEntityDatas(t)):rxjs.throwError("creationRuleExecutorResult is empty!"):rxjs.throwError("conditionExecutionResult is false!")},NF.decorators=[{type:core$1.Injectable}],NF.ctorParameters=function(){return[{type:BifDataService},{type:devkit.BindingData},{type:uiMessager.MessagerService},{type:devkit.ViewModel,decorators:[{type:core$1.Optional}]},{type:devkit.FrameContext,decorators:[{type:core$1.Optional}]}]},NF);function NF(e,t,r,o,i){this.dataService=e,this.bindingData=t,this.messagerService=r,this.viewModel=o,this.frameContext=i}var BifManualCreationSourceWebCmpService=(eG.prototype.pushBySourceVoId=function(e,o,i,t,r,n,a,l){var s=this;if(null==o)throw"entities is null.";o instanceof Map&&(o=Array.from(o.values())),o=Array.isArray(o)?o:[o],t=""===t||null==t?undefined:t,r=""===r||null==r?undefined:r,n=""===n||null==n?undefined:n,a=""===a||null==a?undefined:a,l=""===l||null==l?undefined:l,this.sourceUiService.openBillCreationProcessSelector4Push(e,t,r,n,a).subscribe(function(r){s.dataService.getFormSettingsById(r.formSettingsId).subscribe(function(t){var e=new FormBillCreationProcessExecutorArgs;e.billCreationProcessId=r.id,e.creationRuleId=r.creationRuleId,e.sourceVoEntityDatas=o.map(function(e){return JSON.stringify(e.toJSON(!1,!0))}),e.targetVoDataIds=[],s.dataService.executeBillCreationProcess(e).subscribe(function(e){1==e.conditionResult.conditionExecutionResult?e.creationRuleExecutorResult&&e.creationRuleExecutorResult.mappingResults&&0<e.creationRuleExecutorResult.mappingResults.length?s.sourceUiService.openTargetForm(t,e,__assign({action:i},l)):s.messagerService.error("生单结果为空"):s.messagerService.error(e.conditionResult.message||"生单流程执行出错")})})})},eG.prototype.pushBySourceVoIdAndTargetVoId=function(e,t,o,i,r,n,a,l,s){var c=this;if(null==o)throw"entities is null.";o instanceof Map&&(o=Array.from(o.values())),o=Array.isArray(o)?o:[o],r=""===r||null==r?undefined:r,n=""===n||null==n?undefined:n,a=""===a||null==a?undefined:a,l=""===l||null==l?undefined:l,s=""===s||null==s?undefined:s,this.sourceUiService.openBillCreationProcessSelector4SpecificPush(e,t,r,n,a,l).subscribe(function(r){c.dataService.getFormSettingsById(r.formSettingsId).subscribe(function(t){var e=new FormBillCreationProcessExecutorArgs;e.billCreationProcessId=r.id,e.creationRuleId=r.creationRuleId,e.sourceVoEntityDatas=o.map(function(e){return JSON.stringify(e.toJSON(!1,!0))}),e.targetVoDataIds=[],c.dataService.executeBillCreationProcess(e).subscribe(function(e){1==e.conditionResult.conditionExecutionResult?e.creationRuleExecutorResult&&e.creationRuleExecutorResult.mappingResults&&0<e.creationRuleExecutorResult.mappingResults.length?c.sourceUiService.openTargetForm(t,e,__assign({action:i},s)):c.messagerService.error("生单结果为空"):c.messagerService.error(e.conditionResult.message||"生单流程执行出错")})})})},eG.prototype.pushByCreationProcessId=function(e,o,i,n){var a=this;if(null==o)throw"entities is null.";o instanceof Map&&(o=Array.from(o.values())),o=Array.isArray(o)?o:[o],n=""===n||null==n?undefined:n,this.dataService.getSlimBillCreationProcessEntityExById(e).subscribe(function(r){a.dataService.getFormSettingsById(r.formSettingsId).subscribe(function(t){var e=new FormBillCreationProcessExecutorArgs;e.billCreationProcessId=r.id,e.creationRuleId=r.creationRuleId,e.sourceVoEntityDatas=o.map(function(e){return JSON.stringify(e.toJSON(!1,!0))}),e.targetVoDataIds=[],a.dataService.executeBillCreationProcess(e).subscribe(function(e){1==e.conditionResult.conditionExecutionResult?e.creationRuleExecutorResult&&e.creationRuleExecutorResult.mappingResults&&0<e.creationRuleExecutorResult.mappingResults.length?a.sourceUiService.openTargetForm(t,e,__assign({action:i},n)):a.messagerService.error("生单结果为空"):a.messagerService.error(e.conditionResult.message||"生单流程执行出错")})})})},eG.prototype.openBillCreationProcessSelector4Push=function(e,t,r,o,i){return t=""===t||null==t?undefined:t,r=""===r||null==r?undefined:r,o=""===o||null==o?undefined:o,i=""===i||null==i?undefined:i,this.sourceUiService.openBillCreationProcessSelector4Push(e,t,r,o,i)},eG.prototype.openBillCreationProcessSelector4SpecificPush=function(e,t,r,o,i,n){return r=""===r||null==r?undefined:r,o=""===o||null==o?undefined:o,i=""===i||null==i?undefined:i,n=""===n||null==n?undefined:n,this.sourceUiService.openBillCreationProcessSelector4SpecificPush(e,t,r,o,i,n)},eG.prototype.openTargetForm=function(e,t,r,o){this.sourceUiService.openTargetForm(e,t,__assign({action:r},o))},eG.decorators=[{type:core$1.Injectable}],eG.ctorParameters=function(){return[{type:BifSourceUiService},{type:BifDataService},{type:devkit.BindingData},{type:uiMessager.MessagerService},{type:devkit.ViewModel,decorators:[{type:core$1.Optional}]},{type:devkit.FrameContext,decorators:[{type:core$1.Optional}]}]},eG);function eG(e,t,r,o,i,n){this.sourceUiService=e,this.dataService=t,this.bindingData=r,this.messagerService=o,this.viewModel=i,this.frameContext=n}var BifManualCreationTargetWebCmpService=(lH.prototype.bifLoad=function(e){var t=this,r=new runtimeApi.FormCreateArgs;r.formVoId=e;var o=this.targetUiService.getFormBillCreationProcessExecutorResult();r.rpcCreationRuleExecutorResult=o.creationRuleExecutorResult.ConvertToJson(),this.dataService.createEntityDatas(r).subscribe(function(e){t.stateMachineService.transit("Create")})},lH.prototype.referByTargetVoId=function(e,o,t,r,i,n,a,l){var s=this;t=""===t||null==t?undefined:t,o=""===o||null==o?[this.bindingData.getObject().id]:o,r=""===r||null==r?undefined:r,i=""===i||null==i?undefined:i,n=""===n||null==n?{title:"来源单据选择器",width:1100,height:550}:n,a=""===a||null==a?undefined:a,l=""===l||null==l?undefined:l,this.cardDataService.update().subscribe(function(){s.targetUiService.openBillCreationProcessSelector4Pull(e,t,r,i,a).subscribe(function(r){s.dataService.getFormSettingsById(r.formSettingsId).subscribe(function(e){s.targetUiService.openSourceDataSelector4Pull(e,n,l).subscribe(function(e){var t=new FormBillCreationProcessExecutorArgs;t.billCreationProcessId=r.id,t.creationRuleId=r.creationRuleId,t.sourceVoEntityDatas=e.map(function(e){return JSON.stringify(e.toJSON(!1,!0))}),t.targetVoDataIds=o,s.dataService.executeBillCreationProcess(t).subscribe(function(e){var t=new runtimeApi.FormUpdateArgs;1==e.conditionResult.conditionExecutionResult?e.creationRuleExecutorResult&&e.creationRuleExecutorResult.mappingResults&&0<e.creationRuleExecutorResult.mappingResults.length?(t.rpcCreationRuleExecutorResult=e.creationRuleExecutorResult.ConvertToJson(),s.dataService.updateEntityDatas(t).subscribe(function(e){s.cardDataService.load(o[0]).subscribe()})):s.messagerService.error("生单结果为空"):s.messagerService.error(e.conditionResult.message||"生单流程执行出错")})})})})})},lH.prototype.referBySourceVoIdAndTargetVoId=function(e,t,o,r,i,n,a,l,s){var c=this;r=""===r||null==r?undefined:r,o=""===o||null==o?[this.bindingData.getObject().id]:o,i=""===i||null==i?undefined:i,n=""===n||null==n?undefined:n,a=""===a||null==a?{title:"来源单据选择器",width:1100,height:550}:a,l=""===l||null==l?undefined:l,s=""===s||null==s?undefined:s,this.cardDataService.update().subscribe(function(){c.targetUiService.openBillCreationProcessSelector4SpecificPull(e,t,r,i,n,l).subscribe(function(r){c.dataService.getFormSettingsById(r.formSettingsId).subscribe(function(e){c.targetUiService.openSourceDataSelector4Pull(e,a,s).subscribe(function(e){var t=new FormBillCreationProcessExecutorArgs;t.billCreationProcessId=r.id,t.creationRuleId=r.creationRuleId,t.sourceVoEntityDatas=e.map(function(e){return JSON.stringify(e.toJSON(!1,!0))}),t.targetVoDataIds=o,c.dataService.executeBillCreationProcess(t).subscribe(function(e){var t=new runtimeApi.FormUpdateArgs;1==e.conditionResult.conditionExecutionResult?e.creationRuleExecutorResult&&e.creationRuleExecutorResult.mappingResults&&0<e.creationRuleExecutorResult.mappingResults.length?(t.rpcCreationRuleExecutorResult=e.creationRuleExecutorResult.ConvertToJson(),c.dataService.updateEntityDatas(t).subscribe(function(e){c.cardDataService.load(o[0]).subscribe()})):c.messagerService.error("生单结果为空"):c.messagerService.error(e.conditionResult.message||"生单流程执行出错")})})})})})},lH.prototype.referByCreationProcessId=function(e,o,t,i){var n=this;o=""===o||null==o?[this.bindingData.getObject().id]:o,t=""===t||null==t?{title:"来源单据选择器",width:1100,height:550}:t,i=""===i||null==i?undefined:i,this.cardDataService.update().subscribe(function(){n.dataService.getSlimBillCreationProcessEntityExById(e).subscribe(function(r){n.dataService.getFormSettingsById(r.formSettingsId).subscribe(function(e){n.targetUiService.openSourceDataSelector4Pull(e,t,i).subscribe(function(e){var t=new FormBillCreationProcessExecutorArgs;t.billCreationProcessId=r.id,t.creationRuleId=r.creationRuleId,t.sourceVoEntityDatas=e.map(function(e){return JSON.stringify(e.toJSON(!1,!0))}),t.targetVoDataIds=o,n.dataService.executeBillCreationProcess(t).subscribe(function(e){var t=new runtimeApi.FormUpdateArgs;1==e.conditionResult.conditionExecutionResult?e.creationRuleExecutorResult&&e.creationRuleExecutorResult.mappingResults&&0<e.creationRuleExecutorResult.mappingResults.length?(t.rpcCreationRuleExecutorResult=e.creationRuleExecutorResult.ConvertToJson(),n.dataService.updateEntityDatas(t).subscribe(function(e){n.cardDataService.load(o[0]).subscribe()})):n.messagerService.error("生单结果为空"):n.messagerService.error(e.conditionResult.message||"生单流程执行出错")})})})})})},lH.prototype.getFormBillCreationProcessExecutorResult=function(){return this.targetUiService.getFormBillCreationProcessExecutorResult()},lH.prototype.openBillCreationProcessSelector4Pull=function(e,t,r,o,i){return t=""===t||null==t?undefined:t,r=""===r||null==r?undefined:r,o=""===o||null==o?undefined:o,i=""===i||null==i?undefined:i,this.targetUiService.openBillCreationProcessSelector4Pull(e,t,r,o,i)},lH.prototype.openBillCreationProcessSelector4SpecificPull=function(e,t,r,o,i,n){return r=""===r||null==r?undefined:r,o=""===o||null==o?undefined:o,i=""===i||null==i?undefined:i,n=""===n||null==n?undefined:n,this.targetUiService.openBillCreationProcessSelector4SpecificPull(e,t,r,o,i,n)},lH.prototype.openSourceDataSelector4Pull=function(e,t,r){return t=""===t||null==t?{title:"来源单据选择器",width:1100,height:550}:t,r=""===r||null==r?undefined:r,this.targetUiService.openSourceDataSelector4Pull(e,t,r)},lH.decorators=[{type:core$1.Injectable}],lH.ctorParameters=function(){return[{type:BifDataService},{type:BifTargetUiService},{type:commandServices.StateMachineService},{type:devkit.BindingData},{type:uiMessager.MessagerService},{type:commandServices.CardDataService},{type:devkit.ViewModel,decorators:[{type:core$1.Optional}]},{type:devkit.FrameContext,decorators:[{type:core$1.Optional}]}]},lH);function lH(e,t,r,o,i,n,a,l){this.dataService=e,this.targetUiService=t,this.stateMachineService=r,this.bindingData=o,this.messagerService=i,this.cardDataService=n,this.viewModel=a,this.frameContext=l}var BIF_MANUAL_CREATION_PROVIDERS=[BifDataService,BifSourceUiService,BifTargetUiService,BifManualCreationDataWebCmpService,BifManualCreationSourceWebCmpService,BifManualCreationTargetWebCmpService],BIF_BILL_TRACKER_PROVIDERS=[BillTrackerUiService,BifBillTrackerWebCmpService],BIF_DEVKIT_PROVIDERS=__spread(BIF_MANUAL_CREATION_PROVIDERS,BIF_BILL_TRACKER_PROVIDERS),BifBillTrackerWebCmpModule=(HI.decorators=[{type:core$1.NgModule,args:[{providers:BIF_BILL_TRACKER_PROVIDERS}]}],HI);function HI(){}var BifManualCreationWebCmpModule=(II.decorators=[{type:core$1.NgModule,args:[{providers:BIF_MANUAL_CREATION_PROVIDERS}]}],II);function II(){}exports.FormCreationRuleExecutorArgs=runtimeApi.FormCreationRuleExecutorArgs,exports.FormCreateArgs=runtimeApi.FormCreateArgs,exports.FormCreateResult=runtimeApi.FormCreateResult,exports.FormUpdateArgs=runtimeApi.FormUpdateArgs,exports.FormUpdateResult=runtimeApi.FormUpdateResult,exports.RpcCreationRuleExecutorResult=runtimeApi.RpcCreationRuleExecutorResult,exports.RpcCreationMappingResult=runtimeApi.RpcCreationMappingResult,exports.MappingAssociation=runtimeApi.MappingAssociation,exports.RpcMappingResult=runtimeApi.RpcMappingResult,exports.BifDataService=BifDataService,exports.AbstractBifDataSelectorService=AbstractBifDataSelectorService,exports.DefaultBifDataSelectorService=DefaultBifDataSelectorService,exports.BifSourceUiService=BifSourceUiService,exports.BifTargetUiService=BifTargetUiService,exports.PushSelectorComponent=PushSelectorComponent,exports.PullSelectorComponent=PullSelectorComponent,exports.BifManualCreationModule=BifManualCreationModule,exports.BillTrackerArgs=BillTrackerArgs,exports.BillTrackerUiService=BillTrackerUiService,exports.BillTrackerComponent=BillTrackerComponent,exports.BillTrackerModule=BillTrackerModule,exports.BifBillTrackerWebCmpService=BifBillTrackerWebCmpService,exports.BifManualCreationDataWebCmpService=BifManualCreationDataWebCmpService,exports.BifManualCreationSourceWebCmpService=BifManualCreationSourceWebCmpService,exports.BifManualCreationTargetWebCmpService=BifManualCreationTargetWebCmpService,exports.BifBillTrackerWebCmpModule=BifBillTrackerWebCmpModule,exports.BifManualCreationWebCmpModule=BifManualCreationWebCmpModule,exports.mxDefaultKeyHandler=mxDefaultKeyHandlerType,exports.mxDefaultPopupMenu=mxDefaultPopupMenuType,exports.mxDefaultToolbar=mxDefaultToolbarType,exports.mxEditor=mxEditorType,exports.mxCellHighlight=mxCellHighlightType,exports.mxCellMarker=mxCellMarkerType,exports.mxCellTracker=mxCellTrackerType,exports.mxConnectionHandler=mxConnectionHandlerType,exports.mxConstraintHandler=mxConstraintHandlerType,exports.mxEdgeHandler=mxEdgeHandlerType,exports.mxEdgeSegmentHandler=mxEdgeSegmentHandlerType,exports.mxElbowEdgeHandler=mxElbowEdgeHandlerType,exports.mxGraphHandler=mxGraphHandlerType,exports.mxHandle=mxHandleType,exports.mxKeyHandler=mxKeyHandlerType,exports.mxPanningHandler=mxPanningHandlerType,exports.mxPopupMenuHandler=mxPopupMenuHandlerType,exports.mxRubberband=mxRubberbandType,exports.mxSelectionCellsHandler=mxSelectionCellsHandlerType,exports.mxTooltipHandler=mxTooltipHandlerType,exports.mxVertexHandler=mxVertexHandlerType,exports.mxCellCodec=mxCellCodecType,exports.mxChildChangeCodec=mxChildChangeCodecType,exports.mxDefaultKeyHandlerCodec=mxDefaultKeyHandlerCodecType,exports.mxDefaultPopupMenuCodec=mxDefaultPopupMenuCodecType,exports.mxDefaultToolbarCodec=mxDefaultToolbarCodecType,exports.mxEditorCodec=mxEditorCodecType,exports.mxGenericChangeCodec=mxGenericChangeCodecType,exports.mxGraphCodec=mxGraphCodecType,exports.mxGraphViewCodec=mxGraphViewCodecType,exports.mxModelCodec=mxModelCodecType,exports.mxObjectCodec=mxObjectCodecType,exports.mxRootChangeCodec=mxRootChangeCodecType,exports.mxStylesheetCodec=mxStylesheetCodecType,exports.mxTerminalChangeCodec=mxTerminalChangeCodecType,exports.mxCircleLayout=mxCircleLayoutType,exports.mxCompactTreeLayout=mxCompactTreeLayoutType,exports.mxCompositeLayout=mxCompositeLayoutType,exports.mxEdgeLabelLayout=mxEdgeLabelLayoutType,exports.mxFastOrganicLayout=mxFastOrganicLayoutType,exports.mxGraphLayout=mxGraphLayoutType,exports.mxParallelEdgeLayout=mxParallelEdgeLayoutType,exports.mxPartitionLayout=mxPartitionLayoutType,exports.mxRadialTreeLayout=mxRadialTreeLayoutType,exports.mxStackLayout=mxStackLayoutType,exports.mxHierarchicalLayout=mxHierarchicalLayoutType,exports.mxSwimlaneLayout=mxSwimlaneLayoutType,exports.mxGraphAbstractHierarchyCell=mxGraphAbstractHierarchyCellType,exports.mxGraphHierarchyEdge=mxGraphHierarchyEdgeType,exports.mxGraphHierarchyModel=mxGraphHierarchyModelType,exports.mxGraphHierarchyNode=mxGraphHierarchyNodeType,exports.mxSwimlaneModel=mxSwimlaneModelType,exports.mxCoordinateAssignment=mxCoordinateAssignmentType,exports.mxHierarchicalLayoutStage=mxHierarchicalLayoutStageType,exports.mxMedianHybridCrossingReduction=mxMedianHybridCrossingReductionType,exports.mxMinimumCycleRemover=mxMinimumCycleRemoverType,exports.mxSwimlaneOrdering=mxSwimlaneOrderingType,exports.mxCell=mxCellType,exports.mxCellPath=mxCellPathType,exports.mxGeometry=mxGeometryType,exports.mxGraphModel=mxGraphModelType,exports.renderingHint=renderingHintType,exports.mxActor=mxActorType,exports.mxArrow=mxArrowType,exports.mxArrowConnector=mxArrowConnectorType,exports.mxCloud=mxCloudType,exports.mxConnector=mxConnectorType,exports.mxCylinder=mxCylinderType,exports.mxDoubleEllipse=mxDoubleEllipseType,exports.mxEllipse=mxEllipseType,exports.mxHexagon=mxHexagonType,exports.mxImageShape=mxImageShapeType,exports.mxLabel=mxLabelType,exports.mxLine=mxLineType,exports.mxMarker=mxMarkerType,exports.mxPolyline=mxPolylineType,exports.mxRectangleShape=mxRectangleShapeType,exports.mxRhombus=mxRhombusType,exports.mxShape=mxShapeType,exports.mxStencil=mxStencilType,exports.mxStencilRegistry=mxStencilRegistryType,exports.mxSwimlane=mxSwimlaneType,exports.mxText=mxTextType,exports.mxTriangle=mxTriangleType,exports.mxAbstractCanvas2D=mxAbstractCanvas2DType,exports.mxAnimation=mxAnimationType,exports.mxAutoSaveManager=mxAutoSaveManagerType,exports.mxClipboard=mxClipboardType,exports.mxConstants=mxConstantsType,exports.mxDictionary=mxDictionaryType,exports.mxDivResizer=mxDivResizerType,exports.mxDragSource=mxDragSourceType,exports.mxEffects=mxEffectsType,exports.mxEvent=mxEventType,exports.mxEventObject=mxEventObjectType,exports.mxEventSource=mxEventSourceType,exports.mxForm=mxFormType,exports.mxGuide=mxGuideType,exports.mxImage=mxImageType,exports.mxImageBundle=mxImageBundleType,exports.mxImageExport=mxImageExportType,exports.mxLog=mxLogType,exports.mxMorphing=mxMorphingType,exports.mxMouseEvent=mxMouseEventType,exports.mxObjectIdentity=mxObjectIdentityType,exports.mxPanningManager=mxPanningManagerType,exports.mxPoint=mxPointType,exports.mxPopupMenu=mxPopupMenuType,exports.mxRectangle=mxRectangleType,exports.mxResources=mxResourcesType,exports.mxSvgCanvas2D=mxSvgCanvas2DType,exports.mxToolbar=mxToolbarType,exports.mxUndoableEdit=mxUndoableEditType,exports.mxUndoManager=mxUndoManagerType,exports.mxUrlConverter=mxUrlConverterType,exports.mxUtils=mxUtilsType,exports.mxVmlCanvas2D=mxVmlCanvas2DType,exports.mxWindow=mxWindowType,exports.mxXmlCanvas2D=mxXmlCanvas2DType,exports.mxXmlRequest=mxXmlRequestType,exports.mxCellEditor=mxCellEditorType,exports.mxCellOverlay=mxCellOverlayType,exports.mxCellRenderer=mxCellRendererType,exports.mxCellState=mxCellStateType,exports.mxCellStatePreview=mxCellStatePreviewType,exports.mxConnectionConstraint=mxConnectionConstraintType,exports.mxEdgeStyle=mxEdgeStyleType,exports.mxGraph=mxGraphType,exports.mxGraphSelectionModel=mxGraphSelectionModelType,exports.mxGraphView=mxGraphViewType,exports.mxLayoutManager=mxLayoutManagerType,exports.mxMultiplicity=mxMultiplicityType,exports.mxOutline=mxOutlineType,exports.mxPerimeter=mxPerimeterType,exports.mxPrintPreview=mxPrintPreviewType,exports.mxStyleRegistry=mxStyleRegistryType,exports.mxStylesheet=mxStylesheetType,exports.mxSwimlaneManager=mxSwimlaneManagerType,exports.mxTemporaryCellStates=mxTemporaryCellStatesType,exports.mxClient=mxClientType,exports.mxgraph=mxgraph,exports.BillData=BillData,exports.FormBillCreationProcessExecutorArgs=FormBillCreationProcessExecutorArgs,exports.FormBillCreationProcessExecutorResult=FormBillCreationProcessExecutorResult,exports.FormGetBillCreationProcessEntityExArgs=FormGetBillCreationProcessEntityExArgs,exports.FormGetBillCreationProcessEntityExResult=FormGetBillCreationProcessEntityExResult,exports.ManualCreationMode=ManualCreationMode,exports.BillDataInfo=BillDataInfo,exports.BillInfo=BillInfo,exports.CanTrackingInfo=CanTrackingInfo,exports.DownBillInfo=DownBillInfo,exports.GetBillsInfoArgs=GetBillsInfoArgs,exports.GetDownBillsInfoArgs=GetDownBillsInfoArgs,exports.GetUpBillsInfoArgs=GetUpBillsInfoArgs,exports.TrackingHelper=TrackingHelper,exports.TrackingMappingAssociation=TrackingMappingAssociation,exports.UpBillInfo=UpBillInfo,exports.BillChildInfo=BillChildInfo,exports.BillDetailInfo=BillDetailInfo,exports.BillItemInfo=BillItemInfo,exports.FieldsWithOrder=FieldsWithOrder,exports.SummaryFieldsInfo=SummaryFieldsInfo,exports.FieldNameAndValue=FieldNameAndValue,exports.DateTypeFormatInfo=DateTypeFormatInfo,exports.DecimalTypeFormatInfo=DecimalTypeFormatInfo,exports.TypeToFormat=TypeToFormat$1,exports.ScaleMode=ScaleMode,exports.ExpressionJointQueryParameterContent=ExpressionJointQueryParameterContent,exports.FieldJointQueryParameterContent=FieldJointQueryParameterContent,exports.JointQueryParameterContent=JointQueryParameterContent,exports.JointQueryParameterMode=JointQueryParameterMode,exports.JointQueryParameterResult=JointQueryParameterResult,exports.JointQueryParametersContent=JointQueryParametersContent,exports.ConditionResult=ConditionResult,exports.BIF_UISTATE_KEY_CREATION_RESULT=BIF_UISTATE_KEY_CREATION_RESULT,exports.BIF_UISTATE_KEY_OPEN_TYPE=BIF_UISTATE_KEY_OPEN_TYPE,exports.ModuleConfig=ModuleConfig,exports.SELECTOR_ARGS_INJECTOR=SELECTOR_ARGS_INJECTOR,exports.DEFAULT_SELECTOR_ARGS=DEFAULT_SELECTOR_ARGS,exports.CanTrackingResult=CanTrackingResult,exports.GetChildrenEntityDataArgs=GetChildrenEntityDataArgs,exports.DownBillInfoResult=DownBillInfoResult,exports.EntityDataResult=EntityDataResult,exports.GetEntityDataArgs=GetEntityDataArgs,exports.GetMainEntityDataArgs=GetMainEntityDataArgs,exports.UpBillInfoResult=UpBillInfoResult,exports.GetJointQueryParametersArgs=GetJointQueryParametersArgs,exports.BillTrackerConstant=BillTrackerConstant,exports.BillTrackerModuleConfig=BillTrackerModuleConfig,exports.BillTrackerDirection=BillTrackerDirection,exports.BillTrackerGraphOptions=BillTrackerGraphOptions,exports.BillTrackerGridOptions=BillTrackerGridOptions,exports.Graph=Graph,exports.GraphView=GraphView,exports.BillNodeShape=BillNodeShape,exports.BillAssociationLine=BillAssociationLine,exports.CompactTreeLayout=CompactTreeLayout,exports.RevertCompactTreeLayout=RevertCompactTreeLayout,exports.VertexHandler=VertexHandler,exports.Events=Events,exports.BillCell=BillCell,exports.CellOverlay=CellOverlay,exports.CellOverlayState=CellOverlayState,exports.Outline=Outline,exports.Styles=Styles,exports.BIF_MANUAL_CREATION_PROVIDERS=BIF_MANUAL_CREATION_PROVIDERS,exports.BIF_BILL_TRACKER_PROVIDERS=BIF_BILL_TRACKER_PROVIDERS,exports.BIF_DEVKIT_PROVIDERS=BIF_DEVKIT_PROVIDERS,exports.ɵe=ModuleConfig,exports.ɵc=SELECTOR_ARGS_INJECTOR,exports.ɵd=LocalePipe,exports.ɵa=AbstractUiService,exports.ɵl=BasicInfoComponent,exports.ɵi=BasicTableComponent,exports.ɵj=ChildRowTableDirective,exports.ɵh=BillTrackerDataComponent,exports.ɵg=BillTrackerGraphComponent,exports.ɵo=ChildInfoListComponent,exports.ɵn=ChildInfoComponent,exports.ɵq=BillTrackerModuleConfig,exports.ɵp=BillTrackerFieldLabelPipe,exports.ɵk=BillTrackerLocalePipe,exports.ɵm=BillTrackerDataInfoService,exports.ɵf=BillTrackerDataService,Object.defineProperty(exports,"__esModule",{value:!0})});
//# sourceMappingURL=edp-bif-runtime-api.umd.min.js.map