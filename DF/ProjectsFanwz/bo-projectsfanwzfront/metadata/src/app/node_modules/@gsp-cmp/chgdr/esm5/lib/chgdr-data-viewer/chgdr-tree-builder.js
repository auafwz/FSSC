/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Guid } from '../util/guid.util';
// 参考： Farris TreeTable的节点结构
// export interface TreeNode {
//     id?: string;
//     data: any;
//     /** 叶子节点图标 */
//     icon?: any;
//     /** 节点展开图标 */
//     expandedIcon?: any;
//     /** 节点折叠图标 */
//     collapsedIcon?: any;
//     /** 子节点 */
//     children?: TreeNode[];
//     /** 是否为叶子节点 */
//     leaf?: boolean;
//     /** 是否展开 */
//     expanded?: boolean;
//     type?: string;
//     /** 父节点 */
//     parent?: TreeNode;
//     /** 是否允许选中 */
//     selectable?: boolean;
//  }
var 
// 参考： Farris TreeTable的节点结构
// export interface TreeNode {
//     id?: string;
//     data: any;
//     /** 叶子节点图标 */
//     icon?: any;
//     /** 节点展开图标 */
//     expandedIcon?: any;
//     /** 节点折叠图标 */
//     collapsedIcon?: any;
//     /** 子节点 */
//     children?: TreeNode[];
//     /** 是否为叶子节点 */
//     leaf?: boolean;
//     /** 是否展开 */
//     expanded?: boolean;
//     type?: string;
//     /** 父节点 */
//     parent?: TreeNode;
//     /** 是否允许选中 */
//     selectable?: boolean;
//  }
ChgdrTreeNode = /** @class */ (function () {
    function ChgdrTreeNode() {
    }
    return ChgdrTreeNode;
}());
// 参考： Farris TreeTable的节点结构
// export interface TreeNode {
//     id?: string;
//     data: any;
//     /** 叶子节点图标 */
//     icon?: any;
//     /** 节点展开图标 */
//     expandedIcon?: any;
//     /** 节点折叠图标 */
//     collapsedIcon?: any;
//     /** 子节点 */
//     children?: TreeNode[];
//     /** 是否为叶子节点 */
//     leaf?: boolean;
//     /** 是否展开 */
//     expanded?: boolean;
//     type?: string;
//     /** 父节点 */
//     parent?: TreeNode;
//     /** 是否允许选中 */
//     selectable?: boolean;
//  }
export { ChgdrTreeNode };
if (false) {
    /**
     * 节点ID，用于内部处理，请勿使用
     * @type {?}
     */
    ChgdrTreeNode.prototype.id;
    /**
     * 节点名称
     * @type {?}
     */
    ChgdrTreeNode.prototype.name;
    /**
     * 父节点
     * @type {?}
     */
    ChgdrTreeNode.prototype.parent;
    /**
     * 子节点列表
     * @type {?}
     */
    ChgdrTreeNode.prototype.children;
    /**
     * 是否展开
     * @type {?}
     */
    ChgdrTreeNode.prototype.expanded;
    /**
     * 是否隐藏
     * @type {?}
     */
    ChgdrTreeNode.prototype.hidden;
    /**
     * 展示树结构用的数据实体
     * @type {?}
     */
    ChgdrTreeNode.prototype.data;
    /** @type {?} */
    ChgdrTreeNode.prototype.chgdrRow;
    /** @type {?} */
    ChgdrTreeNode.prototype.chgdrData;
    /** @type {?} */
    ChgdrTreeNode.prototype.isRoot;
}
var ChgdrTreeBuilder = /** @class */ (function () {
    function ChgdrTreeBuilder() {
    }
    /**
     * @param {?} chgdrData
     * @return {?}
     */
    ChgdrTreeBuilder.prototype.build = /**
     * @param {?} chgdrData
     * @return {?}
     */
    function (chgdrData) {
        this.chgdrData = chgdrData;
        if (chgdrData.entityNodes.length == 0) {
            console.warn("无变更日志");
            return [];
        }
        /** @type {?} */
        var rootEntityNode = chgdrData.entityNodes[0];
        /** @type {?} */
        var rootRows = rootEntityNode.rows;
        if (rootRows.length == 0) {
            console.warn("无根变更日志行");
            return [];
        }
        /** @type {?} */
        var rootRow = rootRows[0];
        /** @type {?} */
        var node = this.rowToNode(rootRow);
        node.isRoot = true;
        node.expanded = true;
        return [node];
    };
    /**
     * @private
     * @param {?} row
     * @return {?}
     */
    ChgdrTreeBuilder.prototype.rowToNode = /**
     * @private
     * @param {?} row
     * @return {?}
     */
    function (row) {
        var _this = this;
        /** @type {?} */
        var node = new ChgdrTreeNode();
        node.id = Guid.newGuid();
        node.name = this.buildTreeNodeName(row);
        node.data = {
            id: node.id,
            name: node.name
        };
        node.chgdrRow = row;
        node.chgdrData = this.chgdrData;
        node.children = [];
        row.entityNodes.forEach((/**
         * @param {?} entityNode
         * @return {?}
         */
        function (entityNode) {
            entityNode.rows.forEach((/**
             * @param {?} childRow
             * @return {?}
             */
            function (childRow) {
                /** @type {?} */
                var childNode = _this.rowToNode(childRow);
                childNode.parent = node;
                node.children.push(childNode);
            }));
        }));
        return node;
    };
    /**
     * @private
     * @param {?} row
     * @return {?}
     */
    ChgdrTreeBuilder.prototype.buildTreeNodeName = /**
     * @private
     * @param {?} row
     * @return {?}
     */
    function (row) {
        /** @type {?} */
        var dataCodeName;
        if (row.dataCodes && row.dataCodes.length > 0) {
            dataCodeName = row.dataCodes[0].fieldValue;
        }
        if (dataCodeName) {
            return row.entityName + "-" + dataCodeName + "【" + row.operateType.getName() + "】";
        }
        else {
            return row.entityName + "【" + row.operateType.getName() + "】";
        }
    };
    return ChgdrTreeBuilder;
}());
export { ChgdrTreeBuilder };
if (false) {
    /**
     * @type {?}
     * @private
     */
    ChgdrTreeBuilder.prototype.chgdrData;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hnZHItdHJlZS1idWlsZGVyLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC1jbXAvY2hnZHIvIiwic291cmNlcyI6WyJsaWIvY2hnZHItZGF0YS12aWV3ZXIvY2hnZHItdHJlZS1idWlsZGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBMEJ6Qzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBQUE7SUFzQkEsQ0FBQztJQUFELG9CQUFDO0FBQUQsQ0FBQyxBQXRCRCxJQXNCQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFuQkcsMkJBQVc7Ozs7O0lBRVgsNkJBQWE7Ozs7O0lBR2IsK0JBQXNCOzs7OztJQUV0QixpQ0FBMEI7Ozs7O0lBRzFCLGlDQUFrQjs7Ozs7SUFFbEIsK0JBQWdCOzs7OztJQUdoQiw2QkFBVTs7SUFDVixpQ0FBMkI7O0lBQzNCLGtDQUFxQjs7SUFDckIsK0JBQWdCOztBQUdwQjtJQUFBO0lBd0RBLENBQUM7Ozs7O0lBckRVLGdDQUFLOzs7O0lBQVosVUFBYSxTQUFvQjtRQUM3QixJQUFJLENBQUMsU0FBUyxHQUFHLFNBQVMsQ0FBQztRQUMzQixJQUFJLFNBQVMsQ0FBQyxXQUFXLENBQUMsTUFBTSxJQUFJLENBQUMsRUFBRTtZQUNuQyxPQUFPLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ3RCLE9BQU8sRUFBRSxDQUFDO1NBQ2I7O1lBQ0csY0FBYyxHQUFHLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDOztZQUN6QyxRQUFRLEdBQUcsY0FBYyxDQUFDLElBQUk7UUFDbEMsSUFBSSxRQUFRLENBQUMsTUFBTSxJQUFJLENBQUMsRUFBRTtZQUN0QixPQUFPLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ3hCLE9BQU8sRUFBRSxDQUFDO1NBQ2I7O1lBQ0csT0FBTyxHQUFHLFFBQVEsQ0FBQyxDQUFDLENBQUM7O1lBRXJCLElBQUksR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQztRQUNsQyxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztRQUNuQixJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQztRQUVyQixPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbEIsQ0FBQzs7Ozs7O0lBRU8sb0NBQVM7Ozs7O0lBQWpCLFVBQWtCLEdBQXFCO1FBQXZDLGlCQW1CQzs7WUFsQlMsSUFBSSxHQUFrQixJQUFJLGFBQWEsRUFBRTtRQUMvQyxJQUFJLENBQUMsRUFBRSxHQUFHLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUN6QixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUN4QyxJQUFJLENBQUMsSUFBSSxHQUFHO1lBQ1IsRUFBRSxFQUFFLElBQUksQ0FBQyxFQUFFO1lBQ1gsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJO1NBQ2xCLENBQUM7UUFDRixJQUFJLENBQUMsUUFBUSxHQUFHLEdBQUcsQ0FBQztRQUNwQixJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUM7UUFDaEMsSUFBSSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUM7UUFDbkIsR0FBRyxDQUFDLFdBQVcsQ0FBQyxPQUFPOzs7O1FBQUMsVUFBQSxVQUFVO1lBQzlCLFVBQVUsQ0FBQyxJQUFJLENBQUMsT0FBTzs7OztZQUFDLFVBQUEsUUFBUTs7b0JBQ3RCLFNBQVMsR0FBa0IsS0FBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUM7Z0JBQ3pELFNBQVMsQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDO2dCQUN4QixJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUNsQyxDQUFDLEVBQUMsQ0FBQTtRQUNOLENBQUMsRUFBQyxDQUFBO1FBQ0YsT0FBTyxJQUFJLENBQUM7SUFDaEIsQ0FBQzs7Ozs7O0lBRU8sNENBQWlCOzs7OztJQUF6QixVQUEwQixHQUFxQjs7WUFDdkMsWUFBWTtRQUNoQixJQUFHLEdBQUcsQ0FBQyxTQUFTLElBQUksR0FBRyxDQUFDLFNBQVMsQ0FBQyxNQUFNLEdBQUMsQ0FBQyxFQUFDO1lBQ3ZDLFlBQVksR0FBRyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQztTQUM5QztRQUNELElBQUcsWUFBWSxFQUFDO1lBQ1osT0FBTyxHQUFHLENBQUMsVUFBVSxHQUFHLEdBQUcsR0FBRyxZQUFZLEdBQUcsR0FBRyxHQUFHLEdBQUcsQ0FBQyxXQUFXLENBQUMsT0FBTyxFQUFFLEdBQUcsR0FBRyxDQUFDO1NBQ3RGO2FBQUk7WUFDRCxPQUFPLEdBQUcsQ0FBQyxVQUFVLEdBQUcsR0FBRyxHQUFHLEdBQUcsQ0FBQyxXQUFXLENBQUMsT0FBTyxFQUFFLEdBQUcsR0FBRyxDQUFDO1NBQ2pFO0lBQ0wsQ0FBQztJQUNMLHVCQUFDO0FBQUQsQ0FBQyxBQXhERCxJQXdEQzs7Ozs7OztJQXZERyxxQ0FBNkIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBHdWlkIH0gZnJvbSAnLi4vdXRpbC9ndWlkLnV0aWwnO1xyXG5pbXBvcnQgeyBDaGdkckRhdGEsIENoZ2RyRGF0YVJvd05vZGUgfSBmcm9tICcuL2NoZ2RyLWRhdGEnO1xyXG5cclxuLy8g5Y+C6ICD77yaIEZhcnJpcyBUcmVlVGFibGXnmoToioLngrnnu5PmnoRcclxuLy8gZXhwb3J0IGludGVyZmFjZSBUcmVlTm9kZSB7XHJcbi8vICAgICBpZD86IHN0cmluZztcclxuLy8gICAgIGRhdGE6IGFueTtcclxuLy8gICAgIC8qKiDlj7blrZDoioLngrnlm77moIcgKi9cclxuLy8gICAgIGljb24/OiBhbnk7XHJcbi8vICAgICAvKiog6IqC54K55bGV5byA5Zu+5qCHICovXHJcbi8vICAgICBleHBhbmRlZEljb24/OiBhbnk7XHJcbi8vICAgICAvKiog6IqC54K55oqY5Y+g5Zu+5qCHICovXHJcbi8vICAgICBjb2xsYXBzZWRJY29uPzogYW55O1xyXG4vLyAgICAgLyoqIOWtkOiKgueCuSAqL1xyXG4vLyAgICAgY2hpbGRyZW4/OiBUcmVlTm9kZVtdO1xyXG4vLyAgICAgLyoqIOaYr+WQpuS4uuWPtuWtkOiKgueCuSAqL1xyXG4vLyAgICAgbGVhZj86IGJvb2xlYW47XHJcbi8vICAgICAvKiog5piv5ZCm5bGV5byAICovXHJcbi8vICAgICBleHBhbmRlZD86IGJvb2xlYW47XHJcbi8vICAgICB0eXBlPzogc3RyaW5nO1xyXG4vLyAgICAgLyoqIOeItuiKgueCuSAqL1xyXG4vLyAgICAgcGFyZW50PzogVHJlZU5vZGU7XHJcbi8vICAgICAvKiog5piv5ZCm5YWB6K646YCJ5LitICovXHJcbi8vICAgICBzZWxlY3RhYmxlPzogYm9vbGVhbjtcclxuLy8gIH1cclxuXHJcbmV4cG9ydCBjbGFzcyBDaGdkclRyZWVOb2RlIHtcclxuICAgIC8vIOagkemFjee9ruS4reiuvue9ruS6hmlkRmllbGTnmoTmg4XlhrXkuIvvvIxpZOS8muiiq+iHquWKqOi1i+WAvOS4umRhdGFbaWRGaWVsZF3nmoTlgLzjgILmiYDku6XlnKjmraTorr7nva7lv4Xpobvorr7nva7kuLrkuI5kYXRhLmlk5Lit55u45ZCM44CCXHJcbiAgICAvKiog6IqC54K5SUTvvIznlKjkuo7lhoXpg6jlpITnkIbvvIzor7fli7/kvb/nlKggKi9cclxuICAgIGlkOiBzdHJpbmc7XHJcbiAgICAvKiog6IqC54K55ZCN56ewICovXHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcblxyXG4gICAgLyoqIOeItuiKgueCuSAqL1xyXG4gICAgcGFyZW50OiBDaGdkclRyZWVOb2RlO1xyXG4gICAgLyoqIOWtkOiKgueCueWIl+ihqCAqL1xyXG4gICAgY2hpbGRyZW46IENoZ2RyVHJlZU5vZGVbXTtcclxuXHJcbiAgICAvKiog5piv5ZCm5bGV5byAICovXHJcbiAgICBleHBhbmRlZDogYm9vbGVhbjtcclxuICAgIC8qKiDmmK/lkKbpmpDol48gKi9cclxuICAgIGhpZGRlbjogYm9vbGVhbjtcclxuXHJcbiAgICAvKiog5bGV56S65qCR57uT5p6E55So55qE5pWw5o2u5a6e5L2TICovXHJcbiAgICBkYXRhOiBhbnk7XHJcbiAgICBjaGdkclJvdzogQ2hnZHJEYXRhUm93Tm9kZTtcclxuICAgIGNoZ2RyRGF0YTogQ2hnZHJEYXRhO1xyXG4gICAgaXNSb290OiBib29sZWFuO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQ2hnZHJUcmVlQnVpbGRlciB7XHJcbiAgICBwcml2YXRlIGNoZ2RyRGF0YTogQ2hnZHJEYXRhO1xyXG5cclxuICAgIHB1YmxpYyBidWlsZChjaGdkckRhdGE6IENoZ2RyRGF0YSk6IENoZ2RyVHJlZU5vZGVbXSB7XHJcbiAgICAgICAgdGhpcy5jaGdkckRhdGEgPSBjaGdkckRhdGE7XHJcbiAgICAgICAgaWYgKGNoZ2RyRGF0YS5lbnRpdHlOb2Rlcy5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXCLml6Dlj5jmm7Tml6Xlv5dcIik7XHJcbiAgICAgICAgICAgIHJldHVybiBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IHJvb3RFbnRpdHlOb2RlID0gY2hnZHJEYXRhLmVudGl0eU5vZGVzWzBdO1xyXG4gICAgICAgIGxldCByb290Um93cyA9IHJvb3RFbnRpdHlOb2RlLnJvd3M7XHJcbiAgICAgICAgaWYgKHJvb3RSb3dzLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIuaXoOagueWPmOabtOaXpeW/l+ihjFwiKTtcclxuICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgcm9vdFJvdyA9IHJvb3RSb3dzWzBdO1xyXG5cclxuICAgICAgICBsZXQgbm9kZSA9IHRoaXMucm93VG9Ob2RlKHJvb3RSb3cpO1xyXG4gICAgICAgIG5vZGUuaXNSb290ID0gdHJ1ZTtcclxuICAgICAgICBub2RlLmV4cGFuZGVkID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgcmV0dXJuIFtub2RlXTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJvd1RvTm9kZShyb3c6IENoZ2RyRGF0YVJvd05vZGUpOiBDaGdkclRyZWVOb2RlIHtcclxuICAgICAgICBjb25zdCBub2RlOiBDaGdkclRyZWVOb2RlID0gbmV3IENoZ2RyVHJlZU5vZGUoKTtcclxuICAgICAgICBub2RlLmlkID0gR3VpZC5uZXdHdWlkKCk7XHJcbiAgICAgICAgbm9kZS5uYW1lID0gdGhpcy5idWlsZFRyZWVOb2RlTmFtZShyb3cpO1xyXG4gICAgICAgIG5vZGUuZGF0YSA9IHtcclxuICAgICAgICAgICAgaWQ6IG5vZGUuaWQsXHJcbiAgICAgICAgICAgIG5hbWU6IG5vZGUubmFtZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgbm9kZS5jaGdkclJvdyA9IHJvdztcclxuICAgICAgICBub2RlLmNoZ2RyRGF0YSA9IHRoaXMuY2hnZHJEYXRhO1xyXG4gICAgICAgIG5vZGUuY2hpbGRyZW4gPSBbXTtcclxuICAgICAgICByb3cuZW50aXR5Tm9kZXMuZm9yRWFjaChlbnRpdHlOb2RlID0+IHtcclxuICAgICAgICAgICAgZW50aXR5Tm9kZS5yb3dzLmZvckVhY2goY2hpbGRSb3cgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hpbGROb2RlOiBDaGdkclRyZWVOb2RlID0gdGhpcy5yb3dUb05vZGUoY2hpbGRSb3cpO1xyXG4gICAgICAgICAgICAgICAgY2hpbGROb2RlLnBhcmVudCA9IG5vZGU7XHJcbiAgICAgICAgICAgICAgICBub2RlLmNoaWxkcmVuLnB1c2goY2hpbGROb2RlKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgIHJldHVybiBub2RlO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYnVpbGRUcmVlTm9kZU5hbWUocm93OiBDaGdkckRhdGFSb3dOb2RlKTogc3RyaW5ne1xyXG4gICAgICAgIGxldCBkYXRhQ29kZU5hbWU7XHJcbiAgICAgICAgaWYocm93LmRhdGFDb2RlcyAmJiByb3cuZGF0YUNvZGVzLmxlbmd0aD4wKXtcclxuICAgICAgICAgICAgZGF0YUNvZGVOYW1lID0gcm93LmRhdGFDb2Rlc1swXS5maWVsZFZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihkYXRhQ29kZU5hbWUpe1xyXG4gICAgICAgICAgICByZXR1cm4gcm93LmVudGl0eU5hbWUgKyBcIi1cIiArIGRhdGFDb2RlTmFtZSArIFwi44CQXCIgKyByb3cub3BlcmF0ZVR5cGUuZ2V0TmFtZSgpICsgXCLjgJFcIjtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgcmV0dXJuIHJvdy5lbnRpdHlOYW1lICsgXCLjgJBcIiArIHJvdy5vcGVyYXRlVHlwZS5nZXROYW1lKCkgKyBcIuOAkVwiO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSJdfQ==