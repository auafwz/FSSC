/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Injector, Input, ViewChild } from '@angular/core';
import { GSPMetadataRTService } from '@gsp-lcm/metadatart-selector';
import { ChangeDataHeader } from '../model/change-data-header';
import { ChgdrDataBuilder } from './chgdr-data-builder';
import { ChgdrTreeBuilder } from './chgdr-tree-builder';
import { TreeTableComponent } from '@farris/ui-treetable';
import { ChgdrMetadataService } from '../service/chgdr-metadata.service';
import { ChgdrConfigService } from '../service/chgdr-config.service';
import { ChgdrInnerService } from '../service/chgdr-inner.service';
var ChgdrDataViewerComponent = /** @class */ (function () {
    function ChgdrDataViewerComponent(metadataService, injector, chgdrMetadataService, chgdrConfigService, chgdrInnerService) {
        this.metadataService = metadataService;
        this.injector = injector;
        this.chgdrMetadataService = chgdrMetadataService;
        this.chgdrConfigService = chgdrConfigService;
        this.chgdrInnerService = chgdrInnerService;
        this.showDataId = false;
        this.treeConfig = {
            idField: 'id',
            columns: [
                { field: 'name', title: 'Name', width: 200 }
            ],
            /**
             * 叶子节点图标
             */
            leafIcon: 'f-icon f-icon-page-title-type text-info mr-2',
            /**
             * 节点展开图标
             */
            expandIcon: 'f-icon f-icon-file-folder-open text-info mr-2',
            /**
             * 节点折叠图标
             */
            collapseIcon: 'f-icon f-icon-file-folder-close text-info mr-2',
            showLevel: -1,
            disabled: false,
            init: false,
            selectValues: []
        };
    }
    /**
     * @return {?}
     */
    ChgdrDataViewerComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    ChgdrDataViewerComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        var _this = this;
        if (!!this.data) {
            /** @type {?} */
            var beId = this.data.entityId;
            this.chgdrInnerService.getChgdrConfigHandler(beId).subscribe((/**
             * @param {?} handler
             * @return {?}
             */
            function (handler) {
                _this.chgdrData = new ChgdrDataBuilder().buildChgdrData(_this.data, handler);
                _this.treeData = new ChgdrTreeBuilder().build(_this.chgdrData);
                if (_this.treeTableComponent) {
                    //移除已选中项。
                    //避免更换数据源后，treeGrid找不到之前的选中数据，导致控制台告警
                    _this.treeTableComponent.clearSelections();
                }
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    _this.treeTableComponent.selectNode(_this.treeData[0].id);
                }), 0);
            }));
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ChgdrDataViewerComponent.prototype.handleTreeSelection = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        /** @type {?} */
        var node = $event.node;
        if (this.currentNode != null && this.currentNode.id == node.id) {
            //如果选中相同节点，直接返回
            return;
        }
        this.currentNode = node;
    };
    ChgdrDataViewerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'chgdr-data-viewer',
                    template: "<farris-splitter *ngIf=\"!!chgdrData\" class=\"row flex-fill farris-split-section\" style=\"margin: 0px;\">\r\n  <farris-splitter-pane [ngResizable]=true [rzMinWidth]=\"250\" [rzHandles]=\"'e'\" style=\"padding:0.3rem 0 0.3rem 0.3rem;\"\r\n    class=\"d-flex flex-column farris-lsection f-col-w4\">\r\n    <farris-treetable #treeTable class=\"f-utils-fill\" style=\"overflow-y: auto;\" [columns]=\"treeConfig.columns\" [showBorder]=\"false\" [showHeader]=\"false\"\r\n      [data]=\"treeData\" [idField]=\"treeConfig.idField\" [singleSelect]=\"true\" [showCheckbox]=\"false\"\r\n      [showIcon]=\"true\" [disabled]=\"treeConfig.disabled\" [checkOnSelect]=\"true\"\r\n      (nodeSelected)=\"handleTreeSelection($event)\" [leafIcon]=\"treeConfig.leafIcon\"\r\n      [expandIcon]=\"treeConfig.expandIcon\" [collapseIcon]=\"treeConfig.collapseIcon\"\r\n      [selectValues]=\"treeConfig.selectValues\">\r\n    </farris-treetable>\r\n  </farris-splitter-pane>\r\n  <farris-splitter-pane class=\"farris-rsection farris-overflow-y-auto f-utils-fill-flex-column\" style=\"padding:0 0 0 0.3rem\">\r\n    <farris-section mainTitle=\"\u57FA\u672C\u4FE1\u606F\" [enableMaximize]=\"false\" [enableAccordion]=\"'default'\">\r\n      <lib-chgdr-row-baseinfo-form [chgdrTreeNode]=\"currentNode\" [showDataId]=\"showDataId\"></lib-chgdr-row-baseinfo-form>\r\n    </farris-section>\r\n    <farris-section mainTitle=\"\u53D8\u66F4\u8BE6\u60C5\" [enableMaximize]=\"false\" [fill]=\"true\" class=\"pt-0\">\r\n      <lib-chgdr-row-grid *ngIf=\"!!currentNode && currentNode.chgdrRow.changes.length>0\" [chgdrTreeNode]=\"currentNode\" class=\"f-utils-fill\"></lib-chgdr-row-grid>\r\n      <div class=\"f-datagrid-norecords\" *ngIf=\"!currentNode || currentNode.chgdrRow.changes.length==0\" style=\"height: 250px;\">\r\n        <div class=\"f-datagrid-norecords-content\" style=\"width: 100%;\">\r\n            \u65E0\u6570\u636E\r\n        </div>\r\n      </div>\r\n    </farris-section>\r\n  </farris-splitter-pane>\r\n</farris-splitter>",
                    styles: [":host{display:-webkit-box;display:flex;height:100%}"]
                }] }
    ];
    /** @nocollapse */
    ChgdrDataViewerComponent.ctorParameters = function () { return [
        { type: GSPMetadataRTService },
        { type: Injector },
        { type: ChgdrMetadataService },
        { type: ChgdrConfigService },
        { type: ChgdrInnerService }
    ]; };
    ChgdrDataViewerComponent.propDecorators = {
        data: [{ type: Input }],
        showDataId: [{ type: Input }],
        treeTableComponent: [{ type: ViewChild, args: ["treeTable",] }]
    };
    return ChgdrDataViewerComponent;
}());
export { ChgdrDataViewerComponent };
if (false) {
    /** @type {?} */
    ChgdrDataViewerComponent.prototype.data;
    /** @type {?} */
    ChgdrDataViewerComponent.prototype.showDataId;
    /**
     * @type {?}
     * @private
     */
    ChgdrDataViewerComponent.prototype.treeTableComponent;
    /** @type {?} */
    ChgdrDataViewerComponent.prototype.treeConfig;
    /** @type {?} */
    ChgdrDataViewerComponent.prototype.chgdrData;
    /** @type {?} */
    ChgdrDataViewerComponent.prototype.treeData;
    /** @type {?} */
    ChgdrDataViewerComponent.prototype.currentNode;
    /**
     * @type {?}
     * @private
     */
    ChgdrDataViewerComponent.prototype.metadataService;
    /**
     * @type {?}
     * @private
     */
    ChgdrDataViewerComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    ChgdrDataViewerComponent.prototype.chgdrMetadataService;
    /**
     * @type {?}
     * @private
     */
    ChgdrDataViewerComponent.prototype.chgdrConfigService;
    /**
     * @type {?}
     * @private
     */
    ChgdrDataViewerComponent.prototype.chgdrInnerService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hnZHItZGF0YS12aWV3ZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC1jbXAvY2hnZHIvIiwic291cmNlcyI6WyJsaWIvY2hnZHItZGF0YS12aWV3ZXIvY2hnZHItZGF0YS12aWV3ZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQW9DLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN4RyxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQztBQUVwRSxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSw2QkFBNkIsQ0FBQztBQUkvRCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUN4RCxPQUFPLEVBQUUsZ0JBQWdCLEVBQWlCLE1BQU0sc0JBQXNCLENBQUM7QUFDdkUsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDMUQsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sbUNBQW1DLENBQUM7QUFDekUsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0saUNBQWlDLENBQUM7QUFHckUsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFFbkU7SUFpQ0Usa0NBQW9CLGVBQXFDLEVBQy9DLFFBQWtCLEVBQ2xCLG9CQUEwQyxFQUMxQyxrQkFBc0MsRUFDdEMsaUJBQW9DO1FBSjFCLG9CQUFlLEdBQWYsZUFBZSxDQUFzQjtRQUMvQyxhQUFRLEdBQVIsUUFBUSxDQUFVO1FBQ2xCLHlCQUFvQixHQUFwQixvQkFBb0IsQ0FBc0I7UUFDMUMsdUJBQWtCLEdBQWxCLGtCQUFrQixDQUFvQjtRQUN0QyxzQkFBaUIsR0FBakIsaUJBQWlCLENBQW1CO1FBN0JyQyxlQUFVLEdBQVksS0FBSyxDQUFDO1FBSXJDLGVBQVUsR0FBUTtZQUNoQixPQUFPLEVBQUUsSUFBSTtZQUNiLE9BQU8sRUFBRTtnQkFDUCxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFO2FBQzdDOzs7O1lBRUQsUUFBUSxFQUFFLDhDQUE4Qzs7OztZQUV4RCxVQUFVLEVBQUUsK0NBQStDOzs7O1lBRTNELFlBQVksRUFBRSxnREFBZ0Q7WUFDOUQsU0FBUyxFQUFFLENBQUMsQ0FBQztZQUNiLFFBQVEsRUFBRSxLQUFLO1lBQ2YsSUFBSSxFQUFFLEtBQUs7WUFDWCxZQUFZLEVBQUUsRUFBRTtTQUNqQixDQUFDO0lBVWdELENBQUM7Ozs7SUFFbkQsMkNBQVE7OztJQUFSO0lBQ0EsQ0FBQzs7Ozs7SUFFRCw4Q0FBVzs7OztJQUFYLFVBQVksT0FBc0I7UUFBbEMsaUJBZ0JDO1FBZkMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRTs7Z0JBQ1gsSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUTtZQUM3QixJQUFJLENBQUMsaUJBQWlCLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLENBQUMsU0FBUzs7OztZQUFDLFVBQUEsT0FBTztnQkFDbEUsS0FBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLGdCQUFnQixFQUFFLENBQUMsY0FBYyxDQUFDLEtBQUksQ0FBQyxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7Z0JBQzNFLEtBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxnQkFBZ0IsRUFBRSxDQUFDLEtBQUssQ0FBQyxLQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7Z0JBQzdELElBQUksS0FBSSxDQUFDLGtCQUFrQixFQUFFO29CQUMzQixTQUFTO29CQUNULHFDQUFxQztvQkFDckMsS0FBSSxDQUFDLGtCQUFrQixDQUFDLGVBQWUsRUFBRSxDQUFDO2lCQUMzQztnQkFDRCxVQUFVOzs7Z0JBQUM7b0JBQ1QsS0FBSSxDQUFDLGtCQUFrQixDQUFDLFVBQVUsQ0FBQyxLQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO2dCQUMxRCxDQUFDLEdBQUUsQ0FBQyxDQUFDLENBQUM7WUFDUixDQUFDLEVBQUMsQ0FBQTtTQUNIO0lBQ0gsQ0FBQzs7Ozs7SUFFTSxzREFBbUI7Ozs7SUFBMUIsVUFBMkIsTUFBTTs7WUFDekIsSUFBSSxHQUFrQixNQUFNLENBQUMsSUFBSTtRQUN2QyxJQUFJLElBQUksQ0FBQyxXQUFXLElBQUksSUFBSSxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsRUFBRSxJQUFJLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDOUQsZUFBZTtZQUNmLE9BQU87U0FDUjtRQUNELElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDO0lBQzFCLENBQUM7O2dCQW5FRixTQUFTLFNBQUM7b0JBQ1QsUUFBUSxFQUFFLG1CQUFtQjtvQkFDN0IsMitEQUFpRDs7aUJBRWxEOzs7O2dCQW5CUSxvQkFBb0I7Z0JBRFQsUUFBUTtnQkFVbkIsb0JBQW9CO2dCQUNwQixrQkFBa0I7Z0JBR2xCLGlCQUFpQjs7O3VCQVF2QixLQUFLOzZCQUVMLEtBQUs7cUNBQ0wsU0FBUyxTQUFDLFdBQVc7O0lBMkR4QiwrQkFBQztDQUFBLEFBcEVELElBb0VDO1NBL0RZLHdCQUF3Qjs7O0lBQ25DLHdDQUN1Qjs7SUFDdkIsOENBQXFDOzs7OztJQUNyQyxzREFDOEM7O0lBRTlDLDhDQWVFOztJQUVGLDZDQUFxQjs7SUFDckIsNENBQTBCOztJQUMxQiwrQ0FBMkI7Ozs7O0lBRWYsbURBQTZDOzs7OztJQUN2RCw0Q0FBMEI7Ozs7O0lBQzFCLHdEQUFrRDs7Ozs7SUFDbEQsc0RBQThDOzs7OztJQUM5QyxxREFBNEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEluamVjdG9yLCBJbnB1dCwgT25DaGFuZ2VzLCBPbkluaXQsIFNpbXBsZUNoYW5nZXMsIFZpZXdDaGlsZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBHU1BNZXRhZGF0YVJUU2VydmljZSB9IGZyb20gJ0Bnc3AtbGNtL21ldGFkYXRhcnQtc2VsZWN0b3InO1xyXG5pbXBvcnQgeyBHU1BCdXNpbmVzc0VudGl0eSB9IGZyb20gJ0Bnc3AtYmVmL2dzcC1iZS1tZXRhZGF0YSc7XHJcbmltcG9ydCB7IENoYW5nZURhdGFIZWFkZXIgfSBmcm9tICcuLi9tb2RlbC9jaGFuZ2UtZGF0YS1oZWFkZXInO1xyXG5pbXBvcnQgeyBDaGFuZ2VDb2x1bW5JdGVtLCBDaGdkckRhdGEsIENoZ2RyRGF0YUVudGl0eU5vZGUsIENoZ2RyRGF0YVJvd05vZGUgfSBmcm9tICcuL2NoZ2RyLWRhdGEnO1xyXG5pbXBvcnQgeyBHU1BBc3NvY2lhdGlvbiwgR1NQQ29tbW9uRWxlbWVudCwgR1NQQ29tbW9uT2JqZWN0LCBJR1NQQ29tbW9uRWxlbWVudCwgSUdTUENvbW1vbk9iamVjdCB9IGZyb20gJ0Bnc3AtYmVmL2dzcC1jbS1tZXRhZGF0YSc7XHJcbmltcG9ydCB7IENoYW5nZURhdGFSb3cgfSBmcm9tICcuLi9tb2RlbC9jaGFuZ2UtZGF0YS1yb3cnO1xyXG5pbXBvcnQgeyBDaGdkckRhdGFCdWlsZGVyIH0gZnJvbSAnLi9jaGdkci1kYXRhLWJ1aWxkZXInO1xyXG5pbXBvcnQgeyBDaGdkclRyZWVCdWlsZGVyLCBDaGdkclRyZWVOb2RlIH0gZnJvbSAnLi9jaGdkci10cmVlLWJ1aWxkZXInO1xyXG5pbXBvcnQgeyBUcmVlVGFibGVDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLXRyZWV0YWJsZSc7XHJcbmltcG9ydCB7IENoZ2RyTWV0YWRhdGFTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZS9jaGdkci1tZXRhZGF0YS5zZXJ2aWNlJztcclxuaW1wb3J0IHsgQ2hnZHJDb25maWdTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZS9jaGdkci1jb25maWcuc2VydmljZSc7XHJcbmltcG9ydCB7IGZvcmtKb2luIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IENoZ0xvZ0NvbmZpZ0VudGl0eSB9IGZyb20gJy4uL21vZGVsL2NoZ2RyLWNvbmZpZy1lbnRpdHknO1xyXG5pbXBvcnQgeyBDaGdkcklubmVyU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2UvY2hnZHItaW5uZXIuc2VydmljZSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2NoZ2RyLWRhdGEtdmlld2VyJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vY2hnZHItZGF0YS12aWV3ZXIuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL2NoZ2RyLWRhdGEtdmlld2VyLmNvbXBvbmVudC5jc3MnXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgQ2hnZHJEYXRhVmlld2VyQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMge1xyXG4gIEBJbnB1dCgpXHJcbiAgZGF0YTogQ2hhbmdlRGF0YUhlYWRlcjtcclxuICBASW5wdXQoKSBzaG93RGF0YUlkOiBib29sZWFuID0gZmFsc2U7XHJcbiAgQFZpZXdDaGlsZChcInRyZWVUYWJsZVwiKVxyXG4gIHByaXZhdGUgdHJlZVRhYmxlQ29tcG9uZW50OiBUcmVlVGFibGVDb21wb25lbnRcclxuXHJcbiAgdHJlZUNvbmZpZzogYW55ID0ge1xyXG4gICAgaWRGaWVsZDogJ2lkJyxcclxuICAgIGNvbHVtbnM6IFtcclxuICAgICAgeyBmaWVsZDogJ25hbWUnLCB0aXRsZTogJ05hbWUnLCB3aWR0aDogMjAwIH1cclxuICAgIF0sXHJcbiAgICAvKiog5Y+25a2Q6IqC54K55Zu+5qCHICovXHJcbiAgICBsZWFmSWNvbjogJ2YtaWNvbiBmLWljb24tcGFnZS10aXRsZS10eXBlIHRleHQtaW5mbyBtci0yJyxcclxuICAgIC8qKiDoioLngrnlsZXlvIDlm77moIcgKi9cclxuICAgIGV4cGFuZEljb246ICdmLWljb27CoGYtaWNvbi1maWxlLWZvbGRlci1vcGVuIHRleHQtaW5mbyBtci0yJyxcclxuICAgIC8qKiDoioLngrnmipjlj6Dlm77moIcgKi9cclxuICAgIGNvbGxhcHNlSWNvbjogJ2YtaWNvbsKgZi1pY29uLWZpbGUtZm9sZGVyLWNsb3NlIHRleHQtaW5mbyBtci0yJyxcclxuICAgIHNob3dMZXZlbDogLTEsXHJcbiAgICBkaXNhYmxlZDogZmFsc2UsXHJcbiAgICBpbml0OiBmYWxzZSxcclxuICAgIHNlbGVjdFZhbHVlczogW11cclxuICB9O1xyXG5cclxuICBjaGdkckRhdGE6IENoZ2RyRGF0YTtcclxuICB0cmVlRGF0YTogQ2hnZHJUcmVlTm9kZVtdO1xyXG4gIGN1cnJlbnROb2RlOiBDaGdkclRyZWVOb2RlO1xyXG5cclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIG1ldGFkYXRhU2VydmljZTogR1NQTWV0YWRhdGFSVFNlcnZpY2UsXHJcbiAgICBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvcixcclxuICAgIHByaXZhdGUgY2hnZHJNZXRhZGF0YVNlcnZpY2U6IENoZ2RyTWV0YWRhdGFTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBjaGdkckNvbmZpZ1NlcnZpY2U6IENoZ2RyQ29uZmlnU2VydmljZSxcclxuICAgIHByaXZhdGUgY2hnZHJJbm5lclNlcnZpY2U6IENoZ2RySW5uZXJTZXJ2aWNlKSB7IH1cclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcbiAgfVxyXG5cclxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XHJcbiAgICBpZiAoISF0aGlzLmRhdGEpIHtcclxuICAgICAgbGV0IGJlSWQgPSB0aGlzLmRhdGEuZW50aXR5SWQ7XHJcbiAgICAgIHRoaXMuY2hnZHJJbm5lclNlcnZpY2UuZ2V0Q2hnZHJDb25maWdIYW5kbGVyKGJlSWQpLnN1YnNjcmliZShoYW5kbGVyPT57XHJcbiAgICAgICAgdGhpcy5jaGdkckRhdGEgPSBuZXcgQ2hnZHJEYXRhQnVpbGRlcigpLmJ1aWxkQ2hnZHJEYXRhKHRoaXMuZGF0YSwgaGFuZGxlcik7XHJcbiAgICAgICAgdGhpcy50cmVlRGF0YSA9IG5ldyBDaGdkclRyZWVCdWlsZGVyKCkuYnVpbGQodGhpcy5jaGdkckRhdGEpO1xyXG4gICAgICAgIGlmICh0aGlzLnRyZWVUYWJsZUNvbXBvbmVudCkge1xyXG4gICAgICAgICAgLy/np7vpmaTlt7LpgInkuK3pobnjgIJcclxuICAgICAgICAgIC8v6YG/5YWN5pu05o2i5pWw5o2u5rqQ5ZCO77yMdHJlZUdyaWTmib7kuI3liLDkuYvliY3nmoTpgInkuK3mlbDmja7vvIzlr7zoh7TmjqfliLblj7DlkYroraZcclxuICAgICAgICAgIHRoaXMudHJlZVRhYmxlQ29tcG9uZW50LmNsZWFyU2VsZWN0aW9ucygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgIHRoaXMudHJlZVRhYmxlQ29tcG9uZW50LnNlbGVjdE5vZGUodGhpcy50cmVlRGF0YVswXS5pZCk7XHJcbiAgICAgICAgfSwgMCk7XHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgaGFuZGxlVHJlZVNlbGVjdGlvbigkZXZlbnQpOiB2b2lkIHtcclxuICAgIGNvbnN0IG5vZGU6IENoZ2RyVHJlZU5vZGUgPSAkZXZlbnQubm9kZTtcclxuICAgIGlmICh0aGlzLmN1cnJlbnROb2RlICE9IG51bGwgJiYgdGhpcy5jdXJyZW50Tm9kZS5pZCA9PSBub2RlLmlkKSB7XHJcbiAgICAgIC8v5aaC5p6c6YCJ5Lit55u45ZCM6IqC54K577yM55u05o6l6L+U5ZueXHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMuY3VycmVudE5vZGUgPSBub2RlO1xyXG4gIH1cclxufVxyXG4iXX0=