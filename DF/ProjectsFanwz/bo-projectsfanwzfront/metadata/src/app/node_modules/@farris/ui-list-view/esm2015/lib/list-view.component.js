/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ElementRef, TemplateRef, ContentChild, Output, EventEmitter, Input, Renderer2, ViewChild, HostBinding, ChangeDetectorRef } from '@angular/core';
import { ListViewHeaderTemplateDirective, ListViewTemplateDirective, ListViewFooterTemplateDirective, ListViewEmptyTemplateDirective, } from './template.directive';
import { PaginationControlsComponent } from '@farris/ui-pagination';
export class ListViewComponent {
    /**
     * @param {?} el
     * @param {?} renderer
     * @param {?} cdr
     */
    constructor(el, renderer, cdr) {
        this.el = el;
        this.renderer = renderer;
        this.cdr = cdr;
        // @Input() height:number;
        /**
         * 列表数据
         */
        this.data = [];
        /**
         * 数据为空是否展示默认
         */
        this.showEmpty = true;
        /**
         * 是否自定义空数据模板
         */
        this.emptyTemplate = false;
        /**
         * 是否支持多选 默认为false
         */
        this.multipleSelect = false;
        /**
         * 是否支持分页 默认false
         */
        this.supportPaging = false;
        // 默认分页
        this.pagerOnServer = true;
        this.pageSize = 10;
        this.pageIndex = 1;
        /**
         * 启用跨页多选
         */
        this.enableMorePageSelect = false;
        this.showSelectedList = false;
        this.selectedItemFormat = null;
        // 是否平铺
        this.fill = false;
        // 是否横向排列
        this.cardLayout = false;
        /**
         * 勾选值
         */
        this.checkValues = [];
        this.checkValuesChange = new EventEmitter();
        this.checkItems = [];
        this.checkItemsChange = new EventEmitter();
        // @Input() borderBottom:boolean = true;
        this._pageList = [10, 20, 30, 50];
        this.total = 0;
        /**
         * 作为唯一标识的数据key值 如果没传 唯一标识为index值
         */
        this.listidName = 'id';
        /**
         * 点击某一行后
         */
        this.listClick = new EventEmitter();
        /**
         * 多选框 选中状态变化
         */
        this.checkChange = new EventEmitter();
        // 分页事件
        this.pageChanged = new EventEmitter();
        this.pageSizeChanged = new EventEmitter();
        /**
         * 当前展示列表数据
         */
        this.currentData = [];
        /**
         * 选中的列表数组
         */
        this.selectDataList = [];
        /**
         * 跨页多选记录
         */
        this.selectDataListWithOtherPager = [];
        this.maxSize = 7;
        this.directionLinks = true;
        this.autoHide = false;
        this.responsive = true;
        this.paginationOptions = {
            id: 'Farris-listView-Pagination',
            itemsPerPage: this.pageSize,
            currentPage: this.pageIndex,
            pageList: this.pageList,
            totalItems: this.total
        };
        this.labels = {
            previousLabel: ' ',
            nextLabel: ' ',
            screenReaderPaginationLabel: 'Pagination',
            screenReaderPageLabel: 'page',
            screenReaderCurrentLabel: `You're on page`
        };
        this.mouseInSelectedList = false;
        this.openSelectedList = false;
        this.differenceBy = (/**
         * @param {?} a
         * @param {?} b
         * @param {?} fn
         * @return {?}
         */
        (a, b, fn) => {
            /** @type {?} */
            const s = new Set(b.map(fn));
            return a.map(fn).filter((/**
             * @param {?} el
             * @return {?}
             */
            el => !s.has(el)));
        });
        this.sameBy = (/**
         * @param {?} a
         * @param {?} b
         * @param {?} fn
         * @return {?}
         */
        (a, b, fn) => {
            /** @type {?} */
            const s = new Set(b.map(fn));
            return a.map(fn).filter((/**
             * @param {?} el
             * @return {?}
             */
            el => s.has(el)));
        });
    }
    /**
     * @return {?}
     */
    get activeIndex() {
        return this._activeIndex;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set activeIndex(val) {
        this._activeIndex = val;
        this.dataInit();
    }
    /**
     * @return {?}
     */
    get pageList() {
        return this._pageList;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set pageList(val) {
        this._pageList = val;
        if (this.pager) {
            this.pager.setPageList(val);
        }
    }
    /**
     * @return {?}
     */
    get listviewFill() { return this.fill; }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.currentData = this.data;
        this.dataInit();
        this.paginationOptions = {
            id: 'Farris-listView-Pagination',
            itemsPerPage: this.pageSize,
            currentPage: this.pageIndex,
            pageList: this.pageList,
            totalItems: this.total,
            remote: this.pagerOnServer
        };
        if (this.id) {
            this.paginationOptions.id = this.paginationOptions.id + this.id;
        }
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes.data && !changes.data.isFirstChange()) {
            this.currentData = this.data;
            this.dataInit();
        }
        if (changes['total'] && this.total && this.paginationOptions) {
            this.paginationOptions['totalItems'] = this.total;
        }
        if (changes['pageIndex'] && this.pageIndex && this.paginationOptions) {
            this.paginationOptions['currentPage'] = this.pageIndex;
        }
        if (changes && changes.checkValues !== undefined && !changes.checkValues.isFirstChange()) {
            /** @type {?} */
            const change = this.differenceBy(changes.checkValues.currentValue || [], changes.checkValues.previousValue || [], (/**
             * @param {?} v
             * @return {?}
             */
            v => {
                return v;
            }));
            if (change) {
                if (!this.enableMorePageSelect) {
                    this.checkRows(this.checkValues);
                }
            }
        }
        if (changes.checkItems && !changes.checkItems.isFirstChange()) {
            this.selectDataListWithOtherPager = [...this.checkItems];
            /** @type {?} */
            const ids = this.checkItems.map((/**
             * @param {?} n
             * @return {?}
             */
            n => n[this.listidName]));
            this.checkedItems(ids, false);
        }
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
    }
    /**
     * @return {?}
     */
    ngAfterContentInit() {
    }
    /**
     * 默认搜索模板 点击搜索
     * @param {?} searchField
     * @return {?}
     */
    searchList(searchField) {
        if (searchField !== '' && this.data && this.data.length) {
            this.currentData = this.data.filter((/**
             * @param {?} list
             * @return {?}
             */
            (list) => {
                /** @type {?} */
                let result;
                /** @type {?} */
                const listValue = Object.values(list);
                for (let i = 0; i < listValue.length; i++) {
                    if (typeof listValue[i] == 'string') {
                        if (listValue[i].toString().includes(searchField)) {
                            result = listValue[i].toString().includes(searchField);
                            break;
                        }
                    }
                }
                return result;
            }));
        }
        else {
            this.currentData = this.data;
        }
        return { listdata: this.currentData, searchValue: searchField, length: this.currentData.length };
    }
    /**
     * 点击某一列事件
     * @param {?} event
     * @param {?} listItem
     * @param {?} index
     * @param {?=} checkChangeEvent
     * @return {?}
     */
    listSelect(event, listItem, index, checkChangeEvent = false) {
        if (listItem['unClick'] || listItem['selectDisable']) {
            return;
        }
        else {
            this.checkChange.emit({ listdata: listItem, index });
            if (this.multipleSelect) {
                if (listItem['checked']) {
                    // 支持多选 删除该选中行
                    /** @type {?} */
                    const selectItemIndex = this.selectDataList.findIndex((/**
                     * @param {?} item
                     * @param {?} i
                     * @return {?}
                     */
                    (item, i) => {
                        return this.getKey(item, i) === this.getKey(listItem, index);
                    }));
                    this.selectDataList.splice(selectItemIndex, 1);
                    this.updateDataListForMorePager('remove', listItem);
                }
                else {
                    // 支持多选 插入该选中行
                    /** @type {?} */
                    const result = this.selectDataList.find((/**
                     * @param {?} value
                     * @param {?} i
                     * @return {?}
                     */
                    (value, i) => {
                        return this.getKey(value, i) === this.getKey(listItem, index);
                    }));
                    if (!result) {
                        this.selectDataList.unshift(listItem);
                        this.updateDataListForMorePager('append', listItem);
                    }
                }
                listItem['checked'] = !listItem['checked'];
            }
            else {
                // 不支持多选 替换当前选中行
                this.selectDataList = [];
                this.selectDataList.push(listItem);
            }
            if (!checkChangeEvent) {
                this.clickItem = listItem;
            }
            this.listClick.emit({ data: this.selectDataList, index, checkChangeEvent });
        }
        if (this.multipleSelect) {
            /** @type {?} */
            let ids = this.data.filter((/**
             * @param {?} item
             * @return {?}
             */
            item => !!item.checked)).map((/**
             * @param {?} item
             * @return {?}
             */
            item => item[this.listidName]));
            if (this.enableMorePageSelect) {
                ids = this.selectDataListWithOtherPager.map((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => item[this.listidName]));
            }
            this.onCheckValuesChange(ids);
        }
    }
    /**
     * 获得每一行list 唯一标识
     * @param {?} list
     * @param {?} index
     * @return {?}
     */
    getKey(list, index) {
        if (this.listidName && list.hasOwnProperty(this.listidName)) {
            return list[this.listidName];
        }
        else {
            return index;
        }
    }
    /**
     * checkbox状态变化
     * @param {?} event
     * @param {?} changeData
     * @param {?} i
     * @return {?}
     */
    getSelect(event, changeData, i) {
        /** @type {?} */
        const state = event.checked;
        this.listSelect(state, changeData, i, true);
    }
    /**
     * 排序事件
     * @param {?} sortkeyName
     * @param {?=} sortType
     * @return {?}
     */
    sort(sortkeyName, sortType = 'asc') {
        this.currentData.sort(this.compare(sortkeyName, sortType));
        return { sortResult: { listdata: this.currentData, sortkeyName, sortType } };
    }
    /**
     * @param {?} primaryValue
     * @return {?}
     */
    selectRow(primaryValue) {
        if (this.currentData && this.currentData.length > 0) {
            /** @type {?} */
            const row = this.currentData.find((/**
             * @param {?} item
             * @return {?}
             */
            item => item[this.listidName] === primaryValue));
            if (row) {
                this.clickItem = row;
                this.cdr.markForCheck();
            }
        }
    }
    /**
     * @private
     * @param {?} KeyName
     * @param {?} type
     * @return {?}
     */
    compare(KeyName, type) {
        if (type === 'desc') {
            return (/**
             * @param {?} obj1
             * @param {?} obj2
             * @return {?}
             */
            (obj1, obj2) => {
                /** @type {?} */
                const val1 = obj1[KeyName];
                /** @type {?} */
                const val2 = obj2[KeyName];
                if (val2 < val1) {
                    return 1;
                }
                else if (val2 > val1) {
                    return -1;
                }
                else {
                    return 0;
                }
            });
        }
        if (type === 'asc') {
            return (/**
             * @param {?} obj1
             * @param {?} obj2
             * @return {?}
             */
            (obj1, obj2) => {
                /** @type {?} */
                const val1 = obj1[KeyName];
                /** @type {?} */
                const val2 = obj2[KeyName];
                if (val2 > val1) {
                    return 1;
                }
                else if (val2 < val1) {
                    return -1;
                }
                else {
                    return 0;
                }
            });
        }
    }
    /**
     * @param {?} item
     * @return {?}
     */
    getItemActive(item) {
        // 不管是否开启多选，当前行只有一行
        if (this.listidName && this.clickItem) {
            return item[this.listidName] === this.clickItem[this.listidName];
        }
        else {
            return false;
        }
    }
    /**
     * @param {?} page
     * @return {?}
     */
    onPageChange(page) {
        if (this.pageIndex !== page.pageIndex) {
            this.pageIndex = page.pageIndex;
            this.paginationOptions.currentPage = page.pageIndex;
            this.pageChanged.emit({ pageInfo: page });
        }
    }
    /**
     * @param {?} pageSize
     * @return {?}
     */
    onPageSizeChange(pageSize) {
        // console.log(this.pageSize !== pageSize && this.total);
        if (this.pageSize !== pageSize && this.total) {
            this.paginationOptions.itemsPerPage = pageSize;
            this.pageSize = pageSize;
            /** @type {?} */
            const total = this.total;
            /** @type {?} */
            let pageLength = Math.floor(total / pageSize);
            if (total % pageSize > 0) {
                pageLength += 1;
            }
            if (pageLength && this.pageIndex > pageLength) {
                this.pageIndex = pageLength;
                this.paginationOptions.currentPage = this.pageIndex;
            }
            this.pageSizeChanged.emit({ pageInfo: { pageIndex: this.pageIndex, pageSize } });
        }
    }
    /**
     * @return {?}
     */
    getCurrentData() {
        return this.currentData;
    }
    /**
     * @return {?}
     */
    getSelectData() {
        return this.selectDataList;
    }
    /**
     * 支持重新设置listview数据
     * @param {?} listviewData
     * @return {?}
     */
    setData(listviewData) {
        this.currentData = listviewData;
        this.data = listviewData;
        this.dataInit();
    }
    /**
     * @return {?}
     */
    dataInit() {
        if (this.data && this.data.length) {
            this.selectDataList = this.data.filter((/**
             * @param {?} list
             * @return {?}
             */
            (list) => {
                return list['checked'];
            }));
            if (this.activeIndex >= 0 && this.activeIndex <= (this.data.length - 1)) {
                /** @type {?} */
                const dataItem = this.data[this.activeIndex];
                if (dataItem) {
                    this.clickItem = dataItem;
                    this.selectDataList.push(this.clickItem);
                }
            }
            else if (this.activeIndex < 0) {
                return;
            }
            else {
                if (!this.selectDataList.length && !this.multipleSelect) {
                    this.selectDataList.push(this.data[0]);
                }
                this.clickItem = this.data[0];
            }
        }
        this.updateDataListForMorePager();
        if (this.cdr) {
            this.cdr.detectChanges();
        }
    }
    /**
     * @private
     * @param {?=} active
     * @param {?=} listItem
     * @param {?=} emit
     * @return {?}
     */
    updateDataListForMorePager(active = '', listItem, emit = true) {
        if (this.multipleSelect && this.enableMorePageSelect) {
            if (active === 'remove' && listItem) {
                if (!Array.isArray(listItem)) {
                    this.selectDataListWithOtherPager =
                        this.selectDataListWithOtherPager.filter((/**
                         * @param {?} n
                         * @return {?}
                         */
                        n => {
                            if (typeof listItem === 'object') {
                                return n[this.listidName] != listItem[this.listidName];
                            }
                            else {
                                return n[this.listidName] != listItem;
                            }
                        }));
                }
                else {
                    this.selectDataListWithOtherPager =
                        this.selectDataListWithOtherPager.filter((/**
                         * @param {?} n
                         * @return {?}
                         */
                        n => {
                            return listItem.indexOf((/**
                             * @param {?} a
                             * @return {?}
                             */
                            a => a[this.listidName] === n[this.listidName])) === -1;
                        }));
                }
                if (emit) {
                    this.checkItemsChange.emit({ items: [...this.selectDataListWithOtherPager], instance: this });
                }
            }
            else if (active === 'append') {
                if (!Array.isArray(listItem)) {
                    this.selectDataListWithOtherPager = [...this.selectDataListWithOtherPager, listItem];
                }
                else {
                    this.selectDataListWithOtherPager = [...this.selectDataListWithOtherPager, ...listItem];
                }
                if (emit) {
                    this.checkItemsChange.emit({ items: [...this.selectDataListWithOtherPager], instance: this });
                }
            }
            else {
                if (!this.selectDataListWithOtherPager.length) {
                    this.selectDataListWithOtherPager = [...this.selectDataList];
                }
                else {
                    /** @type {?} */
                    const newCheckeds = this.sameBy(this.currentData, this.selectDataListWithOtherPager, (/**
                     * @param {?} v
                     * @return {?}
                     */
                    (v) => v[this.listidName]));
                    if (newCheckeds && newCheckeds.length) {
                        this.data.forEach((/**
                         * @param {?} item
                         * @return {?}
                         */
                        item => {
                            item.checked = newCheckeds.includes(item[this.listidName]);
                        }));
                    }
                }
            }
        }
    }
    /**
     * 全选
     * @return {?}
     */
    listCheckAll() {
        if (this.multipleSelect) {
            this.currentData.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                item.checked = true;
            }));
            this.selectDataList = this.currentData.filter((/**
             * @param {?} list
             * @return {?}
             */
            (list) => {
                return list['checked'];
            }));
            this.updateDataListForMorePager('append', this.currentData);
            this.cdr.markForCheck();
        }
    }
    /**
     * 取消全选
     * @return {?}
     */
    listCheckAllCancel() {
        if (this.multipleSelect) {
            this.currentData.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                item.checked = false;
            }));
            this.selectDataList = [];
            this.updateDataListForMorePager('remove', this.currentData);
            this.cdr.markForCheck();
        }
    }
    /**
     * 勾选行
     * @param {?} ids ids
     * @return {?}
     */
    checkRows(ids) {
        if (this.multipleSelect) {
            if (!ids || ids.length < 1) {
                this.listCheckAllCancel();
                return;
            }
            this.data.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                if (ids.includes(item[this.listidName])) {
                    item.checked = true;
                }
                else {
                    item.checked = false;
                }
            }));
            // this.onCheckValuesChange(ids);
            this.cdr.markForCheck();
        }
    }
    /**
     * @private
     * @param {?} ids
     * @return {?}
     */
    onCheckValuesChange(ids) {
        this.checkValuesChange.emit(ids);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onMouseEnter($event) {
        $event.stopPropagation();
        this.mouseInSelectedList = true;
        if (this.selectDataListWithOtherPager && this.selectDataListWithOtherPager.length) {
            this.openSelectedList = !this.openSelectedList;
        }
        else {
            this.openSelectedList = false;
        }
    }
    /**
     * @return {?}
     */
    closeSelectedList() {
        this.openSelectedList = false;
        this.mouseInSelectedList = false;
        if (!this.cdr['destroyed']) {
            this.cdr.detectChanges();
        }
    }
    /**
     * @param {?} id
     * @return {?}
     */
    onDelSelectedItem(id) {
        this.currentData.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            if (item[this.listidName] == id) {
                item.checked = false;
            }
        }));
        this.selectDataList = this.selectDataList.filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n[this.listidName] != id));
        this.updateDataListForMorePager('remove', id);
        this.updateCheckedValues();
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onClearSelected($event) {
        // this.clearSelectedItem.emit();
        this.closeSelectedList();
        this.listCheckAllCancel();
        this.selectDataListWithOtherPager = [];
        this.checkValues = [];
        this.onCheckValuesChange([]);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onSelectListPanelClose($event) {
        this.closeSelectedList();
    }
    /**
     * @private
     * @param {?=} emit
     * @return {?}
     */
    updateCheckedValues(emit = true) {
        if (this.multipleSelect) {
            if (!this.enableMorePageSelect) {
                this.checkValues = this.selectDataList.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => n[this.listidName]));
            }
            else {
                this.checkValues = this.selectDataListWithOtherPager.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => n[this.listidName]));
            }
            if (emit) {
                this.onCheckValuesChange(this.checkValues);
                this.checkItemsChange.emit({ items: this.selectDataListWithOtherPager, instance: this });
            }
        }
    }
    /**
     * @param {?=} clearAll
     * @param {?=} emit
     * @return {?}
     */
    clearCheckeds(clearAll = true, emit = true) {
        if (this.multipleSelect) {
            this.currentData.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                item.checked = false;
            }));
            this.selectDataList = [];
            if (clearAll) {
                this.selectDataListWithOtherPager = [];
            }
            else {
                this.updateDataListForMorePager('remove', this.currentData);
            }
            if (emit) {
                this.updateCheckedValues(emit);
            }
            this.cdr.markForCheck();
        }
    }
    /**
     * @private
     * @param {?} ids
     * @param {?} checked
     * @param {?} emit
     * @return {?}
     */
    _setItemsCheckedStatus(ids, checked, emit) {
        if (ids && ids.length) {
            /** @type {?} */
            const action = checked ? 'append' : 'remove';
            ids.forEach((/**
             * @param {?} i
             * @return {?}
             */
            i => {
                /** @type {?} */
                let id = i;
                if (typeof i === 'object') {
                    id = i[this.listidName];
                }
                /** @type {?} */
                const item = this.data.find((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => n[this.listidName] === id));
                if (item) {
                    item.checked = checked;
                }
                if (checked) {
                    this.updateDataListForMorePager('append', i, false);
                }
                else {
                    this.updateDataListForMorePager('remove', id, false);
                }
            }));
            this.updateCheckedValues(emit);
            this.cdr.markForCheck();
        }
    }
    /**
     * @param {?} ids
     * @param {?=} emit
     * @return {?}
     */
    unCheckItems(ids, emit = false) {
        this._setItemsCheckedStatus(ids, false, emit);
    }
    /**
     * @param {?} ids
     * @param {?=} emit
     * @return {?}
     */
    checkedItems(ids, emit = false) {
        this._setItemsCheckedStatus(ids, true, emit);
    }
}
ListViewComponent.decorators = [
    { type: Component, args: [{
                selector: 'farris-list-view',
                template: "<div class=\"f-list-view\" [ngClass]=\"{'f-list-view-multiple': multipleSelect}\">\r\n    <div class=\"f-list-view-header\" *ngIf=\"headerTemplate\">\r\n        <ng-container [ngTemplateOutlet]=\"headerTemplate\"></ng-container>\r\n    </div>\r\n    <div class=\"f-list-view-content\">\r\n        <ul class=\"f-list-view-group\" [ngClass]=\"{'d-flex flex-wrap': cardLayout}\">\r\n            <ng-container *ngIf=\"currentData&&currentData.length;else emptyData\">\r\n                <li class=\"f-list-view-group-item {{listClassName}}\"\r\n                    *ngFor=\"let list of (supportPaging ? (currentData | paginate: paginationOptions) : currentData); let i = index;let first = first; let last = last\"\r\n                    [id]=\"getKey(list,i)\" (click)=\"listSelect($event,list,i)\"\r\n                    [ngClass]=\"{'f-un-click': list['unClick'],'f-un-select':list['selectDisable'],'f-listview-active':getItemActive(list)}\">\r\n                    <div class=\"f-list-select\" *ngIf=\"multipleSelect\" (click)=\"$event.stopPropagation()\">\r\n                        <list-view-checkout [id]=\"'list-'+getKey(list,i)\"\r\n                            [disabled]=\"list['selectDisable']||list['unClick']\" [checked]=\"list['checked']\"\r\n                            (checkedChange)=\"getSelect($event,list,i)\"></list-view-checkout>\r\n                    </div>\r\n                    <div class=\"f-list-content\">\r\n                        <ng-container [ngTemplateOutlet]=\"listTemplate\"\r\n                            [ngTemplateOutletContext]=\"{ item: list , index:i, selectedItem: clickItem, first:first,last:last }\">\r\n                        </ng-container>\r\n                    </div>\r\n                </li>\r\n            </ng-container>\r\n\r\n            <ng-template #emptyData>\r\n                <!-- \u7A7A\u6570\u636E\u9ED8\u8BA4\u6A21\u677F -->\r\n                <div class=\"f-list-view-emptydata\" *ngIf=\"showEmpty&&!emptyTemplate;else customEmpty\">\r\n                    <p class=\"f-empty-title\">{{ 'listview.emptyMessage' | locale }}</p>\r\n                </div>\r\n                <!-- \u81EA\u5B9A\u4E49\u7A7A\u6570\u636E\u6A21\u677F -->\r\n                <ng-template #customEmpty>\r\n                    <ng-container [ngTemplateOutlet]=\"emptyDataTemplate\"></ng-container>\r\n                </ng-template>\r\n\r\n            </ng-template>\r\n        </ul>\r\n    </div>\r\n    <div class=\"f-list-view-footer\" *ngIf=\"footerTemplate || supportPaging\">\r\n        <ng-container [ngTemplateOutlet]=\"footerTemplate\">\r\n            <div class=\"f-paging-wrapper\" *ngIf=\"supportPaging&&currentData&&currentData.length\">\r\n                <pagination-controls #pager [id]=\"paginationOptions.id\" [maxSize]=\"maxSize\"\r\n                    [directionLinks]=\"directionLinks\" [autoHide]=\"autoHide\" [responsive]=\"responsive\"\r\n                    [previousLabel]=\"labels.previousLabel\" [nextLabel]=\"labels.nextLabel\"\r\n                    [screenReaderPaginationLabel]=\"labels.screenReaderPaginationLabel\"\r\n                    [screenReaderPageLabel]=\"labels.screenReaderPageLabel\"\r\n                    [screenReaderCurrentLabel]=\"labels.screenReaderCurrentLabel\" (pageChange)=\"onPageChange($event)\"\r\n                    (pageSizeChange)=\"onPageSizeChange($event)\" [showSelectedList]=\"showSelectedList && enableMorePageSelect\">\r\n\r\n                    <div class=\"flex-fill\" >\r\n                        <div>\r\n                            <span class=\"badge badge-pill badge-light\" *ngIf=\"showSelectedList\"\r\n                                style=\"cursor:pointer\" [attr.title]=\"'datagrid.selectionData.tooltip' | locale\"\r\n                                [class.badge-primary]=\"mouseInSelectedList\"\r\n                                [innerHTML]=\"'datagrid.selectionData.currentLenth' | locale | replaceX: selectDataListWithOtherPager.length\"\r\n                                (click)=\"onMouseEnter($event)\">\r\n                            </span>\r\n                            <pagination-selected-list *ngIf=\"openSelectedList\"\r\n                                [data]=\"selectDataListWithOtherPager | formatItems: selectedItemFormat\"\r\n                                (close)=\"onSelectListPanelClose($event)\"\r\n                                (remove)=\"onDelSelectedItem($event)\"\r\n                                (clear)=\"onClearSelected($event)\"\r\n                            ></pagination-selected-list>\r\n                        </div>\r\n                    </div>\r\n\r\n                </pagination-controls>\r\n            </div>\r\n        </ng-container>\r\n    </div>\r\n</div>",
                styles: [":host{height:100%}:host.f-listview-fill{-webkit-box-flex:1;flex-grow:1;flex-shrink:1;flex-basis:0;overflow:hidden}:host.f-listview-fill .f-list-view{height:100%}:host.f-listview-fill .f-list-view .f-list-view-header{flex-shrink:0}:host.f-listview-fill .f-list-view .f-list-view-footer{flex-shrink:0}:host.f-listview-fill .f-list-view .f-list-view-content{overflow-y:auto;-webkit-box-flex:1;flex-grow:1;flex-shrink:1;flex-basis:0}:host .f-list-view{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}:host .f-list-view .f-paging-wrapper{padding:14px 0}:host .f-list-view-group-item{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}:host .f-list-view-group-item.f-none-border{border-bottom:0}:host .f-list-view-group-item .f-list-content{-webkit-box-flex:1;flex:1 1 auto;width:100%}:host .f-list-select{padding:0 14px}:host .f-list-view-emptydata .f-empty-title{font-size:14px;line-height:22px;color:#999;padding:20px 0;text-align:center}"]
            }] }
];
/** @nocollapse */
ListViewComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: Renderer2 },
    { type: ChangeDetectorRef }
];
ListViewComponent.propDecorators = {
    headerTemplate: [{ type: ContentChild, args: [ListViewHeaderTemplateDirective, { read: TemplateRef },] }],
    listTemplate: [{ type: ContentChild, args: [ListViewTemplateDirective, { read: TemplateRef },] }],
    footerTemplate: [{ type: ContentChild, args: [ListViewFooterTemplateDirective, { read: TemplateRef },] }],
    emptyDataTemplate: [{ type: ContentChild, args: [ListViewEmptyTemplateDirective, { read: TemplateRef },] }],
    listGroup: [{ type: ViewChild, args: ['listGroup',] }],
    pager: [{ type: ViewChild, args: ['pager',] }],
    data: [{ type: Input }],
    id: [{ type: Input }],
    showEmpty: [{ type: Input }],
    emptyTemplate: [{ type: Input }],
    multipleSelect: [{ type: Input }],
    supportPaging: [{ type: Input }],
    pagerOnServer: [{ type: Input }],
    pageSize: [{ type: Input }],
    pageIndex: [{ type: Input }],
    enableMorePageSelect: [{ type: Input }],
    showSelectedList: [{ type: Input }],
    selectedItemFormat: [{ type: Input }],
    fill: [{ type: Input }],
    cardLayout: [{ type: Input }],
    activeIndex: [{ type: Input }],
    listClassName: [{ type: Input }],
    checkValues: [{ type: Input }],
    checkValuesChange: [{ type: Output }],
    checkItems: [{ type: Input }],
    checkItemsChange: [{ type: Input }],
    pageList: [{ type: Input }],
    total: [{ type: Input }],
    listidName: [{ type: Input }],
    listviewFill: [{ type: HostBinding, args: ['class.f-listview-fill',] }],
    listClick: [{ type: Output }],
    checkChange: [{ type: Output }],
    pageChanged: [{ type: Output }],
    pageSizeChanged: [{ type: Output }]
};
if (false) {
    /** @type {?} */
    ListViewComponent.prototype.headerTemplate;
    /** @type {?} */
    ListViewComponent.prototype.listTemplate;
    /** @type {?} */
    ListViewComponent.prototype.footerTemplate;
    /** @type {?} */
    ListViewComponent.prototype.emptyDataTemplate;
    /** @type {?} */
    ListViewComponent.prototype.listGroup;
    /** @type {?} */
    ListViewComponent.prototype.pager;
    /**
     * 列表数据
     * @type {?}
     */
    ListViewComponent.prototype.data;
    /** @type {?} */
    ListViewComponent.prototype.id;
    /**
     * 数据为空是否展示默认
     * @type {?}
     */
    ListViewComponent.prototype.showEmpty;
    /**
     * 是否自定义空数据模板
     * @type {?}
     */
    ListViewComponent.prototype.emptyTemplate;
    /**
     * 是否支持多选 默认为false
     * @type {?}
     */
    ListViewComponent.prototype.multipleSelect;
    /**
     * 是否支持分页 默认false
     * @type {?}
     */
    ListViewComponent.prototype.supportPaging;
    /** @type {?} */
    ListViewComponent.prototype.pagerOnServer;
    /** @type {?} */
    ListViewComponent.prototype.pageSize;
    /** @type {?} */
    ListViewComponent.prototype.pageIndex;
    /**
     * 启用跨页多选
     * @type {?}
     */
    ListViewComponent.prototype.enableMorePageSelect;
    /** @type {?} */
    ListViewComponent.prototype.showSelectedList;
    /** @type {?} */
    ListViewComponent.prototype.selectedItemFormat;
    /** @type {?} */
    ListViewComponent.prototype.fill;
    /** @type {?} */
    ListViewComponent.prototype.cardLayout;
    /** @type {?} */
    ListViewComponent.prototype._activeIndex;
    /** @type {?} */
    ListViewComponent.prototype.listClassName;
    /**
     * 勾选值
     * @type {?}
     */
    ListViewComponent.prototype.checkValues;
    /** @type {?} */
    ListViewComponent.prototype.checkValuesChange;
    /** @type {?} */
    ListViewComponent.prototype.checkItems;
    /** @type {?} */
    ListViewComponent.prototype.checkItemsChange;
    /**
     * @type {?}
     * @private
     */
    ListViewComponent.prototype._pageList;
    /** @type {?} */
    ListViewComponent.prototype.total;
    /**
     * 作为唯一标识的数据key值 如果没传 唯一标识为index值
     * @type {?}
     */
    ListViewComponent.prototype.listidName;
    /**
     * 点击某一行后
     * @type {?}
     */
    ListViewComponent.prototype.listClick;
    /**
     * 多选框 选中状态变化
     * @type {?}
     */
    ListViewComponent.prototype.checkChange;
    /** @type {?} */
    ListViewComponent.prototype.pageChanged;
    /** @type {?} */
    ListViewComponent.prototype.pageSizeChanged;
    /**
     * 当前展示列表数据
     * @type {?}
     */
    ListViewComponent.prototype.currentData;
    /**
     * 选中的列表数组
     * @type {?}
     */
    ListViewComponent.prototype.selectDataList;
    /**
     * 跨页多选记录
     * @type {?}
     */
    ListViewComponent.prototype.selectDataListWithOtherPager;
    /** @type {?} */
    ListViewComponent.prototype.clickItem;
    /** @type {?} */
    ListViewComponent.prototype.maxSize;
    /** @type {?} */
    ListViewComponent.prototype.directionLinks;
    /** @type {?} */
    ListViewComponent.prototype.autoHide;
    /** @type {?} */
    ListViewComponent.prototype.responsive;
    /** @type {?} */
    ListViewComponent.prototype.paginationOptions;
    /** @type {?} */
    ListViewComponent.prototype.labels;
    /** @type {?} */
    ListViewComponent.prototype.mouseInSelectedList;
    /** @type {?} */
    ListViewComponent.prototype.openSelectedList;
    /**
     * @type {?}
     * @private
     */
    ListViewComponent.prototype.differenceBy;
    /**
     * @type {?}
     * @private
     */
    ListViewComponent.prototype.sameBy;
    /**
     * @type {?}
     * @private
     */
    ListViewComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    ListViewComponent.prototype.renderer;
    /**
     * @type {?}
     * @private
     */
    ListViewComponent.prototype.cdr;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGlzdC12aWV3LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktbGlzdC12aWV3LyIsInNvdXJjZXMiOlsibGliL2xpc3Qtdmlldy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFDSCxTQUFTLEVBQTRCLFVBQVUsRUFBRSxXQUFXLEVBQUUsWUFBWSxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQzlHLFdBQVcsRUFBNEIsaUJBQWlCLEVBQzFFLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFDSCwrQkFBK0IsRUFDL0IseUJBQXlCLEVBQ3pCLCtCQUErQixFQUMvQiw4QkFBOEIsR0FDakMsTUFBTSxzQkFBc0IsQ0FBQztBQUU5QixPQUFPLEVBQXNCLDJCQUEyQixFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFReEYsTUFBTSxPQUFPLGlCQUFpQjs7Ozs7O0lBNEgxQixZQUFvQixFQUFjLEVBQVUsUUFBbUIsRUFBVSxHQUFzQjtRQUEzRSxPQUFFLEdBQUYsRUFBRSxDQUFZO1FBQVUsYUFBUSxHQUFSLFFBQVEsQ0FBVztRQUFVLFFBQUcsR0FBSCxHQUFHLENBQW1COzs7OztRQTlHdEYsU0FBSSxHQUFHLEVBQUUsQ0FBQzs7OztRQUtWLGNBQVMsR0FBRyxJQUFJLENBQUM7Ozs7UUFFakIsa0JBQWEsR0FBRyxLQUFLLENBQUM7Ozs7UUFFdEIsbUJBQWMsR0FBRyxLQUFLLENBQUM7Ozs7UUFHdkIsa0JBQWEsR0FBRyxLQUFLLENBQUM7O1FBR3RCLGtCQUFhLEdBQUcsSUFBSSxDQUFDO1FBQ3JCLGFBQVEsR0FBRyxFQUFFLENBQUM7UUFDZCxjQUFTLEdBQUcsQ0FBQyxDQUFDOzs7O1FBRWQseUJBQW9CLEdBQUcsS0FBSyxDQUFDO1FBQzdCLHFCQUFnQixHQUFHLEtBQUssQ0FBQztRQUN6Qix1QkFBa0IsR0FBMEIsSUFBSSxDQUFDOztRQUdqRCxTQUFJLEdBQUcsS0FBSyxDQUFDOztRQUViLGVBQVUsR0FBRyxLQUFLLENBQUM7Ozs7UUFlbkIsZ0JBQVcsR0FBVSxFQUFFLENBQUM7UUFDdkIsc0JBQWlCLEdBQXdCLElBQUksWUFBWSxFQUFTLENBQUM7UUFFcEUsZUFBVSxHQUFHLEVBQUUsQ0FBQztRQUNoQixxQkFBZ0IsR0FBZ0QsSUFBSSxZQUFZLEVBQThCLENBQUM7O1FBSWhILGNBQVMsR0FBRyxDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBVzVCLFVBQUssR0FBRyxDQUFDLENBQUM7Ozs7UUFHVixlQUFVLEdBQUcsSUFBSSxDQUFDOzs7O1FBTWpCLGNBQVMsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDOzs7O1FBRS9CLGdCQUFXLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQzs7UUFHakMsZ0JBQVcsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQ2pDLG9CQUFlLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQzs7OztRQUcvQyxnQkFBVyxHQUFHLEVBQUUsQ0FBQzs7OztRQUdqQixtQkFBYyxHQUFHLEVBQUUsQ0FBQzs7OztRQUVwQixpQ0FBNEIsR0FBRyxFQUFFLENBQUM7UUFLM0IsWUFBTyxHQUFHLENBQUMsQ0FBQztRQUNaLG1CQUFjLEdBQUcsSUFBSSxDQUFDO1FBQ3RCLGFBQVEsR0FBRyxLQUFLLENBQUM7UUFDakIsZUFBVSxHQUFHLElBQUksQ0FBQztRQUNsQixzQkFBaUIsR0FBdUI7WUFDM0MsRUFBRSxFQUFFLDRCQUE0QjtZQUNoQyxZQUFZLEVBQUUsSUFBSSxDQUFDLFFBQVE7WUFDM0IsV0FBVyxFQUFFLElBQUksQ0FBQyxTQUFTO1lBQzNCLFFBQVEsRUFBRSxJQUFJLENBQUMsUUFBUTtZQUN2QixVQUFVLEVBQUUsSUFBSSxDQUFDLEtBQUs7U0FDekIsQ0FBQztRQUVLLFdBQU0sR0FBUTtZQUNqQixhQUFhLEVBQUUsR0FBRztZQUNsQixTQUFTLEVBQUUsR0FBRztZQUNkLDJCQUEyQixFQUFFLFlBQVk7WUFDekMscUJBQXFCLEVBQUUsTUFBTTtZQUM3Qix3QkFBd0IsRUFBRSxnQkFBZ0I7U0FDN0MsQ0FBQztRQUVGLHdCQUFtQixHQUFHLEtBQUssQ0FBQztRQUM1QixxQkFBZ0IsR0FBRyxLQUFLLENBQUM7UUErV2pCLGlCQUFZOzs7Ozs7UUFBRyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUU7O2tCQUMxQixDQUFDLEdBQUcsSUFBSSxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUM1QixPQUFPLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUMsTUFBTTs7OztZQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFDLENBQUM7UUFDOUMsQ0FBQyxFQUFBO1FBRU8sV0FBTTs7Ozs7O1FBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFOztrQkFDcEIsQ0FBQyxHQUFHLElBQUksR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDNUIsT0FBTyxDQUFDLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDLE1BQU07Ozs7WUFBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUMsQ0FBQztRQUM3QyxDQUFDLEVBQUE7SUF0WGtHLENBQUM7Ozs7SUFqRnBHLElBQUksV0FBVztRQUNYLE9BQU8sSUFBSSxDQUFDLFlBQVksQ0FBQztJQUM3QixDQUFDOzs7OztJQUNELElBQWEsV0FBVyxDQUFDLEdBQUc7UUFDeEIsSUFBSSxDQUFDLFlBQVksR0FBRyxHQUFHLENBQUM7UUFDeEIsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQ3BCLENBQUM7Ozs7SUFnQkQsSUFBSSxRQUFRO1FBQ1IsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDO0lBQzFCLENBQUM7Ozs7O0lBQ0QsSUFBYSxRQUFRLENBQUMsR0FBRztRQUNyQixJQUFJLENBQUMsU0FBUyxHQUFHLEdBQUcsQ0FBQztRQUNyQixJQUFJLElBQUksQ0FBQyxLQUFLLEVBQUU7WUFDWixJQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQztTQUMvQjtJQUNMLENBQUM7Ozs7SUFNRCxJQUEwQyxZQUFZLEtBQUssT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQzs7OztJQStDOUUsUUFBUTtRQUVKLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQztRQUM3QixJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDaEIsSUFBSSxDQUFDLGlCQUFpQixHQUFHO1lBQ3JCLEVBQUUsRUFBRSw0QkFBNEI7WUFDaEMsWUFBWSxFQUFFLElBQUksQ0FBQyxRQUFRO1lBQzNCLFdBQVcsRUFBRSxJQUFJLENBQUMsU0FBUztZQUMzQixRQUFRLEVBQUUsSUFBSSxDQUFDLFFBQVE7WUFDdkIsVUFBVSxFQUFFLElBQUksQ0FBQyxLQUFLO1lBQ3RCLE1BQU0sRUFBRSxJQUFJLENBQUMsYUFBYTtTQUM3QixDQUFDO1FBQ0YsSUFBSSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ1QsSUFBSSxDQUFDLGlCQUFpQixDQUFDLEVBQUUsR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUMsRUFBRSxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUM7U0FDbkU7SUFDTCxDQUFDOzs7OztJQUdELFdBQVcsQ0FBQyxPQUFzQjtRQUM5QixJQUFJLE9BQU8sQ0FBQyxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLGFBQWEsRUFBRSxFQUFFO1lBQy9DLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQztZQUM3QixJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7U0FDbkI7UUFDRCxJQUFJLE9BQU8sQ0FBQyxPQUFPLENBQUMsSUFBSSxJQUFJLENBQUMsS0FBSyxJQUFJLElBQUksQ0FBQyxpQkFBaUIsRUFBRTtZQUMxRCxJQUFJLENBQUMsaUJBQWlCLENBQUMsWUFBWSxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQztTQUNyRDtRQUNELElBQUksT0FBTyxDQUFDLFdBQVcsQ0FBQyxJQUFJLElBQUksQ0FBQyxTQUFTLElBQUksSUFBSSxDQUFDLGlCQUFpQixFQUFFO1lBQ2xFLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxhQUFhLENBQUMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDO1NBQzFEO1FBQ0QsSUFBSSxPQUFPLElBQUksT0FBTyxDQUFDLFdBQVcsS0FBSyxTQUFTLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLGFBQWEsRUFBRSxFQUFFOztrQkFDaEYsTUFBTSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxZQUFZLElBQUksRUFBRSxFQUFFLE9BQU8sQ0FBQyxXQUFXLENBQUMsYUFBYSxJQUFJLEVBQUU7Ozs7WUFBRSxDQUFDLENBQUMsRUFBRTtnQkFDbEgsT0FBTyxDQUFDLENBQUM7WUFDYixDQUFDLEVBQUM7WUFDRixJQUFJLE1BQU0sRUFBRTtnQkFDUixJQUFJLENBQUMsSUFBSSxDQUFDLG9CQUFvQixFQUFFO29CQUM1QixJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztpQkFDcEM7YUFDSjtTQUNKO1FBRUQsSUFBSSxPQUFPLENBQUMsVUFBVSxJQUFJLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxhQUFhLEVBQUUsRUFBRTtZQUMzRCxJQUFJLENBQUMsNEJBQTRCLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQzs7a0JBQ25ELEdBQUcsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUc7Ozs7WUFBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEVBQUM7WUFDeEQsSUFBSSxDQUFDLFlBQVksQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUM7U0FDakM7SUFDTCxDQUFDOzs7O0lBRUQsZUFBZTtJQUNmLENBQUM7Ozs7SUFDRCxrQkFBa0I7SUFFbEIsQ0FBQzs7Ozs7O0lBR0QsVUFBVSxDQUFDLFdBQVc7UUFDbEIsSUFBSSxXQUFXLEtBQUssRUFBRSxJQUFJLElBQUksQ0FBQyxJQUFJLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUU7WUFDckQsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU07Ozs7WUFBQyxDQUFDLElBQUksRUFBRSxFQUFFOztvQkFDckMsTUFBTTs7c0JBQ0osU0FBUyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDO2dCQUNyQyxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsU0FBUyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtvQkFDdkMsSUFBSSxPQUFPLFNBQVMsQ0FBQyxDQUFDLENBQUMsSUFBSSxRQUFRLEVBQUU7d0JBQ2pDLElBQUksU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsRUFBRTs0QkFDL0MsTUFBTSxHQUFHLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLENBQUM7NEJBQ3ZELE1BQU07eUJBQ1Q7cUJBQ0o7aUJBQ0o7Z0JBQ0QsT0FBTyxNQUFNLENBQUM7WUFDbEIsQ0FBQyxFQUFDLENBQUM7U0FDTjthQUFNO1lBQ0gsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO1NBQ2hDO1FBQ0QsT0FBTyxFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsV0FBVyxFQUFFLFdBQVcsRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUFFLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxFQUFFLENBQUE7SUFDcEcsQ0FBQzs7Ozs7Ozs7O0lBR0QsVUFBVSxDQUFDLEtBQUssRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFFLG1CQUE0QixLQUFLO1FBQ2hFLElBQUksUUFBUSxDQUFDLFNBQVMsQ0FBQyxJQUFJLFFBQVEsQ0FBQyxlQUFlLENBQUMsRUFBRTtZQUNsRCxPQUFPO1NBQ1Y7YUFBTTtZQUNILElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO1lBQ3JELElBQUksSUFBSSxDQUFDLGNBQWMsRUFBRTtnQkFDckIsSUFBSSxRQUFRLENBQUMsU0FBUyxDQUFDLEVBQUU7OzswQkFFZixlQUFlLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxTQUFTOzs7OztvQkFBQyxDQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsRUFBRTt3QkFDOUQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsS0FBSyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxLQUFLLENBQUMsQ0FBQztvQkFDakUsQ0FBQyxFQUFDO29CQUNGLElBQUksQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLGVBQWUsRUFBRSxDQUFDLENBQUMsQ0FBQztvQkFDL0MsSUFBSSxDQUFDLDBCQUEwQixDQUFDLFFBQVEsRUFBRSxRQUFRLENBQUMsQ0FBQztpQkFFdkQ7cUJBQU07OzswQkFFRyxNQUFNLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJOzs7OztvQkFBQyxDQUFDLEtBQUssRUFBRSxDQUFDLEVBQUUsRUFBRTt3QkFDakQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsS0FBSyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxLQUFLLENBQUMsQ0FBQztvQkFDbEUsQ0FBQyxFQUFDO29CQUNGLElBQUksQ0FBQyxNQUFNLEVBQUU7d0JBQ1QsSUFBSSxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUM7d0JBQ3RDLElBQUksQ0FBQywwQkFBMEIsQ0FBQyxRQUFRLEVBQUUsUUFBUSxDQUFDLENBQUM7cUJBQ3ZEO2lCQUNKO2dCQUNELFFBQVEsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUMsQ0FBQzthQUU5QztpQkFBTTtnQkFDSCxnQkFBZ0I7Z0JBQ2hCLElBQUksQ0FBQyxjQUFjLEdBQUcsRUFBRSxDQUFDO2dCQUN6QixJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQzthQUN0QztZQUNELElBQUksQ0FBQyxnQkFBZ0IsRUFBRTtnQkFDbkIsSUFBSSxDQUFDLFNBQVMsR0FBRyxRQUFRLENBQUM7YUFDN0I7WUFDRCxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsY0FBYyxFQUFFLEtBQUssRUFBRSxnQkFBZ0IsRUFBRSxDQUFDLENBQUM7U0FDL0U7UUFDRCxJQUFJLElBQUksQ0FBQyxjQUFjLEVBQUU7O2dCQUNqQixHQUFHLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNOzs7O1lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBQyxDQUFDLEdBQUc7Ozs7WUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEVBQUM7WUFDckYsSUFBSSxJQUFJLENBQUMsb0JBQW9CLEVBQUU7Z0JBQzNCLEdBQUcsR0FBRyxJQUFJLENBQUMsNEJBQTRCLENBQUMsR0FBRzs7OztnQkFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEVBQUMsQ0FBQzthQUM5RTtZQUNELElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxHQUFHLENBQUMsQ0FBQztTQUNqQztJQUNMLENBQUM7Ozs7Ozs7SUFHRCxNQUFNLENBQUMsSUFBSSxFQUFFLEtBQUs7UUFDZCxJQUFJLElBQUksQ0FBQyxVQUFVLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEVBQUU7WUFDekQsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1NBQ2hDO2FBQU07WUFDSCxPQUFPLEtBQUssQ0FBQztTQUNoQjtJQUNMLENBQUM7Ozs7Ozs7O0lBR0QsU0FBUyxDQUFDLEtBQUssRUFBRSxVQUFVLEVBQUUsQ0FBQzs7Y0FDcEIsS0FBSyxHQUFHLEtBQUssQ0FBQyxPQUFPO1FBQzNCLElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxFQUFFLFVBQVUsRUFBRSxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDaEQsQ0FBQzs7Ozs7OztJQUdELElBQUksQ0FBQyxXQUFXLEVBQUUsUUFBUSxHQUFHLEtBQUs7UUFDOUIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQztRQUMzRCxPQUFPLEVBQUUsVUFBVSxFQUFFLEVBQUUsUUFBUSxFQUFFLElBQUksQ0FBQyxXQUFXLEVBQUUsV0FBVyxFQUFFLFFBQVEsRUFBRSxFQUFFLENBQUM7SUFDakYsQ0FBQzs7Ozs7SUFHTSxTQUFTLENBQUMsWUFBaUI7UUFDOUIsSUFBSSxJQUFJLENBQUMsV0FBVyxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTs7a0JBQzNDLEdBQUcsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUk7Ozs7WUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssWUFBWSxFQUFDO1lBQ2pGLElBQUksR0FBRyxFQUFFO2dCQUNMLElBQUksQ0FBQyxTQUFTLEdBQUcsR0FBRyxDQUFDO2dCQUNyQixJQUFJLENBQUMsR0FBRyxDQUFDLFlBQVksRUFBRSxDQUFDO2FBQzNCO1NBQ0o7SUFFTCxDQUFDOzs7Ozs7O0lBQ08sT0FBTyxDQUFDLE9BQU8sRUFBRSxJQUFJO1FBQ3pCLElBQUksSUFBSSxLQUFLLE1BQU0sRUFBRTtZQUNqQjs7Ozs7WUFBTyxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsRUFBRTs7c0JBQ1osSUFBSSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUM7O3NCQUNwQixJQUFJLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQztnQkFDMUIsSUFBSSxJQUFJLEdBQUcsSUFBSSxFQUFFO29CQUNiLE9BQU8sQ0FBQyxDQUFDO2lCQUNaO3FCQUFNLElBQUksSUFBSSxHQUFHLElBQUksRUFBRTtvQkFDcEIsT0FBTyxDQUFDLENBQUMsQ0FBQztpQkFDYjtxQkFBTTtvQkFDSCxPQUFPLENBQUMsQ0FBQztpQkFDWjtZQUNMLENBQUMsRUFBQztTQUNMO1FBQ0QsSUFBSSxJQUFJLEtBQUssS0FBSyxFQUFFO1lBQ2hCOzs7OztZQUFPLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxFQUFFOztzQkFDWixJQUFJLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQzs7c0JBQ3BCLElBQUksR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDO2dCQUMxQixJQUFJLElBQUksR0FBRyxJQUFJLEVBQUU7b0JBQ2IsT0FBTyxDQUFDLENBQUM7aUJBQ1o7cUJBQU0sSUFBSSxJQUFJLEdBQUcsSUFBSSxFQUFFO29CQUNwQixPQUFPLENBQUMsQ0FBQyxDQUFDO2lCQUNiO3FCQUFNO29CQUFFLE9BQU8sQ0FBQyxDQUFDO2lCQUFFO1lBQ3hCLENBQUMsRUFBQztTQUNMO0lBQ0wsQ0FBQzs7Ozs7SUFFRCxhQUFhLENBQUMsSUFBSTtRQUNkLG1CQUFtQjtRQUNuQixJQUFJLElBQUksQ0FBQyxVQUFVLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRTtZQUNuQyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7U0FDcEU7YUFBTTtZQUNILE9BQU8sS0FBSyxDQUFDO1NBQ2hCO0lBQ0wsQ0FBQzs7Ozs7SUFHRCxZQUFZLENBQUMsSUFBNkM7UUFDdEQsSUFBSSxJQUFJLENBQUMsU0FBUyxLQUFLLElBQUksQ0FBQyxTQUFTLEVBQUU7WUFDbkMsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDO1lBQ2hDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQztZQUNwRCxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO1NBQzdDO0lBQ0wsQ0FBQzs7Ozs7SUFFRCxnQkFBZ0IsQ0FBQyxRQUFnQjtRQUM3Qix5REFBeUQ7UUFDekQsSUFBSSxJQUFJLENBQUMsUUFBUSxLQUFLLFFBQVEsSUFBSSxJQUFJLENBQUMsS0FBSyxFQUFFO1lBQzFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxZQUFZLEdBQUcsUUFBUSxDQUFDO1lBQy9DLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDOztrQkFFbkIsS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLOztnQkFDcEIsVUFBVSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLFFBQVEsQ0FBQztZQUM3QyxJQUFJLEtBQUssR0FBRyxRQUFRLEdBQUcsQ0FBQyxFQUFFO2dCQUN0QixVQUFVLElBQUksQ0FBQyxDQUFDO2FBQ25CO1lBRUQsSUFBSSxVQUFVLElBQUksSUFBSSxDQUFDLFNBQVMsR0FBRyxVQUFVLEVBQUU7Z0JBQzNDLElBQUksQ0FBQyxTQUFTLEdBQUcsVUFBVSxDQUFDO2dCQUM1QixJQUFJLENBQUMsaUJBQWlCLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUM7YUFDdkQ7WUFFRCxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxFQUFFLFFBQVEsRUFBRSxFQUFFLFNBQVMsRUFBRSxJQUFJLENBQUMsU0FBUyxFQUFFLFFBQVEsRUFBRSxFQUFFLENBQUMsQ0FBQztTQUNwRjtJQUNMLENBQUM7Ozs7SUFFRCxjQUFjO1FBQ1YsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDO0lBQzVCLENBQUM7Ozs7SUFFRCxhQUFhO1FBQ1QsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDO0lBQy9CLENBQUM7Ozs7OztJQUVELE9BQU8sQ0FBQyxZQUFZO1FBQ2hCLElBQUksQ0FBQyxXQUFXLEdBQUcsWUFBWSxDQUFDO1FBQ2hDLElBQUksQ0FBQyxJQUFJLEdBQUcsWUFBWSxDQUFDO1FBQ3pCLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUNwQixDQUFDOzs7O0lBRUQsUUFBUTtRQUNKLElBQUksSUFBSSxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRTtZQUMvQixJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTTs7OztZQUFDLENBQUMsSUFBSSxFQUFFLEVBQUU7Z0JBQzVDLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQzNCLENBQUMsRUFBQyxDQUFDO1lBQ0gsSUFBSSxJQUFJLENBQUMsV0FBVyxJQUFJLENBQUMsSUFBSSxJQUFJLENBQUMsV0FBVyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLEVBQUU7O3NCQUMvRCxRQUFRLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDO2dCQUM1QyxJQUFJLFFBQVEsRUFBRTtvQkFDVixJQUFJLENBQUMsU0FBUyxHQUFHLFFBQVEsQ0FBQztvQkFDMUIsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO2lCQUM1QzthQUNKO2lCQUFNLElBQUksSUFBSSxDQUFDLFdBQVcsR0FBRyxDQUFDLEVBQUU7Z0JBQzdCLE9BQU87YUFDVjtpQkFBTTtnQkFDSCxJQUFJLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxNQUFNLElBQUksQ0FBQyxJQUFJLENBQUMsY0FBYyxFQUFFO29CQUNyRCxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7aUJBQzFDO2dCQUNELElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQzthQUNqQztTQUNKO1FBRUQsSUFBSSxDQUFDLDBCQUEwQixFQUFFLENBQUM7UUFHbEMsSUFBSSxJQUFJLENBQUMsR0FBRyxFQUFFO1lBQ1YsSUFBSSxDQUFDLEdBQUcsQ0FBQyxhQUFhLEVBQUUsQ0FBQztTQUM1QjtJQUNMLENBQUM7Ozs7Ozs7O0lBRU8sMEJBQTBCLENBQUMsU0FBK0IsRUFBRSxFQUFFLFFBQWMsRUFBRSxJQUFJLEdBQUcsSUFBSTtRQUM3RixJQUFJLElBQUksQ0FBQyxjQUFjLElBQUksSUFBSSxDQUFDLG9CQUFvQixFQUFFO1lBRWxELElBQUksTUFBTSxLQUFLLFFBQVEsSUFBSSxRQUFRLEVBQUU7Z0JBQ2pDLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxFQUFFO29CQUMxQixJQUFJLENBQUMsNEJBQTRCO3dCQUM3QixJQUFJLENBQUMsNEJBQTRCLENBQUMsTUFBTTs7Ozt3QkFBQyxDQUFDLENBQUMsRUFBRTs0QkFDekMsSUFBSSxPQUFPLFFBQVEsS0FBSyxRQUFRLEVBQUU7Z0NBQzlCLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxRQUFRLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDOzZCQUMxRDtpQ0FBTTtnQ0FDSCxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksUUFBUSxDQUFDOzZCQUN6Qzt3QkFDTCxDQUFDLEVBQUMsQ0FBQztpQkFDVjtxQkFBTTtvQkFDSCxJQUFJLENBQUMsNEJBQTRCO3dCQUM3QixJQUFJLENBQUMsNEJBQTRCLENBQUMsTUFBTTs7Ozt3QkFBQyxDQUFDLENBQUMsRUFBRTs0QkFDekMsT0FBTyxRQUFRLENBQUMsT0FBTzs7Ozs0QkFBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsRUFBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO3dCQUNuRixDQUFDLEVBQUMsQ0FBQztpQkFDVjtnQkFFRCxJQUFJLElBQUksRUFBRTtvQkFDTixJQUFJLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLEVBQUMsS0FBSyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsNEJBQTRCLENBQUMsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQztpQkFDL0Y7YUFFSjtpQkFBTSxJQUFJLE1BQU0sS0FBSyxRQUFRLEVBQUU7Z0JBQzVCLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxFQUFFO29CQUMxQixJQUFJLENBQUMsNEJBQTRCLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyw0QkFBNEIsRUFBRSxRQUFRLENBQUMsQ0FBQztpQkFDeEY7cUJBQU07b0JBQ0gsSUFBSSxDQUFDLDRCQUE0QixHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsNEJBQTRCLEVBQUUsR0FBRyxRQUFRLENBQUMsQ0FBQztpQkFDM0Y7Z0JBRUQsSUFBSSxJQUFJLEVBQUU7b0JBQ04sSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxFQUFDLEtBQUssRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLDRCQUE0QixDQUFDLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBQyxDQUFDLENBQUM7aUJBQy9GO2FBQ0o7aUJBQU07Z0JBQ0gsSUFBSSxDQUFDLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxNQUFNLEVBQUU7b0JBQzNDLElBQUksQ0FBQyw0QkFBNEIsR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDO2lCQUNoRTtxQkFBTTs7MEJBRUcsV0FBVyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsNEJBQTRCOzs7O29CQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxFQUFDO29CQUMvRyxJQUFJLFdBQVcsSUFBSSxXQUFXLENBQUMsTUFBTSxFQUFFO3dCQUNuQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU87Ozs7d0JBQUMsSUFBSSxDQUFDLEVBQUU7NEJBQ3JCLElBQUksQ0FBQyxPQUFPLEdBQUcsV0FBVyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7d0JBQy9ELENBQUMsRUFBQyxDQUFDO3FCQUNOO2lCQUNKO2FBQ0o7U0FDSjtJQUNMLENBQUM7Ozs7O0lBR0QsWUFBWTtRQUNSLElBQUksSUFBSSxDQUFDLGNBQWMsRUFBRTtZQUNyQixJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU87Ozs7WUFBQyxJQUFJLENBQUMsRUFBRTtnQkFDNUIsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUM7WUFDeEIsQ0FBQyxFQUFDLENBQUM7WUFDSCxJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTTs7OztZQUFDLENBQUMsSUFBSSxFQUFFLEVBQUU7Z0JBQ25ELE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQzNCLENBQUMsRUFBQyxDQUFDO1lBRUgsSUFBSSxDQUFDLDBCQUEwQixDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDNUQsSUFBSSxDQUFDLEdBQUcsQ0FBQyxZQUFZLEVBQUUsQ0FBQztTQUMzQjtJQUNMLENBQUM7Ozs7O0lBRUQsa0JBQWtCO1FBQ2QsSUFBSSxJQUFJLENBQUMsY0FBYyxFQUFFO1lBQ3JCLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTzs7OztZQUFDLElBQUksQ0FBQyxFQUFFO2dCQUM1QixJQUFJLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQztZQUN6QixDQUFDLEVBQUMsQ0FBQztZQUNILElBQUksQ0FBQyxjQUFjLEdBQUcsRUFBRSxDQUFDO1lBQ3pCLElBQUksQ0FBQywwQkFBMEIsQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQzVELElBQUksQ0FBQyxHQUFHLENBQUMsWUFBWSxFQUFFLENBQUM7U0FDM0I7SUFDTCxDQUFDOzs7Ozs7SUFLTSxTQUFTLENBQUMsR0FBVTtRQUN2QixJQUFJLElBQUksQ0FBQyxjQUFjLEVBQUU7WUFDckIsSUFBSSxDQUFDLEdBQUcsSUFBSSxHQUFHLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtnQkFDeEIsSUFBSSxDQUFDLGtCQUFrQixFQUFFLENBQUM7Z0JBQzFCLE9BQU87YUFDVjtZQUNELElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTzs7OztZQUFDLElBQUksQ0FBQyxFQUFFO2dCQUNyQixJQUFJLEdBQUcsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxFQUFFO29CQUNyQyxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQztpQkFDdkI7cUJBQU07b0JBQ0gsSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7aUJBQ3hCO1lBQ0wsQ0FBQyxFQUFDLENBQUM7WUFFSCxpQ0FBaUM7WUFDakMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxZQUFZLEVBQUUsQ0FBQztTQUMzQjtJQUNMLENBQUM7Ozs7OztJQUVPLG1CQUFtQixDQUFDLEdBQVU7UUFDbEMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNyQyxDQUFDOzs7OztJQWFELFlBQVksQ0FBQyxNQUFNO1FBQ2YsTUFBTSxDQUFDLGVBQWUsRUFBRSxDQUFDO1FBRXpCLElBQUksQ0FBQyxtQkFBbUIsR0FBRyxJQUFJLENBQUM7UUFDaEMsSUFBSSxJQUFJLENBQUMsNEJBQTRCLElBQUksSUFBSSxDQUFDLDRCQUE0QixDQUFDLE1BQU0sRUFBRTtZQUMvRSxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUM7U0FDbEQ7YUFBTTtZQUNILElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxLQUFLLENBQUM7U0FDakM7SUFDTCxDQUFDOzs7O0lBR0QsaUJBQWlCO1FBQ2IsSUFBSSxDQUFDLGdCQUFnQixHQUFHLEtBQUssQ0FBQztRQUM5QixJQUFJLENBQUMsbUJBQW1CLEdBQUcsS0FBSyxDQUFDO1FBQ2pDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxFQUFFO1lBQ3hCLElBQUksQ0FBQyxHQUFHLENBQUMsYUFBYSxFQUFFLENBQUM7U0FDNUI7SUFDTCxDQUFDOzs7OztJQUVELGlCQUFpQixDQUFDLEVBQU87UUFDckIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPOzs7O1FBQUMsSUFBSSxDQUFDLEVBQUU7WUFDNUIsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsRUFBRTtnQkFDN0IsSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7YUFDeEI7UUFDTCxDQUFDLEVBQUMsQ0FBQztRQUVILElBQUksQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxNQUFNOzs7O1FBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsRUFBQyxDQUFDO1FBQ2hGLElBQUksQ0FBQywwQkFBMEIsQ0FBQyxRQUFRLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFFOUMsSUFBSSxDQUFDLG1CQUFtQixFQUFFLENBQUM7SUFFL0IsQ0FBQzs7Ozs7SUFFRCxlQUFlLENBQUMsTUFBTTtRQUNsQixpQ0FBaUM7UUFDakMsSUFBSSxDQUFDLGlCQUFpQixFQUFFLENBQUM7UUFDekIsSUFBSSxDQUFDLGtCQUFrQixFQUFFLENBQUM7UUFFMUIsSUFBSSxDQUFDLDRCQUE0QixHQUFHLEVBQUUsQ0FBQztRQUN2QyxJQUFJLENBQUMsV0FBVyxHQUFHLEVBQUUsQ0FBQztRQUN0QixJQUFJLENBQUMsbUJBQW1CLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDakMsQ0FBQzs7Ozs7SUFFRCxzQkFBc0IsQ0FBQyxNQUFNO1FBQ3pCLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO0lBQzdCLENBQUM7Ozs7OztJQUVPLG1CQUFtQixDQUFDLElBQUksR0FBRyxJQUFJO1FBQ25DLElBQUksSUFBSSxDQUFDLGNBQWMsRUFBRTtZQUNyQixJQUFJLENBQUMsSUFBSSxDQUFDLG9CQUFvQixFQUFFO2dCQUM1QixJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsR0FBRzs7OztnQkFBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEVBQUMsQ0FBQzthQUN2RTtpQkFBTTtnQkFDSCxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxHQUFHOzs7O2dCQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsRUFBQyxDQUFDO2FBQ3JGO1lBRUQsSUFBSSxJQUFJLEVBQUU7Z0JBQ04sSUFBSSxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztnQkFDM0MsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsNEJBQTRCLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7YUFDNUY7U0FDSjtJQUNMLENBQUM7Ozs7OztJQUVELGFBQWEsQ0FBQyxRQUFRLEdBQUcsSUFBSSxFQUFFLElBQUksR0FBRyxJQUFJO1FBQ3RDLElBQUksSUFBSSxDQUFDLGNBQWMsRUFBRTtZQUNyQixJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU87Ozs7WUFBQyxJQUFJLENBQUMsRUFBRTtnQkFDNUIsSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7WUFDekIsQ0FBQyxFQUFDLENBQUM7WUFDSCxJQUFJLENBQUMsY0FBYyxHQUFHLEVBQUUsQ0FBQztZQUV6QixJQUFJLFFBQVEsRUFBRTtnQkFDVixJQUFJLENBQUMsNEJBQTRCLEdBQUcsRUFBRSxDQUFDO2FBQzFDO2lCQUFPO2dCQUNKLElBQUksQ0FBQywwQkFBMEIsQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO2FBQy9EO1lBRUQsSUFBSSxJQUFJLEVBQUU7Z0JBQ04sSUFBSSxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxDQUFDO2FBQ2xDO1lBRUQsSUFBSSxDQUFDLEdBQUcsQ0FBQyxZQUFZLEVBQUUsQ0FBQztTQUMzQjtJQUNMLENBQUM7Ozs7Ozs7O0lBRU8sc0JBQXNCLENBQUUsR0FBUSxFQUFFLE9BQWdCLEVBQUUsSUFBYTtRQUNyRSxJQUFJLEdBQUcsSUFBSSxHQUFHLENBQUMsTUFBTSxFQUFFOztrQkFDYixNQUFNLEdBQUcsT0FBTyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUEsQ0FBQyxDQUFDLFFBQVE7WUFDM0MsR0FBRyxDQUFDLE9BQU87Ozs7WUFBQyxDQUFDLENBQUMsRUFBRTs7b0JBQ1IsRUFBRSxHQUFHLENBQUM7Z0JBQ1YsSUFBSSxPQUFPLENBQUMsS0FBSyxRQUFRLEVBQUU7b0JBQ3ZCLEVBQUUsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO2lCQUMzQjs7c0JBRUssSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSTs7OztnQkFBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssRUFBRSxFQUFDO2dCQUMzRCxJQUFJLElBQUksRUFBRTtvQkFDTixJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztpQkFDMUI7Z0JBRUQsSUFBSSxPQUFPLEVBQUU7b0JBQ1QsSUFBSSxDQUFDLDBCQUEwQixDQUFDLFFBQVEsRUFBRSxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUM7aUJBQ3ZEO3FCQUFNO29CQUNILElBQUksQ0FBQywwQkFBMEIsQ0FBQyxRQUFRLEVBQUUsRUFBRSxFQUFFLEtBQUssQ0FBQyxDQUFDO2lCQUN4RDtZQUNMLENBQUMsRUFBQyxDQUFDO1lBRUgsSUFBSSxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxDQUFDO1lBQy9CLElBQUksQ0FBQyxHQUFHLENBQUMsWUFBWSxFQUFFLENBQUM7U0FDM0I7SUFDTCxDQUFDOzs7Ozs7SUFFRCxZQUFZLENBQUMsR0FBbUMsRUFBRSxJQUFJLEdBQUcsS0FBSztRQUMxRCxJQUFJLENBQUMsc0JBQXNCLENBQUMsR0FBRyxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNsRCxDQUFDOzs7Ozs7SUFFRCxZQUFZLENBQUMsR0FBYSxFQUFFLElBQUksR0FBRyxLQUFLO1FBQ3BDLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxHQUFHLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ2pELENBQUM7OztZQTltQkosU0FBUyxTQUFDO2dCQUNQLFFBQVEsRUFBRSxrQkFBa0I7Z0JBQzVCLGlvSkFBeUM7O2FBRTVDOzs7O1lBakJ3QyxVQUFVO1lBQTBELFNBQVM7WUFDNUQsaUJBQWlCOzs7NkJBbUJ0RSxZQUFZLFNBQUMsK0JBQStCLEVBQUUsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFOzJCQUNuRSxZQUFZLFNBQUMseUJBQXlCLEVBQUUsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFOzZCQUM3RCxZQUFZLFNBQUMsK0JBQStCLEVBQUUsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFO2dDQUNuRSxZQUFZLFNBQUMsOEJBQThCLEVBQUUsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFO3dCQUVsRSxTQUFTLFNBQUMsV0FBVztvQkFHckIsU0FBUyxTQUFDLE9BQU87bUJBSWpCLEtBQUs7aUJBRUwsS0FBSzt3QkFHTCxLQUFLOzRCQUVMLEtBQUs7NkJBRUwsS0FBSzs0QkFHTCxLQUFLOzRCQUdMLEtBQUs7dUJBQ0wsS0FBSzt3QkFDTCxLQUFLO21DQUVMLEtBQUs7K0JBQ0wsS0FBSztpQ0FDTCxLQUFLO21CQUdMLEtBQUs7eUJBRUwsS0FBSzswQkFNTCxLQUFLOzRCQUtMLEtBQUs7MEJBSUwsS0FBSztnQ0FDTCxNQUFNO3lCQUVOLEtBQUs7K0JBQ0wsS0FBSzt1QkFTTCxLQUFLO29CQU1MLEtBQUs7eUJBR0wsS0FBSzsyQkFFTCxXQUFXLFNBQUMsdUJBQXVCO3dCQUluQyxNQUFNOzBCQUVOLE1BQU07MEJBR04sTUFBTTs4QkFDTixNQUFNOzs7O0lBdkZQLDJDQUF1Rzs7SUFDdkcseUNBQStGOztJQUMvRiwyQ0FBdUc7O0lBQ3ZHLDhDQUF5Rzs7SUFFekcsc0NBQThDOztJQUc5QyxrQ0FBdUQ7Ozs7O0lBSXZELGlDQUFtQjs7SUFFbkIsK0JBQW9COzs7OztJQUdwQixzQ0FBMEI7Ozs7O0lBRTFCLDBDQUErQjs7Ozs7SUFFL0IsMkNBQWdDOzs7OztJQUdoQywwQ0FBK0I7O0lBRy9CLDBDQUE4Qjs7SUFDOUIscUNBQXVCOztJQUN2QixzQ0FBdUI7Ozs7O0lBRXZCLGlEQUFzQzs7SUFDdEMsNkNBQWtDOztJQUNsQywrQ0FBMEQ7O0lBRzFELGlDQUFzQjs7SUFFdEIsdUNBQTRCOztJQUU1Qix5Q0FBcUI7O0lBU3JCLDBDQUErQjs7Ozs7SUFJL0Isd0NBQWlDOztJQUNqQyw4Q0FBNkU7O0lBRTdFLHVDQUF5Qjs7SUFDekIsNkNBQXdIOzs7OztJQUl4SCxzQ0FBcUM7O0lBV3JDLGtDQUFtQjs7Ozs7SUFHbkIsdUNBQTJCOzs7OztJQU0zQixzQ0FBeUM7Ozs7O0lBRXpDLHdDQUEyQzs7SUFHM0Msd0NBQTJDOztJQUMzQyw0Q0FBK0M7Ozs7O0lBRy9DLHdDQUFpQjs7Ozs7SUFHakIsMkNBQW9COzs7OztJQUVwQix5REFBa0M7O0lBR2xDLHNDQUFzQjs7SUFFdEIsb0NBQW1COztJQUNuQiwyQ0FBNkI7O0lBQzdCLHFDQUF3Qjs7SUFDeEIsdUNBQXlCOztJQUN6Qiw4Q0FNRTs7SUFFRixtQ0FNRTs7SUFFRixnREFBNEI7O0lBQzVCLDZDQUF5Qjs7Ozs7SUErV3pCLHlDQUdDOzs7OztJQUVELG1DQUdDOzs7OztJQXRYVywrQkFBc0I7Ozs7O0lBQUUscUNBQTJCOzs7OztJQUFFLGdDQUE4QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgICBDb21wb25lbnQsIE9uSW5pdCwgQWZ0ZXJDb250ZW50SW5pdCwgRWxlbWVudFJlZiwgVGVtcGxhdGVSZWYsIENvbnRlbnRDaGlsZCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIElucHV0LCBSZW5kZXJlcjIsIFZpZXdDaGlsZCxcclxuICAgIEFmdGVyVmlld0luaXQsIEhvc3RCaW5kaW5nLCBTaW1wbGVDaGFuZ2VzLCBPbkNoYW5nZXMsIENoYW5nZURldGVjdG9yUmVmLCBEb0NoZWNrXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7XHJcbiAgICBMaXN0Vmlld0hlYWRlclRlbXBsYXRlRGlyZWN0aXZlLFxyXG4gICAgTGlzdFZpZXdUZW1wbGF0ZURpcmVjdGl2ZSxcclxuICAgIExpc3RWaWV3Rm9vdGVyVGVtcGxhdGVEaXJlY3RpdmUsXHJcbiAgICBMaXN0Vmlld0VtcHR5VGVtcGxhdGVEaXJlY3RpdmUsXHJcbn0gZnJvbSAnLi90ZW1wbGF0ZS5kaXJlY3RpdmUnO1xyXG5cclxuaW1wb3J0IHsgUGFnaW5hdGlvbkluc3RhbmNlLCBQYWdpbmF0aW9uQ29udHJvbHNDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLXBhZ2luYXRpb24nO1xyXG5cclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdmYXJyaXMtbGlzdC12aWV3JyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9saXN0LXZpZXcuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgc3R5bGVVcmxzOiBbJy4vbGlzdC12aWV3LmNvbXBvbmVudC5zY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIExpc3RWaWV3Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMsIEFmdGVyQ29udGVudEluaXQsIEFmdGVyVmlld0luaXQge1xyXG5cclxuICAgIEBDb250ZW50Q2hpbGQoTGlzdFZpZXdIZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZSwgeyByZWFkOiBUZW1wbGF0ZVJlZiB9KSBoZWFkZXJUZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PjtcclxuICAgIEBDb250ZW50Q2hpbGQoTGlzdFZpZXdUZW1wbGF0ZURpcmVjdGl2ZSwgeyByZWFkOiBUZW1wbGF0ZVJlZiB9KSBsaXN0VGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgICBAQ29udGVudENoaWxkKExpc3RWaWV3Rm9vdGVyVGVtcGxhdGVEaXJlY3RpdmUsIHsgcmVhZDogVGVtcGxhdGVSZWYgfSkgZm9vdGVyVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgICBAQ29udGVudENoaWxkKExpc3RWaWV3RW1wdHlUZW1wbGF0ZURpcmVjdGl2ZSwgeyByZWFkOiBUZW1wbGF0ZVJlZiB9KSBlbXB0eURhdGFUZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PjtcclxuXHJcbiAgICBAVmlld0NoaWxkKCdsaXN0R3JvdXAnKSBsaXN0R3JvdXA6IEVsZW1lbnRSZWY7XHJcblxyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ3BhZ2VyJykgcGFnZXI6IFBhZ2luYXRpb25Db250cm9sc0NvbXBvbmVudDtcclxuXHJcbiAgICAvLyBASW5wdXQoKSBoZWlnaHQ6bnVtYmVyO1xyXG4gICAgLyoqIOWIl+ihqOaVsOaNriAqL1xyXG4gICAgQElucHV0KCkgZGF0YSA9IFtdO1xyXG5cclxuICAgIEBJbnB1dCgpIGlkOiBzdHJpbmc7XHJcblxyXG4gICAgLyoqIOaVsOaNruS4uuepuuaYr+WQpuWxleekuum7mOiupCAqL1xyXG4gICAgQElucHV0KCkgc2hvd0VtcHR5ID0gdHJ1ZTtcclxuICAgIC8qKiDmmK/lkKboh6rlrprkuYnnqbrmlbDmja7mqKHmnb8gKi9cclxuICAgIEBJbnB1dCgpIGVtcHR5VGVtcGxhdGUgPSBmYWxzZTtcclxuICAgIC8qKiDmmK/lkKbmlK/mjIHlpJrpgIkg6buY6K6k5Li6ZmFsc2UgKi9cclxuICAgIEBJbnB1dCgpIG11bHRpcGxlU2VsZWN0ID0gZmFsc2U7XHJcblxyXG4gICAgLyoqIOaYr+WQpuaUr+aMgeWIhumhtSDpu5jorqRmYWxzZSAqL1xyXG4gICAgQElucHV0KCkgc3VwcG9ydFBhZ2luZyA9IGZhbHNlO1xyXG5cclxuICAgIC8vIOm7mOiupOWIhumhtVxyXG4gICAgQElucHV0KCkgcGFnZXJPblNlcnZlciA9IHRydWU7XHJcbiAgICBASW5wdXQoKSBwYWdlU2l6ZSA9IDEwO1xyXG4gICAgQElucHV0KCkgcGFnZUluZGV4ID0gMTtcclxuICAgIC8qKiDlkK/nlKjot6jpobXlpJrpgIkgKi9cclxuICAgIEBJbnB1dCgpIGVuYWJsZU1vcmVQYWdlU2VsZWN0ID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBzaG93U2VsZWN0ZWRMaXN0ID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBzZWxlY3RlZEl0ZW1Gb3JtYXQ6IChpdGVtOiBhbnkpID0+IHN0cmluZyA9IG51bGw7XHJcblxyXG4gICAgLy8g5piv5ZCm5bmz6ZO6XHJcbiAgICBASW5wdXQoKSBmaWxsID0gZmFsc2U7XHJcbiAgICAvLyDmmK/lkKbmqKrlkJHmjpLliJdcclxuICAgIEBJbnB1dCgpIGNhcmRMYXlvdXQgPSBmYWxzZTtcclxuXHJcbiAgICBfYWN0aXZlSW5kZXg6IG51bWJlcjtcclxuICAgIGdldCBhY3RpdmVJbmRleCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fYWN0aXZlSW5kZXg7XHJcbiAgICB9XHJcbiAgICBASW5wdXQoKSBzZXQgYWN0aXZlSW5kZXgodmFsKSB7XHJcbiAgICAgICAgdGhpcy5fYWN0aXZlSW5kZXggPSB2YWw7XHJcbiAgICAgICAgdGhpcy5kYXRhSW5pdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIEBJbnB1dCgpIGxpc3RDbGFzc05hbWU6IHN0cmluZztcclxuICAgIC8qKlxyXG4gICAgICog5Yu+6YCJ5YC8XHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIGNoZWNrVmFsdWVzOiBhbnlbXSA9IFtdO1xyXG4gICAgQE91dHB1dCgpIGNoZWNrVmFsdWVzQ2hhbmdlOiBFdmVudEVtaXR0ZXI8YW55W10+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnlbXT4oKTtcclxuXHJcbiAgICBASW5wdXQoKSBjaGVja0l0ZW1zID0gW107XHJcbiAgICBASW5wdXQoKSBjaGVja0l0ZW1zQ2hhbmdlOiBFdmVudEVtaXR0ZXI8e2l0ZW1zOiBhbnlbXSwgaW5zdGFuY2U6IGFueX0+ID0gbmV3IEV2ZW50RW1pdHRlcjx7aXRlbXM6IFtdLCBpbnN0YW5jZTogYW55fT4oKTtcclxuXHJcbiAgICAvLyBASW5wdXQoKSBib3JkZXJCb3R0b206Ym9vbGVhbiA9IHRydWU7XHJcblxyXG4gICAgcHJpdmF0ZSBfcGFnZUxpc3QgPSBbMTAsIDIwLCAzMCwgNTBdO1xyXG5cclxuICAgIGdldCBwYWdlTGlzdCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcGFnZUxpc3Q7XHJcbiAgICB9XHJcbiAgICBASW5wdXQoKSBzZXQgcGFnZUxpc3QodmFsKSB7XHJcbiAgICAgICAgdGhpcy5fcGFnZUxpc3QgPSB2YWw7XHJcbiAgICAgICAgaWYgKHRoaXMucGFnZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5wYWdlci5zZXRQYWdlTGlzdCh2YWwpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIEBJbnB1dCgpIHRvdGFsID0gMDtcclxuXHJcbiAgICAvKiog5L2c5Li65ZSv5LiA5qCH6K+G55qE5pWw5o2ua2V55YC8IOWmguaenOayoeS8oCDllK/kuIDmoIfor4bkuLppbmRleOWAvCAqL1xyXG4gICAgQElucHV0KCkgbGlzdGlkTmFtZSA9ICdpZCc7XHJcblxyXG4gICAgQEhvc3RCaW5kaW5nKCdjbGFzcy5mLWxpc3R2aWV3LWZpbGwnKSBnZXQgbGlzdHZpZXdGaWxsKCkgeyByZXR1cm4gdGhpcy5maWxsOyB9XHJcblxyXG5cclxuICAgIC8qKiDngrnlh7vmn5DkuIDooYzlkI4gKi9cclxuICAgIEBPdXRwdXQoKSBsaXN0Q2xpY2sgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICAvKiog5aSa6YCJ5qGGIOmAieS4reeKtuaAgeWPmOWMliAqL1xyXG4gICAgQE91dHB1dCgpIGNoZWNrQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIC8vIOWIhumhteS6i+S7tlxyXG4gICAgQE91dHB1dCgpIHBhZ2VDaGFuZ2VkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIHBhZ2VTaXplQ2hhbmdlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICAvKiog5b2T5YmN5bGV56S65YiX6KGo5pWw5o2uICovXHJcbiAgICBjdXJyZW50RGF0YSA9IFtdO1xyXG5cclxuICAgIC8qKiDpgInkuK3nmoTliJfooajmlbDnu4QgKi9cclxuICAgIHNlbGVjdERhdGFMaXN0ID0gW107XHJcbiAgICAvKiog6Leo6aG15aSa6YCJ6K6w5b2VICovXHJcbiAgICBzZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyID0gW107XHJcblxyXG4gICAgLy8g5b2T5YmN54K55Ye7XHJcbiAgICBwdWJsaWMgY2xpY2tJdGVtOiBhbnk7XHJcblxyXG4gICAgcHVibGljIG1heFNpemUgPSA3O1xyXG4gICAgcHVibGljIGRpcmVjdGlvbkxpbmtzID0gdHJ1ZTtcclxuICAgIHB1YmxpYyBhdXRvSGlkZSA9IGZhbHNlO1xyXG4gICAgcHVibGljIHJlc3BvbnNpdmUgPSB0cnVlO1xyXG4gICAgcHVibGljIHBhZ2luYXRpb25PcHRpb25zOiBQYWdpbmF0aW9uSW5zdGFuY2UgPSB7XHJcbiAgICAgICAgaWQ6ICdGYXJyaXMtbGlzdFZpZXctUGFnaW5hdGlvbicsXHJcbiAgICAgICAgaXRlbXNQZXJQYWdlOiB0aGlzLnBhZ2VTaXplLFxyXG4gICAgICAgIGN1cnJlbnRQYWdlOiB0aGlzLnBhZ2VJbmRleCxcclxuICAgICAgICBwYWdlTGlzdDogdGhpcy5wYWdlTGlzdCxcclxuICAgICAgICB0b3RhbEl0ZW1zOiB0aGlzLnRvdGFsXHJcbiAgICB9O1xyXG5cclxuICAgIHB1YmxpYyBsYWJlbHM6IGFueSA9IHtcclxuICAgICAgICBwcmV2aW91c0xhYmVsOiAnICcsXHJcbiAgICAgICAgbmV4dExhYmVsOiAnICcsXHJcbiAgICAgICAgc2NyZWVuUmVhZGVyUGFnaW5hdGlvbkxhYmVsOiAnUGFnaW5hdGlvbicsXHJcbiAgICAgICAgc2NyZWVuUmVhZGVyUGFnZUxhYmVsOiAncGFnZScsXHJcbiAgICAgICAgc2NyZWVuUmVhZGVyQ3VycmVudExhYmVsOiBgWW91J3JlIG9uIHBhZ2VgXHJcbiAgICB9O1xyXG5cclxuICAgIG1vdXNlSW5TZWxlY3RlZExpc3QgPSBmYWxzZTtcclxuICAgIG9wZW5TZWxlY3RlZExpc3QgPSBmYWxzZTtcclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgZWw6IEVsZW1lbnRSZWYsIHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyMiwgcHJpdmF0ZSBjZHI6IENoYW5nZURldGVjdG9yUmVmKSB7IH1cclxuXHJcbiAgICBuZ09uSW5pdCgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5jdXJyZW50RGF0YSA9IHRoaXMuZGF0YTtcclxuICAgICAgICB0aGlzLmRhdGFJbml0KCk7XHJcbiAgICAgICAgdGhpcy5wYWdpbmF0aW9uT3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgaWQ6ICdGYXJyaXMtbGlzdFZpZXctUGFnaW5hdGlvbicsXHJcbiAgICAgICAgICAgIGl0ZW1zUGVyUGFnZTogdGhpcy5wYWdlU2l6ZSxcclxuICAgICAgICAgICAgY3VycmVudFBhZ2U6IHRoaXMucGFnZUluZGV4LFxyXG4gICAgICAgICAgICBwYWdlTGlzdDogdGhpcy5wYWdlTGlzdCxcclxuICAgICAgICAgICAgdG90YWxJdGVtczogdGhpcy50b3RhbCxcclxuICAgICAgICAgICAgcmVtb3RlOiB0aGlzLnBhZ2VyT25TZXJ2ZXJcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmICh0aGlzLmlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFnaW5hdGlvbk9wdGlvbnMuaWQgPSB0aGlzLnBhZ2luYXRpb25PcHRpb25zLmlkICsgdGhpcy5pZDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcclxuICAgICAgICBpZiAoY2hhbmdlcy5kYXRhICYmICFjaGFuZ2VzLmRhdGEuaXNGaXJzdENoYW5nZSgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudERhdGEgPSB0aGlzLmRhdGE7XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YUluaXQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNoYW5nZXNbJ3RvdGFsJ10gJiYgdGhpcy50b3RhbCAmJiB0aGlzLnBhZ2luYXRpb25PcHRpb25zKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFnaW5hdGlvbk9wdGlvbnNbJ3RvdGFsSXRlbXMnXSA9IHRoaXMudG90YWw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjaGFuZ2VzWydwYWdlSW5kZXgnXSAmJiB0aGlzLnBhZ2VJbmRleCAmJiB0aGlzLnBhZ2luYXRpb25PcHRpb25zKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFnaW5hdGlvbk9wdGlvbnNbJ2N1cnJlbnRQYWdlJ10gPSB0aGlzLnBhZ2VJbmRleDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNoYW5nZXMgJiYgY2hhbmdlcy5jaGVja1ZhbHVlcyAhPT0gdW5kZWZpbmVkICYmICFjaGFuZ2VzLmNoZWNrVmFsdWVzLmlzRmlyc3RDaGFuZ2UoKSkge1xyXG4gICAgICAgICAgICBjb25zdCBjaGFuZ2UgPSB0aGlzLmRpZmZlcmVuY2VCeShjaGFuZ2VzLmNoZWNrVmFsdWVzLmN1cnJlbnRWYWx1ZSB8fCBbXSwgY2hhbmdlcy5jaGVja1ZhbHVlcy5wcmV2aW91c1ZhbHVlIHx8IFtdLCB2ID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKGNoYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmVuYWJsZU1vcmVQYWdlU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja1Jvd3ModGhpcy5jaGVja1ZhbHVlcyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChjaGFuZ2VzLmNoZWNrSXRlbXMgJiYgIWNoYW5nZXMuY2hlY2tJdGVtcy5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyID0gWy4uLnRoaXMuY2hlY2tJdGVtc107XHJcbiAgICAgICAgICAgIGNvbnN0IGlkcyA9IHRoaXMuY2hlY2tJdGVtcy5tYXAobiA9PiBuW3RoaXMubGlzdGlkTmFtZV0pO1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrZWRJdGVtcyhpZHMsIGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdBZnRlclZpZXdJbml0KCkge1xyXG4gICAgfVxyXG4gICAgbmdBZnRlckNvbnRlbnRJbml0KCkge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvKiog6buY6K6k5pCc57Si5qih5p2/IOeCueWHu+aQnOe0oiAqL1xyXG4gICAgc2VhcmNoTGlzdChzZWFyY2hGaWVsZCkge1xyXG4gICAgICAgIGlmIChzZWFyY2hGaWVsZCAhPT0gJycgJiYgdGhpcy5kYXRhICYmIHRoaXMuZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50RGF0YSA9IHRoaXMuZGF0YS5maWx0ZXIoKGxpc3QpID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCByZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsaXN0VmFsdWUgPSBPYmplY3QudmFsdWVzKGxpc3QpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaXN0VmFsdWUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGxpc3RWYWx1ZVtpXSA9PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGlzdFZhbHVlW2ldLnRvU3RyaW5nKCkuaW5jbHVkZXMoc2VhcmNoRmllbGQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBsaXN0VmFsdWVbaV0udG9TdHJpbmcoKS5pbmNsdWRlcyhzZWFyY2hGaWVsZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudERhdGEgPSB0aGlzLmRhdGE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7IGxpc3RkYXRhOiB0aGlzLmN1cnJlbnREYXRhLCBzZWFyY2hWYWx1ZTogc2VhcmNoRmllbGQsIGxlbmd0aDogdGhpcy5jdXJyZW50RGF0YS5sZW5ndGggfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKiDngrnlh7vmn5DkuIDliJfkuovku7YgKi9cclxuICAgIGxpc3RTZWxlY3QoZXZlbnQsIGxpc3RJdGVtLCBpbmRleCwgY2hlY2tDaGFuZ2VFdmVudDogYm9vbGVhbiA9IGZhbHNlKSB7XHJcbiAgICAgICAgaWYgKGxpc3RJdGVtWyd1bkNsaWNrJ10gfHwgbGlzdEl0ZW1bJ3NlbGVjdERpc2FibGUnXSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5jaGVja0NoYW5nZS5lbWl0KHsgbGlzdGRhdGE6IGxpc3RJdGVtLCBpbmRleCB9KTtcclxuICAgICAgICAgICAgaWYgKHRoaXMubXVsdGlwbGVTZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgIGlmIChsaXN0SXRlbVsnY2hlY2tlZCddKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5pSv5oyB5aSa6YCJIOWIoOmZpOivpemAieS4reihjFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdEl0ZW1JbmRleCA9IHRoaXMuc2VsZWN0RGF0YUxpc3QuZmluZEluZGV4KChpdGVtLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEtleShpdGVtLCBpKSA9PT0gdGhpcy5nZXRLZXkobGlzdEl0ZW0sIGluZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdERhdGFMaXN0LnNwbGljZShzZWxlY3RJdGVtSW5kZXgsIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRGF0YUxpc3RGb3JNb3JlUGFnZXIoJ3JlbW92ZScsIGxpc3RJdGVtKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOaUr+aMgeWkmumAiSDmj5LlhaXor6XpgInkuK3ooYxcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLnNlbGVjdERhdGFMaXN0LmZpbmQoKHZhbHVlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEtleSh2YWx1ZSwgaSkgPT09IHRoaXMuZ2V0S2V5KGxpc3RJdGVtLCBpbmRleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdC51bnNoaWZ0KGxpc3RJdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVEYXRhTGlzdEZvck1vcmVQYWdlcignYXBwZW5kJywgbGlzdEl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGxpc3RJdGVtWydjaGVja2VkJ10gPSAhbGlzdEl0ZW1bJ2NoZWNrZWQnXTtcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyDkuI3mlK/mjIHlpJrpgIkg5pu/5o2i5b2T5YmN6YCJ5Lit6KGMXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdERhdGFMaXN0ID0gW107XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdERhdGFMaXN0LnB1c2gobGlzdEl0ZW0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghY2hlY2tDaGFuZ2VFdmVudCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGlja0l0ZW0gPSBsaXN0SXRlbTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmxpc3RDbGljay5lbWl0KHsgZGF0YTogdGhpcy5zZWxlY3REYXRhTGlzdCwgaW5kZXgsIGNoZWNrQ2hhbmdlRXZlbnQgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLm11bHRpcGxlU2VsZWN0KSB7XHJcbiAgICAgICAgICAgIGxldCBpZHMgPSB0aGlzLmRhdGEuZmlsdGVyKGl0ZW0gPT4gISFpdGVtLmNoZWNrZWQpLm1hcChpdGVtID0+IGl0ZW1bdGhpcy5saXN0aWROYW1lXSk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZU1vcmVQYWdlU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBpZHMgPSB0aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXIubWFwKGl0ZW0gPT4gaXRlbVt0aGlzLmxpc3RpZE5hbWVdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLm9uQ2hlY2tWYWx1ZXNDaGFuZ2UoaWRzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIOiOt+W+l+avj+S4gOihjGxpc3Qg5ZSv5LiA5qCH6K+GICovXHJcbiAgICBnZXRLZXkobGlzdCwgaW5kZXgpIHtcclxuICAgICAgICBpZiAodGhpcy5saXN0aWROYW1lICYmIGxpc3QuaGFzT3duUHJvcGVydHkodGhpcy5saXN0aWROYW1lKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbGlzdFt0aGlzLmxpc3RpZE5hbWVdO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbmRleDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIGNoZWNrYm9454q25oCB5Y+Y5YyWICovXHJcbiAgICBnZXRTZWxlY3QoZXZlbnQsIGNoYW5nZURhdGEsIGkpIHtcclxuICAgICAgICBjb25zdCBzdGF0ZSA9IGV2ZW50LmNoZWNrZWQ7XHJcbiAgICAgICAgdGhpcy5saXN0U2VsZWN0KHN0YXRlLCBjaGFuZ2VEYXRhLCBpLCB0cnVlKTtcclxuICAgIH1cclxuXHJcbiAgICAvKiog5o6S5bqP5LqL5Lu2ICovXHJcbiAgICBzb3J0KHNvcnRrZXlOYW1lLCBzb3J0VHlwZSA9ICdhc2MnKSB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50RGF0YS5zb3J0KHRoaXMuY29tcGFyZShzb3J0a2V5TmFtZSwgc29ydFR5cGUpKTtcclxuICAgICAgICByZXR1cm4geyBzb3J0UmVzdWx0OiB7IGxpc3RkYXRhOiB0aGlzLmN1cnJlbnREYXRhLCBzb3J0a2V5TmFtZSwgc29ydFR5cGUgfSB9O1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwdWJsaWMgc2VsZWN0Um93KHByaW1hcnlWYWx1ZTogYW55KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudERhdGEgJiYgdGhpcy5jdXJyZW50RGF0YS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJvdyA9IHRoaXMuY3VycmVudERhdGEuZmluZChpdGVtID0+IGl0ZW1bdGhpcy5saXN0aWROYW1lXSA9PT0gcHJpbWFyeVZhbHVlKTtcclxuICAgICAgICAgICAgaWYgKHJvdykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGlja0l0ZW0gPSByb3c7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcbiAgICBwcml2YXRlIGNvbXBhcmUoS2V5TmFtZSwgdHlwZSkge1xyXG4gICAgICAgIGlmICh0eXBlID09PSAnZGVzYycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChvYmoxLCBvYmoyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB2YWwxID0gb2JqMVtLZXlOYW1lXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHZhbDIgPSBvYmoyW0tleU5hbWVdO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbDIgPCB2YWwxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHZhbDIgPiB2YWwxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHR5cGUgPT09ICdhc2MnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAob2JqMSwgb2JqMikgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdmFsMSA9IG9iajFbS2V5TmFtZV07XHJcbiAgICAgICAgICAgICAgICBjb25zdCB2YWwyID0gb2JqMltLZXlOYW1lXTtcclxuICAgICAgICAgICAgICAgIGlmICh2YWwyID4gdmFsMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAxO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWwyIDwgdmFsMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7IHJldHVybiAwOyB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldEl0ZW1BY3RpdmUoaXRlbSkge1xyXG4gICAgICAgIC8vIOS4jeeuoeaYr+WQpuW8gOWQr+WkmumAie+8jOW9k+WJjeihjOWPquacieS4gOihjFxyXG4gICAgICAgIGlmICh0aGlzLmxpc3RpZE5hbWUgJiYgdGhpcy5jbGlja0l0ZW0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGl0ZW1bdGhpcy5saXN0aWROYW1lXSA9PT0gdGhpcy5jbGlja0l0ZW1bdGhpcy5saXN0aWROYW1lXTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBvblBhZ2VDaGFuZ2UocGFnZTogeyBwYWdlSW5kZXg6IG51bWJlciwgcGFnZVNpemU6IG51bWJlciB9KSB7XHJcbiAgICAgICAgaWYgKHRoaXMucGFnZUluZGV4ICE9PSBwYWdlLnBhZ2VJbmRleCkge1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2VJbmRleCA9IHBhZ2UucGFnZUluZGV4O1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2luYXRpb25PcHRpb25zLmN1cnJlbnRQYWdlID0gcGFnZS5wYWdlSW5kZXg7XHJcbiAgICAgICAgICAgIHRoaXMucGFnZUNoYW5nZWQuZW1pdCh7IHBhZ2VJbmZvOiBwYWdlIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvblBhZ2VTaXplQ2hhbmdlKHBhZ2VTaXplOiBudW1iZXIpIHtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnBhZ2VTaXplICE9PSBwYWdlU2l6ZSAmJiB0aGlzLnRvdGFsKTtcclxuICAgICAgICBpZiAodGhpcy5wYWdlU2l6ZSAhPT0gcGFnZVNpemUgJiYgdGhpcy50b3RhbCkge1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2luYXRpb25PcHRpb25zLml0ZW1zUGVyUGFnZSA9IHBhZ2VTaXplO1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2VTaXplID0gcGFnZVNpemU7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB0b3RhbCA9IHRoaXMudG90YWw7XHJcbiAgICAgICAgICAgIGxldCBwYWdlTGVuZ3RoID0gTWF0aC5mbG9vcih0b3RhbCAvIHBhZ2VTaXplKTtcclxuICAgICAgICAgICAgaWYgKHRvdGFsICUgcGFnZVNpemUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBwYWdlTGVuZ3RoICs9IDE7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChwYWdlTGVuZ3RoICYmIHRoaXMucGFnZUluZGV4ID4gcGFnZUxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYWdlSW5kZXggPSBwYWdlTGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYWdpbmF0aW9uT3B0aW9ucy5jdXJyZW50UGFnZSA9IHRoaXMucGFnZUluZGV4O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLnBhZ2VTaXplQ2hhbmdlZC5lbWl0KHsgcGFnZUluZm86IHsgcGFnZUluZGV4OiB0aGlzLnBhZ2VJbmRleCwgcGFnZVNpemUgfSB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Q3VycmVudERhdGEoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudERhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0U2VsZWN0RGF0YSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3REYXRhTGlzdDtcclxuICAgIH1cclxuICAgIC8qKiDmlK/mjIHph43mlrDorr7nva5saXN0dmlld+aVsOaNriAqL1xyXG4gICAgc2V0RGF0YShsaXN0dmlld0RhdGEpIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnREYXRhID0gbGlzdHZpZXdEYXRhO1xyXG4gICAgICAgIHRoaXMuZGF0YSA9IGxpc3R2aWV3RGF0YTtcclxuICAgICAgICB0aGlzLmRhdGFJbml0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgZGF0YUluaXQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZGF0YSAmJiB0aGlzLmRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0RGF0YUxpc3QgPSB0aGlzLmRhdGEuZmlsdGVyKChsaXN0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbGlzdFsnY2hlY2tlZCddO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuYWN0aXZlSW5kZXggPj0gMCAmJiB0aGlzLmFjdGl2ZUluZGV4IDw9ICh0aGlzLmRhdGEubGVuZ3RoIC0gMSkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGFJdGVtID0gdGhpcy5kYXRhW3RoaXMuYWN0aXZlSW5kZXhdO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGFJdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGlja0l0ZW0gPSBkYXRhSXRlbTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdERhdGFMaXN0LnB1c2godGhpcy5jbGlja0l0ZW0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYWN0aXZlSW5kZXggPCAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc2VsZWN0RGF0YUxpc3QubGVuZ3RoICYmICF0aGlzLm11bHRpcGxlU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdC5wdXNoKHRoaXMuZGF0YVswXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsaWNrSXRlbSA9IHRoaXMuZGF0YVswXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy51cGRhdGVEYXRhTGlzdEZvck1vcmVQYWdlcigpO1xyXG5cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuY2RyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB1cGRhdGVEYXRhTGlzdEZvck1vcmVQYWdlcihhY3RpdmU6ICdyZW1vdmUnfCdhcHBlbmQnfCcnID0gJycsIGxpc3RJdGVtPzogYW55LCBlbWl0ID0gdHJ1ZSkge1xyXG4gICAgICAgIGlmICh0aGlzLm11bHRpcGxlU2VsZWN0ICYmIHRoaXMuZW5hYmxlTW9yZVBhZ2VTZWxlY3QpIHtcclxuXHJcbiAgICAgICAgICAgIGlmIChhY3RpdmUgPT09ICdyZW1vdmUnICYmIGxpc3RJdGVtKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkobGlzdEl0ZW0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyID1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyLmZpbHRlcihuID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbGlzdEl0ZW0gPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5bdGhpcy5saXN0aWROYW1lXSAhPSBsaXN0SXRlbVt0aGlzLmxpc3RpZE5hbWVdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gblt0aGlzLmxpc3RpZE5hbWVdICE9IGxpc3RJdGVtO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyID1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyLmZpbHRlcihuID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsaXN0SXRlbS5pbmRleE9mKGEgPT4gYVt0aGlzLmxpc3RpZE5hbWVdID09PSBuW3RoaXMubGlzdGlkTmFtZV0pID09PSAtMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGVtaXQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrSXRlbXNDaGFuZ2UuZW1pdCh7aXRlbXM6IFsuLi50aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXJdLCBpbnN0YW5jZTogdGhpc30pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfSBlbHNlIGlmIChhY3RpdmUgPT09ICdhcHBlbmQnKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkobGlzdEl0ZW0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyID0gWy4uLnRoaXMuc2VsZWN0RGF0YUxpc3RXaXRoT3RoZXJQYWdlciwgbGlzdEl0ZW1dO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXIgPSBbLi4udGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyLCAuLi5saXN0SXRlbV07XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGVtaXQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrSXRlbXNDaGFuZ2UuZW1pdCh7aXRlbXM6IFsuLi50aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXJdLCBpbnN0YW5jZTogdGhpc30pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXIubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyID0gWy4uLnRoaXMuc2VsZWN0RGF0YUxpc3RdO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3Q2hlY2tlZHMgPSB0aGlzLnNhbWVCeSh0aGlzLmN1cnJlbnREYXRhLCB0aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXIsICh2KSA9PiB2W3RoaXMubGlzdGlkTmFtZV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdDaGVja2VkcyAmJiBuZXdDaGVja2Vkcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBuZXdDaGVja2Vkcy5pbmNsdWRlcyhpdGVtW3RoaXMubGlzdGlkTmFtZV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIOWFqOmAiSAqL1xyXG4gICAgbGlzdENoZWNrQWxsKCkge1xyXG4gICAgICAgIGlmICh0aGlzLm11bHRpcGxlU2VsZWN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudERhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdERhdGFMaXN0ID0gdGhpcy5jdXJyZW50RGF0YS5maWx0ZXIoKGxpc3QpID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBsaXN0WydjaGVja2VkJ107XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy51cGRhdGVEYXRhTGlzdEZvck1vcmVQYWdlcignYXBwZW5kJywgdGhpcy5jdXJyZW50RGF0YSk7XHJcbiAgICAgICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKiDlj5bmtojlhajpgIkgKi9cclxuICAgIGxpc3RDaGVja0FsbENhbmNlbCgpIHtcclxuICAgICAgICBpZiAodGhpcy5tdWx0aXBsZVNlbGVjdCkge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnREYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0RGF0YUxpc3QgPSBbXTtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVEYXRhTGlzdEZvck1vcmVQYWdlcigncmVtb3ZlJywgdGhpcy5jdXJyZW50RGF0YSk7XHJcbiAgICAgICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Yu+6YCJ6KGMXHJcbiAgICAgKiBAcGFyYW0gaWRzIGlkc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgY2hlY2tSb3dzKGlkczogYW55W10pOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5tdWx0aXBsZVNlbGVjdCkge1xyXG4gICAgICAgICAgICBpZiAoIWlkcyB8fCBpZHMubGVuZ3RoIDwgMSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0Q2hlY2tBbGxDYW5jZWwoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmRhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChpZHMuaW5jbHVkZXMoaXRlbVt0aGlzLmxpc3RpZE5hbWVdKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIHRoaXMub25DaGVja1ZhbHVlc0NoYW5nZShpZHMpO1xyXG4gICAgICAgICAgICB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBvbkNoZWNrVmFsdWVzQ2hhbmdlKGlkczogYW55W10pIHtcclxuICAgICAgICB0aGlzLmNoZWNrVmFsdWVzQ2hhbmdlLmVtaXQoaWRzKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGRpZmZlcmVuY2VCeSA9IChhLCBiLCBmbikgPT4ge1xyXG4gICAgICAgIGNvbnN0IHMgPSBuZXcgU2V0KGIubWFwKGZuKSk7XHJcbiAgICAgICAgcmV0dXJuIGEubWFwKGZuKS5maWx0ZXIoZWwgPT4gIXMuaGFzKGVsKSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzYW1lQnkgPSAoYSwgYiwgZm4pID0+IHtcclxuICAgICAgICBjb25zdCBzID0gbmV3IFNldChiLm1hcChmbikpO1xyXG4gICAgICAgIHJldHVybiBhLm1hcChmbikuZmlsdGVyKGVsID0+IHMuaGFzKGVsKSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIG9uTW91c2VFbnRlcigkZXZlbnQpIHtcclxuICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG4gICAgICAgIHRoaXMubW91c2VJblNlbGVjdGVkTGlzdCA9IHRydWU7XHJcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0RGF0YUxpc3RXaXRoT3RoZXJQYWdlciAmJiB0aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXIubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMub3BlblNlbGVjdGVkTGlzdCA9ICF0aGlzLm9wZW5TZWxlY3RlZExpc3Q7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5vcGVuU2VsZWN0ZWRMaXN0ID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBjbG9zZVNlbGVjdGVkTGlzdCgpIHtcclxuICAgICAgICB0aGlzLm9wZW5TZWxlY3RlZExpc3QgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm1vdXNlSW5TZWxlY3RlZExpc3QgPSBmYWxzZTtcclxuICAgICAgICBpZiAoIXRoaXMuY2RyWydkZXN0cm95ZWQnXSkge1xyXG4gICAgICAgICAgICB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uRGVsU2VsZWN0ZWRJdGVtKGlkOiBhbnkpIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnREYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChpdGVtW3RoaXMubGlzdGlkTmFtZV0gPT0gaWQpIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuc2VsZWN0RGF0YUxpc3QgPSB0aGlzLnNlbGVjdERhdGFMaXN0LmZpbHRlcihuID0+IG5bdGhpcy5saXN0aWROYW1lXSAhPSBpZCk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVEYXRhTGlzdEZvck1vcmVQYWdlcigncmVtb3ZlJywgaWQpO1xyXG5cclxuICAgICAgICB0aGlzLnVwZGF0ZUNoZWNrZWRWYWx1ZXMoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgb25DbGVhclNlbGVjdGVkKCRldmVudCkge1xyXG4gICAgICAgIC8vIHRoaXMuY2xlYXJTZWxlY3RlZEl0ZW0uZW1pdCgpO1xyXG4gICAgICAgIHRoaXMuY2xvc2VTZWxlY3RlZExpc3QoKTtcclxuICAgICAgICB0aGlzLmxpc3RDaGVja0FsbENhbmNlbCgpO1xyXG5cclxuICAgICAgICB0aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXIgPSBbXTtcclxuICAgICAgICB0aGlzLmNoZWNrVmFsdWVzID0gW107XHJcbiAgICAgICAgdGhpcy5vbkNoZWNrVmFsdWVzQ2hhbmdlKFtdKTtcclxuICAgIH1cclxuXHJcbiAgICBvblNlbGVjdExpc3RQYW5lbENsb3NlKCRldmVudCkge1xyXG4gICAgICAgIHRoaXMuY2xvc2VTZWxlY3RlZExpc3QoKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZUNoZWNrZWRWYWx1ZXMoZW1pdCA9IHRydWUpIHtcclxuICAgICAgICBpZiAodGhpcy5tdWx0aXBsZVNlbGVjdCkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZW5hYmxlTW9yZVBhZ2VTZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tWYWx1ZXMgPSB0aGlzLnNlbGVjdERhdGFMaXN0Lm1hcChuID0+IG5bdGhpcy5saXN0aWROYW1lXSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrVmFsdWVzID0gdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyLm1hcChuID0+IG5bdGhpcy5saXN0aWROYW1lXSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChlbWl0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uQ2hlY2tWYWx1ZXNDaGFuZ2UodGhpcy5jaGVja1ZhbHVlcyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrSXRlbXNDaGFuZ2UuZW1pdCh7IGl0ZW1zOiB0aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXIsIGluc3RhbmNlOiB0aGlzIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyQ2hlY2tlZHMoY2xlYXJBbGwgPSB0cnVlLCBlbWl0ID0gdHJ1ZSkge1xyXG4gICAgICAgIGlmICh0aGlzLm11bHRpcGxlU2VsZWN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudERhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdCA9IFtdO1xyXG5cclxuICAgICAgICAgICAgaWYgKGNsZWFyQWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXIgPSBbXTtcclxuICAgICAgICAgICAgfSBlbHNlICB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZURhdGFMaXN0Rm9yTW9yZVBhZ2VyKCdyZW1vdmUnLCB0aGlzLmN1cnJlbnREYXRhKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGVtaXQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQ2hlY2tlZFZhbHVlcyhlbWl0KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5jZHIubWFya0ZvckNoZWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX3NldEl0ZW1zQ2hlY2tlZFN0YXR1cyggaWRzOiBhbnksIGNoZWNrZWQ6IGJvb2xlYW4sIGVtaXQ6IGJvb2xlYW4pIHtcclxuICAgICAgICBpZiAoaWRzICYmIGlkcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgY29uc3QgYWN0aW9uID0gY2hlY2tlZCA/ICdhcHBlbmQnOiAncmVtb3ZlJztcclxuICAgICAgICAgICAgaWRzLmZvckVhY2goaSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgaWQgPSBpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBpID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkID0gaVt0aGlzLmxpc3RpZE5hbWVdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLmRhdGEuZmluZChuID0+IG5bdGhpcy5saXN0aWROYW1lXSA9PT0gaWQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBjaGVja2VkO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChjaGVja2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVEYXRhTGlzdEZvck1vcmVQYWdlcignYXBwZW5kJywgaSwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZURhdGFMaXN0Rm9yTW9yZVBhZ2VyKCdyZW1vdmUnLCBpZCwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ2hlY2tlZFZhbHVlcyhlbWl0KTtcclxuICAgICAgICAgICAgdGhpcy5jZHIubWFya0ZvckNoZWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHVuQ2hlY2tJdGVtcyhpZHM6IG51bWJlcltdIHwgc3RyaW5nW10gfCBvYmplY3RbXSwgZW1pdCA9IGZhbHNlKSB7XHJcbiAgICAgICAgdGhpcy5fc2V0SXRlbXNDaGVja2VkU3RhdHVzKGlkcywgZmFsc2UsIGVtaXQpO1xyXG4gICAgfVxyXG5cclxuICAgIGNoZWNrZWRJdGVtcyhpZHM6IG9iamVjdFtdLCBlbWl0ID0gZmFsc2UpIHtcclxuICAgICAgICB0aGlzLl9zZXRJdGVtc0NoZWNrZWRTdGF0dXMoaWRzLCB0cnVlLCBlbWl0KTtcclxuICAgIH1cclxuXHJcbn1cclxuXHJcblxyXG5cclxuIl19