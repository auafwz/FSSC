/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, ViewChild, ElementRef, Renderer2, NgZone, Output, EventEmitter, ChangeDetectorRef, Injector } from '@angular/core';
import { of } from 'rxjs';
import { HttpClient } from '@angular/common/http';
import { LocaleService } from '@farris/ui-locale';
export class DiscussionPersonnelComponent {
    /**
     * @param {?} renderer
     * @param {?} elementRef
     * @param {?} ngZone
     * @param {?} http
     * @param {?} cd
     * @param {?} injector
     */
    constructor(renderer, elementRef, ngZone, http, cd, injector) {
        this.renderer = renderer;
        this.elementRef = elementRef;
        this.ngZone = ngZone;
        this.http = http;
        this.cd = cd;
        this.injector = injector;
        // 操作列表或者分组所需要的主键字段
        this.listIdField = "id";
        // 列表中显示的字段
        this.listDisplayText = "userName";
        // 新建还是维护自定义角色
        // @Output() customGroupChange = new EventEmitter<any>();
        // 对外暴露数据
        this.selectionsChange = new EventEmitter();
        // 选中的行
        this.lineDataChange = new EventEmitter();
        this.openDialog = new EventEmitter();
        this.ougUsers = new EventEmitter();
        // 右侧项
        this.selections = [];
        this.selectedSections = [];
        this.selectedUsers = [];
        // 最重要显示的人员信息
        this.finalText = '';
        this.sectionDataTree = [];
        this.sectionDataTiled = [];
        this.currentSectionData = [];
        this.currentSection = {};
        this.currentSectionPerson = {};
        this.currentSectionId = '';
        this.sectionCrumbs = [];
        this.pageSize = 20;
        this.showSearchList = false;
        this.crumbsEllipsis = false;
        this.searchUserList = {};
        this.selectEmployee = "选择员工";
        this.placeholder = "请输入员工姓名搜索";
        this.allOrg = "全部组织";
        this.groupIcon = '<span class="f-icon f-icon-search"></span>';
        this.localeService = this.injector.get(LocaleService);
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        // let sectionDataTrees = this.initsectionData(this.sectionData,'');
        this.allOrg = this.localeService.getValue('discussionGroup.allOrg');
        /** @type {?} */
        let sectionDataTrees = this.initSectionData(this.sectionData, '');
        // this.sectionSort(sectionDataTrees);
        // if(sectionDataTrees.length>1){
        /** @type {?} */
        let sectionParent = [
            {
                data: {
                    id: 'discussionParent',
                    code: 'parent',
                    name: this.allOrg,
                    layer: 0,
                    parentId: "",
                    sortOrder: 1,
                    path: "",
                },
                children: [],
                personnels: {
                    count: 0,
                    pageCount: 0,
                    pageIndex: 1,
                    pageSize: 0,
                    totalCount: 0,
                    users: []
                },
                parent: null,
                parents: [],
                parentsArr: [],
                checked: false
            }
        ];
        sectionParent[0].children = sectionDataTrees;
        sectionParent[0].children.sort((/**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        (a, b) => a.data['sortOrder'] - b.data['sortOrder']));
        this.initSectionTree(sectionParent[0].children);
        this.sectionDataTree = sectionParent;
        // }
        // else{
        //     this.sectionDataTree = sectionDataTrees;
        // }
        //console.log(this.sectionDataTree);
        if (this.sectionDataTree && this.sectionDataTree.length) {
            this.sectionDataTiled = this.tileSectionData(this.sectionDataTree);
        }
        //console.log(this.sectionDataTiled);
        this.currentSection = this.sectionDataTree[0];
        this.sectionCrumbs = this.sectionDataTree[0].children.length ? this.sectionDataTree[0].children[0]['parentsArr'] : [];
        this.currentSectionData = this.sectionDataTree[0].children.length ? this.sectionDataTree[0].children : [];
        this.currentSectionId = this.sectionDataTree[0].data.id;
        this.getPersonnel(this.currentSectionId, 0).subscribe((/**
         * @param {?} d
         * @return {?}
         */
        (d) => {
            if (d.hasOwnProperty("users")) {
                this.sectionDataTree[0].personnels = d;
                this.currentSectionPerson = this.sectionDataTree[0].personnels;
                // console.log('cur',this.currentSectionPerson);
            }
        }));
        this.selectEmployee = this.localeService.getValue('discussionGroup.selectEmployee');
        this.placeholder = this.localeService.getValue('discussionGroup.placeholder');
        // console.log(this.sectionDataTiled);
    }
    /**
     * @param {?} data
     * @param {?=} parentId
     * @param {?=} parentName
     * @return {?}
     */
    initSectionTree(data, parentId = "discussionParent", parentName = this.allOrg) {
        if (data && data.length) {
            data.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                /** @type {?} */
                let par = {
                    id: parentId,
                    name: parentName
                };
                item.parentsArr.unshift(par);
                item.parents.unshift(parentId);
                if (item.children.length) {
                    this.initSectionTree(item.children);
                }
            }));
        }
    }
    /**
     * 初始化分组数据
     * @param {?} data
     * @param {?} parentId
     * @param {?=} parentIdField
     * @param {?=} idField
     * @return {?}
     */
    initSectionData(data, parentId, parentIdField = 'parentId', idField = 'id') {
        /** @type {?} */
        const nodes = new Map();
        /** @type {?} */
        const result = [];
        /** @type {?} */
        const unattached = [];
        if (data && data.length) {
            data.forEach((/**
             * @param {?} t
             * @return {?}
             */
            t => {
                /** @type {?} */
                const node = {
                    data: t,
                    children: [],
                    personnels: {},
                    parent: null,
                    parents: [],
                    parentsArr: [],
                    checked: false
                };
                /** @type {?} */
                const id = t[idField];
                nodes.set(id, node);
                /** @type {?} */
                const PID = t[parentIdField];
                if (PID === parentId || PID === null) {
                    result.push(node);
                }
                else {
                    /** @type {?} */
                    const parent = nodes.get(PID);
                    // console.log(parent);
                    if (parent) {
                        /** @type {?} */
                        let par = {
                            id: PID,
                            name: parent.data.name
                        };
                        node['parent'] = PID;
                        node['parents'] = [...parent.parents, PID];
                        node['parentsArr'] = [...parent.parentsArr, par];
                        parent.children.push(node);
                        parent.children.sort((/**
                         * @param {?} a
                         * @param {?} b
                         * @return {?}
                         */
                        (a, b) => a.data['sortOrder'] - b.data['sortOrder']));
                    }
                    else {
                        unattached.push(node);
                    }
                }
            }));
            if (unattached.length) {
                unattached.forEach((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => {
                    /** @type {?} */
                    const pid = n.data[parentIdField];
                    /** @type {?} */
                    const parent = nodes.get(pid);
                    if (parent) {
                        parent.children.push(n);
                        parent.children.sort((/**
                         * @param {?} a
                         * @param {?} b
                         * @return {?}
                         */
                        (a, b) => a.data['sortOrder'] - b.data['sortOrder']));
                    }
                }));
            }
        }
        return result;
    }
    /**
     * @param {?} nodes
     * @return {?}
     */
    tileSectionData(nodes) {
        /** @type {?} */
        let r = [];
        this.getAllNodes(nodes, r);
        return r;
    }
    /**
     * @param {?} nodes
     * @param {?} r
     * @return {?}
     */
    getAllNodes(nodes, r) {
        nodes.forEach((/**
         * @param {?} n
         * @return {?}
         */
        n => {
            r.push(n);
            if (n.children.length) {
                this.getAllNodes(n.children, r);
            }
        }));
    }
    /**
     * 点击下级
     * @param {?} section
     * @return {?}
     */
    sectionNext(section) {
        if (JSON.stringify(section.personnels) === '{}' && !section.hasOwnProperty('noPersonnel')) {
            section.personnels = {
                count: 0,
                pageCount: 0,
                pageIndex: 1,
                pageSize: 0,
                totalCount: 0,
                users: []
            };
            this.getPersonnel(section.data.id, 0).subscribe((/**
             * @param {?} d
             * @return {?}
             */
            (d) => {
                if (d.hasOwnProperty("users")) {
                    section.personnels.count = d['count'];
                    section.personnels.pageCount = d['pageCount'];
                    section.personnels.pageIndex = d['pageIndex'];
                    section.personnels.pageSize = d['pageSize'];
                    section.personnels.totalCount = d['totalCount'];
                    section.personnels['users'] = [...section.personnels['users'], ...d['users']];
                }
                else {
                    section['noPersonnel'] = true;
                }
                this.getNextData(section);
            }));
        }
        else {
            this.getNextData(section);
        }
    }
    /**
     * 获取下级数据
     * @param {?} section
     * @return {?}
     */
    getNextData(section) {
        if ((section.children && section.children.length) || (JSON.stringify(section.personnels) !== '{}')) {
            /** @type {?} */
            const sec = this.getSectionById(section.data.id);
            if (sec) {
                /** @type {?} */
                let secChecked = sec['checked'];
                sec['disabled'] = secChecked ? true : false;
                if (!sec['indeterminate']) {
                    if (sec.children && sec.children.length) {
                        sec.children.forEach((/**
                         * @param {?} item
                         * @return {?}
                         */
                        item => {
                            item['checked'] = secChecked;
                            item['indeterminate'] = false;
                            // item['disabled'] = sec['disabled'];
                        }));
                    }
                    ;
                    if (section.personnels['users'] && section.personnels['users'].length) {
                        section.personnels['users'].forEach((/**
                         * @param {?} user
                         * @return {?}
                         */
                        user => {
                            user['checked'] = secChecked;
                            user['indeterminate'] = false;
                            // user['disabled'] = sec['disabled'];
                        }));
                    }
                }
            }
            /** @type {?} */
            let secParent = {
                id: sec.data.id,
                name: sec.data.name
            };
            /** @type {?} */
            let secCrumbs = [...sec['parentsArr'], secParent];
            this.sectionCrumbs = sec.children.length ? sec.children[0]['parentsArr'] : secCrumbs;
            this.currentSectionData = sec.children.length ? sec.children : [];
            this.currentSection = sec;
            this.currentSectionId = sec.data.id;
            this.currentSectionPerson = sec.personnels;
            setTimeout((/**
             * @return {?}
             */
            () => {
                this.initCrumbsList();
            }), 0);
            // console.log(this.currentSection);
            this.cd.detectChanges();
        }
        else {
            this.currentSectionPerson = [];
        }
    }
    /**
     * @param {?} ougId
     * @param {?} pageIndex
     * @param {?=} pageSize
     * @return {?}
     */
    getPersonnel(ougId, pageIndex, pageSize = this.pageSize) {
        // let data = {};
        if (this.orgUrl) {
            /** @type {?} */
            const url = `${this.orgUrl}?orgId=${ougId}&pageSize=${pageSize}&pageIndex=${pageIndex}`;
            return this.http.get(url);
            // if(ougId == 'langchao'){
            //     return this.http.get('assets/data/discussionPerson.json');
            // }
            // else if(ougId == 'guoji'){
            //     return this.http.get('assets/data/discussionPerson2.json');
            // }
            // else if(ougId == 'yanfa'){
            //     return this.http.get('assets/data/discussionPerson3.json');
            // }
            // else{
            //     return of(true);
            // }
        }
        else {
            return of(true);
        }
        // return data;
    }
    /**
     * @param {?} id
     * @return {?}
     */
    getSectionById(id) {
        /** @type {?} */
        let section = this.sectionDataTiled.find((/**
         * @param {?} sec
         * @return {?}
         */
        sec => {
            return sec.data.id == id;
        }));
        return section;
    }
    /**
     * 点击面包屑
     * @param {?} crumbs
     * @return {?}
     */
    crumbsClick(crumbs) {
        if (crumbs.id == this.currentSectionId)
            return;
        /** @type {?} */
        const sec = this.getSectionById(crumbs.id);
        this.sectionCrumbs = sec.children.length ? sec.children[0]['parentsArr'] : [];
        this.currentSectionData = sec.children.length ? sec.children : [];
        this.currentSectionId = sec.data.id;
        this.currentSectionPerson = sec.personnels;
        this.currentSection = sec;
        setTimeout((/**
         * @return {?}
         */
        () => {
            this.initCrumbsList();
        }), 0);
    }
    /**
     * 部门或人员状态变化
     * @param {?} event
     * @param {?} section
     * @param {?} type
     * @return {?}
     */
    handleClick(event, section, type) {
        if (this.currentSection.disabled)
            return;
        event.stopPropagation();
        section.checked = !section.checked;
        section['indeterminate'] = false;
        this.setSectionDataChecked();
        if (section.checked) {
            /** @type {?} */
            let selectedData = {
                parent: this.currentSection,
                data: section
            };
            if (type == 'user') {
                if (this._isSelectedInArray(section[this.listIdField], this.listIdField, this.selectedUsers)) {
                    return;
                }
                else {
                    this.selectedUsers.push(selectedData);
                }
            }
            else if (type == 'section') {
                this.addSection(section);
            }
        }
        else {
            if (type == 'user') {
                if (this._isSelectedInArray(section[this.listIdField], this.listIdField, this.selectedUsers)) {
                    this.selectedUsers.forEach((/**
                     * @param {?} item
                     * @param {?} index
                     * @return {?}
                     */
                    (item, index) => {
                        if (item['data'][this.listIdField] === section[this.listIdField]) {
                            this.selectedUsers.splice(index, 1);
                        }
                    }));
                }
            }
            else if (type == 'section') {
                this.removeSection(section);
            }
        }
        // console.log(this.selectedUsers,this.selectedSections);
    }
    /**
     * @param {?} event
     * @param {?} user
     * @return {?}
     */
    handleSearchClick(event, user) {
        event.stopPropagation();
        user.checked = !user.checked;
        if (user.checked) {
            if (this._isSelectedInArray(user[this.listIdField], this.listIdField, this.selectedUsers)) {
                return;
            }
            else {
                /** @type {?} */
                let selectedData = {
                    parent: null,
                    data: user
                };
                this.selectedUsers.push(selectedData);
            }
        }
        else {
            if (this._isSelectedInArray(user[this.listIdField], this.listIdField, this.selectedUsers)) {
                this.selectedUsers.forEach((/**
                 * @param {?} item
                 * @param {?} index
                 * @return {?}
                 */
                (item, index) => {
                    if (item['data'][this.listIdField] === user[this.listIdField]) {
                        this.selectedUsers.splice(index, 1);
                    }
                }));
            }
        }
    }
    /**
     * @return {?}
     */
    setSectionDataChecked() {
        /** @type {?} */
        let curChecked = false;
        /** @type {?} */
        let sec = this.currentSection;
        /** @type {?} */
        let secArray = [];
        if (sec.children || (sec.personnels['users'] && sec.personnels['users'].length)) {
            secArray = secArray.concat(sec.children, sec.personnels['users']);
            /** @type {?} */
            let secCheckedList = secArray.filter((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                if (item.hasOwnProperty('checked') && item['checked']) {
                    return item;
                }
            }));
            /** @type {?} */
            let secIndeList = sec.children.filter((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                if (item.hasOwnProperty('indeterminate') && item['indeterminate']) {
                    return item;
                }
            }));
            this.currentSection['indeterminate'] = (secIndeList && secIndeList.length) ? true : false;
            if (secCheckedList && secCheckedList.length) {
                if (secCheckedList.length == secArray.length && sec.personnels.pageIndex >= sec.personnels.pageCount - 1) {
                    curChecked = true;
                }
                else {
                    this.currentSection['indeterminate'] = true;
                }
            }
            else {
                curChecked = false;
            }
            this.currentSection['checked'] = curChecked;
            // console.log(this.currentSection);
        }
        if (this.currentSection.parents.length > 0 && this.currentSection['indeterminate']) {
            this.currentSection.parents.forEach((/**
             * @param {?} par
             * @return {?}
             */
            par => {
                /** @type {?} */
                const parSec = this.getSectionById(par);
                if (parSec) {
                    parSec['indeterminate'] = this.currentSection['indeterminate'];
                }
            }));
        }
    }
    /**
     * @param {?=} status
     * @return {?}
     */
    setChildDisabledStatus(status = true) {
        /** @type {?} */
        let sec = this.currentSection;
        // sec['disabled'] = status;
        if (sec.children || (sec.personnels['users'] && sec.personnels['users'].length)) {
            sec.children.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                item['disabled'] = status;
            }));
            // sec['childDisabled'] = status;
            sec.personnels['users'].forEach((/**
             * @param {?} user
             * @return {?}
             */
            user => {
                user['disabled'] = status;
            }));
        }
    }
    /**
     * 人员查看更多
     * @return {?}
     */
    getMoreData() {
        if (this.currentSectionId) {
            /** @type {?} */
            const sec = this.getSectionById(this.currentSectionId);
            if (sec) {
                this.getPersonnel(this.currentSectionId, sec.personnels.pageIndex + 1).subscribe((/**
                 * @param {?} d
                 * @return {?}
                 */
                (d) => {
                    if (d.hasOwnProperty("users")) {
                        sec.personnels.pageIndex = d['pageIndex'];
                        sec.personnels['users'] = [...sec.personnels['users'], ...d['users']];
                        if (sec.personnels['users'].length) {
                            if (sec['checked']) {
                                sec.personnels['users'].forEach((/**
                                 * @param {?} user
                                 * @return {?}
                                 */
                                user => {
                                    user['checked'] = sec['checked'];
                                }));
                            }
                        }
                        // this.setSectionDataChecked();
                    }
                    this.cd.detectChanges();
                }));
            }
        }
    }
    /**
     * 全选
     * @param {?} event
     * @return {?}
     */
    handleClickAll(event) {
        if (this.currentSection.disabled)
            return;
        if (this.currentSection) {
            this.currentSection['checked'] = !this.currentSection['checked'];
            this.currentSection['indeterminate'] = false;
            /** @type {?} */
            let curChecked = this.currentSection['checked'];
            this.currentSection.children.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                item['checked'] = curChecked;
            }));
            if (JSON.stringify(this.currentSection.personnels) != '{}' && this.currentSection['personnels']['users'].length) {
                this.currentSection['personnels']['users'].forEach((/**
                 * @param {?} user
                 * @return {?}
                 */
                user => {
                    user['checked'] = curChecked;
                }));
            }
            if (curChecked) {
                this.addSection(this.currentSection);
            }
            else {
                this.removeSection(this.currentSection);
            }
        }
    }
    /**
     * @param {?} section
     * @return {?}
     */
    addSection(section) {
        if (this._isSelectedInArray(section['data'][this.listIdField], this.listIdField, this.selectedSections)) {
            return;
        }
        else {
            this.selectedSections.push(section);
        }
    }
    /**
     * @param {?} section
     * @return {?}
     */
    removeSection(section) {
        if (this._isSelectedInArray(section['data'][this.listIdField], this.listIdField, this.selectedSections)) {
            this.selectedSections.forEach((/**
             * @param {?} item
             * @param {?} index
             * @return {?}
             */
            (item, index) => {
                if (item['data'][this.listIdField] === section['data'][this.listIdField]) {
                    this.selectedSections.splice(index, 1);
                }
            }));
        }
    }
    /**
     * 搜索用户
     * @return {?}
     */
    searchUser() {
        if (this.searchText) {
            this.showSearchList = true;
            this.getSearchData(this.searchText, 0).subscribe((/**
             * @param {?} d
             * @return {?}
             */
            d => {
                if (d.hasOwnProperty("users")) {
                    this.searchUserList = d;
                }
            }));
        }
        else {
            this.showSearchList = false;
        }
    }
    /**
     * 搜索人员查看更多
     * @return {?}
     */
    getMoreSearchData() {
        if (this.searchText && this.personSearchUrl) {
            this.getSearchData(this.searchText, this.searchUserList.pageIndex + 1).subscribe((/**
             * @param {?} d
             * @return {?}
             */
            d => {
                if (d.hasOwnProperty("users")) {
                    this.searchUserList.pageIndex = d['pageIndex'];
                    this.searchUserList['users'] = [...this.searchUserList['users'], ...d['users']];
                }
            }));
        }
    }
    /**
     * @param {?} text
     * @param {?} pageIndex
     * @param {?=} pageSize
     * @return {?}
     */
    getSearchData(text, pageIndex, pageSize = this.pageSize) {
        if (this.personSearchUrl) {
            /** @type {?} */
            const url = `${this.personSearchUrl}?param=${text}&pageSize=${pageSize}&pageIndex=${pageIndex}`;
            return this.http.get(url);
            //return this.http.get('assets/data/discussionPerson3.json');
        }
        else {
            return of(true);
        }
    }
    /**
     * 选中人员或组织删除
     * @param {?} data
     * @param {?} type
     * @return {?}
     */
    selectionRemove(data, type) {
        if (!data)
            return;
        if (type == 'user') {
            /** @type {?} */
            let index = this.selectedUsers.findIndex((/**
             * @param {?} user
             * @return {?}
             */
            user => {
                return user.data.id == data.data.id;
            }));
            if (index >= 0) {
                this.selectedUsers.splice(index, 1);
            }
            data.data['checked'] = false;
        }
        else if (type == 'section') {
            /** @type {?} */
            let index = this.selectedSections.findIndex((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                return item.data.id == data.data.id;
            }));
            if (index >= 0) {
                this.selectedSections.splice(index, 1);
            }
            data['checked'] = false;
        }
        /** @type {?} */
        let dataParent = null;
        if (type == 'section') {
            dataParent = this.getSectionById(data.parent);
        }
        else if (type == 'user') {
            dataParent = this.getSectionById(data.parent.data.id);
        }
        if (dataParent) {
            dataParent['checked'] = false;
            if ((dataParent.children && dataParent.children.length) || (dataParent.personnels.users && dataParent.personnels.users.length)) {
                /** @type {?} */
                let childrens = dataParent.children.filter((/**
                 * @param {?} child
                 * @return {?}
                 */
                child => {
                    return child['checked'];
                }));
                /** @type {?} */
                let users = dataParent.personnels.users.filter((/**
                 * @param {?} user
                 * @return {?}
                 */
                user => {
                    return user['checked'];
                }));
                if ((childrens && childrens.length) || (users && users.length)) {
                    dataParent['indeterminate'] = true;
                }
                else {
                    dataParent['indeterminate'] = false;
                }
                if (dataParent.parents.length > 0) {
                    dataParent.parents.forEach((/**
                     * @param {?} par
                     * @return {?}
                     */
                    par => {
                        /** @type {?} */
                        const parSec = this.getSectionById(par);
                        if ((parSec.children && parSec.children.length) || (parSec.personnels.users && parSec.personnels.users.length)) {
                            /** @type {?} */
                            let parchildrens = parSec.children.filter((/**
                             * @param {?} child
                             * @return {?}
                             */
                            child => {
                                return child['checked'];
                            }));
                            /** @type {?} */
                            let parusers = parSec.personnels.users.filter((/**
                             * @param {?} user
                             * @return {?}
                             */
                            user => {
                                return user['checked'];
                            }));
                            if ((parchildrens && parchildrens.length) || (parusers && parusers.length)) {
                                parSec['indeterminate'] = true;
                            }
                            else {
                                if (dataParent['indeterminate']) {
                                    parSec['indeterminate'] = dataParent['indeterminate'];
                                }
                                else {
                                    parSec['indeterminate'] = false;
                                }
                            }
                        }
                    }));
                }
            }
        }
    }
    /**
     * 删除右侧全部数据
     * @return {?}
     */
    moveAllToLeft() {
        this.selectedUsers.forEach((/**
         * @param {?} user
         * @return {?}
         */
        user => {
            user.data['checked'] = false;
        }));
        this.selectedSections.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            item['checked'] = false;
        }));
        this.sectionDataTiled.forEach((/**
         * @param {?} sec
         * @return {?}
         */
        sec => {
            sec['indeterminate'] = false;
            sec['checked'] = false;
            sec['disabled'] = false;
            if (JSON.stringify(sec.personnels) != '{}' && sec['personnels']['users'].length) {
                sec['personnels']['users'].forEach((/**
                 * @param {?} user
                 * @return {?}
                 */
                user => {
                    user['checked'] = false;
                }));
            }
        }));
        this.selectedUsers = [];
        this.selectedSections = [];
        this.cd.markForCheck();
    }
    /**
     *
     * @param {?} numberType 0：取消；1：确定
     * @return {?}
     */
    returnResult(numberType) {
        this.finalText = '';
        if (numberType) {
            // console.log(this.selectedUsers,this.selectedSections);
            this.selectionsChange.emit({
                info: 'confirm',
                data: {
                    users: this.selectedUsers,
                    section: this.selectedSections
                }
            });
            // this.selections.forEach(item => {
            //     this.finalText += item[this.listDisplayText] + '；';
            // })
        }
        else {
            this.selectionsChange.emit({
                info: 'cancel',
                data: {
                    users: [],
                    section: []
                }
            });
        }
        this.moveAllToLeft();
        this.searchText = '';
        this.searchUser();
        this.personnelDialog.close();
    }
    /**
     * @return {?}
     */
    initCrumbsList() {
        /** @type {?} */
        const crumbsListWidth = this.crumbsList.nativeElement.offsetWidth - 30;
        /** @type {?} */
        const crumbsListItems = this.crumbsList.nativeElement.children;
        // console.log(crumbsListItems);
        /** @type {?} */
        let crumbsListItemWidth = 0;
        if (crumbsListItems && crumbsListItems.length) {
            for (let i = crumbsListItems.length - 1; i >= 0; i--) {
                // console.log(crumbsListItems[i]);
                this.renderer.setStyle(crumbsListItems[i], 'display', 'flex');
                /** @type {?} */
                let width = crumbsListItems[i].offsetWidth;
                crumbsListItemWidth += width;
                if (crumbsListItemWidth >= crumbsListWidth) {
                    this.renderer.setStyle(crumbsListItems[i], 'display', 'none');
                }
                else {
                    this.renderer.setStyle(crumbsListItems[i], 'display', 'flex');
                }
                // console.log(width,crumbsListItemWidth,crumbsListWidth,i);
            }
        }
        ;
        // console.log(crumbsListItemWidth,crumbsListWidth);
        if (crumbsListItemWidth >= crumbsListWidth) {
            this.crumbsEllipsis = true;
        }
        else {
            this.crumbsEllipsis = false;
        }
    }
    /**
     * @return {?}
     */
    crumbsMore() {
        if (this.sectionCrumbs && this.sectionCrumbs.length) {
            this.crumbsClick(this.sectionCrumbs[0]);
        }
    }
    /**
     * @param {?} value
     * @param {?} field
     * @param {?} array
     * @return {?}
     */
    _isInArray(value, field, array) {
        if (!field || !value) {
            throw new Error('前2个参数必填');
        }
        return array.find((/**
         * @param {?} item
         * @return {?}
         */
        item => value === item[field])) ? true : false;
    }
    /**
     * @param {?} value
     * @param {?} field
     * @param {?} array
     * @return {?}
     */
    _isSelectedInArray(value, field, array) {
        if (!field || !value) {
            throw new Error('前2个参数必填');
        }
        return array.find((/**
         * @param {?} item
         * @return {?}
         */
        item => value === item['data'][field])) ? true : false;
    }
    /**
     * @return {?}
     */
    closeDialog() {
        this.moveAllToLeft();
        this.searchText = '';
        this.searchUser();
    }
}
DiscussionPersonnelComponent.decorators = [
    { type: Component, args: [{
                selector: 'farris-discussion-personnel',
                template: "<div class=\"farris-discussion-personnel-wrapper\">\r\n    <button class=\"btn btn-link\" (click)=\"personnelDialog.show()\">{{ 'discussionGroup.advancedQuery' | locale }}</button>\r\n</div>\r\n<ng-template #buttonRef>\r\n    <button class=\"btn btn-secondary\" (click)=\"returnResult(0)\">{{ 'discussionGroup.cancel' | locale }}</button>\r\n    <button class=\"btn btn-primary\" (click)=\"returnResult(1)\">{{ 'discussionGroup.confirm' | locale }}</button>\r\n</ng-template>\r\n<farris-dialog #personnelDialog [buttons]=\"buttonRef\" [width]=\"690\" [height]=\"520\" [resizable]=\"false\" [title]=\"selectEmployee\" (closed)=\"closeDialog()\">\r\n    <div class=\"f-discussion-dialog-content\">\r\n        <div class=\"f-discussion-dialog-content-left col-6 d-flex flex-column\">\r\n            <div class=\"f-discussion-personnel-search\">\r\n                <input-group [placeholder]=\"placeholder\" [groupText]=\"groupIcon\" [(ngModel)]=\"searchText\" (valueChange)=\"searchUser()\" (enterHandle)=\"searchUser()\" (clickHandle)=\"searchUser()\"></input-group>\r\n            </div>\r\n            <div class=\"f-discussion-tab-content f-utils-fill d-flex flex-column\">\r\n                <div class=\"f-discussion-personnel-content f-utils-fill d-flex flex-column\" [ngClass]=\"{'f-discussion-personnel-content-hide': showSearchList}\">\r\n                    <div class=\"f-discussion-personnel-crumbs d-flex\">\r\n                        <ul class=\"crumbs-list d-flex\" #crumbsList [ngClass]=\"{'crumbs-list-padding': crumbsEllipsis}\" *ngIf=\"sectionCrumbs && sectionCrumbs.length\">\r\n                            <li class=\"crumbs-list-item\" *ngFor=\"let crumbs of sectionCrumbs;let first = first;let last = last;\" (click)=\"crumbsClick(crumbs)\"  \r\n                            [ngClass]=\"{'crumbs-list-item-disabled': !(first || !last)}\">\r\n                                <span class=\"crumbs-text\">{{crumbs.name}}</span>\r\n                                <span class=\"crumbs-arrow f-icon f-icon-arrow-chevron-right\" *ngIf=\"first || !last\"></span>\r\n                            </li>\r\n                        </ul>\r\n                        <div class=\"crumbs-list-ellipsis crumbs-list-item\" *ngIf=\"crumbsEllipsis\" (click)=\"crumbsMore()\">\r\n                            <span class=\"crumbs-text\">...</span>\r\n                            <span class=\"crumbs-arrow f-icon f-icon-arrow-chevron-right\"></span>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"f-discussion-section-content f-utils-fill\">\r\n                        <perfect-scrollbar>\r\n                            <ul class=\"f-discussion-section-list\">\r\n                                <!-- <li class=\"section-list-item\" *ngIf=\"currentSectionData.length || currentSectionPerson.users.length\" (click)=\"handleClickAll($event)\">\r\n                                    <div class=\"custom-control custom-checkbox  custom-control-inline section-list-item-checkbox\">\r\n                                        <input type=\"checkbox\" class=\"custom-control-input\" [checked]=\"currentSection.checked\" [disabled]=\"currentSection.disabled\" [indeterminate]=\"currentSection.indeterminate\">\r\n                                        <label class=\"custom-control-label\"></label>\r\n                                    </div>\r\n                                    <div class=\"section-list-item-name f-utils-fill\">\r\n                                        \u5168\u9009\r\n                                    </div>\r\n                                </li> -->\r\n                                <li class=\"section-list-item\" *ngFor=\"let section of currentSectionData\">\r\n                                    <div class=\"custom-control custom-checkbox custom-control-inline section-list-item-checkbox\" (click)=\"handleClick($event,section,'section')\">\r\n                                        <input type=\"checkbox\" class=\"custom-control-input\" [checked]=\"section.checked\" [indeterminate]=\"section.indeterminate\" [disabled]=\"currentSection.disabled\">\r\n                                        <label class=\"custom-control-label\"></label>\r\n                                    </div>\r\n                                    <div class=\"section-list-item-name f-utils-fill\" [title]=\"section.data.name\" (click)=\"handleClick($event,section,'section')\">\r\n                                        {{section.data.name}}\r\n                                    </div>\r\n                                    <div class=\"section-list-item-next\" (click)=\"sectionNext(section)\">\r\n                                        {{ 'discussionGroup.next' | locale }}\r\n                                    </div>\r\n                                </li>\r\n                                <ng-container *ngIf=\"currentSectionPerson\">\r\n                                    <li class=\"section-list-item person-list-item\" *ngFor=\"let person of currentSectionPerson.users\" (click)=\"handleClick($event,person,'user')\">\r\n                                        <div class=\"custom-control custom-checkbox  custom-control-inline section-list-item-checkbox\">\r\n                                            <input type=\"checkbox\" class=\"custom-control-input\" [checked]=\"person.checked\" [disabled]=\"currentSection.disabled\">\r\n                                            <label class=\"custom-control-label\"></label>\r\n                                        </div>\r\n                                        <div class=\"person-list-item-img\">\r\n                                            <img [src]=\"person.imgData\" alt=\"\" *ngIf=\"person.imgData\">\r\n                                            <div class=\"f-discussion-personnel-item-tip\" *ngIf=\"!person.imgData\" [innerHTML]=\"person | avatarHtml\"></div>\r\n                                        </div>\r\n                                        <div class=\"person-list-item-content f-utils-fill\">\r\n                                            <div class=\"section-list-item-name\" [title]=\"person.name\">\r\n                                                {{person.name}}\r\n                                            </div>\r\n                                            <div class=\"section-list-item-tip\">\r\n                                                <!-- {{person.email}} -->\r\n                                                <span *ngIf=\"sectionCrumbs.length>=2\">{{sectionCrumbs[sectionCrumbs.length - 2].name}}</span>\r\n                                                <span *ngIf=\"sectionCrumbs.length>=2\">/</span>\r\n                                                <span>{{sectionCrumbs[sectionCrumbs.length - 1].name}}</span>\r\n                                            </div>\r\n                                        </div>\r\n                                        <!-- \u4EBA\u5458\u5217\u8868 -->\r\n                                    </li>\r\n                                    <div class=\"f-discussion-person-list-page\" *ngIf=\"currentSectionPerson['users'] && currentSectionPerson['users'].length\">\r\n                                        <span class=\"section-page-more section-page-text\" *ngIf=\"currentSectionPerson.pageIndex < currentSectionPerson.pageCount-1\" (click)=\"getMoreData()\">{{ 'discussionGroup.viewMore' | locale }}</span>\r\n                                        <!-- <span class=\"section-page-end section-page-text\"  *ngIf=\"currentSectionPerson.pageIndex >= currentSectionPerson.pageCount-1\">\u52A0\u8F7D\u5B8C\u6210</span> -->\r\n                                    </div>\r\n                                </ng-container>\r\n                            </ul>\r\n                            <div class=\"f-discussion-section-list-empty\" *ngIf=\"!currentSectionData.length &&(currentSectionPerson.users && !currentSectionPerson.users.length)\">\r\n                                <span class=\"f-icon f-icon-top_my\"></span>\r\n                                <span class=\"section-list-empty-text\">{{ 'discussionGroup.emptyList' | locale }}</span>\r\n                            </div>\r\n                        </perfect-scrollbar>\r\n                    </div>\r\n                </div>\r\n                <div class=\"f-discussion-personnel-search-list f-utils-fill\" [hidden]=\"!showSearchList\">\r\n                    <perfect-scrollbar>\r\n                        <ul class=\"f-discussion-section-list\" *ngIf=\"searchUserList && searchUserList.users && searchUserList.users.length\">\r\n                            <li class=\"section-list-item person-list-item\" *ngFor=\"let user of searchUserList.users\" (click)=\"handleSearchClick($event,user)\">\r\n                                <div class=\"custom-control custom-checkbox  custom-control-inline section-list-item-checkbox\">\r\n                                    <input type=\"checkbox\" class=\"custom-control-input\" [checked]=\"user.checked\">\r\n                                    <label class=\"custom-control-label\"></label>\r\n                                </div>\r\n                                <div class=\"person-list-item-img\">\r\n                                    <img [src]=\"user.imgData\" alt=\"\" *ngIf=\"user.imgData\">\r\n                                    <div class=\"f-discussion-personnel-item-tip\" *ngIf=\"!user.imgData\" [innerHTML]=\"user | avatarHtml\"></div>\r\n                                </div>\r\n                                <div class=\"person-list-item-content f-utils-fill\">\r\n                                    <div class=\"section-list-item-name\" [title]=\"user.name\">\r\n                                        {{user.name}}\r\n                                    </div>\r\n                                    <div class=\"section-list-item-tip\">\r\n                                        <span [innerHTML]=\"user | getOrgText:sectionData\"></span>\r\n                                    </div>\r\n                                </div>\r\n                            </li>\r\n                            <div class=\"f-discussion-person-list-page\">\r\n                                <span class=\"section-page-more section-page-text\" *ngIf=\"searchUserList.pageIndex < searchUserList.pageCount-1\" (click)=\"getMoreSearchData()\">{{ 'discussionGroup.viewMore' | locale }}</span>\r\n                            </div>\r\n                        </ul>\r\n                        <div class=\"f-discussion-section-list-empty\" *ngIf=\"!searchUserList.users || !searchUserList.users.length\">\r\n                            <span class=\"f-icon f-icon-top_my\"></span>\r\n                            <span class=\"section-list-empty-text\">{{ 'discussionGroup.emptyList' | locale }}</span>\r\n                        </div>\r\n                    </perfect-scrollbar>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"f-discussion-dialog-content-right f-utils-fill d-flex flex-column\">\r\n            <div class=\"f-discussion-selected-personnel f-utils-fill d-flex flex-column\">\r\n                <div class=\"f-discussion-selected-personnel-header\">\r\n                    <div class=\"f-discussion-selected-personnel-header-text\">\r\n                        <span>{{ 'discussionGroup.selected' | locale }}</span>(<span>{{ 'discussionGroup.people' | locale }}</span><span>{{selectedUsers.length}}</span><span>{{ 'discussionGroup.per' | locale }}</span>\uFF0C<span>{{ 'discussionGroup.section' | locale }}</span><span>{{selectedSections.length}}</span><span>{{ 'discussionGroup.pcs' | locale }}</span>)\r\n                    </div>\r\n                    <div class=\"f-discussion-selected-personnel-header-btn\" (click)=\"moveAllToLeft()\">\r\n                        <button class=\"btn btn-link\">{{ 'discussionGroup.emptySelected' | locale }}</button>\r\n                    </div>\r\n                </div>\r\n                <div class=\"f-discussion-selected-personnel-content f-utils-fill d-flex flex-column\">\r\n                    <div class=\"f-discussion-selected-list f-utils-fill\">\r\n                        <perfect-scrollbar>\r\n                            <div class=\"f-discussion-selected-item\" *ngFor=\"let user of selectedUsers\">\r\n                                <div class=\"f-discussion-personnel-item-avatar\">\r\n                                    <img [src]=\"user.data.imgData\" alt=\"\" *ngIf=\"user.data.imgData\">\r\n                                    <div class=\"f-discussion-personnel-item-tip\" *ngIf=\"!user.data.imgData\" [innerHTML]=\"user.data | avatarHtml\"></div>\r\n                                </div>\r\n                                <div class=\"f-discussion-selected-item-text f-utils-fill\">\r\n                                    <div class=\"f-discussion-selected-name\">\r\n                                        {{user.data.name}}\r\n                                    </div>\r\n                                    <div class=\"f-discussion-selected-item-tip\" *ngIf=\"user.parent\">\r\n                                        <span *ngIf=\"user.parent.parentsArr.length>=1\">{{user.parent.parentsArr[user.parent.parentsArr.length - 1].name}}</span>\r\n                                            <span *ngIf=\"user.parent.parentsArr.length>=1\">/</span>\r\n                                            <span>{{user.parent.data.name}}</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"f-discussion-selected-item-remove\" (click)=\"selectionRemove(user,'user')\">\r\n                                    <span class=\"f-icon f-icon-close-outline\"></span>\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"f-discussion-selected-item\" *ngFor=\"let section of selectedSections\">\r\n                                <div class=\"f-discussion-selected-item-text f-utils-fill\">\r\n                                    <div class=\"f-discussion-selected-name\">\r\n                                        {{section.data.name}}\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"f-discussion-selected-item-remove\" (click)=\"selectionRemove(section,'section')\">\r\n                                    <span class=\"f-icon f-icon-close-outline\"></span>\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"f-discussion-section-list-empty\" *ngIf=\"!selectedUsers.length && !selectedSections.length\">\r\n                                <span class=\"f-icon f-icon-top_my\"></span>\r\n                                <span class=\"section-list-empty-text\">{{ 'discussionGroup.emptyRight' | locale }}</span>\r\n                            </div>\r\n                        </perfect-scrollbar>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</farris-dialog>\r\n",
                styles: [""]
            }] }
];
/** @nocollapse */
DiscussionPersonnelComponent.ctorParameters = () => [
    { type: Renderer2 },
    { type: ElementRef },
    { type: NgZone },
    { type: HttpClient },
    { type: ChangeDetectorRef },
    { type: Injector }
];
DiscussionPersonnelComponent.propDecorators = {
    listIdField: [{ type: Input }],
    listDisplayText: [{ type: Input }],
    sectionData: [{ type: Input }],
    orgUrl: [{ type: Input }],
    personSearchUrl: [{ type: Input }],
    personnelDialog: [{ type: ViewChild, args: ['personnelDialog',] }],
    selectionsChange: [{ type: Output }],
    lineDataChange: [{ type: Output }],
    openDialog: [{ type: Output }],
    ougUsers: [{ type: Output }],
    crumbsList: [{ type: ViewChild, args: ['crumbsList',] }]
};
if (false) {
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.listIdField;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.listDisplayText;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.sectionData;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.orgUrl;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.personSearchUrl;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.personnelDialog;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.selectionsChange;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.lineDataChange;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.openDialog;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.ougUsers;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.crumbsList;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.selections;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.selectedSections;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.selectedUsers;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.searchText;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.finalText;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.sectionDataTree;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.sectionDataTiled;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.currentSectionData;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.currentSection;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.currentSectionPerson;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.currentSectionId;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.sectionCrumbs;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.pageSize;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.showSearchList;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.crumbsEllipsis;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.searchUserList;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.selectEmployee;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.placeholder;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.allOrg;
    /**
     * @type {?}
     * @private
     */
    DiscussionPersonnelComponent.prototype.localeService;
    /** @type {?} */
    DiscussionPersonnelComponent.prototype.groupIcon;
    /**
     * @type {?}
     * @private
     */
    DiscussionPersonnelComponent.prototype.renderer;
    /**
     * @type {?}
     * @private
     */
    DiscussionPersonnelComponent.prototype.elementRef;
    /**
     * @type {?}
     * @private
     */
    DiscussionPersonnelComponent.prototype.ngZone;
    /**
     * @type {?}
     * @private
     */
    DiscussionPersonnelComponent.prototype.http;
    /**
     * @type {?}
     * @private
     */
    DiscussionPersonnelComponent.prototype.cd;
    /**
     * @type {?}
     * @private
     */
    DiscussionPersonnelComponent.prototype.injector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGlzY3Vzc2lvbi1wZXJzb25uZWwuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9kaXNjdXNzaW9uLWdyb3VwLyIsInNvdXJjZXMiOlsibGliL2Rpc2N1c3Npb24tcGVyc29ubmVsL2Rpc2N1c3Npb24tcGVyc29ubmVsLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxLQUFLLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFlLE1BQU0sRUFBRSxZQUFZLEVBQUUsaUJBQWlCLEVBQUUsUUFBUSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ25LLE9BQU8sRUFBRSxFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFFMUIsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQU9sRCxNQUFNLE9BQU8sNEJBQTRCOzs7Ozs7Ozs7SUFpRHJDLFlBQ1ksUUFBbUIsRUFDbkIsVUFBc0IsRUFDdEIsTUFBYyxFQUNkLElBQWdCLEVBQ2hCLEVBQXFCLEVBQ3JCLFFBQWtCO1FBTGxCLGFBQVEsR0FBUixRQUFRLENBQVc7UUFDbkIsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQUN0QixXQUFNLEdBQU4sTUFBTSxDQUFRO1FBQ2QsU0FBSSxHQUFKLElBQUksQ0FBWTtRQUNoQixPQUFFLEdBQUYsRUFBRSxDQUFtQjtRQUNyQixhQUFRLEdBQVIsUUFBUSxDQUFVOztRQXBEckIsZ0JBQVcsR0FBVyxJQUFJLENBQUM7O1FBRTNCLG9CQUFlLEdBQVcsVUFBVSxDQUFDOzs7O1FBU3BDLHFCQUFnQixHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7O1FBRTNDLG1CQUFjLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUN6QyxlQUFVLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUNy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REFBMEIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIFZpZXdDaGlsZCwgRWxlbWVudFJlZiwgUmVuZGVyZXIyLCBOZ1pvbmUsIEhvc3RCaW5kaW5nLCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgQ2hhbmdlRGV0ZWN0b3JSZWYsIEluamVjdG9yIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IG9mIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IFR5cGUgfSBmcm9tICcuL3R5cGUnO1xyXG5pbXBvcnQgeyBIdHRwQ2xpZW50IH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xyXG5pbXBvcnQgeyBMb2NhbGVTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1sb2NhbGUnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdmYXJyaXMtZGlzY3Vzc2lvbi1wZXJzb25uZWwnLFxyXG4gIHRlbXBsYXRlVXJsOicuL2Rpc2N1c3Npb24tcGVyc29ubmVsLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6WycuL2Rpc2N1c3Npb24tcGVyc29ubmVsLmNvbXBvbmVudC5zY3NzJ10sXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBEaXNjdXNzaW9uUGVyc29ubmVsQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgICAvLyDmk43kvZzliJfooajmiJbogIXliIbnu4TmiYDpnIDopoHnmoTkuLvplK7lrZfmrrVcclxuICAgIEBJbnB1dCgpIGxpc3RJZEZpZWxkOiBzdHJpbmcgPSBcImlkXCI7XHJcbiAgICAvLyDliJfooajkuK3mmL7npLrnmoTlrZfmrrVcclxuICAgIEBJbnB1dCgpIGxpc3REaXNwbGF5VGV4dDogc3RyaW5nID0gXCJ1c2VyTmFtZVwiO1xyXG4gICAgQElucHV0KCkgc2VjdGlvbkRhdGE6YW55W107XHJcbiAgICBASW5wdXQoKSBvcmdVcmw6c3RyaW5nO1xyXG4gICAgQElucHV0KCkgcGVyc29uU2VhcmNoVXJsOnN0cmluZztcclxuXHJcbiAgICBAVmlld0NoaWxkKCdwZXJzb25uZWxEaWFsb2cnKSBwZXJzb25uZWxEaWFsb2c7XHJcbiAgICAvLyDmlrDlu7rov5jmmK/nu7TmiqToh6rlrprkuYnop5LoibJcclxuICAgIC8vIEBPdXRwdXQoKSBjdXN0b21Hcm91cENoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gICAgLy8g5a+55aSW5pq06Zyy5pWw5o2uXHJcbiAgICBAT3V0cHV0KCkgc2VsZWN0aW9uc0NoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gICAgLy8g6YCJ5Lit55qE6KGMXHJcbiAgICBAT3V0cHV0KCkgbGluZURhdGFDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICAgIEBPdXRwdXQoKSBvcGVuRGlhbG9nID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgICBAT3V0cHV0KCkgb3VnVXNlcnMgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuXHJcbiAgICBAVmlld0NoaWxkKCdjcnVtYnNMaXN0JykgY3J1bWJzTGlzdDpFbGVtZW50UmVmO1xyXG5cclxuICAgIC8vIOWPs+S+p+mhuVxyXG4gICAgc2VsZWN0aW9uczogYW55W10gPSBbXTtcclxuICAgIHNlbGVjdGVkU2VjdGlvbnM6YW55W10gPSBbXTtcclxuICAgIHNlbGVjdGVkVXNlcnM6YW55W10gPSBbXTtcclxuICAgIC8vIOaQnOe0ouaWh+acrFxyXG4gICAgc2VhcmNoVGV4dDogc3RyaW5nXHJcbiAgICAvLyDmnIDph43opoHmmL7npLrnmoTkurrlkZjkv6Hmga9cclxuICAgIGZpbmFsVGV4dDogc3RyaW5nID0gJyc7XHJcblxyXG4gICAgc2VjdGlvbkRhdGFUcmVlOkFycmF5PGFueT4gPSBbXTtcclxuICAgIHNlY3Rpb25EYXRhVGlsZWQ6QXJyYXk8YW55PiA9IFtdO1xyXG4gICAgY3VycmVudFNlY3Rpb25EYXRhOkFycmF5PGFueT4gPSBbXTtcclxuICAgIGN1cnJlbnRTZWN0aW9uOmFueSA9IHt9O1xyXG4gICAgY3VycmVudFNlY3Rpb25QZXJzb246YW55ID0ge307XHJcbiAgICBjdXJyZW50U2VjdGlvbklkOnN0cmluZyA9ICcnO1xyXG4gICAgc2VjdGlvbkNydW1iczpBcnJheTxhbnk+ID0gW107XHJcbiAgICBwYWdlU2l6ZTpudW1iZXIgPSAyMDtcclxuXHJcbiAgICBzaG93U2VhcmNoTGlzdDpib29sZWFuID0gZmFsc2U7XHJcbiAgICBjcnVtYnNFbGxpcHNpczpib29sZWFuID0gZmFsc2U7XHJcbiAgICBzZWFyY2hVc2VyTGlzdDphbnkgPSB7fTtcclxuXHJcbiAgICBzZWxlY3RFbXBsb3llZTpzdHJpbmcgPSBcIumAieaLqeWRmOW3pVwiO1xyXG4gICAgcGxhY2Vob2xkZXI6c3RyaW5nID0gXCLor7fovpPlhaXlkZjlt6Xlp5PlkI3mkJzntKJcIjtcclxuICAgIGFsbE9yZzpzdHJpbmcgPSBcIuWFqOmDqOe7hOe7h1wiO1xyXG4gICAgcHJpdmF0ZSBsb2NhbGVTZXJ2aWNlOiBMb2NhbGVTZXJ2aWNlO1xyXG4gICAgZ3JvdXBJY29uID0gJzxzcGFuIGNsYXNzPVwiZi1pY29uIGYtaWNvbi1zZWFyY2hcIj48L3NwYW4+JztcclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyMixcclxuICAgICAgICBwcml2YXRlIGVsZW1lbnRSZWY6IEVsZW1lbnRSZWYsXHJcbiAgICAgICAgcHJpdmF0ZSBuZ1pvbmU6IE5nWm9uZSxcclxuICAgICAgICBwcml2YXRlIGh0dHA6IEh0dHBDbGllbnQsXHJcbiAgICAgICAgcHJpdmF0ZSBjZDogQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgICAgICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3JcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMubG9jYWxlU2VydmljZSA9IHRoaXMuaW5qZWN0b3IuZ2V0KExvY2FsZVNlcnZpY2UpO1xyXG4gICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCgpIHtcclxuICAgICAgICAvLyBsZXQgc2VjdGlvbkRhdGFUcmVlcyA9IHRoaXMuaW5pdHNlY3Rpb25EYXRhKHRoaXMuc2VjdGlvbkRhdGEsJycpO1xyXG4gICAgICAgIHRoaXMuYWxsT3JnID0gdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKCdkaXNjdXNzaW9uR3JvdXAuYWxsT3JnJyk7XHJcbiAgICAgICAgbGV0IHNlY3Rpb25EYXRhVHJlZXMgPSB0aGlzLmluaXRTZWN0aW9uRGF0YSh0aGlzLnNlY3Rpb25EYXRhLCcnKTtcclxuICAgICAgICAvLyB0aGlzLnNlY3Rpb25Tb3J0KHNlY3Rpb25EYXRhVHJlZXMpO1xyXG4gICAgICAgIC8vIGlmKHNlY3Rpb25EYXRhVHJlZXMubGVuZ3RoPjEpe1xyXG4gICAgICAgICAgICBsZXQgc2VjdGlvblBhcmVudCA9IFtcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOntcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6J2Rpc2N1c3Npb25QYXJlbnQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2RlOidwYXJlbnQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0aGlzLmFsbE9yZyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5ZXI6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudElkOiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3J0T3JkZXI6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg6IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW10sXHJcbiAgICAgICAgICAgICAgICAgICAgcGVyc29ubmVsczp7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50OjAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VDb3VudDowLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYWdlSW5kZXg6MSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFnZVNpemU6MCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxDb3VudDowLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VyczogW11cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHBhcmVudDogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRzOiBbXSxcclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRzQXJyIDogW10sXHJcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tlZDpmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICBzZWN0aW9uUGFyZW50WzBdLmNoaWxkcmVuID0gc2VjdGlvbkRhdGFUcmVlcztcclxuICAgICAgICAgICAgc2VjdGlvblBhcmVudFswXS5jaGlsZHJlbi5zb3J0KChhLCBiKTpudW1iZXIgPT4gYS5kYXRhWydzb3J0T3JkZXInXSAtIGIuZGF0YVsnc29ydE9yZGVyJ10pO1xyXG4gICAgICAgICAgICB0aGlzLmluaXRTZWN0aW9uVHJlZShzZWN0aW9uUGFyZW50WzBdLmNoaWxkcmVuKTtcclxuICAgICAgICAgICAgdGhpcy5zZWN0aW9uRGF0YVRyZWUgPSBzZWN0aW9uUGFyZW50O1xyXG4gICAgICAgIC8vIH1cclxuICAgICAgICAvLyBlbHNle1xyXG4gICAgICAgIC8vICAgICB0aGlzLnNlY3Rpb25EYXRhVHJlZSA9IHNlY3Rpb25EYXRhVHJlZXM7XHJcbiAgICAgICAgLy8gfVxyXG4gICAgICAgIC8vY29uc29sZS5sb2codGhpcy5zZWN0aW9uRGF0YVRyZWUpO1xyXG4gICAgICAgIGlmKHRoaXMuc2VjdGlvbkRhdGFUcmVlICYmIHRoaXMuc2VjdGlvbkRhdGFUcmVlLmxlbmd0aCl7XHJcbiAgICAgICAgICAgIHRoaXMuc2VjdGlvbkRhdGFUaWxlZCA9IHRoaXMudGlsZVNlY3Rpb25EYXRhKHRoaXMuc2VjdGlvbkRhdGFUcmVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLnNlY3Rpb25EYXRhVGlsZWQpO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFNlY3Rpb24gPSB0aGlzLnNlY3Rpb25EYXRhVHJlZVswXTtcclxuICAgICAgICB0aGlzLnNlY3Rpb25DcnVtYnMgPSB0aGlzLnNlY3Rpb25EYXRhVHJlZVswXS5jaGlsZHJlbi5sZW5ndGg/dGhpcy5zZWN0aW9uRGF0YVRyZWVbMF0uY2hpbGRyZW5bMF1bJ3BhcmVudHNBcnInXTpbXTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRTZWN0aW9uRGF0YSA9IHRoaXMuc2VjdGlvbkRhdGFUcmVlWzBdLmNoaWxkcmVuLmxlbmd0aD90aGlzLnNlY3Rpb25EYXRhVHJlZVswXS5jaGlsZHJlbjpbXTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRTZWN0aW9uSWQgPSB0aGlzLnNlY3Rpb25EYXRhVHJlZVswXS5kYXRhLmlkO1xyXG4gICAgICAgIHRoaXMuZ2V0UGVyc29ubmVsKHRoaXMuY3VycmVudFNlY3Rpb25JZCwwKS5zdWJzY3JpYmUoKGQ6YW55KT0+e1xyXG4gICAgICAgICAgICBpZihkLmhhc093blByb3BlcnR5KFwidXNlcnNcIikpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWN0aW9uRGF0YVRyZWVbMF0ucGVyc29ubmVscyA9IGQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRTZWN0aW9uUGVyc29uID0gdGhpcy5zZWN0aW9uRGF0YVRyZWVbMF0ucGVyc29ubmVscztcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdjdXInLHRoaXMuY3VycmVudFNlY3Rpb25QZXJzb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuc2VsZWN0RW1wbG95ZWUgPSB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoJ2Rpc2N1c3Npb25Hcm91cC5zZWxlY3RFbXBsb3llZScpO1xyXG4gICAgICAgIHRoaXMucGxhY2Vob2xkZXIgPSB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoJ2Rpc2N1c3Npb25Hcm91cC5wbGFjZWhvbGRlcicpO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuc2VjdGlvbkRhdGFUaWxlZCk7XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdFNlY3Rpb25UcmVlKGRhdGEscGFyZW50SWQ9XCJkaXNjdXNzaW9uUGFyZW50XCIsICBwYXJlbnROYW1lID0gdGhpcy5hbGxPcmcpe1xyXG4gICAgICAgIGlmKGRhdGEgJiYgZGF0YS5sZW5ndGgpe1xyXG4gICAgICAgICAgICBkYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgcGFyID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOnBhcmVudElkLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6cGFyZW50TmFtZVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGl0ZW0ucGFyZW50c0Fyci51bnNoaWZ0KHBhcik7XHJcbiAgICAgICAgICAgICAgICBpdGVtLnBhcmVudHMudW5zaGlmdChwYXJlbnRJZCk7XHJcbiAgICAgICAgICAgICAgICBpZihpdGVtLmNoaWxkcmVuLmxlbmd0aCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0U2VjdGlvblRyZWUoaXRlbS5jaGlsZHJlbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWIneWni+WMluWIhue7hOaVsOaNrlxyXG4gICAgICovXHJcbiAgICBpbml0U2VjdGlvbkRhdGEoZGF0YSwgcGFyZW50SWQsIHBhcmVudElkRmllbGQgPSAncGFyZW50SWQnLCBpZEZpZWxkID0gJ2lkJykge1xyXG4gICAgICAgIGNvbnN0IG5vZGVzID0gbmV3IE1hcCgpO1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIGNvbnN0IHVuYXR0YWNoZWQgPSBbXTtcclxuICAgICAgICBpZihkYXRhICYmIGRhdGEubGVuZ3RoKXtcclxuICAgICAgICAgICAgZGF0YS5mb3JFYWNoKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgbm9kZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB0LFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbXSxcclxuICAgICAgICAgICAgICAgICAgICBwZXJzb25uZWxzOnt9LFxyXG4gICAgICAgICAgICAgICAgICAgIHBhcmVudDogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRzOiBbXSxcclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRzQXJyIDogW10sXHJcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tlZDogZmFsc2VcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpZCA9IHRbaWRGaWVsZF07XHJcbiAgICAgICAgICAgICAgICBub2Rlcy5zZXQoaWQsIG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgUElEID0gdFtwYXJlbnRJZEZpZWxkXTtcclxuICAgICAgICAgICAgICAgIGlmIChQSUQgPT09IHBhcmVudElkIHx8IFBJRCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnQgPSBub2Rlcy5nZXQoUElEKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhwYXJlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHBhciA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOlBJRCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6cGFyZW50LmRhdGEubmFtZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlWydwYXJlbnQnXSA9IFBJRDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZVsncGFyZW50cyddID0gWy4uLnBhcmVudC5wYXJlbnRzLCBQSURdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlWydwYXJlbnRzQXJyJ10gPSBbLi4ucGFyZW50LnBhcmVudHNBcnIsIHBhcl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5jaGlsZHJlbi5wdXNoKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuY2hpbGRyZW4uc29ydCgoYSwgYik6bnVtYmVyID0+IGEuZGF0YVsnc29ydE9yZGVyJ10gLSBiLmRhdGFbJ3NvcnRPcmRlciddKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1bmF0dGFjaGVkLnB1c2gobm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYodW5hdHRhY2hlZC5sZW5ndGgpe1xyXG4gICAgICAgICAgICAgICAgdW5hdHRhY2hlZC5mb3JFYWNoKG4gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBpZCA9IG4uZGF0YVtwYXJlbnRJZEZpZWxkXTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnQgPSBub2Rlcy5nZXQocGlkKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5jaGlsZHJlbi5wdXNoKG4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuY2hpbGRyZW4uc29ydCgoYSwgYik6bnVtYmVyID0+IGEuZGF0YVsnc29ydE9yZGVyJ10gLSBiLmRhdGFbJ3NvcnRPcmRlciddKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG4gICAgdGlsZVNlY3Rpb25EYXRhKG5vZGVzKXtcclxuICAgICAgICBsZXQgciA9IFtdO1xyXG4gICAgICAgIHRoaXMuZ2V0QWxsTm9kZXMobm9kZXMscik7XHJcbiAgICAgICAgcmV0dXJuIHI7XHJcbiAgICB9XHJcbiAgICBnZXRBbGxOb2Rlcyggbm9kZXMsIHIpIHtcclxuICAgICAgICBub2Rlcy5mb3JFYWNoKG4gPT57XHJcbiAgICAgICAgICAgIHIucHVzaChuKTtcclxuICAgICAgICAgICAgaWYgKG4uY2hpbGRyZW4ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldEFsbE5vZGVzKG4uY2hpbGRyZW4sIHIpO1xyXG4gICAgICAgICAgICB9ICBcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDngrnlh7vkuIvnuqdcclxuICAgICAqIEBwYXJhbSBzZWN0aW9uIFxyXG4gICAgICovXHJcbiAgICBzZWN0aW9uTmV4dChzZWN0aW9uKXtcclxuICAgICAgICBpZihKU09OLnN0cmluZ2lmeShzZWN0aW9uLnBlcnNvbm5lbHMpID09PSAne30nICYmICFzZWN0aW9uLmhhc093blByb3BlcnR5KCdub1BlcnNvbm5lbCcpKXtcclxuICAgICAgICAgICAgc2VjdGlvbi5wZXJzb25uZWxzID0ge1xyXG4gICAgICAgICAgICAgICAgY291bnQ6MCxcclxuICAgICAgICAgICAgICAgIHBhZ2VDb3VudDowLFxyXG4gICAgICAgICAgICAgICAgcGFnZUluZGV4OjEsXHJcbiAgICAgICAgICAgICAgICBwYWdlU2l6ZTowLFxyXG4gICAgICAgICAgICAgICAgdG90YWxDb3VudDowLFxyXG4gICAgICAgICAgICAgICAgdXNlcnM6IFtdXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0UGVyc29ubmVsKHNlY3Rpb24uZGF0YS5pZCwwKS5zdWJzY3JpYmUoKGQ6YW55KT0+e1xyXG4gICAgICAgICAgICAgICAgaWYoZC5oYXNPd25Qcm9wZXJ0eShcInVzZXJzXCIpKXtcclxuICAgICAgICAgICAgICAgICAgICBzZWN0aW9uLnBlcnNvbm5lbHMuY291bnQgPSBkWydjb3VudCddO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlY3Rpb24ucGVyc29ubmVscy5wYWdlQ291bnQgPSBkWydwYWdlQ291bnQnXTtcclxuICAgICAgICAgICAgICAgICAgICBzZWN0aW9uLnBlcnNvbm5lbHMucGFnZUluZGV4ID0gZFsncGFnZUluZGV4J107XHJcbiAgICAgICAgICAgICAgICAgICAgc2VjdGlvbi5wZXJzb25uZWxzLnBhZ2VTaXplID0gZFsncGFnZVNpemUnXTtcclxuICAgICAgICAgICAgICAgICAgICBzZWN0aW9uLnBlcnNvbm5lbHMudG90YWxDb3VudCA9IGRbJ3RvdGFsQ291bnQnXTtcclxuICAgICAgICAgICAgICAgICAgICBzZWN0aW9uLnBlcnNvbm5lbHNbJ3VzZXJzJ10gPSBbLi4uc2VjdGlvbi5wZXJzb25uZWxzWyd1c2VycyddLC4uLmRbJ3VzZXJzJ11dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICBzZWN0aW9uWydub1BlcnNvbm5lbCddID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0TmV4dERhdGEoc2VjdGlvbik7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0TmV4dERhdGEoc2VjdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bkuIvnuqfmlbDmja5cclxuICAgICAqIEBwYXJhbSBzZWN0aW9uIFxyXG4gICAgICovXHJcbiAgICBnZXROZXh0RGF0YShzZWN0aW9uKXtcclxuICAgICAgICBpZigoc2VjdGlvbi5jaGlsZHJlbiAmJiBzZWN0aW9uLmNoaWxkcmVuLmxlbmd0aCkgfHwgKEpTT04uc3RyaW5naWZ5KHNlY3Rpb24ucGVyc29ubmVscykgIT09ICd7fScpKXtcclxuICAgICAgICAgICAgY29uc3Qgc2VjID0gdGhpcy5nZXRTZWN0aW9uQnlJZChzZWN0aW9uLmRhdGEuaWQpO1xyXG4gICAgICAgICAgICBpZihzZWMpe1xyXG4gICAgICAgICAgICAgICAgbGV0IHNlY0NoZWNrZWQgPSBzZWNbJ2NoZWNrZWQnXTtcclxuICAgICAgICAgICAgICAgIHNlY1snZGlzYWJsZWQnXSA9IHNlY0NoZWNrZWQ/dHJ1ZTpmYWxzZTtcclxuICAgICAgICAgICAgICAgIGlmKCFzZWNbJ2luZGV0ZXJtaW5hdGUnXSl7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoc2VjLmNoaWxkcmVuICYmIHNlYy5jaGlsZHJlbi5sZW5ndGgpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWMuY2hpbGRyZW4uZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1bJ2NoZWNrZWQnXSA9IHNlY0NoZWNrZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtWydpbmRldGVybWluYXRlJ10gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGl0ZW1bJ2Rpc2FibGVkJ10gPSBzZWNbJ2Rpc2FibGVkJ107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoc2VjdGlvbi5wZXJzb25uZWxzWyd1c2VycyddICYmIHNlY3Rpb24ucGVyc29ubmVsc1sndXNlcnMnXS5sZW5ndGgpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWN0aW9uLnBlcnNvbm5lbHNbJ3VzZXJzJ10uZm9yRWFjaCh1c2VyID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJbJ2NoZWNrZWQnXSA9IHNlY0NoZWNrZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyWydpbmRldGVybWluYXRlJ10gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVzZXJbJ2Rpc2FibGVkJ10gPSBzZWNbJ2Rpc2FibGVkJ107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsZXQgc2VjUGFyZW50ID0ge1xyXG4gICAgICAgICAgICAgICAgaWQ6c2VjLmRhdGEuaWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOnNlYy5kYXRhLm5hbWVcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgbGV0IHNlY0NydW1icyA9IFsuLi5zZWNbJ3BhcmVudHNBcnInXSxzZWNQYXJlbnRdO1xyXG4gICAgICAgICAgICB0aGlzLnNlY3Rpb25DcnVtYnMgPSBzZWMuY2hpbGRyZW4ubGVuZ3RoP3NlYy5jaGlsZHJlblswXVsncGFyZW50c0FyciddOnNlY0NydW1icztcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50U2VjdGlvbkRhdGEgPSBzZWMuY2hpbGRyZW4ubGVuZ3RoP3NlYy5jaGlsZHJlbjpbXTtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50U2VjdGlvbiA9IHNlYztcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50U2VjdGlvbklkID0gc2VjLmRhdGEuaWQ7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFNlY3Rpb25QZXJzb24gPSBzZWMucGVyc29ubmVscztcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRDcnVtYnNMaXN0KCk7XHJcbiAgICAgICAgICAgIH0sIDApO1xyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmN1cnJlbnRTZWN0aW9uKTtcclxuICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFNlY3Rpb25QZXJzb24gPSBbXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0UGVyc29ubmVsKG91Z0lkOnN0cmluZyxwYWdlSW5kZXg6bnVtYmVyLHBhZ2VTaXplOm51bWJlciA9IHRoaXMucGFnZVNpemUpe1xyXG4gICAgICAgIC8vIGxldCBkYXRhID0ge307XHJcbiAgICAgICAgaWYodGhpcy5vcmdVcmwpe1xyXG4gICAgICAgICAgICBjb25zdCB1cmwgPSBgJHt0aGlzLm9yZ1VybH0/b3JnSWQ9JHtvdWdJZH0mcGFnZVNpemU9JHtwYWdlU2l6ZX0mcGFnZUluZGV4PSR7cGFnZUluZGV4fWA7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0KHVybCk7XHJcbiAgICAgICAgICAgIC8vIGlmKG91Z0lkID09ICdsYW5nY2hhbycpe1xyXG4gICAgICAgICAgICAvLyAgICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQoJ2Fzc2V0cy9kYXRhL2Rpc2N1c3Npb25QZXJzb24uanNvbicpO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIC8vIGVsc2UgaWYob3VnSWQgPT0gJ2d1b2ppJyl7XHJcbiAgICAgICAgICAgIC8vICAgICByZXR1cm4gdGhpcy5odHRwLmdldCgnYXNzZXRzL2RhdGEvZGlzY3Vzc2lvblBlcnNvbjIuanNvbicpO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIC8vIGVsc2UgaWYob3VnSWQgPT0gJ3lhbmZhJyl7XHJcbiAgICAgICAgICAgIC8vICAgICByZXR1cm4gdGhpcy5odHRwLmdldCgnYXNzZXRzL2RhdGEvZGlzY3Vzc2lvblBlcnNvbjMuanNvbicpO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIC8vIGVsc2V7XHJcbiAgICAgICAgICAgIC8vICAgICByZXR1cm4gb2YodHJ1ZSk7XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgcmV0dXJuIG9mKHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyByZXR1cm4gZGF0YTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRTZWN0aW9uQnlJZChpZCl7XHJcbiAgICAgICAgbGV0IHNlY3Rpb24gPSB0aGlzLnNlY3Rpb25EYXRhVGlsZWQuZmluZChzZWM9PntcclxuICAgICAgICAgICAgcmV0dXJuIHNlYy5kYXRhLmlkID09IGlkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBzZWN0aW9uO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDngrnlh7vpnaLljIXlsZFcclxuICAgICAqIEBwYXJhbSBjcnVtYnMgXHJcbiAgICAgKi9cclxuICAgIGNydW1ic0NsaWNrKGNydW1icyl7XHJcbiAgICAgICAgaWYoY3J1bWJzLmlkID09IHRoaXMuY3VycmVudFNlY3Rpb25JZCkgcmV0dXJuO1xyXG4gICAgICAgIGNvbnN0IHNlYyA9IHRoaXMuZ2V0U2VjdGlvbkJ5SWQoY3J1bWJzLmlkKTtcclxuICAgICAgICB0aGlzLnNlY3Rpb25DcnVtYnMgPSBzZWMuY2hpbGRyZW4ubGVuZ3RoP3NlYy5jaGlsZHJlblswXVsncGFyZW50c0FyciddOltdO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFNlY3Rpb25EYXRhID0gc2VjLmNoaWxkcmVuLmxlbmd0aD9zZWMuY2hpbGRyZW46W107XHJcbiAgICAgICAgdGhpcy5jdXJyZW50U2VjdGlvbklkID0gc2VjLmRhdGEuaWQ7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50U2VjdGlvblBlcnNvbiA9IHNlYy5wZXJzb25uZWxzO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFNlY3Rpb24gPSBzZWM7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdENydW1ic0xpc3QoKTtcclxuICAgICAgICB9LCAwKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6YOo6Zeo5oiW5Lq65ZGY54q25oCB5Y+Y5YyWXHJcbiAgICAgKiBAcGFyYW0gZXZlbnQgXHJcbiAgICAgKiBAcGFyYW0gc2VjdGlvbiBcclxuICAgICAqL1xyXG4gICAgaGFuZGxlQ2xpY2soZXZlbnQsc2VjdGlvbix0eXBlKSB7XHJcbiAgICAgICAgaWYodGhpcy5jdXJyZW50U2VjdGlvbi5kaXNhYmxlZCkgcmV0dXJuO1xyXG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIHNlY3Rpb24uY2hlY2tlZCA9ICFzZWN0aW9uLmNoZWNrZWQ7XHJcbiAgICAgICAgc2VjdGlvblsnaW5kZXRlcm1pbmF0ZSddID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zZXRTZWN0aW9uRGF0YUNoZWNrZWQoKTtcclxuICAgICAgICBpZihzZWN0aW9uLmNoZWNrZWQpe1xyXG4gICAgICAgICAgICBsZXQgc2VsZWN0ZWREYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgcGFyZW50OnRoaXMuY3VycmVudFNlY3Rpb24sXHJcbiAgICAgICAgICAgICAgICBkYXRhOnNlY3Rpb25cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgaWYodHlwZSA9PSAndXNlcicpe1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzU2VsZWN0ZWRJbkFycmF5KHNlY3Rpb25bdGhpcy5saXN0SWRGaWVsZF0sIHRoaXMubGlzdElkRmllbGQsIHRoaXMuc2VsZWN0ZWRVc2VycykpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRVc2Vycy5wdXNoKHNlbGVjdGVkRGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZih0eXBlID09ICdzZWN0aW9uJyl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkZFNlY3Rpb24oc2VjdGlvbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgaWYodHlwZSA9PSAndXNlcicpe1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzU2VsZWN0ZWRJbkFycmF5KHNlY3Rpb25bdGhpcy5saXN0SWRGaWVsZF0sIHRoaXMubGlzdElkRmllbGQsIHRoaXMuc2VsZWN0ZWRVc2VycykpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkVXNlcnMuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1bJ2RhdGEnXVt0aGlzLmxpc3RJZEZpZWxkXSA9PT0gc2VjdGlvblt0aGlzLmxpc3RJZEZpZWxkXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFVzZXJzLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmKHR5cGUgPT0gJ3NlY3Rpb24nKXtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlU2VjdGlvbihzZWN0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnNlbGVjdGVkVXNlcnMsdGhpcy5zZWxlY3RlZFNlY3Rpb25zKTtcclxuICAgIH1cclxuXHJcbiAgICBoYW5kbGVTZWFyY2hDbGljayhldmVudCx1c2VyKXtcclxuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB1c2VyLmNoZWNrZWQgPSAhdXNlci5jaGVja2VkO1xyXG4gICAgICAgIGlmKHVzZXIuY2hlY2tlZCl7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9pc1NlbGVjdGVkSW5BcnJheSh1c2VyW3RoaXMubGlzdElkRmllbGRdLCB0aGlzLmxpc3RJZEZpZWxkLCB0aGlzLnNlbGVjdGVkVXNlcnMpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgICAgIGxldCBzZWxlY3RlZERhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50Om51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTp1c2VyXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFVzZXJzLnB1c2goc2VsZWN0ZWREYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICBpZiAodGhpcy5faXNTZWxlY3RlZEluQXJyYXkodXNlclt0aGlzLmxpc3RJZEZpZWxkXSwgdGhpcy5saXN0SWRGaWVsZCwgdGhpcy5zZWxlY3RlZFVzZXJzKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFVzZXJzLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1bJ2RhdGEnXVt0aGlzLmxpc3RJZEZpZWxkXSA9PT0gdXNlclt0aGlzLmxpc3RJZEZpZWxkXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkVXNlcnMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgc2V0U2VjdGlvbkRhdGFDaGVja2VkKCl7XHJcbiAgICAgICAgbGV0IGN1ckNoZWNrZWQ6Ym9vbGVhbiA9IGZhbHNlO1xyXG4gICAgICAgIGxldCBzZWMgPSB0aGlzLmN1cnJlbnRTZWN0aW9uO1xyXG4gICAgICAgIGxldCBzZWNBcnJheTphbnkgPSBbXTtcclxuICAgICAgICBpZihzZWMuY2hpbGRyZW4gfHwgKHNlYy5wZXJzb25uZWxzWyd1c2VycyddICYmIHNlYy5wZXJzb25uZWxzWyd1c2VycyddLmxlbmd0aCkpe1xyXG4gICAgICAgICAgICBzZWNBcnJheSA9IHNlY0FycmF5LmNvbmNhdChzZWMuY2hpbGRyZW4sc2VjLnBlcnNvbm5lbHNbJ3VzZXJzJ10pO1xyXG4gICAgICAgICAgICBsZXQgc2VjQ2hlY2tlZExpc3QgPSBzZWNBcnJheS5maWx0ZXIoaXRlbT0+e1xyXG4gICAgICAgICAgICAgICAgaWYoaXRlbS5oYXNPd25Qcm9wZXJ0eSgnY2hlY2tlZCcpICYmIGl0ZW1bJ2NoZWNrZWQnXSl7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBsZXQgc2VjSW5kZUxpc3QgPSBzZWMuY2hpbGRyZW4uZmlsdGVyKGl0ZW09PntcclxuICAgICAgICAgICAgICAgIGlmKGl0ZW0uaGFzT3duUHJvcGVydHkoJ2luZGV0ZXJtaW5hdGUnKSAmJiBpdGVtWydpbmRldGVybWluYXRlJ10pe1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTZWN0aW9uWydpbmRldGVybWluYXRlJ10gPSAoc2VjSW5kZUxpc3QgJiYgc2VjSW5kZUxpc3QubGVuZ3RoKT8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgICAgICAgICBpZihzZWNDaGVja2VkTGlzdCAmJiBzZWNDaGVja2VkTGlzdC5sZW5ndGgpe1xyXG4gICAgICAgICAgICAgICAgaWYoc2VjQ2hlY2tlZExpc3QubGVuZ3RoID09IHNlY0FycmF5Lmxlbmd0aCAmJiBzZWMucGVyc29ubmVscy5wYWdlSW5kZXggPj0gc2VjLnBlcnNvbm5lbHMucGFnZUNvdW50LTEpe1xyXG4gICAgICAgICAgICAgICAgICAgIGN1ckNoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRTZWN0aW9uWydpbmRldGVybWluYXRlJ10gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgICAgICBjdXJDaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50U2VjdGlvblsnY2hlY2tlZCddID0gY3VyQ2hlY2tlZDtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5jdXJyZW50U2VjdGlvbik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZih0aGlzLmN1cnJlbnRTZWN0aW9uLnBhcmVudHMubGVuZ3RoPjAgJiYgdGhpcy5jdXJyZW50U2VjdGlvblsnaW5kZXRlcm1pbmF0ZSddKXtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50U2VjdGlvbi5wYXJlbnRzLmZvckVhY2gocGFyID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBhclNlYyA9IHRoaXMuZ2V0U2VjdGlvbkJ5SWQocGFyKTtcclxuICAgICAgICAgICAgICAgIGlmKHBhclNlYyl7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyU2VjWydpbmRldGVybWluYXRlJ10gPSB0aGlzLmN1cnJlbnRTZWN0aW9uWydpbmRldGVybWluYXRlJ107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZXRDaGlsZERpc2FibGVkU3RhdHVzKHN0YXR1czpib29sZWFuID0gdHJ1ZSl7XHJcbiAgICAgICAgbGV0IHNlYyA9IHRoaXMuY3VycmVudFNlY3Rpb247XHJcbiAgICAgICAgLy8gc2VjWydkaXNhYmxlZCddID0gc3RhdHVzO1xyXG4gICAgICAgIGlmKHNlYy5jaGlsZHJlbiB8fCAoc2VjLnBlcnNvbm5lbHNbJ3VzZXJzJ10gJiYgc2VjLnBlcnNvbm5lbHNbJ3VzZXJzJ10ubGVuZ3RoKSl7XHJcbiAgICAgICAgICAgIHNlYy5jaGlsZHJlbi5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgaXRlbVsnZGlzYWJsZWQnXSA9IHN0YXR1cztcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vIHNlY1snY2hpbGREaXNhYmxlZCddID0gc3RhdHVzO1xyXG4gICAgICAgICAgICBzZWMucGVyc29ubmVsc1sndXNlcnMnXS5mb3JFYWNoKHVzZXIgPT4ge1xyXG4gICAgICAgICAgICAgICAgdXNlclsnZGlzYWJsZWQnXSA9IHN0YXR1cztcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5Lq65ZGY5p+l55yL5pu05aSaXHJcbiAgICAgKi9cclxuICAgIGdldE1vcmVEYXRhKCl7XHJcbiAgICAgICAgaWYodGhpcy5jdXJyZW50U2VjdGlvbklkKXtcclxuICAgICAgICAgICAgY29uc3Qgc2VjID0gdGhpcy5nZXRTZWN0aW9uQnlJZCh0aGlzLmN1cnJlbnRTZWN0aW9uSWQpO1xyXG4gICAgICAgICAgICBpZihzZWMpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRQZXJzb25uZWwodGhpcy5jdXJyZW50U2VjdGlvbklkLCBzZWMucGVyc29ubmVscy5wYWdlSW5kZXggKyAxKS5zdWJzY3JpYmUoKGQ6YW55KT0+e1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGQuaGFzT3duUHJvcGVydHkoXCJ1c2Vyc1wiKSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlYy5wZXJzb25uZWxzLnBhZ2VJbmRleCA9IGRbJ3BhZ2VJbmRleCddO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWMucGVyc29ubmVsc1sndXNlcnMnXSA9IFsuLi5zZWMucGVyc29ubmVsc1sndXNlcnMnXSwuLi5kWyd1c2VycyddXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoc2VjLnBlcnNvbm5lbHNbJ3VzZXJzJ10ubGVuZ3RoKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHNlY1snY2hlY2tlZCddKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWMucGVyc29ubmVsc1sndXNlcnMnXS5mb3JFYWNoKHVzZXIgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyWydjaGVja2VkJ10gPSBzZWNbJ2NoZWNrZWQnXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLnNldFNlY3Rpb25EYXRhQ2hlY2tlZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWFqOmAiVxyXG4gICAgICogQHBhcmFtIGV2ZW50IFxyXG4gICAgICovXHJcbiAgICBoYW5kbGVDbGlja0FsbChldmVudCl7XHJcbiAgICAgICAgaWYodGhpcy5jdXJyZW50U2VjdGlvbi5kaXNhYmxlZCkgcmV0dXJuO1xyXG4gICAgICAgIGlmKHRoaXMuY3VycmVudFNlY3Rpb24pe1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTZWN0aW9uWydjaGVja2VkJ10gPSAhdGhpcy5jdXJyZW50U2VjdGlvblsnY2hlY2tlZCddO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTZWN0aW9uWydpbmRldGVybWluYXRlJ10gPSBmYWxzZTtcclxuICAgICAgICAgICAgbGV0IGN1ckNoZWNrZWQgPSB0aGlzLmN1cnJlbnRTZWN0aW9uWydjaGVja2VkJ107XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFNlY3Rpb24uY2hpbGRyZW4uZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIGl0ZW1bJ2NoZWNrZWQnXSA9IGN1ckNoZWNrZWQ7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZihKU09OLnN0cmluZ2lmeSh0aGlzLmN1cnJlbnRTZWN0aW9uLnBlcnNvbm5lbHMpICE9ICd7fScgJiYgdGhpcy5jdXJyZW50U2VjdGlvblsncGVyc29ubmVscyddWyd1c2VycyddLmxlbmd0aCl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRTZWN0aW9uWydwZXJzb25uZWxzJ11bJ3VzZXJzJ10uZm9yRWFjaCh1c2VyID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VyWydjaGVja2VkJ10gPSBjdXJDaGVja2VkO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYoY3VyQ2hlY2tlZCl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkZFNlY3Rpb24odGhpcy5jdXJyZW50U2VjdGlvbilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWN0aW9uKHRoaXMuY3VycmVudFNlY3Rpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGFkZFNlY3Rpb24oc2VjdGlvbil7XHJcbiAgICAgICAgaWYgKHRoaXMuX2lzU2VsZWN0ZWRJbkFycmF5KHNlY3Rpb25bJ2RhdGEnXVt0aGlzLmxpc3RJZEZpZWxkXSwgdGhpcy5saXN0SWRGaWVsZCwgdGhpcy5zZWxlY3RlZFNlY3Rpb25zKSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRTZWN0aW9ucy5wdXNoKHNlY3Rpb24pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJlbW92ZVNlY3Rpb24oc2VjdGlvbil7XHJcbiAgICAgICAgaWYgKHRoaXMuX2lzU2VsZWN0ZWRJbkFycmF5KHNlY3Rpb25bJ2RhdGEnXVt0aGlzLmxpc3RJZEZpZWxkXSwgdGhpcy5saXN0SWRGaWVsZCwgdGhpcy5zZWxlY3RlZFNlY3Rpb25zKSkge1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkU2VjdGlvbnMuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChpdGVtWydkYXRhJ11bdGhpcy5saXN0SWRGaWVsZF0gPT09IHNlY3Rpb25bJ2RhdGEnXVt0aGlzLmxpc3RJZEZpZWxkXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRTZWN0aW9ucy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmkJzntKLnlKjmiLdcclxuICAgICAqL1xyXG4gICAgc2VhcmNoVXNlcigpIHtcclxuICAgICAgICBpZiAodGhpcy5zZWFyY2hUZXh0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd1NlYXJjaExpc3QgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLmdldFNlYXJjaERhdGEodGhpcy5zZWFyY2hUZXh0LDApLnN1YnNjcmliZShkPT57XHJcbiAgICAgICAgICAgICAgICBpZihkLmhhc093blByb3BlcnR5KFwidXNlcnNcIikpe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoVXNlckxpc3QgPSBkO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgdGhpcy5zaG93U2VhcmNoTGlzdCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5pCc57Si5Lq65ZGY5p+l55yL5pu05aSaXHJcbiAgICAgKi9cclxuICAgIGdldE1vcmVTZWFyY2hEYXRhKCl7XHJcbiAgICAgICAgaWYodGhpcy5zZWFyY2hUZXh0ICYmIHRoaXMucGVyc29uU2VhcmNoVXJsKXtcclxuICAgICAgICAgICAgdGhpcy5nZXRTZWFyY2hEYXRhKHRoaXMuc2VhcmNoVGV4dCx0aGlzLnNlYXJjaFVzZXJMaXN0LnBhZ2VJbmRleCArIDEpLnN1YnNjcmliZShkPT57XHJcbiAgICAgICAgICAgICAgICBpZihkLmhhc093blByb3BlcnR5KFwidXNlcnNcIikpe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoVXNlckxpc3QucGFnZUluZGV4ID0gZFsncGFnZUluZGV4J107XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWFyY2hVc2VyTGlzdFsndXNlcnMnXSA9IFsuLi50aGlzLnNlYXJjaFVzZXJMaXN0Wyd1c2VycyddLC4uLmRbJ3VzZXJzJ11dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0U2VhcmNoRGF0YSh0ZXh0OnN0cmluZyxwYWdlSW5kZXg6bnVtYmVyLHBhZ2VTaXplOm51bWJlciA9IHRoaXMucGFnZVNpemUpe1xyXG4gICAgICAgIGlmKHRoaXMucGVyc29uU2VhcmNoVXJsKXtcclxuICAgICAgICAgICAgY29uc3QgdXJsID0gYCR7dGhpcy5wZXJzb25TZWFyY2hVcmx9P3BhcmFtPSR7dGV4dH0mcGFnZVNpemU9JHtwYWdlU2l6ZX0mcGFnZUluZGV4PSR7cGFnZUluZGV4fWA7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0KHVybCk7XHJcbiAgICAgICAgICAgIC8vcmV0dXJuIHRoaXMuaHR0cC5nZXQoJ2Fzc2V0cy9kYXRhL2Rpc2N1c3Npb25QZXJzb24zLmpzb24nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgcmV0dXJuIG9mKHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOmAieS4reS6uuWRmOaIlue7hOe7h+WIoOmZpFxyXG4gICAgICogQHBhcmFtIGRhdGEgXHJcbiAgICAgKiBAcGFyYW0gdHlwZSBcclxuICAgICAqL1xyXG4gICAgc2VsZWN0aW9uUmVtb3ZlKGRhdGE6IGFueSwgdHlwZTpzdHJpbmcpIHtcclxuICAgICAgICBpZighZGF0YSkgcmV0dXJuO1xyXG4gICAgICAgIGlmKHR5cGUgPT0gJ3VzZXInKXtcclxuICAgICAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5zZWxlY3RlZFVzZXJzLmZpbmRJbmRleCh1c2VyID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB1c2VyLmRhdGEuaWQgPT0gZGF0YS5kYXRhLmlkO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYoaW5kZXggPj0gMCApe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFVzZXJzLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGF0YS5kYXRhWydjaGVja2VkJ10gPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZih0eXBlID09ICdzZWN0aW9uJyl7XHJcbiAgICAgICAgICAgIGxldCBpbmRleCA9IHRoaXMuc2VsZWN0ZWRTZWN0aW9ucy5maW5kSW5kZXgoaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5kYXRhLmlkID09IGRhdGEuZGF0YS5pZDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmKGluZGV4ID49IDAgKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRTZWN0aW9ucy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGRhdGFbJ2NoZWNrZWQnXSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgZGF0YVBhcmVudCA9IG51bGw7XHJcbiAgICAgICAgaWYodHlwZSA9PSAnc2VjdGlvbicpe1xyXG4gICAgICAgICAgICBkYXRhUGFyZW50ID0gdGhpcy5nZXRTZWN0aW9uQnlJZChkYXRhLnBhcmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYodHlwZSA9PSAndXNlcicpe1xyXG4gICAgICAgICAgICBkYXRhUGFyZW50ID0gdGhpcy5nZXRTZWN0aW9uQnlJZChkYXRhLnBhcmVudC5kYXRhLmlkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoZGF0YVBhcmVudCl7XHJcbiAgICAgICAgICAgIGRhdGFQYXJlbnRbJ2NoZWNrZWQnXSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBpZigoZGF0YVBhcmVudC5jaGlsZHJlbiAmJiBkYXRhUGFyZW50LmNoaWxkcmVuLmxlbmd0aCkgfHwgKGRhdGFQYXJlbnQucGVyc29ubmVscy51c2VycyAmJiBkYXRhUGFyZW50LnBlcnNvbm5lbHMudXNlcnMubGVuZ3RoKSApe1xyXG4gICAgICAgICAgICAgICAgbGV0IGNoaWxkcmVucyA9IGRhdGFQYXJlbnQuY2hpbGRyZW4uZmlsdGVyKGNoaWxkPT57XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkWydjaGVja2VkJ107XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGxldCB1c2VycyA9IGRhdGFQYXJlbnQucGVyc29ubmVscy51c2Vycy5maWx0ZXIodXNlcj0+e1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1c2VyWydjaGVja2VkJ107XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgaWYoKGNoaWxkcmVucyAmJiBjaGlsZHJlbnMubGVuZ3RoKSB8fCAodXNlcnMgJiYgdXNlcnMubGVuZ3RoKSl7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVBhcmVudFsnaW5kZXRlcm1pbmF0ZSddID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVBhcmVudFsnaW5kZXRlcm1pbmF0ZSddID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZihkYXRhUGFyZW50LnBhcmVudHMubGVuZ3RoPjApe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFQYXJlbnQucGFyZW50cy5mb3JFYWNoKHBhciA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhclNlYyA9IHRoaXMuZ2V0U2VjdGlvbkJ5SWQocGFyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoKHBhclNlYy5jaGlsZHJlbiAmJiBwYXJTZWMuY2hpbGRyZW4ubGVuZ3RoKSB8fCAocGFyU2VjLnBlcnNvbm5lbHMudXNlcnMgJiYgcGFyU2VjLnBlcnNvbm5lbHMudXNlcnMubGVuZ3RoKSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcGFyY2hpbGRyZW5zID0gcGFyU2VjLmNoaWxkcmVuLmZpbHRlcihjaGlsZD0+e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZFsnY2hlY2tlZCddO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcGFydXNlcnMgPSBwYXJTZWMucGVyc29ubmVscy51c2Vycy5maWx0ZXIodXNlcj0+e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1c2VyWydjaGVja2VkJ107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoKHBhcmNoaWxkcmVucyAmJiBwYXJjaGlsZHJlbnMubGVuZ3RoKSB8fCAocGFydXNlcnMgJiYgcGFydXNlcnMubGVuZ3RoKSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyU2VjWydpbmRldGVybWluYXRlJ10gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihkYXRhUGFyZW50WydpbmRldGVybWluYXRlJ10pe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJTZWNbJ2luZGV0ZXJtaW5hdGUnXSA9IGRhdGFQYXJlbnRbJ2luZGV0ZXJtaW5hdGUnXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyU2VjWydpbmRldGVybWluYXRlJ10gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Yig6Zmk5Y+z5L6n5YWo6YOo5pWw5o2uXHJcbiAgICAgKi9cclxuICAgIG1vdmVBbGxUb0xlZnQoKSB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZFVzZXJzLmZvckVhY2godXNlcj0+e1xyXG4gICAgICAgICAgICB1c2VyLmRhdGFbJ2NoZWNrZWQnXSA9IGZhbHNlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRTZWN0aW9ucy5mb3JFYWNoKGl0ZW09PntcclxuICAgICAgICAgICAgaXRlbVsnY2hlY2tlZCddID0gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zZWN0aW9uRGF0YVRpbGVkLmZvckVhY2goc2VjID0+IHtcclxuICAgICAgICAgICAgc2VjWydpbmRldGVybWluYXRlJ10gPSBmYWxzZTtcclxuICAgICAgICAgICAgc2VjWydjaGVja2VkJ10gPSBmYWxzZTtcclxuICAgICAgICAgICAgc2VjWydkaXNhYmxlZCddID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGlmKEpTT04uc3RyaW5naWZ5KHNlYy5wZXJzb25uZWxzKSAhPSAne30nICYmIHNlY1sncGVyc29ubmVscyddWyd1c2VycyddLmxlbmd0aCl7XHJcbiAgICAgICAgICAgICAgICBzZWNbJ3BlcnNvbm5lbHMnXVsndXNlcnMnXS5mb3JFYWNoKHVzZXIgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJbJ2NoZWNrZWQnXSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkVXNlcnMgPSBbXTtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkU2VjdGlvbnMgPSBbXTtcclxuICAgICAgICB0aGlzLmNkLm1hcmtGb3JDaGVjaygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogXHJcbiAgICAgKiBAcGFyYW0gbnVtYmVyVHlwZSAw77ya5Y+W5raI77ybMe+8muehruWumlxyXG4gICAgICovXHJcbiAgICByZXR1cm5SZXN1bHQobnVtYmVyVHlwZTogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5maW5hbFRleHQgPSAnJztcclxuICAgICAgICBpZiAobnVtYmVyVHlwZSkge1xyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnNlbGVjdGVkVXNlcnMsdGhpcy5zZWxlY3RlZFNlY3Rpb25zKTtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zQ2hhbmdlLmVtaXQoe1xyXG4gICAgICAgICAgICAgICAgaW5mbzogJ2NvbmZpcm0nLFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJzOiB0aGlzLnNlbGVjdGVkVXNlcnMsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VjdGlvbjogdGhpcy5zZWxlY3RlZFNlY3Rpb25zXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvLyB0aGlzLnNlbGVjdGlvbnMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgLy8gICAgIHRoaXMuZmluYWxUZXh0ICs9IGl0ZW1bdGhpcy5saXN0RGlzcGxheVRleHRdICsgJ++8myc7XHJcbiAgICAgICAgICAgIC8vIH0pXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zQ2hhbmdlLmVtaXQoe1xyXG4gICAgICAgICAgICAgICAgaW5mbzogJ2NhbmNlbCcsXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcnM6IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgIHNlY3Rpb246IFtdXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm1vdmVBbGxUb0xlZnQoKTtcclxuICAgICAgICB0aGlzLnNlYXJjaFRleHQgPSAnJztcclxuICAgICAgICB0aGlzLnNlYXJjaFVzZXIoKTtcclxuICAgICAgICB0aGlzLnBlcnNvbm5lbERpYWxvZy5jbG9zZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIGluaXRDcnVtYnNMaXN0KCl7XHJcbiAgICAgICAgY29uc3QgY3J1bWJzTGlzdFdpZHRoID0gdGhpcy5jcnVtYnNMaXN0Lm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGggLSAzMDtcclxuICAgICAgICBjb25zdCBjcnVtYnNMaXN0SXRlbXMgPSB0aGlzLmNydW1ic0xpc3QubmF0aXZlRWxlbWVudC5jaGlsZHJlbjtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhjcnVtYnNMaXN0SXRlbXMpO1xyXG4gICAgICAgIGxldCBjcnVtYnNMaXN0SXRlbVdpZHRoID0gMDtcclxuICAgICAgICBpZihjcnVtYnNMaXN0SXRlbXMgJiYgY3J1bWJzTGlzdEl0ZW1zLmxlbmd0aCl7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSBjcnVtYnNMaXN0SXRlbXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGNydW1ic0xpc3RJdGVtc1tpXSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKGNydW1ic0xpc3RJdGVtc1tpXSwnZGlzcGxheScsJ2ZsZXgnKTtcclxuICAgICAgICAgICAgICAgIGxldCB3aWR0aCA9IGNydW1ic0xpc3RJdGVtc1tpXS5vZmZzZXRXaWR0aDtcclxuICAgICAgICAgICAgICAgIGNydW1ic0xpc3RJdGVtV2lkdGggKz0gd2lkdGg7XHJcbiAgICAgICAgICAgICAgICBpZihjcnVtYnNMaXN0SXRlbVdpZHRoID49IGNydW1ic0xpc3RXaWR0aCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShjcnVtYnNMaXN0SXRlbXNbaV0sJ2Rpc3BsYXknLCdub25lJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoY3J1bWJzTGlzdEl0ZW1zW2ldLCdkaXNwbGF5JywnZmxleCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cod2lkdGgsY3J1bWJzTGlzdEl0ZW1XaWR0aCxjcnVtYnNMaXN0V2lkdGgsaSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGNydW1ic0xpc3RJdGVtV2lkdGgsY3J1bWJzTGlzdFdpZHRoKTtcclxuICAgICAgICBpZihjcnVtYnNMaXN0SXRlbVdpZHRoID49IGNydW1ic0xpc3RXaWR0aCl7XHJcbiAgICAgICAgICAgIHRoaXMuY3J1bWJzRWxsaXBzaXMgPSB0cnVlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgdGhpcy5jcnVtYnNFbGxpcHNpcyA9IGZhbHNlO1xyXG4gICAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNydW1ic01vcmUoKXtcclxuICAgICAgICBpZih0aGlzLnNlY3Rpb25DcnVtYnMgJiYgdGhpcy5zZWN0aW9uQ3J1bWJzLmxlbmd0aCl7XHJcbiAgICAgICAgICAgIHRoaXMuY3J1bWJzQ2xpY2sodGhpcy5zZWN0aW9uQ3J1bWJzWzBdKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX2lzSW5BcnJheSh2YWx1ZTogc3RyaW5nLCBmaWVsZDogc3RyaW5nLCBhcnJheTogYW55W10pIHtcclxuICAgICAgICBpZiAoIWZpZWxkIHx8ICF2YWx1ZSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+WJjTLkuKrlj4LmlbDlv4XloasnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFycmF5LmZpbmQoaXRlbSA9PiB2YWx1ZSA9PT0gaXRlbVtmaWVsZF0pID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIF9pc1NlbGVjdGVkSW5BcnJheSh2YWx1ZTogc3RyaW5nLCBmaWVsZDogc3RyaW5nLCBhcnJheTogYW55W10pIHtcclxuICAgICAgICBpZiAoIWZpZWxkIHx8ICF2YWx1ZSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+WJjTLkuKrlj4LmlbDlv4XloasnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFycmF5LmZpbmQoaXRlbSA9PiB2YWx1ZSA9PT0gaXRlbVsnZGF0YSddW2ZpZWxkXSkgPyB0cnVlIDogZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2VEaWFsb2coKXtcclxuICAgICAgICB0aGlzLm1vdmVBbGxUb0xlZnQoKTtcclxuICAgICAgICB0aGlzLnNlYXJjaFRleHQgPSAnJztcclxuICAgICAgICB0aGlzLnNlYXJjaFVzZXIoKTtcclxuICAgIH1cclxufSJdfQ==