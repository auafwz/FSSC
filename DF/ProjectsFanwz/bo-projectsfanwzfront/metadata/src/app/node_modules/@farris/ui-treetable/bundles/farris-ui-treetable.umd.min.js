!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@farris/ui-input-group"),require("@angular/common"),require("resize-observer-polyfill"),require("lodash-es"),require("@farris/ui-perfect-scrollbar"),require("@angular/forms"),require("@farris/ui-common/column"),require("@farris/ui-common/events"),require("@angular/platform-browser"),require("@farris/ui-locale"),require("@farris/ui-pagination"),require("rxjs/operators"),require("rxjs"),require("@farris/ui-common"),require("@angular/core"),require("@farris/ui-context-menu")):"function"==typeof define&&define.amd?define("@farris/ui-treetable",["exports","@farris/ui-input-group","@angular/common","resize-observer-polyfill","lodash-es","@farris/ui-perfect-scrollbar","@angular/forms","@farris/ui-common/column","@farris/ui-common/events","@angular/platform-browser","@farris/ui-locale","@farris/ui-pagination","rxjs/operators","rxjs","@farris/ui-common","@angular/core","@farris/ui-context-menu"],t):t((e.farris=e.farris||{},e.farris["ui-treetable"]={}),e.uiInputGroup,e.ng.common,e.ResizeObserver,e.lodashEs,e.uiPerfectScrollbar,e.ng.forms,e.column,e.events,e.ng.platformBrowser,e.uiLocale,e.uiPagination,e.rxjs.operators,e.rxjs,e.uiCommon,e.ng.core,e.uiContextMenu)}(this,function(e,t,n,i,s,o,r,l,a,c,h,d,u,p,f,g,m){"use strict";i=i&&i.hasOwnProperty("default")?i["default"]:i;var y=function(){return(y=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function v(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,s=n.call(e),r=[];try{for(;(void 0===t||0<t--)&&!(i=s.next()).done;)r.push(i.value)}catch(l){o={error:l}}finally{try{i&&!i.done&&(n=s["return"])&&n.call(s)}finally{if(o)throw o.error}}return r}function b(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}var w=(C.prototype.addShortcut=function(e){var n=this,i=y({},this.defaults,e);-1<i.keys.indexOf("ctrl")&&(i.keys=i.keys.replace("ctrl","control"));var o="keydown."+i.keys;return i.description&&this.hotkeys.set(i.keys,i.description),new p.Observable(function(t){var e=n.eventManager.addEventListener(i.element,o,function(e){e.preventDefault(),t.next(e)});return function(){e(),n.hotkeys["delete"](i.keys)}})},C.decorators=[{type:g.Injectable,args:[{providedIn:"root"}]}],C.ctorParameters=function(){return[{type:c.EventManager}]},C.ngInjectableDef=g.defineInjectable({factory:function(){return new C(g.inject(c.EventManager))},token:C,providedIn:"root"}),C);function C(e){this.eventManager=e,this.hotkeys=new Map,this.defaults={element:document}}var x=(k.prototype.onSelectionChange=function(e){this.selectionSource.next(e)},k.prototype.onDblClick=function(e){this.dblClickSource.next(e)},k.prototype.onChangeCheckboxStatus=function(e){this.changeCheckboxStatus.next(e)},k.prototype.onInsert=function(e,t){this.insertNode.next(e)},k.prototype.onRemove=function(e){this.removeNode.next(e)},k.prototype.onUpdate=function(e){this.updateNode.next(e)},k.prototype.columnIsVisible=function(e,t){return e.visible===undefined||("function"==typeof e.visible?e.visible(t):e.visible)},k.prototype.checkColumnsForGroupHeader=function(e,t){var n=[];return e&&e.length&&(n=this.getDataColumns(e)),{columns:n}},k.prototype.getDataFields=function(e,n){var i=0,o=0;return e.forEach(function(e){var t=e.colspan||1;i+t<=n&&(i+=t,o++)}),e.splice(0,o)},k.prototype.getDataColumns=function(n){var i=this;if(!n||!n.length)return[];for(var o=[],e=function(e){var t=n[e];n[e]&&!n[e].length&&(t=b(o),o=[]),t.forEach(function(t){!t.field&&t.colspan&&1<t.colspan?i.getDataFields(n[e+1],t.colspan).forEach(function(t){o.includes(function(e){return e.field===t.field})||o.push(t)}):o.includes(function(e){return e.field===t.field})||o.push(t)})},t=0;t<n.length;t++)e(t);return o.filter(function(e){return!e.colspan||1===e.colspan})},k.decorators=[{type:g.Injectable}],k);function k(){this.selectionSource=new p.Subject,this.dblClickSource=new p.Subject,this.changeCheckboxStatus=new p.Subject,this.removeNode=new p.Subject,this.insertNode=new p.Subject,this.updateNode=new p.Subject,this.selectionSource$=this.selectionSource.asObservable(),this.dblClickSource$=this.dblClickSource.asObservable(),this.changeCheckboxStatus$=this.changeCheckboxStatus.asObservable(),this.insertNode$=this.insertNode.asObservable(),this.removeNode$=this.removeNode.asObservable(),this.updateNode$=this.updateNode.asObservable()}var S=(I.prototype.getTableHeight=function(){return this.tt.height},I.prototype.getTableHeaderHeight=function(){return this.tt.headerBox.nativeElement.getBoundingClientRect().height},I.prototype.getTableBodyHeight=function(){return this.tt.height-this.getTableHeaderHeight()},I.prototype.getTableWidth=function(){return this.tt.width},I.prototype.getRowHeight=function(){return this.tt.rowHeight},I.prototype.getRowNodes=function(e){for(var t=e,n=t+this.getTableHeight(),i=0,o=[],s=0,r=0,l=this.tt.state.rowNodes,a=this.getRowHeight(),c=0;c<l.length;c++){var d=l[c];d.visible&&((i+=a)+a<t?s+=a:n<i?r+=a:o.push(d))}return{data:o,topHideHeight:s,bottomHideHeight:r}},I);function I(e){this.tt=e}var N=(E.prototype.search=function(e,t,n){var i=this;switch(void 0===n&&(n="client"),this.allNodes.length||(this.allNodes=s.cloneDeep(this.ttInstance.state.rowNodes)),n){case"server":this.searchOnServer(e,t);break;default:if(""!==t&&t!==undefined){var o=this.searchOnClient(e,t,this.allNodes);this._updateSerializedValues(o)}else this.ttInstance.updateSerializedValue();this.ttInstance.checkeds&&this.ttInstance.checkeds.length?this.ttInstance.checkedNodes(this.ttInstance.checkeds.map(function(e){return e.data[i.ttInstance.idField]})):this.ttInstance.detectChanges()}},E.prototype._updateSerializedValues=function(e){var t=e.map(function(e){return b(e.parents,[e.id])}).flat(),n=Array.from(new Set(t)),i=this.allNodes.filter(function(t){return n.some(function(e){return e==t.id})}).map(function(e){return e.expanded=!0,e});this.ttInstance.serializedValue=this.resetTreeData(null,i),this.ttInstance.state.rowNodes=this.ttInstance.serializedValue},E.prototype.findParent=function(t,e){var n=this,i=[];if(t&&e&&e.length){var o=e.find(function(e){return e.id===t.data[n.ttInstance.idField]});i.push(o),o.parent&&(i=i.concat(this.findParent(o.parent,e)))}return i},E.prototype.searchExpression=function(n,i,e){var o=this;return void 0===e&&(e=[]),(e.length?e:this.ttInstance.columns.map(function(e){return e.field})).map(function(e){var t=""+o.getValue(e,n.node.data);if(t!==undefined)return"number"==typeof t?t===parseFloat(i):-1<t.indexOf(i);console.warn("不存在列 "+e)}).reduce(function(e,t){return e||t},!1)},E.prototype.getValue=function(e,t){if(e){if(!(-1<e.indexOf(".")))return t[e];try{return e.split(".").reduce(function(e,t){return e?e[t]:null},t)}catch(n){console.log(e)}}},E.prototype.getFindTextTotal=function(e,i,t){var o,s,r=this,n=[e];return"*"===e?n=this.ttInstance.columns.map(function(e){return e.field}):-1<e.indexOf(",")&&(n=e.split(",").map(function(e){return e.trim()})),o=n,s=0,t.forEach(function(n){o.forEach(function(e){var t=""+r.getValue(e,n.node.data);t!==undefined&&-1<t.indexOf(i)&&s++})}),s},E.prototype.searchOnClient=function(t,n,e){var i=this;return n?"*"===t?e.filter(function(e){return i.searchExpression(e,n)}):-1<t.indexOf(",")?e.filter(function(e){return i.searchExpression(e,n,t.split(",").map(function(e){return e.trim()}))}):(n=n.toLowerCase(),-1===t.indexOf(".")?e.filter(function(e){return-1<(""+e.node.data[t]).toLowerCase().indexOf(n)}):e.filter(function(e){return-1<(""+i.getValue(t,e.node.data)).toLowerCase().indexOf(n)})):[]},E.prototype.findParents=function(e,t){var n=this,i=[];return e.forEach(function(e){i=i.concat(n.findParent(e.node,t))}),Array.from(new Set(i))},E.prototype.resetTreeData=function(t,n){var i=this,o=[],e=[];return null===t?e=n.filter(function(e){return e.parent===t}):(t.node.expanded=!0,(e=n.filter(function(e){return e.parent&&e.parent.data[i.ttInstance.idField]===t.id})).length?t.node.children=e.map(function(e){return e.node}):t.node.children=[]),e.forEach(function(e){e.visible=!0,o.push(e),o=o.concat(i.resetTreeData(e,n))}),o},E.prototype.searchOnServer=function(e,t){},E);function E(e){this.ttInstance=e,this.allNodes=[]}var R=(T.decorators=[{type:g.Directive,args:[{selector:"tt-column, [tt-column]"}]}],T.propDecorators={field:[{type:g.Input}],title:[{type:g.Input}],width:[{type:g.Input}],hAlign:[{type:g.Input}],align:[{type:g.Input}],formatter:[{type:g.Input}]},T);function T(){}var O=(Object.defineProperty(z.prototype,"groupColumns",{get:function(){return this._groupColumns},set:function(e){this._groupColumns=e||[],this.columns=this.ttService.checkColumnsForGroupHeader(e.map(function(e){return b(e)}),this).columns},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e,this.updateSerializedValue(),this.initNodeStatus(),this.setNewColumnsWidth(),this.loadedData.emit()},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"allCheckbox",{set:function(e){this.headerCheckboxCmp=e},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"selections",{get:function(){return this._selections},set:function(e){var t=this;if(e&&e.length){this._selections=e.filter(function(e){return e&&t.findRowNode(e.id)});var n=this._selections.map(function(e){return e.id});(n.length!==this.selectValues.length||n.length===this.selectValues.length&&this.difference(n,this.selectValues).length)&&(this.selectValues=n,setTimeout(function(){t.selectValuesChange.emit(n)}))}else this._selections=[],this.selectValues=[],this.selectValuesChange.emit([])},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"selectedRow",{get:function(){return this._selectedRow},set:function(e){(this._selectedRow=e)?this.selectValue!==e.id&&(this.selectValue=e.id,this.selectValueChange.emit(e.id)):(this.selectValue=null,this.selectValueChange.emit(null))},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"checkeds",{get:function(){return this._checkeds},set:function(e){var t=this;if(e&&e.length){this._checkeds=e.filter(function(e){return t.findRowNode(e.id)});var n=this._checkeds.map(function(e){return e.id});(n.length!==this.checkValues.length||n.length===this.checkValues.length&&this.difference(n,this.checkValues).length)&&(this.checkValues=n,setTimeout(function(){t.checkValuesChange.emit(n)}))}else this._checkeds=[],this.checkValues=[],this.checkValuesChange.emit([])},enumerable:!0,configurable:!0}),z.prototype.checkOptons=function(){var e=this;if(this.nowrap||(this.virtualized=!1),setTimeout(function(){e.reSetSize(),e.setScorllBodyHeight()}),this.multiSelect&&(this.singleSelect=!1),this.singleSelect&&this.showCheckbox&&(this.checkOnSelect=!0,this.selectOnCheck=!0),this.beforeSortColumn||(this.beforeSortColumn=function(){return p.of(!0)}),this.fit){this.renderer.addClass(this.el.nativeElement,"f-utils-fill-flex-column");var t=this.el.nativeElement.parentElement||this.el.nativeElement.parentNode;t&&this.renderer.setStyle(t,"overflow","hidden")}this.beforeClickNode||(this.beforeClickNode=function(){return p.of(!0)}),this.beforeCheckAll||(this.beforeCheckAll=function(){return p.of(!0)}),this.beforeUnCheckAll||(this.beforeUnCheckAll=function(){return p.of(!0)}),this.autoWidth&&(this.fitColumns=!1,this.resizableColumns=!1)},z.prototype.ngOnInit=function(){var s=this;this.id="Treetable-"+this._UUID,this.styleElement=this.utils.createStyleSheet(this.styleSheetId),this.checkColumnOption(),this.checkOptons(),this.ngZone&&this.ngZone.runOutsideAngular(function(){s.el.nativeElement.parentElement&&(s.ro=new i(function(e,t){var n=e[0].contentRect,i=n.width,o=n.height;s.fit&&s.resize({width:i,height:o})}),s.ro.observe(s.el.nativeElement.parentElement))}),this.paginationOptions=this.initPaginationOptions()},z.prototype.ngOnDestroy=function(){this.ro&&(this.el.nativeElement.parentElement&&this.ro.unobserve(this.el.nativeElement.parentElement),this.ro=null),this.findKeysHandler&&this.findKeysHandler.unsubscribe(),this.utils.removeStyleSheet(this.styleSheetId)},z.prototype.ngOnChanges=function(e){e.data&&!e.data.isFirstChange()&&(this.isDataChanged=e.data.currentValue!==e.data.previousValue),e.multiSelect&&!e.multiSelect.isFirstChange()&&(this.singleSelect=!e.multiSelect.currentValue,this.singleSelect&&this.showCheckbox&&(this.selectOnCheck=!0,this.checkOnSelect=!0)),e.disabled&&!e.disabled.isFirstChange()&&(this.hovered=!e.disabled.currentValue),e.enableFindText&&!e.enableFindText.isFirstChange()&&this.setFindText(e.enableFindText.currentValue),e.selectValue&&!e.selectValue.isFirstChange()&&this.selectNode(e.selectValue.currentValue),e.selectValues&&!e.selectValues.isFirstChange()&&this.selectNodes(e.selectValues.currentValue),e.checkValues&&!e.checkValues.isFirstChange()&&this.checkedNodes(e.checkValues.currentValue),e.pageIndex===undefined||e.pageIndex.isFirstChange()||(this.paginationOptions=Object.assign(this.paginationOptions,{currentPage:this.pageIndex})),e.pageSize===undefined||e.pageSize.isFirstChange()||(this.paginationOptions=Object.assign(this.paginationOptions,{itemsPerPage:this.pageSize})),e.pageList===undefined||e.pageList.isFirstChange()||(this.paginationOptions=Object.assign(this.paginationOptions,{pageList:this.pageList})),e.total===undefined||e.total.isFirstChange()||(this.paginationOptions=Object.assign(this.paginationOptions,{totalItems:this.total})),e.fitColumns&&!e.fitColumns.isFirstChange()&&this.setTableWidth(this.allColumnsWidth())},z.prototype.ngAfterViewChecked=function(){},z.prototype.ngAfterContentInit=function(){var t=this;this.templates.forEach(function(e){switch(e.getType()){case"header":t.headerTemplate=e.template;break;case"body":t.bodyTemplate=e.template}}),this.columnsRef.length&&(this.columns=this.ttc2columns(this.columnsRef),this.columnsRef.changes.subscribe(function(e){t.columns=t.ttc2columns(e)}))},z.prototype.ngAfterViewInit=function(){this.containerElement=this.el.nativeElement.querySelector(".farris-treetable"),this.loadedData.emit(),this.registerShortcuts(),this.setNewColumnsWidth(),this.setRightFixedColumnShadow(),this.el&&this.farrisInstances&&this.farrisInstances.add(this.el.nativeElement,this)},z.prototype.setNewColumnsWidth=function(){var s=this;if(this.autoWidth){var r=[],e=[];this.showHeader&&this.headerTable&&(r=Array.from(this.headerTable.nativeElement.querySelectorAll("th"))),this.serializedValue&&this.serializedValue.length&&this.bodyTable&&(e=Array.from(this.bodyTable.nativeElement.querySelector("tr").querySelectorAll("td"))),e.forEach(function(e,t){var n=e.getAttribute("field"),i=e.getBoundingClientRect().width.toFixed(2),o=s.columns.find(function(e){return e.field===n});o&&o.width!==undefined&&(i=i>o.width?i:o.width,e.style.minWidth=i+"px"),r[t].style.width=i+"px"})}},z.prototype.columnIsVisible=function(e){return this.ttService.columnIsVisible(e,this)},z.prototype.columnCssName=function(e){return"#"+this.id+' .treetable-cell[field="'+e.field+'"], #'+this.id+' .treetable-header-cell[field="'+e.field+'"]:not(.group-header-cell)'},z.prototype.sortColumnsByFixed=function(e){void 0===e&&(e=!0);var n=this.columns.filter(function(e){return"left"===e.fixed}),t=this.columns.filter(function(e){return!e.fixed||"center"===e.fixed}),i=this.columns.filter(function(e){return"right"===e.fixed});if(n&&n.length&&n.forEach(function(e,t){e.left=t?n[t-1].width:0}),i&&i.length){var o=i.reduce(function(e,t){return e+t.width},0);i.forEach(function(e,t){o-=e.width,e.right=o})}e&&(this.columns=n.concat(t).concat(i))},z.prototype.checkColumnOption=function(){var r=this,l=[];this.fitColumns||this.sortColumnsByFixed(),this.columns.forEach(function(e,t){e.visible===undefined&&(e.visible=!0),e.halign&&(e.hAlign=e.halign),e.width===undefined&&(e.width=100),e.id||(e.id="treetable-header-"+(e.field||t))});var a=this.allColumnsWidth(),c=0,e=this.columns.filter(function(e){return"right"===e.fixed});e&&e.length?(e[0].rightShadowCol=!0,e[e.length-1].lastColumn=!0):this.columns&&this.columns.length&&(this.columns[this.columns.length-1].lastColumn=!0);var t=this.columns.filter(function(e){return"left"===e.fixed});t&&t.length&&(t[t.length-1].leftShadowCol=!0),this.columns.forEach(function(e,t){var n=r.columnIsVisible(e),i=r.columnCssName(e),o=r.utils.getCssRule(i,r.styleElement.sheet);if(o)o.style.display=n?"":"none";else{var s=i+" { ";s+=n?"":"display: none;",r.fitColumns?s+="width: "+(e.width/a*100).toFixed(2)+"%;":(s+="width: "+e.width+"px;",e.fixed&&("left"===e.fixed&&(s+="left: "+e.left+"px",c++),"right"===e.fixed&&(s+="right: "+e.right+"px",c++))),s+="}",l.push(s)}}),l.length&&this.utils.appendCssRules(l,this.styleElement.sheet),this.setTableWidth(a),this.paginationForChildren&&this.columns.push({field:"__nodespagerbar__",width:100,title:"",align:"center",template:this.nodesPagerBar}),this.fixedColumns=!!c},z.prototype.setTableWidth=function(e){this.headerTable&&this.bodyTable&&(this.fitColumns?(this.headerTable.nativeElement.style.width="100%",this.bodyTable.nativeElement.style.width="100%"):(this.headerTable.nativeElement.style.width=e+"px",this.bodyTable.nativeElement.style.width=e+"px"))},z.prototype.allColumnsWidth=function(){var n=this;return this.columns.reduce(function(e,t){return n.columnIsVisible(t)?e+t.width:e},0)},z.prototype.onPageChange=function(e){this.pageChanged.emit(e)},z.prototype.onPageSizeChange=function(e){this.pageSizeChanged.emit(e)},z.prototype.updatePageInfo=function(e){if(e&&Object.keys(e).length){var t={};e.total!==undefined&&(t.totalItems=e.total),e.pageIndex!==undefined&&(t.currentPage=e.pageIndex),e.pageSize!==undefined&&(t.itemsPerPage=e.pageSize),e.pageList!==undefined&&(t.pageList=e.pageList),this.paginationOptions=Object.assign(this.paginationOptions,t)}},z.prototype.initPaginationOptions=function(){return{id:"Farris-TreeTable-Pagination_"+this._UUID,itemsPerPage:this.pageSize,currentPage:this.pageIndex,pageList:this.pageList,totalItems:this.total,remote:this.pagerOnServer}},z.prototype.getNodeText=function(e,t){if(!e.isMultilingualField)return this.utils.getValue(e.field,t,!0);var n=this.utils.getValue(e.field,t);if(this.localeService){var i=this.localeService.localeId||"zh-CHS";return n&&"object"==typeof n&&0<Object.keys(n).length?n[i]:n}},z.prototype.initNodeStatus=function(){this.singleSelect?this.selectValue&&this.selectNode(this.selectValue,!1):(this.checkValues&&this.checkValues.length&&this.checkedNodes(this.checkValues,!1,!1),this.selectValues&&this.selectValues.length&&!this.onlySelectSelf&&this.selectNodes(this.selectValues,!1,!1))},z.prototype.registerShortcuts=function(){var e=this;this.showFilterBar&&this._hotKeys&&this._hotKeys.addShortcut({keys:"enter",element:this.inputGroup.textbox.nativeElement}).subscribe(function(){e.onSearch()}),this.setFindText(this.enableFindText)},z.prototype.setFindText=function(e){var t=this;void 0===e&&(e=!0),this.enableFindText=e,this.enableFindText&&this._hotKeys?this.findKeysHandler=this._hotKeys.addShortcut({keys:"control.shift.f"}).subscribe(function(e){t.enableFindText&&(t.showFindInput=!0,t.detectChanges())}):(this.showFindInput&&(this.showFindInput=!1,this.cdRef.detectChanges()),this.findKeysHandler&&(this.findKeysHandler.unsubscribe(),this.findKeysHandler=null))},z.prototype.getCustomCls=function(e,t,n){void 0===t&&(t=""),void 0===n&&(n="row");var i={},o=this.rowStyler;if("cell"===n&&(o=this.cellStyler),o){var s=o(e.node,t);if(s){var r=[];if("string"==typeof s?r=[s]:Array.isArray(s)&&(r=s),r.length){var l={};return r.forEach(function(e){l[""+e]=!0}),y({},l,i)}return s}return i}return i},z.prototype.getRowCls=function(e,t){return this.getCustomCls(e,"row")},z.prototype.getCellCls=function(e,t){return this.getCustomCls(e,t,"cell")},z.prototype.getRealColWidth=function(e){var n=this;if(this.columns&&this.columns.length&&this.fitColumns){var t=this.columns.reduce(function(e,t){return e+(n.columnIsVisible(t)?t.width:0)},0);return this.columnIsVisible(e)?(e.width/t*100).toFixed(2)+"%":0}return e.width+"px"},z.prototype.onResized=function(){this.resizeSer.windowResized()},z.prototype.setRightFixedColumnShadow=function(){if(this.psRef&&this.psRef.directiveRef){var e=this.psRef.directiveRef.instance;if(!e)return;if(e.containerWidth+e.scrollbarXLeft<e.contentWidth){var t=this.columns.filter(function(e){return"right"===e.fixed}),n="#"+this.id+".f-treetable--fixed-columns";if(t&&t.length){var i=n+" [r-tt-shadow-col]::before{\n                        box-shadow:#d9d9d9 -12px 0px 8px -12px inset;\n                    }";this.utils.appendCssRules([i],this.styleElement.sheet)}}}},z.prototype.setFixedColumnShadow=function(e,t){var n=this.columns.filter(function(e){return"left"===e.fixed}),i=this.columns.filter(function(e){return"right"===e.fixed}),o="#"+this.id+".f-treetable--fixed-columns",s="",r="",l="",a="";if(n&&n.length&&(l=(s=o+' [field="'+n[n.length-1].field+'"]::after')+"{\n                box-shadow:#d9d9d9 12px 0px 8px -12px inset;\n            }"),i&&i.length&&(a=(r=o+" [r-tt-shadow-col]::before")+"{\n                box-shadow:#d9d9d9 -12px 0px 8px -12px inset;\n            }"),0===e)s&&this.utils.removeCssRule(s,this.styleElement.sheet);else if((e+t.srcElement.offsetWidth).toFixed()==t.srcElement.scrollWidth)r&&this.utils.removeCssRule(r,this.styleElement.sheet);else{var c=[];l&&c.push(l),a&&c.push(a),this.utils.appendCssRules(c,this.styleElement.sheet)}},z.prototype.onScrollX=function(e){if(this.showHeader&&this.headerBox){var t=e.srcElement.scrollLeft;this.state.scrollX=t,this.headerBox.nativeElement.scrollLeft=t,this.setFixedColumnShadow(t,e)}},z.prototype.onScrollY=function(e){if(this.virtualized){var t=e.target.scrollTop,n=this.scrollLoader.getRowNodes(t),i=n.data,o=n.topHideHeight,s=n.bottomHideHeight;this.state.scrollY=t,this.serializedValue=i,this.topHideHeight=o,this.bottomHideHeight=s,this.detectChanges()}},z.prototype.onSearchValueChange=function(e){e||this.onClearSearchValue()},z.prototype.onClearSearchValue=function(){this.searchData.value="",this.clearSearchValue.emit()},z.prototype.onCellClick=function(e,t,n){this.cellClick.emit({event:e,col:t,node:n})},z.prototype.trackByFn=function(e,t){return t.id},z.prototype.formatData=function(e,t,n){var i=this.getNodeText(e,t);return this.colFormatSer.format(i,t,n)},z.prototype.columnsChanged=function(){this.checkColumnOption(),this.detectChanges()},z.prototype.ttc2columns=function(e){return e.map(function(e){return{field:e.field,title:e.title,align:e.align,hAlign:e.hAlign,width:e.width,formatter:e.formatter}})},z.prototype.reSetSize=function(){if(this.fit){var e=this.el.nativeElement.parentNode;this.width=e.offsetWidth,this.height=e.offsetHeight}},z.prototype.renderVirtualRowNodes=function(e){var t=this;if(void 0===e&&(e=null),this.virtualized){var n=e||this.state.scrollY,i=this.scrollLoader.getRowNodes(n);this.serializedValue=i.data,this.topHideHeight=i.topHideHeight,this.bottomHideHeight=i.bottomHideHeight,this.detectChanges(),e&&this.ngZone.runOutsideAngular(function(){setTimeout(function(){t.psRef.directiveRef.elementRef.nativeElement.scrollTop=e},20)})}},z.prototype.updateSerializedValue=function(e){void 0===e&&(e=null),this.serializedValue=[],this.searchHandle.allNodes=[],this.state.rowNodes=[],this.serializeNodes(null,this.data,0,!0),this.virtualized&&this.fixedHeader?this.renderVirtualRowNodes(e):(this.serializedValue=this.state.rowNodes,this.detectChanges())},z.prototype.serializeNodes=function(u,p,f,g,m){var y=this;p&&p.length&&p.forEach(function(e,t){e.parent=u,e.hasOwnProperty("selectable")||(e.selectable=!0),e.hasOwnProperty("showIcon")||(e.showIcon=!0),"yes"===y.onlySelectLeaf&&e.selectable&&(e.selectable=!!e.leaf);var n=e.data[y.idField];e.id=n;var i=-1<y.findIndexInSelection(e),o=-1<y.findIndexInCheckeds(e),s=t===p.length-1,r=0===t,l=[],a=null;if(u){var c=u.data[y.idField],d=m||[];(l=l.concat(d.map(function(e){return e}))).push(c),a=y.state.rowNodes.find(function(e){return e.id===u.id})}var h={id:n,node:e,parent:u,level:f,visible:g&&(!u||u.expanded),isSelected:i,isChecked:o,parents:l,parentRowNode:a,index:y.state.rowNodes.length,last:s,first:r};y.state.rowNodes.push(h),y.serializeNodes(e,e.children,f+1,h.visible,l)})},z.prototype.isSelected=function(t){var n=this;return this.singleSelect?!(!t||!this.selectedRow)&&t.data[this.idField]===this.selectedRow.data[this.idField]:!(!this.selections||!this.selections.length)&&-1<this.selections.findIndex(function(e){return e.data[n.idField]===t.data[n.idField]})},z.prototype.isChecked=function(t){var n=this;return!(!t||!this.checkeds)&&this.checkeds instanceof Array&&-1<this.checkeds.findIndex(function(e){return e.data[n.idField]===t.data[n.idField]})},z.prototype.unSelectedCurrentRowEmit=function(){var e=this.selectedRow;e&&this.nodeUnSelect.emit({node:e,type:"row",instance:this})},z.prototype._singleSelectNode=function(e){this.clearSelections(),this.selectedRow=e.rowNode.node,this.selectRowIndex=e.rowIndex,this.selections=[e.rowNode.node],e.rowNode.isSelected=!0,this.showCheckbox&&(e.rowNode.isChecked=!0,this.clearCheckeds(),this.setCheckeds(e.rowNode));var t={originalEvent:e.originalEvent,node:e.rowNode.node,type:"row",index:e.rowIndex,parents:e.rowNode.parents,instance:this};this.nodeSelected.emit(t)},z.prototype._singleUnSelectNode=function(e){this.selectedRow=null,this.selectRowIndex=-1,e.rowNode.isSelected=!1,e.rowNode.isChecked=!1,this.selections=[],this.nodeUnSelect.emit({originalEvent:e.originalEvent,node:e.rowNode.node,type:"row",parents:e.rowNode.parents,instance:this})},z.prototype.__singleSelectNode=function(e,t){void 0===t&&(t=!1),t?this.keepSelect||this._singleUnSelectNode(e):(this.unSelectedCurrentRowEmit(),this._singleSelectNode(e))},z.prototype.__multiSelectNode=function(e,t){void 0===t&&(t=!1);var n=e.rowNode;t?this.keepSelect||(this.singleSelectWhenMultiSelect(n,!1),this.nodeUnSelect.emit({originalEvent:e.originalEvent,node:n.node,type:"row",index:e.rowIndex,parents:n.parents,instance:this})):(this.unSelectedCurrentRowEmit(),this.singleSelectWhenMultiSelect(n,!0),this.nodeSelected.emit({originalEvent:e.originalEvent,node:n.node,type:"row",index:e.rowIndex,parents:n.parents,instance:this}))},z.prototype.handleRowClick=function(e){var t=e.rowNode;t.node.elementRef=e.originalEvent.target;var n=this.isSelected(t.node);if(this.singleSelect)this.__singleSelectNode(e,n);else if(t.indeterminate=!1,this.onlySelectSelf)this.__multiSelectNode(e,n);else if(t.isSelected=!n,this.setSelections(t),this.checkOnSelect){t.isChecked=!n,this.setCheckeds(t),this.ttService.onChangeCheckboxStatus(t);var i=this.cascadeNodes(t,t.isChecked);t.isChecked?this.nodeChecked.emit({originalEvent:e,node:t.node,nodes:i,instance:this}):this.nodeUnChecked.emit({originalEvent:e,node:t.node,nodes:i,instance:this})}this.detectChanges()},z.prototype.singleSelectWhenMultiSelect=function(e,t){this.checkOnSelect&&(e.isChecked=t,this.setCheckeds(e),this.cascadeNodes(e,e.isChecked),e.isChecked?this.nodeChecked.emit({originalEvent:event,node:e.node,instance:this}):this.nodeUnChecked.emit({originalEvent:event,node:e.node,instance:this})),this.clearSelections(),this.onlySelectSelf&&(this.selectedRow=e.node),e.isSelected=t,this.setSelections(e)},z.prototype.selectWhenChecked=function(e,t,n){e.isChecked=t,this.setCheckeds(e),this.selectOnCheck&&(this.onlySelectSelf&&this.clearSelections(),this.singleSelect&&this.showCheckbox&&this.clearCheckeds(),e.isSelected=t,this.setSelections(e),e.isSelected?this.nodeSelected.emit({originalEvent:n,node:e.node,instance:this,type:"checkbox"}):this.nodeUnSelect.emit({originalEvent:n,node:e.node,instance:this,type:"checkbox"}))},z.prototype.isInArray=function(t,e){var n=this;return(!e||0!==e.length)&&-1<e.findIndex(function(e){return e.data[n.idField]===t.id})},z.prototype.setSelections=function(t){var n=this;if(t.isSelected)this.selections||(this.selections=[]),this.isInArray(t,this.selections)||this.selections.push(t.node);else if(this.selections){var e=this.selections.findIndex(function(e){return e.data[n.idField]===t.node.data[n.idField]});-1!==e&&this.selections.splice(e,1)}},z.prototype.setCheckeds=function(t){var n=this;if(t.isChecked)this.checkeds||(this.checkeds=[]),this.isInArray(t,this.checkeds)||this.checkeds.push(t.node);else if(this.checkeds){var e=this.checkeds.findIndex(function(e){return e.data[n.idField]===t.node.data[n.idField]});-1!==e&&this.checkeds.splice(e,1)}},z.prototype.getDiffrentData=function(e){var n=this;if(e.length){var i=[];return e.forEach(function(t){-1===i.findIndex(function(e){return e.data[n.idField]===t.data[n.idField]})&&i.push(t)}),i}return e},z.prototype.cascadeNodes=function(e,t){var n=this.propagateSelectionDown(e,t);return n=n.concat(this.propagateSelectionUp(e,t)),this.updateAllCheckboxStatus(),this.getDiffrentData(n)},z.prototype.toggleNodeWithCheckbox=function(e,t,n){t.indeterminate=!1,this.ttService.onChangeCheckboxStatus(t);var i=this.cascadeNodes(t,n);n?this.nodeChecked.emit({originalEvent:e,node:t.node,nodes:i,instance:this}):this.nodeUnChecked.emit({originalEvent:e,node:t.node,nodes:i,instance:this}),this.selectWhenChecked(t,n,e),this.checkeds=b(this.checkeds),this.detectChanges(),e.stopPropagation()},z.prototype.toggleNodesWithCheckbox=function(e,t){t?this.data&&this.data.length&&this.checkAllNodes({originalEvent:e,checked:t,instance:this}):(this.selections=null,this.unCheckAllNodes({originalEvent:e,checked:t,instance:this})),this.detectChanges()},z.prototype.cascadeCheckedNode=function(e,t){var n=[];return!e.node.selectable&&e.node.selectable!==undefined||(e.isChecked=t,this.setCheckeds(e),this.selectOnCheck&&(e.isSelected=t,this.setSelections(e)),this.isInArray(e,n)||n.push(e.node)),n},z.prototype.propagateSelectionDown=function(e,i){var o=this,s=this.cascadeCheckedNode(e,i);return this.cascadeCheck&&this.cascadeDown&&e.node.children&&e.node.children.length&&e.node.children.forEach(function(t,e){var n=o.state.rowNodes.find(function(e){return e.id===t.data[o.idField]});n&&n.node.selectable&&(n.indeterminate=!1,n.isChecked=i,o.ttService.onChangeCheckboxStatus(n),s=s.concat(o.propagateSelectionDown(n,i)))}),s},z.prototype.propagateSelectionUp=function(e,o){var s=this,r=this.cascadeCheckedNode(e,o);if(this.cascadeCheck&&this.cascadeUp&&e.node.parent&&e.parents&&e.parents.length){var l=[];e.parents.forEach(function(e,t){var n=s.findRowNode(e);if(n&&n.node.selectable){var i=s.cascadeCheckedNode(n,o);i.length&&r.push(i[0]),l.push(n)}}),l.reverse().forEach(function(e){s.updateCheckboxStatus(e)})}return r},z.prototype.updateAllCheckboxStatus=function(){var e=this.isIndeterminate();this.showCheckAll&&!this.singleSelect&&this.showCheckbox&&e!==undefined&&this.headerCheckboxCmp&&(this.headerCheckboxCmp.chkAll.nativeElement.indeterminate=2===e,this.headerCheckboxCmp.checked=1===e)},z.prototype.updateParentCheckboxStatus=function(e){var n=this,i=[];e.parents.forEach(function(e){var t=n.findRowNode(e);t&&i.push(t)}),i.reverse().forEach(function(e){n.updateCheckboxStatus(e)})},z.prototype.updateParentsCheckStatus=function(e){var t=this,n=[];e.forEach(function(e){n=b(n,e)}),n=Array.from(new Set(n)),this.findRowNodes(n).sort(function(e,t){return t.level-e.level}).forEach(function(e){t.updateCheckboxStatus(e)})},z.prototype.updateCheckboxStatus=function(e){var t=this.isIndeterminate(e);t!==undefined&&e.node.selectable&&(e.indeterminate=2===t,this.ttService.onChangeCheckboxStatus(e))},z.prototype.isIndeterminate=function(e){var t=this.getCheckboxStatus(e);if(t!==undefined){var n=!1;n=2!==t&&!!t,e&&e.node.selectable&&(e.isChecked=n,this.setCheckeds(e))}return t},z.prototype.getCheckboxStatus=function(n){var e,i=this,o=0,s=0,t=[];return e=(t=n?n.node.children||[]:this.state.rowNodes.filter(function(e){return 0===e.level})).length,t.forEach(function(e){var t=e;n&&(t=i.findRowNode(e.data[i.idField])),t&&!t.indeterminate&&(t.isChecked?s++:o++)}),0===e?undefined:o===e?0:s===e?1:2},z.prototype.findIndexIn=function(n,e){var i=this,t=-1;return e&&e.length&&(t=e.findIndex(function(e,t){return i.equals(e,n)})),t},z.prototype.findIndexInCheckeds=function(e){return this.findIndexIn(e,this.checkeds)},z.prototype.findIndexInSelection=function(e){return this.findIndexIn(e,this.selections)},z.prototype.equals=function(e,t){return e.data[this.idField]===t.data[this.idField]},z.prototype.toggleExpand=function(e,n){var i=this;void 0===n&&(n=!1),e?(e.expanded=!e.expanded,this.toggleVisible(e),this.virtualized&&e.children&&e.children.length&&this.renderVirtualRowNodes(),e.expanded?this.expand.emit(e):this.collapse.emit(e),n&&e.children&&e.children.length&&e.children.forEach(function(e,t){i.toggleExpand(e,n)})):this.data&&this.data.length&&this.data.forEach(function(e){i.toggleExpand(e)}),this.setNewColumnsWidth()},z.prototype.toggleVisible=function(n){var i=this,e=this.findRowNode(n.data[this.idField]);if(e){var t=e.id;this.state.rowNodes.filter(function(e){return-1<e.parents.indexOf(t)}).forEach(function(e){var t=i.findRowNode(e.parent.data[i.idField]);e.visible=t?t.visible&&e.parent.expanded:n.expanded})}},z.prototype.expandNode=function(e,t){if(void 0===t&&(t=!0),e){var n=this.findRowNode(e);n?(n.node.expanded=!0,this.toggleVisible(n.node),this.virtualized?n.node.children&&n.node.children.length&&this.renderVirtualRowNodes():this.detectChanges(),t&&this.expand.emit(n.node),this.setNewColumnsWidth()):console.error("Con't find tree node widh id:"+e)}else console.error("PARAM id is null")},z.prototype.expandAll=function(){this.state.rowNodes=this.state.rowNodes.map(function(e){return e.node.expanded=!0,e.visible=!0,e}),this.virtualized?this.renderVirtualRowNodes():this.serializedValue=this.state.rowNodes,this.setNewColumnsWidth(),this.expandAllNodes.emit(),this.detectChanges()},z.prototype.expandNodes=function(e){},z.prototype.expandAllNodesBy=function(t){t&&(t.node.expanded=!0,t.visible=!0,this.state.rowNodes.filter(function(e){return-1<e.parents.indexOf(t.id)}).forEach(function(e){e.visible=!0,e.node.expanded=!0}),this.detectChanges(),this.setNewColumnsWidth())},z.prototype.collapseNode=function(e){if(e){var t=this.findRowNode(e);t?(t.node.expanded=!1,this.toggleVisible(t.node),this.detectChanges(),this.setNewColumnsWidth(),this.collapse.emit(t.node)):console.error("Con't find tree node widh id:"+e)}else console.error("PARAM id is null")},z.prototype.collapseAll=function(){this.state.rowNodes=this.state.rowNodes.map(function(e){return e.node.expanded=!1,e.visible=!e.parent,e}),this.virtualized?this.renderVirtualRowNodes():this.serializedValue=this.state.rowNodes,this.collapseAllNodes.emit(),this.detectChanges(),this.setNewColumnsWidth()},z.prototype.getContainerOffset=function(){var e=this.containerElement.getBoundingClientRect();return{left:e.left+document.body.scrollLeft,top:e.top+document.body.scrollTop}},z.prototype.onColumnResizeBegin=function(e){var t=Math.round(this.getContainerOffset().left);this.lastResizerHelperX=e.pageX-t+this.containerElement.scrollLeft,e.preventDefault()},z.prototype.onColumnResize=function(e){if(this.resizableColumns){var t=this.getContainerOffset().left;this.renderer.addClass(this.containerElement,"ui-unselectable-text"),this.resizerHelperVC.nativeElement.style.height=this.containerElement.offsetHeight+"px",this.resizerHelperVC.nativeElement.style.top="0px",this.resizerHelperVC.nativeElement.style.left=e.pageX-t+"px",this.resizerHelperVC.nativeElement.style.display="block"}},z.prototype.onColumnResizeEnd=function(e,t){var n=this.resizerHelperVC.nativeElement.offsetLeft-this.lastResizerHelperX,i=t.offsetWidth+n,o=t.style.minWidth||15,s=this.columns.findIndex(function(e){return e.id===t.id});if(this.fitColumns){if(o<i){for(a=t.nextElementSibling;!a.offsetParent;)a=a.nextElementSibling;if(a){var r=a.offsetWidth-n,l=a.style.minWidth||15;15<i&&l<r&&(this.resizeColGroup(this.headerTable.nativeElement,s,i,r),this.resizeColGroup(this.bodyTable.nativeElement,s,i,r))}}}else{this.resizeColGroup(this.headerTable.nativeElement,s,i,0),this.resizeColGroup(this.bodyTable.nativeElement,s,i,0),this.columns[s]&&(this.columns[s].width=i),this.sortColumnsByFixed(!1),this.setTableWidth(this.allColumnsWidth());var a,c=this.columns[s];if(c){var d=this.columnCssName(c)+"{width:"+i+"px}";this.utils.appendCssRules([d],this.styleElement.sheet)}(a=this.columns[s+1])&&a.fixed&&(d=this.columnCssName(a)+"{"+a.fixed+":"+a[a.fixed]+"px}",this.utils.appendCssRules([d],this.styleElement.sheet))}this.resizerHelperVC.nativeElement.style.display="none",this.renderer.removeClass(this.containerElement,"ui-unselectable-text"),this.psRef.directiveRef.update()},z.prototype.resizeColGroup=function(e,t,n,i){if(e){var o="COLGROUP"===e.children[0].nodeName?e.children[0]:null;if(!o)throw new Error("Scrollable tables require a colgroup to support resizable columns");var s=o.children[t],r=s.nextElementSibling;s.style.width=n+"px",r&&i&&this.fitColumns&&(r.style.width=i+"px")}},z.prototype.onSearch=function(){this.search.emit(this.searchData)},z.prototype.insert=function(e,t){t?(t.children||(t.children=[]),t.children.push(e),this.expandNode(t.data[this.idField]),this.appendNew.emit({parent:t})):this.data.push(e),this.updateSerializedValue()},z.prototype.append=function(e,t){e&&e[this.idField]?this.insert({data:e,id:e[this.idField]},t):console.warn("Please set id value.")},z.prototype.emitAppendNew=function(e){if(this.virtualized){var t=this.psRef.directiveRef.elementRef.nativeElement.scrollTop;this.updateSerializedValue(t)}else this.updateSerializedValue()},z.prototype.appendChildren=function(e,t,n){var i;if(void 0===n&&(n=!0),e&&e.length){if(!t)throw new Error("未找到父级节点");(i=t.children).push.apply(i,b(e)),this.emitAppendNew(t),n&&this.appendNew.emit({parent:t})}else this.updateSerializedValue(),console.warn("添加子节点的数据为空")},z.prototype.loadChildren=function(e,t,n){void 0===n&&(n=!0),t&&(t.children=e||[],this.emitAppendNew(t),n&&this.appendNew.emit({parent:t}))},z.prototype.remove=function(t){var n=this;if(t){var e=this.findRowNode(t);e&&(this.selectValue===t&&(this.selectedRow=null,this.selectValue=null),e.parent?s.remove(e.parent.children,function(e){return e.data[n.idField]===t}):(s.remove(this.state.rowNodes,function(e){return e.id===t}),this.data=this.data.filter(function(e){return e.data[n.idField]!==t})),this.updateSerializedValue(),this.detectChanges(),this.ttService.onRemove(e),this.removed.emit(e))}},z.prototype.update=function(e,t){if(e&&t){var n=this.findRowNode(e);n&&(n.node.data=s.extend(n.node.data,t),this.detectChanges(),this.ttService.onUpdate(n),this.updated.emit(n))}},z.prototype.setScorllBodyHeight=function(){if(this.scorllBodyHeight=this.height,this.showFilterBar&&(this.scorllBodyHeight=this.scorllBodyHeight-46),this.fixedHeader&&this.showHeader)if(this.headerBox&&(this.headerWrap||this.useGroupHeader)){var e=this.headerBox.nativeElement.clientHeight;this.scorllBodyHeight=this.scorllBodyHeight-e}else this.scorllBodyHeight=this.scorllBodyHeight-this.headerHeight;this.pagination&&(this.scorllBodyHeight=this.scorllBodyHeight-this.pagerHeight),this.detectChanges()},z.prototype.resize=function(e){e&&(this.width=e.width,this.height=e.height),this.setScorllBodyHeight(),this.data&&this.data.length&&this.renderVirtualRowNodes()},z.prototype.loadData=function(e){this.data=e},z.prototype.empty=function(){this.data=[]},z.prototype.clearAll=function(e){var t=this;return void 0===e&&(e=!0),this.state.rowNodes.filter(function(e){return e.indeterminate}).forEach(function(e){e.indeterminate=!1,t.ttService.onChangeCheckboxStatus(e)}),this.state.rowNodes=this.state.rowNodes.map(function(e){return e.isChecked=!1,e.isSelected=!1,e.indeterminate=!1,e}),this.checkeds=[],this.selections=[],this.selectedRow=undefined,this.showCheckAll&&this.headerCheckboxCmp&&(this.headerCheckboxCmp.chkAll.nativeElement.indeterminate=!1,this.headerCheckboxCmp.checked=!1),e&&this.detectChanges(),this},z.prototype.detectChanges=function(){return this.cdRef.markForCheck(),this.cdRef.destroyed||this.cdRef.detectChanges(),this},z.prototype.clearCheckeds=function(){var t=this;return this.checkeds&&this.checkeds.length&&this.findRowNodes(this.checkeds.map(function(e){return e.data[t.idField]})).forEach(function(e){e.isChecked=!1}),this.checkeds=[],this.showCheckAll&&this.headerCheckboxCmp&&(this.headerCheckboxCmp.chkAll.nativeElement.indeterminate=!1,this.headerCheckboxCmp.checked=!1),this},z.prototype.clearSelections=function(){var t=this;if(this.selections&&this.selections.length){var e=this.selections.map(function(e){return e.data[t.idField]});this.serializedValue.forEach(function(e){e.isSelected=!1}),this.findRowNodes(e).forEach(function(e){e.isSelected=!1,t.singleSelect&&(e.isChecked=!1)})}return this.selections=undefined,this.selectedRow=undefined,this},z.prototype.selectFirstNode=function(){if(this.state.rowNodes&&this.state.rowNodes.length){var e=this.state.rowNodes.find(function(e){return e.node.selectable});e&&this.selectNode(e.id)}},z.prototype.scrollToCurrentRow=function(e){var t="rownode-"+e,n=this.el.nativeElement.querySelector("#"+t)||document.getElementById(t);return!!n&&(this.isElementInViewport(n)||n.scrollIntoView({block:"nearest",inline:"nearest"}),!0)},z.prototype.isElementInViewport=function(e){var t=this.el.nativeElement.querySelector(".farris-treetable-body");if(!t)return!1;var n=t.getBoundingClientRect().height,i=e.offsetTop-this.psRef.directiveRef.elementRef.nativeElement.scrollTop;return 0<=i&&i<=n},z.prototype.scrollToCurrentNode=function(){var n=this;if(this.selectedRow){var t=this.selectedRow.id;if(!this.scrollToCurrentRow(t)){var e=this.findRowNode(t);if(e.parents&&e.parents.length)e.parents.forEach(function(t){var e=30*n.state.rowNodes.filter(function(e){return e.visible}).findIndex(function(e){return e.id===t});n.scrollToY(e),n.expandNode(t,!1)});else{var i=30*this.state.rowNodes.filter(function(e){return e.visible}).findIndex(function(e){return e.id===t});this.scrollToY(i-30)}}}},z.prototype.selectNode=function(e,t,n){if(void 0===t&&(t=!0),void 0===n&&(n=!0),!e)return this;var i=this.findRowNode(e),o=!this.selectedRow||this.selectedRow&&e!==this.selectedRow.id;return i&&o?(this.singleSelect||this.onlySelectSelf?(this.clearSelections(),this.selections=[i.node],i.isSelected=!0,this.checkOnSelect&&this.showCheckbox&&(this.clearCheckeds(),i.isChecked=!0,this.checkeds=[i.node])):this.setSelections(i),this.selectedRow=i.node,this.selectNodeChangedSubject.next(e),this.nodeSelected.emit({node:i.node,instance:this}),t&&this.detectChanges(),n&&this.fixedHeader&&this.scrollToCurrentNode()):i||(this.selectedRow=null,console.warn("未找到ID为"+e+"的数据！！")),this},z.prototype.unSelectNode=function(e,t){void 0===t&&(t=!0);var n=this.findRowNode(e);n?(n.isSelected=!1,this.singleSelect?(this.clearSelections(),this.selectedRow=null,n.isChecked=!1,this.selections=[]):this.onlySelectSelf?this.selections=[]:this.setSelections(n),t&&this.detectChanges(),this.nodeUnSelect.emit({node:n.node,instance:this})):console.warn("未找到ID为"+e+"的数据！！")},z.prototype.selectNodes=function(e,t,n){var i=this;if(void 0===t&&(t=!0),void 0===n&&(n=!1),e&&e.length){var o=this.findRowNodes(e).map(function(e){return e.isSelected=!0,i.setSelections(e),e.node});this.selections=b(this.selections),t&&this.detectChanges(),this.selectNodeChangedSubject.next(e.join(",")),n&&this.nodeSelected.emit({node:o,instance:this})}return this},z.prototype.unSelectNodes=function(e){var t=this;if(e&&e.length){var n=this.findRowNodes(e);n&&n.length&&(n.forEach(function(e){e.isSelected=!1,t.setSelections(e)}),this.selections=b(this.selections),this.detectChanges(),this.nodeUnSelect.emit({node:n.map(function(e){return e.node}),instance:this}))}else this.clearSelections(),this.detectChanges()},z.prototype.checkedNode=function(e,t,n){if(void 0===t&&(t=!0),void 0===n&&(n=!0),this.isEnableMultiSelect()){var i=this.findRowNode(e);i?(i.isChecked=!0,this.isChecked(i.node)||(this.setCheckeds(i),t&&this.cascadeCheck&&this.cascadeUp&&this.updateParentCheckboxStatus(i)),n&&this.detectChanges(),this.nodeChecked.emit({originalEvent:null,node:i.node,instance:this})):console.warn("未找到ID为"+e+"的数据。")}},z.prototype.unCheckedNode=function(e,t){if(void 0===t&&(t=!0),this.isEnableMultiSelect()){var n=this.findRowNode(e);n?(n.isChecked=!1,this.setCheckeds(n),t&&this.cascadeCheck&&this.cascadeUp&&this.updateParentCheckboxStatus(n),this.detectChanges(),this.nodeUnChecked.emit({node:n,instance:this})):console.warn("未找到ID为"+e+"的数据。")}},z.prototype._checkedNodes=function(e,t){var n=this,i=[],o=this.findRowNodes(e).map(function(e){return i.push(e.parents),e.isChecked=t,n.setCheckeds(e),e.node});return this.checkeds=b(this.checkeds),this.cascadeCheck&&this.cascadeUp&&this.updateParentsCheckStatus(i),o},z.prototype.checkedNodes=function(e,t,n,i){if(void 0===t&&(t=!0),void 0===n&&(n=!0),this.isEnableMultiSelect()&&e&&e.length){var o=this.cascadeCheck;i&&o&&(this.cascadeCheck=!1);var s=this._checkedNodes(e,!0);i&&o&&(this.cascadeCheck=!0),this.updateAllCheckboxStatus(),t&&this.detectChanges(),n&&this.nodeChecked.emit({originalEvent:null,node:s,nodes:s,instance:this})}},z.prototype.unCheckedNodes=function(e,t,n){if(void 0===n&&(n=!0),e&&e.length){var i=this.cascadeCheck;t&&i&&(this.cascadeCheck=!1);var o=this._checkedNodes(e,!1);t&&i&&(this.cascadeCheck=!0),this.detectChanges(),n&&this.nodeUnChecked.emit({originalEvent:null,node:o,nodes:o,instance:this})}else this.clearCheckeds(),this.detectChanges()},z.prototype.findRowNode=function(t){return t&&this.state.rowNodes?this.state.rowNodes.find(function(e){return e.id===t}):undefined},z.prototype.findNode=function(e){return this.findRowNode(e)},z.prototype.getRoot=function(e){var t=this.findRowNode(e);return t?t.parents&&t.parents.length?this.findRowNode(t.parents[0]):t:null},z.prototype.findRowNodes=function(t){return this.state.rowNodes.filter(function(e){return-1<t.indexOf(e.id)})},z.prototype.checkAllNodes=function(e){var t=this,n=this.state.rowNodes.filter(function(e){return e.node.selectable||e.node.selectable===undefined});this.checkeds=n.map(function(e){return e.indeterminate=!1,t.ttService.onChangeCheckboxStatus(e),!e.node.selectable&&e.node.selectable!==undefined||(e.isChecked=!0),e.node}),this.selectOnCheck&&(this.selections=n.map(function(e){return!e.node.selectable&&e.node.selectable!==undefined||(e.isSelected=!0),e.node})),this.checkAll.emit(e),this.detectChanges()},z.prototype.unCheckAllNodes=function(e){this.clearAll(),this.unCheckAll.emit(e),this.detectChanges()},z.prototype.isEnableMultiSelect=function(){return!this.singleSelect||!!this.showCheckbox||(console.warn("未启用多选！"),!1)},z.prototype.getNodeIconFromData=function(e){var t=null,n=null,i=null;if(this.useIconFromData&&this.iconField){var o="";"string"==typeof this.iconField?n=i=t=e[o=this.iconField]?e[o]:this.utils.getValue(o,e.data):(this.iconField.leaf&&(t=this.utils.getValue(this.iconField.leaf,e.data)),this.iconField.expand&&(n=this.utils.getValue(this.iconField.expand,e.data)),this.iconField.collapse&&(i=this.utils.getValue(this.iconField.collapse,e.data)),n&&!i&&(i=n),!n&&i&&(n=i))}return{leaf:t,expand:n,collapse:i}},z.prototype.getTreeIcon=function(e){var t=e,n=this.leafIcon||"file",i=this.expandIcon||"folder-open",o=this.collapseIcon||"folder";if(t.showLoading)return{"treenode-loading":!0};if(t.icon&&(n=t.icon),t.expandedIcon&&(i=t.expandedIcon),t.collapsedIcon&&(o=t.collapsedIcon),this.useIconFromData){var s=this.getNodeIconFromData(e),r=s.leaf,l=s.expand,a=s.collapse;this.whenDataIconEmptyUseDefault?(r&&(n=r),l&&(i=l),a&&(o=a)):(n=r||"",i=l||"",o=a||"")}var c=!(t.leaf&&(!t.children||!t.children.length)||t.expanded),d=!!t.expanded,h=t.leaf===undefined?!t.children||!t.children.length:t.leaf,u={};return h&&n?u[n]=h:t.expanded&&i?u[i]=d:o&&(u[o]=c),this.iconCls&&(u[this.iconCls]=!0),u},z.prototype.compare=function(e,t){return"string"==typeof e?e.localeCompare(t):e===t?0:t<e?1:-1},z.prototype._sort=function(r,l){var a=0,c=this.sortName.split(","),d=this.sortOrder.split(",");if(!this.sortName)return a;for(var e=function(e){var t=c[e],n=d[e],i=h.columns.find(function(e){return e.field===t}).sorter||h.compare,o=h.utils.getValue(t,r.data);null!==o&&o!==undefined||(o="");var s=h.utils.getValue(t,l.data);if(null!==s&&s!==undefined||(s=""),0!==(a=i(o,s)))return{value:a*("asc"===n?1:-1)}},h=this,t=0;t<c.length;t++){var n=e(t);if("object"==typeof n)return n.value}return a},z.prototype.clientSort=function(){var t=this,e=this.data.sort(this._sort.bind(this)),n=function(e){return(e=e.sort(t._sort.bind(t))).forEach(function(e){e.children&&e.children.length&&(e.children=e.children.sort(t._sort.bind(t)),n(e.children))}),e};e.forEach(function(e){e.children=n(e.children)}),this.loadData(e)},z.prototype.onSortColumnClick=function(e,t){var n=this;if(t.sortable){var i=this.sortName,o=this.sortOrder,s=[],r=[];i&&(s=i.split(","),r=o.split(","));var l,a=t.order||"asc",c=a,d=s.findIndex(function(e){return e===t.field});if(0<=d){var h="asc"===r[d]?"desc":"asc";c=h,this.multiSort&&"asc"===c?(c=undefined,s.splice(d,1),r.splice(d,1)):r[d]=h}else this.multiSort?(s.push(t.field),r.push(a)):(s=[t.field],r=[a]);t.order=c,this.sortName=s.join(","),this.sortOrder=r.join(","),this.multiSort||((l=this.columns)&&l.length&&l.forEach(function(t){t.order=undefined;var e=s.findIndex(function(e){return e===t.field});0<=e&&(t.order=r[e])}),this.cdRef.detectChanges()),this.beforeSortColumn(this.sortName,this.sortOrder).subscribe(function(){n.remoteSort||n.clientSort(),n.columnSorted.emit({sortName:n.sortName,sortOrder:n.sortOrder})})}},z.prototype.findKeyWords=function(e){var n=this,t=e.value,i=e.field;if(this.findField=i,t&&2<=t.length){if(this.findValue=t,!i)return void console.warn("Please set a field for the FindField property.");var o=this.searchHandle.searchOnClient(i,t,this.state.rowNodes);if(o&&o.length){this.findResult=o.sort(function(e,t){return e.index===t.index?0:e.index>t.index?1:-1});var s=o[0].index;this.findCount=o.length;var r=this.searchHandle.findParents(o,this.state.rowNodes);this.findCurrent=1,b(r,o).forEach(function(e){n.expandNode(e.id)});var l=0;this.state.rowNodes.forEach(function(e,t){e.visible&&t<s&&(l+=n.rowHeight)}),this.psRef&&this.psRef.directiveRef&&this.psRef.directiveRef.scrollToY(l-30),this.highLightKeywords()}else this.findResult=[],this.findCurrent=0,this.findCount=0}else this.resetFindText(),this.cdRef.detectChanges()},z.prototype.closeFindPanel=function(){this.showFindInput=!1,this.resetFindText(),this.cdRef.detectChanges()},z.prototype.highLightKeywords=function(){var t=this;this.ngZone.runOutsideAngular(function(){setTimeout(function(){var e=t.el.nativeElement.querySelectorAll(".search-highlight");e.length&&(t.cdRef.detectChanges(),t.renderer.addClass(e[0],"active"))},100)})},z.prototype.resetFindText=function(){this.findValue="",this.findCurrent=0,this.findCount=0,this.findResult=[]},z.prototype.nextFindValue=function(e){var n=this;if(this.findResult&&this.findResult.length){var t=Array.from(this.el.nativeElement.querySelectorAll(".search-highlight"));this.findCurrent===this.findResult.length?this.findCurrent=1:e?(this.findCurrent=this.findCurrent+e,-1===e&&this.findCurrent<=0&&(this.findCurrent=1)):this.findCurrent++;var i=this.el.nativeElement.querySelector(".search-highlight.active"),o=t.indexOf(i);if(i&&this.renderer.removeClass(i,"active"),this.virtualized)if(t[o+=e||1])this.renderer.addClass(t[o],"active");else{var s=this.findResult[this.findCurrent-1],r=0;this.state.rowNodes.forEach(function(e,t){e.visible&&s.index>t&&(r+=n.rowHeight)}),this.psRef&&this.psRef.directiveRef&&this.psRef.directiveRef.scrollToY(r-30,200),this.ngZone.runOutsideAngular(function(){setTimeout(function(){var e=n.el.nativeElement.querySelectorAll(".search-highlight");n.renderer.addClass(e[0],"active")},100)})}else{var l=t[this.findCurrent-1];if(l&&(this.renderer.addClass(l,"active"),this.psRef&&this.psRef.directiveRef)){var a=l.closest("td").offsetTop-30;this.psRef.directiveRef.scrollToY(a,200)}}this.cdRef.detectChanges()}},z.prototype.scrollToY=function(e,t){void 0===t&&(t=200),this.state.scrollY=e||0,this.psRef.directiveRef.scrollToY(e,t)},z.prototype.showOrHideColumn=function(t,n){Array.isArray(t)?this.columns.forEach(function(e){-1<t.indexOf(e.field)&&(e.visible=!n)}):this.columns.forEach(function(e){t===e.field&&(e.visible=!n)}),this.columnsChanged()},z.prototype.showColumn=function(e){this.showOrHideColumn(e,!1)},z.prototype.hideColumn=function(e){this.showOrHideColumn(e,!0)},z.prototype.showChildsLoading=function(e){var t,n=this.columns.filter(function(e){return!1!==e.visible}).length,i=((t={})[this.idField]="正在加载中....",t.__colspan__=n,t);this.loadChildren([{data:i,__childs_loading__:!0}],e,!1)},z.prototype.onChildsPageChanged=function(e){this.childsPageChanged.emit(e)},z.prototype.trId2DataId=function(e){return e.id.replace("rownode-","")},z.prototype.onKeydownEvent=function(e){var t=this;if(e&&this.singleSelect&&this.data&&this.data.length&&["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)&&"INPUT"!==e.target.nodeName){var n;e.stopPropagation(),e.preventDefault(),this.inputGroup.textbox.nativeElement.blur();var i=Array.from(this.bodyTable.nativeElement.querySelectorAll("tr")),o=i.length,s=-1;if(this.selectedRow&&(s=i.findIndex(function(e){return t.trId2DataId(e)===t.selectedRow.id})),"ArrowDown"===e.code)n=s+1;else{if("ArrowUp"!==e.code)return void(!this.selectedRow||"ArrowRight"!==e.code&&"ArrowLeft"!==e.code||this.toggleExpand(this.selectedRow));-1!==s&&(n=s-1)}if(0<=n&&n<o){var r=i[n];if(r){var l=this.trId2DataId(r);this.selectNode(l),r.scrollIntoView({block:"nearest"})}}}},z.decorators=[{type:g.Component,args:[{selector:"farris-treetable",template:'\x3c!--\r\n * @Author: 疯狂秀才(Lucas Huang)\r\n * @Date: 2019-06-03 20:00:11\r\n * @LastEditors: 疯狂秀才(Lucas Huang)\r\n * @LastEditTime: 2019-11-28 14:23:52\r\n * @QQ: 1055818239\r\n * @Version: v0.0.1\r\n --\x3e\r\n<div class="filter-row" style="width: 100%;" *ngIf="showFilterBar">\r\n    <form style="display: flex; width: 100%;">\r\n        <div class="search-fields" style="padding-left:0;">\r\n            <select class="custom-select" [(ngModel)]="searchData.field" name="field">\r\n                <option value="*">{{allColumnsTitle}}</option>\r\n                <option *ngFor="let col of searchFields" value="{{col.value}}">{{ col.label }}</option>\r\n            </select>\r\n        </div>\r\n        <div class="search-text flex-fill" style="padding-right: 0px;">\r\n            <input-group #inputGroup [groupText]="searchButtonText" name="searchValue" [(ngModel)]="searchData.value"\r\n                (clear)="onClearSearchValue()" (valueChange)="onSearchValueChange($event)" (clickHandle)="onSearch()"\r\n                (keydownHandle)="onKeydownEvent($event)"></input-group>\r\n        </div>\r\n    </form>\r\n</div>\r\n\r\n<ng-content select="tt-column"></ng-content>\r\n\r\n<ng-template #tdcell let-col let-serializedNode="rowNode" let-left="left">\r\n\r\n    <ng-container *ngIf="enableFindText">\r\n        <span *ngIf="!col.formatter" style="width: 100%;"\r\n            [innerHTML]="getNodeText(col, serializedNode.node.data) | highlight: findValue: col.field :findField"></span>\r\n        <span *ngIf="col.formatter" style="width: 100%;" \r\n            [innerHTML]="formatData(col, serializedNode.node.data, col.formatter) | safe: \'html\' "></span>\r\n    </ng-container>\r\n\r\n    <ng-container *ngIf="!enableFindText">\r\n        <span *ngIf="!col.formatter" style="width: 100%;"\r\n            [innerHTML]="getNodeText(col, serializedNode.node.data)"></span>\r\n        <span *ngIf="col.formatter" style="width: 100%;" \r\n            [innerHTML]="formatData(col, serializedNode.node.data, col.formatter) | safe: \'html\' "></span>\r\n    </ng-container>\r\n</ng-template>\r\n\r\n<ng-template #tbodyrows>\r\n    <ng-template ngFor let-serializedNode let-rowIndex="index" [ngForTrackBy]="trackByFn" [ngForOf]="pagination ? (serializedValue | paginate: paginationOptions) : serializedValue">\r\n        <tr *ngIf="serializedNode.visible" #row="row" \r\n            [attr.id]=" \'rownode-\' + serializedNode.id" class="f-treetable-row"\r\n            [selectRow]="serializedNode" [rowIndex]="rowIndex" [dblclick]="true" [dblclickNode]="serializedNode"\r\n            [selectRowDisabled]="!serializedNode.node.selectable"\r\n            [customRowStyle]="serializedNode"\r\n            [class.f-treetable-disable-row]="row.selectRowDisabled"\r\n            [class.farris-table-selectedrow]="serializedNode.isSelected">\r\n\r\n            <td *ngIf="serializedNode.node.data[\'__colspan__\']"  [attr.colspan]=" serializedNode.node.data[\'__colspan__\'] || 0">\r\n                <childs-loading></childs-loading>\r\n            </td>\r\n\r\n            <ng-container *ngIf="!serializedNode.node.data[\'__colspan__\']">\r\n                <td *ngFor="let col of columns; let i = index;"\r\n                    [customCellStyle]="col" [rowNode]="serializedNode" [rowIndex]="rowIndex"\r\n                    [style.textAlign]="col!.align || \'left\'" \r\n                    (click)="onCellClick($event, col, serializedNode.node)"\r\n                    class="treetable-cell" [attr.field]="col.field"\r\n                    [attr.colspan]=" serializedNode.node.data[\'__cellspan__\'] || 0"\r\n                    [attr.title]="col | tipmsg: serializedNode.node"\r\n                    [class.f-treetable--fixed-left]="fixedHeader && col.fixed && col.fixed === \'left\'"\r\n                    [class.f-treetable--fixed-right]="fixedHeader && col.fixed && col.fixed === \'right\'"\r\n                    [attr.r-tt-shadow-col]="col.rightShadowCol"\r\n                    [attr.l-tt-shadow-col]="col.leftShadowCol"\r\n                >\r\n\r\n                    <div class="treetable-cell-content d-flex">\r\n                        <farris-treeTableToggler style="float: left"\r\n                            [showLines]="showLines"\r\n                            [indentSpacing]="indentSpacing"\r\n                            [disabled]="!serializedNode.node.selectable || disabled"\r\n                            [rowNode]="serializedNode" *ngIf="i == 0"></farris-treeTableToggler>\r\n                        \r\n                        <div class="flex-grow-1 text">\r\n                            <ng-container *ngIf="!col.template">\r\n                                <ng-container *ngTemplateOutlet="tdcell; context: {$implicit: col, node: serializedNode.node, rowNode: serializedNode, rowData: serializedNode.node.data  }" ></ng-container>\r\n                            </ng-container>\r\n            \r\n                            <ng-container *ngIf="col.template"\r\n                                [ngTemplateOutlet]="col.template"\r\n                                [ngTemplateOutletContext]="{$implicit: { column: col, node: serializedNode.node, rowNode: serializedNode, rowData:  serializedNode.node.data  }}">\r\n                            </ng-container>\r\n                        </div>\r\n                    </div>\r\n                </td>\r\n            </ng-container>\r\n        </tr>\r\n    </ng-template>\r\n</ng-template>\r\n\r\n<ng-template #tbody>\r\n    <tbody class="farris-treetable-tbody"\r\n        [farris-context-menus]="contextMenuItems" [disabled]="!enableContextMenu" \r\n        [activeDomName]="\'tr\'" [beforeShowContextMenu]="onBeforeShowContextMenu"\r\n        [menuClass]="\'f-treetable-context-menu\'">\r\n        <ng-container *ngTemplateOutlet="tbodyrows"></ng-container>\r\n    </tbody>\r\n</ng-template>\r\n\r\n\x3c!--单行表头模板--\x3e\r\n<ng-template #headerCells let-cols>\r\n    <ng-template ngFor let-col [ngForOf]="cols" let-i="index" let-first="first" let-last="last">\r\n        <th [resizable-column]="!col.lastColumn && (!col.colspan || col.colspan == 1)" [style.textAlign]="col!.hAlign || \'left\'" #th \r\n            class="treetable-header-cell"\r\n            [class.f-treetable--fixed-left]="col.fixed && col.fixed === \'left\'"\r\n            [class.f-treetable--fixed-right]="col.fixed && col.fixed === \'right\'"\r\n            [attr.field]="col.field || \'\'"\r\n            [attr.r-tt-shadow-col]="col.rightShadowCol"\r\n            [attr.l-tt-shadow-col]="col.leftShadowCol"\r\n            [attr.colspan]="col.colspan" \r\n            [attr.rowspan]="col.rowspan"\r\n            [class.group-header-cell]="col.colspan && col.colspan > 1"\r\n            [attr.id]="col.id"\r\n            >\r\n      \r\n            <div class="d-flex" style="line-height: 1.25em;" [style.padding-right.px]="col.sortable ? 10: 0">\r\n                <ng-container *ngIf="!singleSelect && showCheckAll && first && showCheckbox && !last">\r\n                    <tt-header-checkbox #allCheckbox></tt-header-checkbox>\r\n                </ng-container>\r\n                <ng-container *ngIf="col.headTemplate"\r\n                    [ngTemplateOutlet]="col.headTemplate"\r\n                    [ngTemplateOutletContext]="{$implicit: { column: col}}">\r\n                </ng-container>\r\n                <ng-container *ngIf="!col.headTemplate">\r\n                    <span style="overflow: hidden;width: 100%;" *ngIf="!headerWrap">{{ col.title }}</span>\r\n                    <span style="white-space: pre-wrap;width: 100%;"  *ngIf="headerWrap">{{ col.title }}</span>\r\n                </ng-container>\r\n                <ng-container *ngIf="col.sortable">\r\n                    <span class="f-treetable-sort"\r\n                        [class.f-treetable-sort-asc]="col.order === \'asc\'"\r\n                        [class.f-treetable-sort-desc]="col.order === \'desc\'"\r\n                        (click)="onSortColumnClick($event, col)" *ngIf="col.order"></span>\r\n                    <span class="f-treetable-sort" (click)="onSortColumnClick($event, col)" *ngIf="!col.order"></span>\r\n                </ng-container>\r\n\r\n            </div>\r\n        </th>\r\n    </ng-template>\r\n</ng-template>\r\n\r\n\x3c!--多行表头模板--\x3e\r\n<ng-template #groupHeader>\r\n    <tr *ngFor="let cols of groupColumns">\r\n        <ng-container *ngTemplateOutlet="headerCells; context: {$implicit: cols}"></ng-container>\r\n    </tr>\r\n</ng-template>\r\n\r\n\r\n<ng-template #scorllview>\r\n    <div class="farris-treetable fixed" [attr.id]="id" [class.f-treetable--fixed-columns]="fixedColumns"\r\n        [class.farris-treetable-nowrap]="!nowrap" [class.table-bordered]="showBorder"\r\n        [ngClass]="{\'farris-treetable-disabled\': disabled, \'flex-fill\': fit}"\r\n        [class.farris-treetable-showlines]="showLinesOnHover && showLines" [style.width]="fit ? \'100%\' : width + \'px\'"\r\n        >\r\n        <div #headerBox class="farris-treetable-header" *ngIf="showHeader && columns" style="overflow: hidden; background-color: #f7f8fb">\r\n            <table #headerTable class="table" >\r\n                <colgroup *ngIf="!autoWidth">\r\n                    <ng-container *ngFor="let col of columns">\r\n                        <col *ngIf="columnIsVisible(col)" [style.width]="getRealColWidth(col)" />\r\n                    </ng-container>\r\n                </colgroup>\r\n                <thead class="farris-treetable-thead" [class.header-wrap]="headerWrap">\r\n                    <ng-container *ngIf="!headerTemplate">\r\n                        <tr *ngIf="!useGroupHeader; else groupHeader">\r\n                            <ng-container *ngTemplateOutlet="headerCells; context: {$implicit: columns}"></ng-container>\r\n                        </tr>\r\n                    </ng-container>\r\n\r\n                    <ng-container *ngIf="headerTemplate">\r\n                        <ng-container *ngTemplateOutlet="headerTemplate; context: {$implicit: columns}"></ng-container>\r\n                    </ng-container>\r\n                </thead>\r\n            </table>\r\n            \x3c!-- 客户端查询定位工具条 --\x3e\r\n            <find-input *ngIf="showFindInput" [columns]="columns" [current]="findCurrent" [count]="findCount"\r\n                (valueChanged)="findKeyWords($event)" (close)="closeFindPanel()" (enterHandler)="nextFindValue($event)">\r\n            </find-input>\r\n\r\n        </div>\r\n\r\n        <div class="farris-treetable-body">\r\n            <perfect-scrollbar #perfectScrollbar [config]="{minScrollbarLength: 15}" (psScrollX)="onScrollX($event)"\r\n                (psScrollY)="onScrollY($event)" [style.height]="scorllBodyHeight + \'px\'">\r\n                <div *ngIf="topHideHeight && virtualized" [style.height]="topHideHeight + \'px\'"> </div>\r\n                <table #bodyTable class="table" [style.tableLayout]="autoWidth? \'auto\': \'fixed\'"\r\n                    [ngClass]="{\'table-striped\': striped, \'table-hover\': hovered, \'f-table-norecords\': (!serializedValue || !serializedValue.length) }">\r\n                    <colgroup>\r\n                        <ng-container *ngFor="let col of columns">\r\n                            <col *ngIf="columnIsVisible(col)" [style.width]="getRealColWidth(col)" />\r\n                        </ng-container>\r\n                    </colgroup>\r\n\r\n                    <ng-container *ngIf="!serializedValue || !serializedValue.length">\r\n                        <tbody class="farris-treetable-tbody">\r\n                            <tr class="f-table-norecords-row">\r\n                                <td [attr.align]="\'center\'" class="farris-treetable-emptydata" [attr.colspan]="columns.length">\r\n                                    <div class="f-table-norecords-content" >\r\n                                        {{ \'treetable.emptyMessage\' | locale }}\r\n                                    </div>\r\n                                </td>\r\n                            </tr>\r\n                        </tbody>\r\n                    </ng-container>\r\n\r\n                    <ng-container *ngIf="serializedValue && serializedValue.length">\r\n                        <ng-container *ngIf="bodyTemplate">\r\n                            <tbody class="farris-treetable-tbody" treeTableBody [columns]="columns" [template]="bodyTemplate"></tbody>\r\n                        </ng-container>\r\n\r\n                        <ng-container #defaultBodyTemplate *ngIf="!bodyTemplate">\r\n                            <ng-container *ngTemplateOutlet="tbody"></ng-container>\r\n                        </ng-container>\r\n                    </ng-container>\r\n                </table>\r\n                <div *ngIf="bottomHideHeight && virtualized" [style.height]="bottomHideHeight + \'px\'"> </div>\r\n            </perfect-scrollbar>\r\n        </div>\r\n\r\n        \x3c!-- 分页条 --\x3e\r\n        <div *ngIf="pagination" #tablePager class="farris-table-pager">\r\n            <pagination-controls #pager [id]="paginationOptions?.id"\r\n                [maxSize]="pagerLabelSize" [directionLinks]="true"\r\n                [autoHide]="false" [responsive]="true"\r\n                [previousLabel]="\' \'" [nextLabel]="\' \'"\r\n                [showPageInfo]="showPageInfo" [showPageNumber]="showPageNumber" [showPageList]="showPageList"\r\n                (pageChange)="onPageChange($event)"\r\n                (pageSizeChange)="onPageSizeChange($event)"\r\n                >\r\n            </pagination-controls>\r\n        </div>\r\n\r\n        <div #resizerHelper class="column-resizer-helper" *ngIf="resizableColumns"></div>\r\n    </div>\r\n</ng-template>\r\n\r\n<ng-template #nodespagerbar let-ctx>\r\n    <nodes-pager [context]="ctx" (pageChange)="onChildsPageChanged($event)"></nodes-pager>\r\n</ng-template>\r\n\r\n\r\n\r\n<div class="farris-treetable" [class.table-bordered]="showBorder" [attr.id]="id"\r\n    [class.farris-treetable-showlines]="showLinesOnHover && showLines" \r\n    [class.farris-treetable-nowrap]="!nowrap"  *ngIf="!fixedHeader; else scorllview">\r\n    <table class="table" [style.tableLayout]="autoWidth? \'auto\': \'fixed\'"\r\n        [ngClass]="{\'table-striped\': striped, \'table-hover\': hovered, \'f-table-norecords\': (!serializedValue || !serializedValue.length) }">\r\n        <thead class="farris-treetable-thead" *ngIf="showHeader" [class.header-wrap]="headerWrap">\r\n            <ng-container *ngIf="!headerTemplate && columns">\r\n                <th *ngFor="let col of columns;let isFirst=first" [style.textAlign]="col!.hAlign || \'left\'" class="treetable-header-cell" [attr.field]="col.field">\r\n                    <div class="d-flex">\r\n                        <ng-container *ngIf="!singleSelect && showCheckAll && isFirst && showCheckbox">\r\n                            <tt-header-checkbox #allCheckbox class="f-cmp-treetable-toggler"></tt-header-checkbox>\r\n                        </ng-container>\r\n\r\n                        <ng-container *ngIf="!col.headTemplate">\r\n                            <div class="flex-grow-1 text" [style.whiteSpace]="headerWrap ? \'pre-wrap\': \'\'">{{col.title}}</div>\r\n                        </ng-container>\r\n        \r\n                        <ng-container *ngIf="col.headTemplate"\r\n                            [ngTemplateOutlet]="col.headTemplate"\r\n                            [ngTemplateOutletContext]="{$implicit: { column: col}}">\r\n                        </ng-container>\r\n                        \r\n                    </div>\r\n                </th>\r\n            </ng-container>\r\n            <ng-container *ngIf="headerTemplate">\r\n                <ng-container *ngTemplateOutlet="headerTemplate; context: {$implicit: columns}"></ng-container>\r\n            </ng-container>\r\n        </thead>\r\n        <ng-container *ngIf="serializedValue && serializedValue.length">\r\n             \x3c!-- 客户端查询定位工具条 --\x3e\r\n             <find-input *ngIf="showFindInput" [current]="findCurrent" [count]="findCount"\r\n             (valueChanged)="findKeyWords($event)" (close)="closeFindPanel()"  [columns]="columns"\r\n             (enterHandler)="nextFindValue($event)"></find-input>\r\n            <ng-container *ngIf="bodyTemplate">\r\n                <tbody class="farris-treetable-tbody" treeTableBody [columns]="columns" [template]="bodyTemplate">\r\n                </tbody>\r\n            </ng-container>\r\n            <ng-container *ngIf="!bodyTemplate">\r\n                <ng-container *ngTemplateOutlet="tbody"></ng-container>\r\n            </ng-container>\r\n        </ng-container>\r\n        <ng-container *ngIf="!serializedValue || !serializedValue.length">\r\n            <tbody class="farris-treetable-tbody">\r\n                <tr class="f-table-norecords-row" style="height: 200px">\r\n                    <td [attr.align]="\'center\'" class="farris-treetable-emptydata" [attr.colspan]="columns.length">\r\n                        <div class="f-table-norecords-content" >\r\n                            {{ \'treetable.emptyMessage\' | locale }}\r\n                        </div>\r\n                    </td>\r\n                </tr>\r\n            </tbody>\r\n        </ng-container>\r\n    </table>\r\n</div>\r\n\r\n',exportAs:"treeTable",encapsulation:g.ViewEncapsulation.None,changeDetection:g.ChangeDetectionStrategy.OnPush,styles:["\n        .farris-treetable {\n            position: relative;\n        }\n        .resizable-column {\n            background-clip: padding-box;\n            position: relative;\n        }\n        .column-resizer {\n            display: block;\n            position: absolute!important;\n            top: 0;\n            right: 0;\n            margin: 0;\n            width: .5em;\n            height: 100%;\n            padding: 0;\n            cursor: col-resize;\n            border: 1px solid transparent;\n        }\n        .column-resizer-helper {\n            width: 1px;\n            position: absolute;\n            z-index: 10;\n            display: none;\n            border-right: 1px dashed #1890ff;\n        }\n\n        .farris-treetable-disabled .farris-treetable-body .table tr{\n            opacity: 0.4;\n            cursor: not-allowed;\n        }\n        .farris-treetable-disabled .table tr.farris-table-selectedrow{\n            opacity: 1;\n            cursor: default;\n        }\n\n        .custom-checkbox .custom-control-input:indeterminate~.custom-control-label::after {\n            background-image: url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 4 4'%3e%3cpath stroke='%23fff' d='M0 2h4'/%3e%3c/svg%3e\");\n            background-color: #1890ff;\n        }\n        .unselectable-text {\n            -webkit-user-select: none;\n            -moz-user-select: none;\n            -o-user-select: none;\n            -ms-user-select: none;\n            user-select: none\n        }\n        .search-highlight {\n            background-color: #FFFF1F;\n        }\n        .search-highlight.active{\n            background-color: #FF901C;\n        }\n\n    "]}]}],z.ctorParameters=function(){return[{type:x},{type:g.ElementRef},{type:a.ResizeService},{type:g.Renderer2},{type:f.CommonUtils},{type:l.ColumnFormatService},{type:w},{type:g.ChangeDetectorRef},{type:g.NgZone},{type:g.Injector}]},z.propDecorators={width:[{type:g.Input}],height:[{type:g.Input}],showFilterBar:[{type:g.Input}],headerHeight:[{type:g.Input}],headerWrap:[{type:g.Input}],rowHeight:[{type:g.Input}],columns:[{type:g.Input}],groupColumns:[{type:g.Input}],useGroupHeader:[{type:g.Input}],fitColumns:[{type:g.Input}],searchFields:[{type:g.Input}],allColumnsTitle:[{type:g.Input}],showLines:[{type:g.Input}],showLinesOnHover:[{type:g.Input}],multiSelect:[{type:g.Input}],singleSelect:[{type:g.Input}],showCheckbox:[{type:g.Input}],idField:[{type:g.Input}],showBorder:[{type:g.Input}],showCheckAll:[{type:g.Input}],showHeader:[{type:g.Input}],striped:[{type:g.Input}],hovered:[{type:g.Input}],disabled:[{type:g.Input}],loadDataType:[{type:g.Input}],fixedHeader:[{type:g.Input}],checkOnSelect:[{type:g.Input}],selectOnCheck:[{type:g.Input}],onlySelectSelf:[{type:g.Input}],resizableColumns:[{type:g.Input}],fit:[{type:g.Input}],cascadeCheck:[{type:g.Input}],cascadeDown:[{type:g.Input}],cascadeUp:[{type:g.Input}],emptyMessage:[{type:g.Input}],indentSpacing:[{type:g.Input}],keepSelect:[{type:g.Input}],virtualized:[{type:g.Input}],onlySelectLeaf:[{type:g.Input}],showIcon:[{type:g.Input}],leafIcon:[{type:g.Input}],expandIcon:[{type:g.Input}],collapseIcon:[{type:g.Input}],foldIcon:[{type:g.Input}],unfoldIcon:[{type:g.Input}],useIconFromData:[{type:g.Input}],whenDataIconEmptyUseDefault:[{type:g.Input}],iconField:[{type:g.Input}],iconCls:[{type:g.Input}],remoteSort:[{type:g.Input}],sortName:[{type:g.Input}],sortOrder:[{type:g.Input}],multiSort:[{type:g.Input}],beforeSortColumn:[{type:g.Input}],rowStyler:[{type:g.Input}],cellStyler:[{type:g.Input}],enableFindText:[{type:g.Input}],findField:[{type:g.Input}],expandLevel:[{type:g.Input}],selectValue:[{type:g.Input}],selectValueChange:[{type:g.Output}],dblClickExpand:[{type:g.Input}],selectValues:[{type:g.Input}],selectValuesChange:[{type:g.Output}],nowrap:[{type:g.Input}],checkValues:[{type:g.Input}],checkValuesChange:[{type:g.Output}],beforeNodeSelected:[{type:g.Input}],beforeNodeUnSelected:[{type:g.Input}],beforeNodeChecked:[{type:g.Input}],beforeNodeUnChecked:[{type:g.Input}],beforeCheckAll:[{type:g.Input}],beforeUnCheckAll:[{type:g.Input}],beforeClickNode:[{type:g.Input}],pagination:[{type:g.Input}],paginationForChildren:[{type:g.Input}],pagerViewMode:[{type:g.Input}],pagerOnServer:[{type:g.Input}],pageList:[{type:g.Input}],pageIndex:[{type:g.Input}],pageSize:[{type:g.Input}],pagerHeight:[{type:g.Input}],showPageList:[{type:g.Input}],showPageInfo:[{type:g.Input}],showPageNumber:[{type:g.Input}],pagerLabelSize:[{type:g.Input}],total:[{type:g.Input}],enableContextMenu:[{type:g.Input}],contextMenuItems:[{type:g.Input}],beforeShowContextMenu:[{type:g.Input}],pageSizeChanged:[{type:g.Output}],pageChanged:[{type:g.Output}],columnSorted:[{type:g.Output}],nodeSelected:[{type:g.Output}],nodeUnSelect:[{type:g.Output}],nodeChecked:[{type:g.Output}],nodeUnChecked:[{type:g.Output}],checkAll:[{type:g.Output}],unCheckAll:[{type:g.Output}],search:[{type:g.Output}],dblClick:[{type:g.Output}],loadedData:[{type:g.Output}],expand:[{type:g.Output}],collapse:[{type:g.Output}],expandAllNodes:[{type:g.Output}],collapseAllNodes:[{type:g.Output}],appendNew:[{type:g.Output}],removed:[{type:g.Output}],updated:[{type:g.Output}],clearSearchValue:[{type:g.Output}],cellClick:[{type:g.Output}],childsPageChanged:[{type:g.Output}],data:[{type:g.Input}],autoWidth:[{type:g.Input}],templates:[{type:g.ContentChildren,args:[f.FarrisTemplateDirective]}],columnsRef:[{type:g.ContentChildren,args:[R]}],headerBox:[{type:g.ViewChild,args:["headerBox"]}],resizerHelperVC:[{type:g.ViewChild,args:["resizerHelper"]}],headerTable:[{type:g.ViewChild,args:["headerTable"]}],bodyTable:[{type:g.ViewChild,args:["bodyTable"]}],inputGroup:[{type:g.ViewChild,args:["inputGroup"]}],psRef:[{type:g.ViewChild,args:[o.PerfectScrollbarComponent]}],allCheckbox:[{type:g.ViewChild,args:["allCheckbox"]}],nodesPagerBar:[{type:g.ViewChild,args:["nodespagerbar"]}],onResized:[{type:g.HostListener,args:["window:resize"]}]},z);function z(e,t,n,i,o,s,r,l,a,c){var d=this;this.ttService=e,this.el=t,this.resizeSer=n,this.renderer=i,this.utils=o,this.colFormatSer=s,this.shortcuts=r,this.cdRef=l,this.ngZone=a,this.injector=c,this.id="",this.width=500,this.height=400,this.showFilterBar=!1,this.headerHeight=35,this.headerWrap=!1,this.rowHeight=29,this.columns=[],this._groupColumns=[],this.useGroupHeader=!1,this.fitColumns=!0,this.allColumnsTitle="所有列",this.showLines=!1,this.showLinesOnHover=!1,this.multiSelect=!1,this.singleSelect=!0,this.showCheckbox=!1,this.showBorder=!0,this.showCheckAll=!0,this.showHeader=!0,this.striped=!1,this.hovered=!0,this.disabled=!1,this.loadDataType="all",this.fixedHeader=!1,this.checkOnSelect=!1,this.selectOnCheck=!1,this.onlySelectSelf=!1,this.resizableColumns=!0,this.fit=!1,this.cascadeCheck=!0,this.cascadeDown=!0,this.cascadeUp=!0,this.emptyMessage="暂无数据",this.indentSpacing=16,this.keepSelect=!0,this.virtualized=!1,this.onlySelectLeaf="default",this.showIcon=!1,this.leafIcon="file",this.expandIcon="folder-open",this.collapseIcon="folder",this.foldIcon="treetable-toggler",this.unfoldIcon="extanded treetable-toggler",this.useIconFromData=!1,this.whenDataIconEmptyUseDefault=!0,this.iconField="",this.remoteSort=!0,this.enableFindText=!1,this.expandLevel=-1,this.selectValue="",this.selectValueChange=new g.EventEmitter,this.dblClickExpand=!0,this.selectValues=[],this.selectValuesChange=new g.EventEmitter,this.nowrap=!0,this.checkValues=[],this.checkValuesChange=new g.EventEmitter,this.pagination=!1,this.paginationForChildren=!1,this.pagerViewMode="default",this.pagerOnServer=!0,this.pageList=[10,20,30,50,100],this.pageIndex=1,this.pageSize=20,this.pagerHeight=56,this.showPageList=!1,this.showPageInfo=!0,this.showPageNumber=!0,this.pagerLabelSize=7,this.total=0,this.enableContextMenu=!1,this.contextMenuItems=[],this.pageSizeChanged=new g.EventEmitter,this.pageChanged=new g.EventEmitter,this.columnSorted=new g.EventEmitter,this.nodeSelected=new g.EventEmitter,this.nodeUnSelect=new g.EventEmitter,this.nodeChecked=new g.EventEmitter,this.nodeUnChecked=new g.EventEmitter,this.checkAll=new g.EventEmitter,this.unCheckAll=new g.EventEmitter,this.search=new g.EventEmitter,this.dblClick=new g.EventEmitter,this.loadedData=new g.EventEmitter,this.expand=new g.EventEmitter,this.collapse=new g.EventEmitter,this.expandAllNodes=new g.EventEmitter,this.collapseAllNodes=new g.EventEmitter,this.appendNew=new g.EventEmitter,this.removed=new g.EventEmitter,this.updated=new g.EventEmitter,this.clearSearchValue=new g.EventEmitter,this.cellClick=new g.EventEmitter,this.childsPageChanged=new g.EventEmitter,this._data=[],this.autoWidth=!1,this._selections=[],this.selectRowIndex=-1,this._selectedRow=null,this._checkeds=[],this.searchData={field:"*",value:""},this.searchButtonText='<i class="f-icon f-icon-search"></i>',this.showFindInput=!1,this.isDataChanged=!1,this.topHideHeight=0,this.bottomHideHeight=0,this.state={rowNodes:[],scrollY:0,scrollX:0},this.findValue="",this.findCount=0,this.findCurrent=0,this.findResult=[],this.ro=null,this.findKeysHandler=null,this._hotKeys=null,this.styleSheetId="treetable-style-",this.paginationOptions={id:"Farris-TreeTable-Pagination_",itemsPerPage:this.pageSize,currentPage:this.pageIndex,pageList:this.pageList,totalItems:this.total,remote:this.pagerOnServer},this.selectNodeChangedSubject=new p.BehaviorSubject(null),this._UUID="",this.fixedColumns=!1,this.farrisInstances=null,this.difference=function(e,n){return e.filter(function(t){return!n.some(function(e){return e==t})})},this.onBeforeShowContextMenu=function(e){var o=e.contextMenuDom,t=e.event.target.id;if(o){t=d.trId2DataId(o);var s=d.findRowNode(t),n=p.of({show:!0});return d.beforeShowContextMenu&&(n=d.beforeShowContextMenu({data:s,tree:d})),n.pipe(u.switchMap(function(e){if(e.show){e.menus&&(d.contextMenuItems=e.menus,d.detectChanges());var t=o.closest(".farris-treetable").offsetWidth,n=o.offsetWidth,i=n<t?n:t;return p.of({show:!0,data:{data:s,tree:d},focusTargetWidth:i})}return p.of({show:!1})}))}return p.of({show:!1})},this.searchHandle=new N(this),this.scrollLoader=new S(this),this.injector&&(this._hotKeys=this.injector.get(w,null),this.localeService=this.injector.get(h.LocaleService,null),this.idService=this.injector.get(f.IdService,null)),this.idService?(this._UUID=this.idService.uuid(),this.styleSheetId+=this.idService.uuid()):(this._UUID=(""+Math.random()).slice(2),this.styleSheetId+=(""+Math.random()).slice(2)),this.farrisInstances=this.injector.get(f.FarrisComponentInstanceService,null)}var F=(V.decorators=[{type:g.Component,args:[{selector:"[treeTableBody]",template:'\n        <ng-template ngFor let-serializedNode let-rowIndex="index" [ngForOf]="tt.serializedValue">\n            <ng-container *ngIf="serializedNode.visible">\n                <ng-container\n                    *ngTemplateOutlet="template;\n                        context: {$implicit: serializedNode, node: serializedNode.node,\n                        rowData: serializedNode.node.data, rowIndex: rowIndex, columns: columns}">\n                </ng-container>\n            </ng-container>\n        </ng-template>\n    '}]}],V.ctorParameters=function(){return[{type:O}]},V.propDecorators={columns:[{type:g.Input}],template:[{type:g.Input}]},V);function V(e){this.tt=e}var H=(Object.defineProperty(D.prototype,"offsetWidth",{get:function(){return this.togglerEl.nativeElement.parentElement.offsetWidth},enumerable:!0,configurable:!0}),D.prototype.ngOnInit=function(){var t=this;this.treeNodeIcon=this.tt.getTreeIcon(this.rowNode.node),this.isShowTriangle=this.showTriangle(),this.noChilds=this.hasChildren();var e=this.tt.expand.subscribe(function(e){t.rowNode.id===e.data[t.tt.idField]&&t.tt.detectChanges()}),n=this.tt.collapse.subscribe(function(e){t.rowNode.id===e.data[t.tt.idField]&&t.tt.detectChanges()}),i=this.tt.appendNew.subscribe(function(e){e.parent&&t.rowNode.id===e.parent.data[t.tt.idField]&&(!t.rowNode.node.leaf&&t.rowNode.node.leaf!==undefined||(t.rowNode.node.leaf=!1,t.registerClickEvent()))});this.subscriptions=[e,n,i]},D.prototype.ngOnChanges=function(e){e.showLines&&!e.showLines.isFirstChange()&&(this.showLines?this.render.setStyle(this.togglerEl.nativeElement,"display",this.isShowTriangle?"":"none"):this.render.removeStyle(this.togglerEl.nativeElement,"display"),this.reSetLines())},D.prototype.ngAfterViewInit=function(){var e=this;this.registerClickEvent(),setTimeout(function(){e.reSetLines()})},D.prototype.ngDoCheck=function(){this.tt&&this.tt.data&&(this.isShowTriangle=this.showTriangle(),this.noChilds=this.hasChildren(),this.treeNodeIcon=this.tt.getTreeIcon(this.rowNode.node))},D.prototype.ngAfterViewChecked=function(){this.tt&&this.tt.data&&this.reSetLines()},D.prototype.ngOnDestroy=function(){this.unAllSubscriptions()},D.prototype.unAllSubscriptions=function(){this.subscriptions.forEach(function(e){e.unsubscribe()}),this.subscriptions=[]},D.prototype.hasChildren=function(){var e=this.rowNode.node;return!1===e.leaf||0!==this.rowNode.level||e.children&&0<e.children.length},D.prototype.showTriangle=function(){var e=this.rowNode.node;return"all"===this.tt.loadDataType?!1===e.leaf||e.children&&0<e.children.length:!1===e.leaf},D.prototype.reSetLines=function(){if(this.togglerEl&&this.tt.showLines){var e=this.togglerEl.nativeElement.closest(".treetable-cell-content");if(e)for(var t=e.querySelectorAll(".treetable-lines"),n=0;n<t.length;n++)t[n].remove()}this._renderLines()},D.prototype._renderLines=function(){var t=this;if(this.tt.bodyTemplate){if(this.togglerEl){this.noLineStyle();var e=this.togglerEl.nativeElement.closest("tr").querySelectorAll("td");Array.from(e).forEach(function(e){t.render.setStyle(e,"padding","0.25rem 0.75rem")})}}else this.showLines?this.renderLines():this.noLineStyle()},D.prototype.noLineStyle=function(){this.togglerEl&&(this.render.setStyle(this.togglerEl.nativeElement,"margin-left",this.rowNode.level*this.indentSpacing+"px"),this.render.setStyle(this.togglerEl.nativeElement,"visibility",this.isShowTriangle?"visible":"hidden"),this.render.removeStyle(this.togglerEl.nativeElement,"display"))},D.prototype.renderLines=function(){var e=this.rowNode.level,t=this.togglerEl.nativeElement.closest(".treetable-cell-content");if(t){var n=this.togglerEl.nativeElement.parentElement;0!==e||this.showTriangle()||this.createLeafNodeLines(n,t,!0);for(var i=0;i<e;i++){t.insertBefore(this.newLineElement(),n);var o=this.newLineElement(!1);t.insertBefore(o,n),this.showTriangle()||i!==e-1||this.createLeafNodeLines(n,t)}}},D.prototype.newLineElement=function(e){void 0===e&&(e=!0);var t=this.render.createElement("div");return this.render.addClass(t,"treetable-lines"),this.showLines&&e&&this.render.addClass(t,"treetable-lines-border-color"),t},D.prototype.createLeafNodeLines=function(e,t,n){void 0===n&&(n=!1);var i=this.newLineElement(),o=this.newLineElement(!1);this.render.addClass(o,"treetable-lines-leaf");var s=this.render.createElement("div");if(this.showLines){var r="normal";this.rowNode.last&&(r="corner",this.render.removeClass(i,"treetable-lines-border-color")),o.appendChild(s),this.render.addClass(s,r),this.render.addClass(s,"treetable-lines-border-color")}t.insertBefore(i,e),t.insertBefore(o,e),n&&this.render.setStyle(o,"marginRight","3px")},D.prototype.registerClickEvent=function(){this.togglerEl&&this.render.listen(this.togglerEl.nativeElement,"click",this.onClick.bind(this))},D.prototype.onClick=function(e){return e.stopPropagation(),e.preventDefault(),this.tt.disabled||this.tt.toggleExpand(this.rowNode.node),!1},D.decorators=[{type:g.Component,args:[{selector:"farris-treeTableToggler",template:'\n    <a href="javascript:void(0)" #toggler\n            class="treenode-fold"\n            [ngClass]="rowNode.node.expanded ? tt.unfoldIcon : tt.foldIcon"\n            [style.display]="isShowTriangle ? \'\' : \'none\'"></a>\n    <span class="tree-icon-line" [style.display]="isShowTriangle && showLines? \'\' : \'none\'"></span>\n    <span [style.display]="(tt.showIcon && rowNode.node.showIcon) ? \'inline-block\': \'none\'"\n                                    class="treenode-icon" [ngClass]="treeNodeIcon"></span>\n    <tt-checkbox  [rowNode]="rowNode" *ngIf="tt.showCheckbox" [disabled]="disabled" [checked]="rowNode.isChecked" ></tt-checkbox>\n    ',encapsulation:g.ViewEncapsulation.None,exportAs:"ttToggler"}]}],D.ctorParameters=function(){return[{type:O},{type:g.NgZone},{type:g.Renderer2}]},D.propDecorators={cls:[{type:g.HostBinding,args:["class.f-cmp-treetable-toggler"]}],rowNode:[{type:g.Input}],disabled:[{type:g.Input}],showLines:[{type:g.Input}],indentSpacing:[{type:g.Input}],togglerEl:[{type:g.ViewChild,args:["toggler"]}]},D);function D(e,t,n){this.tt=e,this.ngzone=t,this.render=n,this.cls=!0,this.showLines=!1,this.indentSpacing=16,this.treeNodeIcon={},this.isShowTriangle=!1,this.noChilds=!1,this.subscriptions=[]}var L=(P.prototype.ngOnInit=function(){},P.prototype.ngOnChanges=function(e){},P.prototype.ngOnDestroy=function(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=null)},P.prototype.ngDoCheck=function(){this.tt.bodyTemplate&&(this.tt.isSelected(this.rowNode.node)||this.render.removeClass(this.el.nativeElement,"farris-table-selectedrow"))},P.prototype.onclick=function(e){var t=this;this.isEnabled()&&(0!==this.delay?this.prevent||(this.prevent=!0,this.timer=setTimeout(function(){t.rowClick(e),t.prevent=!1},this.delay)):this.rowClick(e))},P.prototype.isEnabled=function(){return!this.tt.disabled&&!0!==this.selectRowDisabled},P.prototype.rowClick=function(t){var n=this;t.stopPropagation(),this.tt.beforeClickNode({instance:this.tt,rowNode:this.rowNode,event:t,type:"row"}).subscribe(function(e){e&&(n.tt.handleRowClick({originalEvent:t,rowNode:n.rowNode,rowIndex:n.rowIndex}),n.ngZone.runOutsideAngular(function(){n.toggleClass()}))})},P.prototype.toggleClass=function(){var t=this;this.tt.bodyTemplate||(this.tt.isSelected(this.rowNode.node)?(this.tt.singleSelect&&this.tt.el.nativeElement.querySelectorAll(".farris-treetable-tbody>tr.farris-table-selectedrow").forEach(function(e){t.render.removeClass(e,"farris-table-selectedrow")}),this.render.addClass(this.el.nativeElement,"farris-table-selectedrow")):this.tt.keepSelect||this.render.removeClass(this.el.nativeElement,"farris-table-selectedrow"))},P.decorators=[{type:g.Directive,args:[{selector:"[selectRow]",exportAs:"row"}]}],P.ctorParameters=function(){return[{type:O},{type:g.ElementRef},{type:g.Renderer2},{type:g.NgZone}]},P.propDecorators={rowNode:[{type:g.Input,args:["selectRow"]}],rowIndex:[{type:g.Input}],selectRowDisabled:[{type:g.Input}],delay:[{type:g.Input}],onclick:[{type:g.HostListener,args:["click",["$event"]]}]},P);function P(e,t,n,i){var o=this;this.tt=e,this.el=t,this.render=n,this.ngZone=i,this.prevent=!1,this.delay=0,this.subscription=this.tt.selectNodeChangedSubject.subscribe(function(e){e&&o.rowNode&&-1<e.split(",").indexOf(o.rowNode.id)&&(o.toggleClass(),o.rowNode.node.elementRef=o.el)})}var A=(M.prototype.ngOnInit=function(){},M.prototype.handleClick=function(t){var n=this;return this.disabled||this.tt.disabled||(this.checked?this.tt.beforeUnCheckAll:this.tt.beforeCheckAll)({instance:this.tt,checked:!this.checked}).subscribe(function(e){n.chkAll.nativeElement.indeterminate=!1,n.checked=!n.checked,n.tt.toggleNodesWithCheckbox(t,n.checked)}),t.stopPropagation(),!1},M.decorators=[{type:g.Component,args:[{selector:"tt-header-checkbox",template:'\n    <div class="custom-control custom-checkbox  custom-control-inline tt-checkbox">\n        <input type="checkbox" #chkAll class="custom-control-input"  [checked]="checked">\n        <label class="custom-control-label" (click)="handleClick($event)"></label>\n    </div>\n    ',styles:["\n        :host {\n            vertical-align: middle;\n        }\n        "]}]}],M.ctorParameters=function(){return[{type:O},{type:x}]},M.propDecorators={checked:[{type:g.Input}],disabled:[{type:g.Input}],checkedChange:[{type:g.Output}],chkAll:[{type:g.ViewChild,args:["chkAll"]}]},M);function M(e,t){this.tt=e,this.ttService=t,this.checkedChange=new g.EventEmitter}var _=(j.prototype.ngOnInit=function(){var t=this;this.chk.nativeElement.indeterminate=this.rowNode.indeterminate||!1,this.ttService.changeCheckboxStatus$.pipe(u.map(function(e){return e.id===t.rowNode.id?e:null})).subscribe(function(e){e&&(t.chk.nativeElement.indeterminate=t.rowNode.indeterminate,t.checked=t.rowNode.isChecked,t.chk.nativeElement.checked=t.checked)})},j.prototype.handleClick=function(t){var n=this;return this.disabled||this.tt.beforeClickNode({instance:this.tt,rowNode:this.rowNode,event:t,type:"checkbox"}).subscribe(function(e){e&&(n.checked=!n.checked,n.tt.singleSelect?(n.tt.clearAll(),n.checked?n.tt.selectNode(n.rowNode.id,!0):n.tt.unSelectNode(n.rowNode.id,!0)):n.tt.toggleNodeWithCheckbox(t,n.rowNode,n.checked))}),t.stopPropagation(),!1},j.decorators=[{type:g.Component,args:[{selector:"tt-checkbox",template:'\n    <div class="custom-control custom-checkbox  custom-control-inline tt-checkbox">\n        <input type="checkbox" #chk class="custom-control-input" [disabled]="disabled" [checked]="checked">\n        <label class="custom-control-label" (click)="handleClick($event)"></label>\n    </div>\n    ',styles:["\n        :host {\n            vertical-align: middle;\n        }\n        :host .custom-checkbox {\n            opacity: 1;\n            float: none;\n        }\n        "]}]}],j.ctorParameters=function(){return[{type:O},{type:x}]},j.propDecorators={cls1:[{type:g.HostBinding,args:["class.tree-toggler-checkbox"]}],checked:[{type:g.Input}],disabled:[{type:g.Input}],rowNode:[{type:g.Input}],checkedChange:[{type:g.Output}],chk:[{type:g.ViewChild,args:["chk"]}]},j);function j(e,t){this.tt=e,this.ttService=t,this.cls1=!0,this.checkedChange=new g.EventEmitter}var B=(U.prototype.ngOnInit=function(){this.enableDblClick||(this.selectRowDir.delay=0)},U.prototype.ondblclick=function(e){if(this.tt.disabled)return!1;if(this.tt.multiSelect&&this.dblclickNode&&this.dblclickNode.node.leaf)return!1;var t=null;if(-1<e.target.className.indexOf("f-cmp-treetable-toggler")?t=e.target.querySelector(".treenode-fold"):-1<e.target.className.indexOf("treenode-fold")&&(t=e.target),t&&"visible"===t.style.visibility)return!1;if(this.selectRowDir&&(this.selectRowDir.prevent=!1,clearTimeout(this.selectRowDir.timer),this.selectRowDir.rowNode&&this.enableDblClick)){var n=this.selectRowDir.rowNode;"all"===this.tt.loadDataType&&!n.node.leaf&&this.tt.dblClickExpand&&this.tt.toggleExpand(n.node),this.tt.dblClick.emit(n.node)}},U.decorators=[{type:g.Directive,args:[{selector:"[dblclick]"}]}],U.ctorParameters=function(){return[{type:O},{type:g.ElementRef},{type:x},{type:L,decorators:[{type:g.Optional},{type:g.Self}]}]},U.propDecorators={enableDblClick:[{type:g.Input,args:["dblclick"]}],dblclickNode:[{type:g.Input}],ondblclick:[{type:g.HostListener,args:["dblclick",["$event"]]}]},U);function U(e,t,n,i){this.tt=e,this.el=t,this.ttService=n,this.selectRowDir=i,this.enableDblClick=!1}var W=($.prototype.ngOnInit=function(){this.setRowStyle()},$.prototype.setRowStyle=function(){var t=this,e=this.tt.rowStyler;if(e){var n=e(this.rowNode.node);if(n)if("object"==typeof n&&(n.style||n.cls))n.style&&Object.keys(n.style).forEach(function(e){t.render.setStyle(t.el.nativeElement,e,n.style[e])}),n.cls&&n.cls.split(",").forEach(function(e){t.render.addClass(t.el.nativeElement,e)});else if(Array.isArray(n)||"string"==typeof n){var i=this.tt.getRowCls(this.rowNode);i&&Object.keys(i).length&&Object.keys(i).forEach(function(e){i[e]&&t.render.addClass(t.el.nativeElement,e)})}else Object.keys(n).forEach(function(e){t.render.setStyle(t.el.nativeElement,e,n[e])})}},$.prototype.ngOnChanges=function(e){e.rowNode&&!e.rowNode.isFirstChange()&&this.setRowStyle()},$.decorators=[{type:g.Directive,args:[{selector:"[customRowStyle]"}]}],$.ctorParameters=function(){return[{type:g.Injector},{type:g.NgZone},{type:g.ElementRef},{type:O},{type:f.CommonUtils},{type:g.Renderer2}]},$.propDecorators={rowNode:[{type:g.Input,args:["customRowStyle"]}]},$);function $(e,t,n,i,o,s){this.injector=e,this.ngZone=t,this.el=n,this.tt=i,this.utils=o,this.render=s}var q=(K.prototype.ngOnInit=function(){this.tt&&this.tt.getCellCls&&this.setCellStyle(),this.tt.showBorder||1!==this.tt.columns.length||this.render.setStyle(this.el.nativeElement,"border-width","0px")},K.prototype.setCellStyle=function(){var t=this,n=this.tt.getCellCls(this.rowNode,this.column.field);if(this.column&&this.column.styler){n&&Object.keys(n).length&&Object.keys(n).forEach(function(e){n[e]&&t.render.addClass(t.el.nativeElement,e)});var e=this.rowNode.node.data,i=this.column.styler(this.utils.getValue(this.column.field,e),e,this.rowIndex,this.rowNode);i&&(i.style||i.cls)&&(i.style&&Object.keys(i.style).forEach(function(e){t.render.setStyle(t.el.nativeElement,e,i.style[e])}),i.cls&&i.cls.split(",").forEach(function(e){t.render.addClass(t.el.nativeElement,e)}))}else Object.keys(n).forEach(function(e){t.render.setStyle(t.el.nativeElement,e,n[e])})},K.prototype.ngOnChanges=function(e){e.rowNode&&!e.rowNode.isFirstChange()&&this.setCellStyle()},K.decorators=[{type:g.Directive,args:[{selector:"[customCellStyle]"}]}],K.ctorParameters=function(){return[{type:g.Injector},{type:g.NgZone},{type:g.ElementRef},{type:O},{type:f.CommonUtils},{type:g.Renderer2}]},K.propDecorators={column:[{type:g.Input,args:["customCellStyle"]}],rowNode:[{type:g.Input}],rowIndex:[{type:g.Input}]},K);function K(e,t,n,i,o,s){this.injector=e,this.ngZone=t,this.el=n,this.tt=i,this.utils=o,this.render=s}var G=(Z.prototype.ngAfterViewInit=function(){var e=this;this.isEnable()&&(this.render.addClass(this.el.nativeElement,"resizable-column"),this.resizer=document.createElement("span"),this.resizer.className="column-resizer",this.el.nativeElement.appendChild(this.resizer),this.ngzone.runOutsideAngular(function(){e.resizerMouseDownListener=e.onMouseDown.bind(e),e.resizer.addEventListener("mousedown",e.resizerMouseDownListener),e.el.nativeElement.addEventListener("mouseenter",e.onMouseEnter.bind(e))}))},Z.prototype.isEnable=function(){return this.tt.resizableColumns&&!this.tt.autoWidth&&this.enableResize},Z.prototype.bindDocumentEvents=function(){var e=this;this.ngzone.runOutsideAngular(function(){e.documentMouseMoveListener=e.onMouseMove.bind(e),document.addEventListener("mousemove",e.documentMouseMoveListener),e.documentMouseUpListener=e.onMouseUp.bind(e),document.addEventListener("mouseup",e.documentMouseUpListener)})},Z.prototype.unbindDocumentEvents=function(){this.documentMouseMoveListener&&(document.removeEventListener("mousemove",this.documentMouseMoveListener),this.documentMouseMoveListener=null),this.documentMouseUpListener&&(document.removeEventListener("mouseup",this.documentMouseUpListener),this.documentMouseUpListener=null)},Z.prototype.onMouseDown=function(e){this.tt.onColumnResizeBegin(e),this.bindDocumentEvents()},Z.prototype.onMouseEnter=function(){},Z.prototype.onMouseMove=function(e){this.tt.onColumnResize(e)},Z.prototype.onMouseUp=function(e){this.tt.onColumnResizeEnd(e,this.el.nativeElement),this.unbindDocumentEvents()},Z.prototype.ngOnDestroy=function(){this.resizerMouseDownListener&&this.resizer.removeEventListener("mousedown",this.resizerMouseDownListener),this.unbindDocumentEvents()},Z.decorators=[{type:g.Directive,args:[{selector:"[resizable-column]"}]}],Z.ctorParameters=function(){return[{type:O},{type:g.NgZone},{type:g.ElementRef},{type:g.Renderer2}]},Z.propDecorators={enableResize:[{type:g.Input,args:["resizable-column"]}]},Z);function Z(e,t,n,i){this.tt=e,this.ngzone=t,this.el=n,this.render=i,this.enableResize=!0}var Y=(X.prototype.ngOnInit=function(){var t=this;this.columns.length&&(this.columns=this.columns.filter(function(e){return!e.formatter&&e.field}),this.findField=this.columns[0].field),this.ngZone.runOutsideAngular(function(){t.keyupEventSub=p.fromEvent(t.input.nativeElement,"keyup").pipe(u.filter(function(e){return 13!==(e["switch"]||e.keyCode)}),u.debounceTime(200),u.map(function(e){return e.target.value})).subscribe(function(e){t.valueChanged.emit({value:e,field:t.findField})})})},X.prototype.ngAfterViewInit=function(){this.input.nativeElement.focus()},X.prototype.ngOnDestroy=function(){this.keyupEventSub&&this.keyupEventSub.unsubscribe(),this.keyupEventSub=null},X.prototype.onClose=function(e){return this.close.emit(),!1},X.prototype.onEnter=function(e,t){return this.enterHandler.emit(t),!1},X.decorators=[{type:g.Component,args:[{selector:"find-input",template:'\n        <div class="f-find-input" style="">\n            <div class="input-group">\n                <div class="input-group-prepend">\n                    <select class="form-control" [(ngModel)]="findField">\n                        <option *ngFor="let col of columns" value="{{col.field}}">{{ col.title }}</option>\n                    </select>\n                </div>\n                <input #input type="text" placeholder="至少2个字符" class="form-control"\n                    (keydown.esc)="onClose($event)" (keydown.enter)="onEnter($event, 0)">\n                <div class="input-group-append">\n                    <span class="input-group-text">{{current}}/{{count}}</span>\n                    <button class="btn btn-outline-secondary" type="button" title="上一个"\n                        [disabled]="current === 0" (click)="onEnter($event, -1)">\n                        <span class="f-icon f-icon-arrow-chevron-up"></span>\n                    </button>\n                    <button class="btn btn-outline-secondary" type="button" title="下一个"\n                    [disabled]="current === count" (click)="onEnter($event, 1)">\n                        <span class="f-icon f-icon-arrow-chevron-down"></span>\n                    </button>\n                    <button class="btn btn-outline-secondary" type="button" title="关闭" (click)="onClose($event)">\n                        <span class="f-icon f-icon-close"></span>\n                    </button>\n                </div>\n            </div>\n        </div>\n    ',styles:["\n        .f-find-input {\n            width: 300px; height: 40px; background: #fefefe; position: absolute; right: 0; z-index: 10; padding: 5px;\n            border: 1px solid #d5d5d5;\n            box-shadow: 0px 1px 2px 0px #989898;\n        }\n        .f-find-input .input-group-text { border-right: 1px solid #ccc; font-size: 10px }\n        .f-find-input .input-group-append { background: #fff; }\n        .f-find-input .input-group-append button { padding:1px 6px;}\n        "]}]}],X.ctorParameters=function(){return[{type:g.ElementRef},{type:g.NgZone},{type:g.Injector}]},X.propDecorators={current:[{type:g.Input}],count:[{type:g.Input}],columns:[{type:g.Input}],close:[{type:g.Output}],valueChanged:[{type:g.Output}],enterHandler:[{type:g.Output}],input:[{type:g.ViewChild,args:["input"]}]},X);function X(e,t,n){this.el=e,this.ngZone=t,this.injector=n,this.current=0,this.count=0,this.columns=[],this.close=new g.EventEmitter,this.valueChanged=new g.EventEmitter,this.enterHandler=new g.EventEmitter,this.findField="",this.keyupEventSub=null}var Q=(J.prototype.transform=function(e,t,n,i){void 0===n&&(n=""),void 0===i&&(i="");var o=!0;if(n&&i&&(o=-1===i.indexOf(",")?n===i:i.split(",").some(function(e){return e===n})),!o)return e;if(t&&e){var s=t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");s=s.split(" ").filter(function(e){return 0<e.length}).join("|");var r=new RegExp(s,"gi");return this.sanitizer.bypassSecurityTrustHtml(this.replaceContent(e,r,function(e){return'<span class="search-highlight">'+e+"</span>"}))}return e},J.prototype.parseHTML=function(e,t){var n=(t||document).createElement("template");return n.innerHTML=e,n.content.cloneNode(!0)},J.prototype.replaceContent=function(e,t,n){var i,o,s=e.match(/>.*?\</gi);if(s&&s.length){try{for(var r=function u(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}(s),l=r.next();!l.done;l=r.next()){var a=l.value,c=s[a],d=s[a].replace(t,n),h=new RegExp(c,"g");e=e.replace(h,d)}}catch(p){i={error:p}}finally{try{l&&!l.done&&(o=r["return"])&&o.call(r)}finally{if(i)throw i.error}}return e}return e.replace(t,n)},J.decorators=[{type:g.Pipe,args:[{name:"highlight"}]}],J.ctorParameters=function(){return[{type:c.DomSanitizer},{type:g.ElementRef}]},J);function J(e,t){this.sanitizer=e,this.el=t}var ee=(te.prototype.ngOnInit=function(){this.setPagerInfo()},te.prototype.ngOnChanges=function(e){e.context&&!e.context.isFirstChange()&&this.setPagerInfo()},te.prototype.setPagerInfo=function(){if(this.context){var e=this.context.node;e&&e.pagination&&(this.pagerInfo=y({},e.pagination),this.showPager.next(e.expanded&&e.pagination))}},te.prototype.getPagerCount=function(){var e=this.pagerInfo,t=e.pageSize,n=e.total;return n?Math.ceil(n/t):0},te.prototype.isFirstPager=function(){return 1===this.pagerInfo.pageIndex},te.prototype.isLastPager=function(){return this.pagerInfo.pageIndex===this.getPagerCount()},te.prototype.previous=function(e){e.stopPropagation(),this.setCurrent(this.pagerInfo.pageIndex-1,this.pagerInfo.pageSize)},te.prototype.next=function(e){e.stopPropagation(),this.setCurrent(this.pagerInfo.pageIndex+1,this.pagerInfo.pageSize)},te.prototype.setCurrent=function(e,t,n){n&&n.stopPropagation(),this.pageChange.emit({pageIndex:e,pageSize:t,node:this.context.node,context:this.context})},te.decorators=[{type:g.Component,args:[{selector:"nodes-pager",template:'\r\n<div style="padding: 3px 0;" *ngIf="showPager | async">\r\n    <ul class="treetable-nodes-pagerbar d-flex">\r\n        <li class="pageinfo">{{ pagerInfo.pageIndex }} / {{ getPagerCount() }}</li>\r\n        <li class="pager-btn prev" [class.disabled]="isFirstPager()" (click)="previous($event)" title="{{ \'pagination.previous\'|locale: \'上一页\' }}">\r\n            <span class="f-icon f-icon-arrow-chevron-left"></span>\r\n        </li>\r\n        <li class="pager-btn next"  [class.disabled]="isLastPager()" (click)="next($event)" title="{{ \'pagination.next\'|locale: \'下一页\' }}">\r\n            <span class="f-icon f-icon-arrow-chevron-right"></span>\r\n        </li>\r\n    </ul>\r\n\r\n</div>',styles:["\n        .treetable-nodes-pagerbar { height: 22px; line-height: 22px; list-style: none}\n        .treetable-nodes-pagerbar li { float: left; box-sizing: border-box; }\n        .treetable-nodes-pagerbar .pager-btn {\n            width: 22px;\n            height: 22px;\n            text-align: center;\n            border: 1px solid #ccc;\n            background: rgb(248 249 250);\n            cursor: pointer;\n        }\n        .treetable-nodes-pagerbar .pager-btn:hover {\n            background: white;\n        }\n        .treetable-nodes-pagerbar .pageinfo {padding: 0 5px; font-weight: 400;}\n        .treetable-nodes-pagerbar .prev {}\n        .treetable-nodes-pagerbar .next {\n            border-left: 0;\n        }\n\n        .pager-btn.disabled{\n            color: rgb(204 204 204);\n            pointer-events: none;\n        }\n        "]}]}],te.ctorParameters=function(){return[{type:O},{type:g.ChangeDetectorRef},{type:g.Injector}]},te.propDecorators={context:[{type:g.Input}],pageChange:[{type:g.Output}]},te);function te(e,t,n){var i=this;this.tt=e,this.cd=t,this.injector=n,this.pageChange=new g.EventEmitter,this.showPager=new p.BehaviorSubject(!1),this.pagerInfo=null,this.tt&&(this.tt.expand.pipe(u.filter(function(e){return e.id===i.context.node.id&&e.pagination&&e.children.filter(function(e){return!e.__childs_loading__}).length})).subscribe(function(e){i.pagerInfo=y({},e.pagination),i.showPager.next(!0)}),this.tt.appendNew.subscribe(function(e){var t=e.parent;t.id===i.context.node.id&&t.pagination&&(i.pagerInfo=y({},t.pagination),i.showPager.next(!0))}),this.tt.collapse.subscribe(function(e){e.id===i.context.node.id&&i.showPager.next(!1)}))}var ne=(ie.prototype.ngOnInit=function(){},ie.decorators=[{type:g.Component,args:[{selector:"childs-loading",template:'\n    <div class="loading">\n        <span></span>\n        <span></span>\n        <span></span>\n        <span></span>\n        <span></span>\n    </div>\n    ',styles:["\n        .loading{\n            width: 150px;\n            height: 10px;\n            margin: 0 auto;\n            margin-top:10px;\n            margin-bottom: 20px;\n        }\n        .loading span{\n            display: inline-block;\n            width: 10px;\n            height: 100%;\n            margin-right: 5px;\n            border-radius: 50%;\n            background: #59a1ff;\n            -webkit-animation: load 1.04s ease infinite;\n        }\n        .loading span:last-child{\n            margin-right: 0px;\n        }\n        @-webkit-keyframes load{\n            0%{\n                opacity: 1;\n                -webkit-transform: scale(1.3);\n            }\n            100%{\n                opacity: 0.2;\n                -webkit-transform: scale(.3);\n            }\n        }\n        .loading span:nth-child(1){\n            -webkit-animation-delay:0.13s;\n        }\n        .loading span:nth-child(2){\n            -webkit-animation-delay:0.26s;\n        }\n        .loading span:nth-child(3){\n            -webkit-animation-delay:0.39s;\n        }\n        .loading span:nth-child(4){\n            -webkit-animation-delay:0.52s;\n        }\n        .loading span:nth-child(5){\n            -webkit-animation-delay:0.65s;\n        }\n        "]}]}],ie.ctorParameters=function(){return[]},ie);function ie(){}var oe=(se.prototype.transform=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.showTips?this.getCellTooltipContent(e,t[0]):""},se.prototype.getCellTooltipContent=function(e,t){var n=this.commonUtils.getValue(e.field,t.data);return e.tipContent?"string"==typeof e.tipContent?n=e.tipContent:"function"==typeof e.tipContent&&(n=e.tipContent(n,t.data,e)):e.formatter&&"object"==typeof e.formatter&&"enum"===e.formatter.type&&(n=this.commonUtils.getEnumTitleFromColumnOptions(n,e.formatter.options)),n},se.decorators=[{type:g.Pipe,args:[{name:"tipmsg"}]}],se.ctorParameters=function(){return[{type:f.CommonUtils}]},se);function se(e){this.commonUtils=e}var re=(le.decorators=[{type:g.NgModule,args:[{imports:[n.CommonModule,r.FormsModule,f.FarrisCommonModule.forRoot(),o.PerfectScrollbarModule,t.InputGroupModule,h.LocaleModule.forRoot(),l.DataColumnModule.forRoot(),d.PaginationModule,m.FarrisContextMenuModule],declarations:[O,F,H,L,_,A,B,G,R,q,Y,Q,W,ee,ne,oe],exports:[O,F,H,L,_,A,B,G,f.FarrisCommonModule,q,R,Q,W,ee,ne,oe],providers:[x,a.ResizeService,w]}]}],le);function le(){}e.TreetableService=x,e.FindInputComponent=Y,e.HighlightPipe=Q,e.TTHotkeys=w,e.TreetableNodesPagerComponent=ee,e.ChildsLoadingComponent=ne,e.CellTipsPipe=oe,e.TreeTableModule=re,e.TreeTableColumnDirective=R,e.TreeTableComponent=O,e.TTBodyComponent=F,e.TreeTableTogglerComponent=H,e.TreeTableSelectRowDirective=L,e.TreeTableHeaderCheckboxComponent=A,e.TreeTableCheckboxComponent=_,e.DblClickRowDirective=B,e.CustomRowStyleDirective=W,e.TTCustomCellStyleDirective=q,e.TTResizableColumnDirective=G,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=farris-ui-treetable.umd.min.js.map