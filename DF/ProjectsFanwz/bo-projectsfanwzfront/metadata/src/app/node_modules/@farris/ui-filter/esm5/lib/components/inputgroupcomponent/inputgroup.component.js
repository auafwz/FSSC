/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, EventEmitter, Output, HostBinding } from '@angular/core';
import { SolutionService } from '../../service/solution.service';
var SimpleInputGroupComponent = /** @class */ (function () {
    function SimpleInputGroupComponent(solutionService) {
        this.solutionService = solutionService;
        /**
         * 判断是否是在扩展区域展示
         */
        this.extend = false;
        /**
         * 判断是否显示label
         */
        this.showlabel = true;
        this.searchHandle = new EventEmitter();
        this.isTextFromDialog = false;
    }
    Object.defineProperty(SimpleInputGroupComponent.prototype, "item", {
        get: /**
         * @return {?}
         */
        function () {
            return this.constructTextItem(this._item);
        },
        set: /**
         * @param {?} textItem
         * @return {?}
         */
        function (textItem) {
            this._item = textItem;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SimpleInputGroupComponent.prototype, "isExtend", {
        get: /**
         * @return {?}
         */
        function () {
            return !this.extend && this.autoLabel;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SimpleInputGroupComponent.prototype, "hidenLabel", {
        get: /**
         * @return {?}
         */
        function () {
            return !this.showlabel;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} textItem
     * @return {?}
     */
    SimpleInputGroupComponent.prototype.constructTextItem = /**
     * @param {?} textItem
     * @return {?}
     */
    function (textItem) {
        /** @type {?} */
        var textValueObj = (/** @type {?} */ (textItem.value));
        textValueObj.textValue = textValueObj.textValue && textValueObj.textValue.trim();
        textItem.value = textValueObj;
        return textItem;
    };
    /**
     * @return {?}
     */
    SimpleInputGroupComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.testId = this.solutionService.getGuid();
        this.getInputGroupBindingInfo();
        if (this.item && this.item.control && this.item.control.hasOwnProperty('isExtend')) {
            this.extend = this.item.control.isExtend;
            if (!this.extend) {
                this.showlabel = this.item.control.showLabel;
            }
        }
    };
    /**
     * @return {?}
     */
    SimpleInputGroupComponent.prototype.getInputGroupBindingInfo = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var inputGroupControl = ((/** @type {?} */ (this.item.control)));
        this.usageMode = inputGroupControl.usageMode;
        if (this.usageMode == 'open-modal' || this.usageMode == 'open-remote-modal') {
            this.dialogOptions = inputGroupControl.dialogOptions;
            /*
                example of dialogOptions = {
                   modalId: "1e011720-eb0f-4c9c-82b6-6844c89b2303"
                   mapFields: {hDepartment: "Name"}
                   title: "测试标题栏"
                   width: 800
                   height: 600
                }
             */
            if (this.dialogOptions.mapFields) {
                this.textField = JSON.stringify(this.dialogOptions.mapFields).split('"')[1];
            }
        }
    };
    /**
     * @param {?} field
     * @return {?}
     */
    SimpleInputGroupComponent.prototype.getConditionItemTitle = /**
     * @param {?} field
     * @return {?}
     */
    function (field) {
        return this.solutionService.getConditionItemTitle(field);
    };
    /*
        dialogOptions = {
            modalId: "ae011720-eb0f-4c9c-82b6-6844c89b2303"
            mapFields: {hDepartment: "Name"}
            title: "测试标题栏"
            width: 800
            height: 600
            showButtons: true
            buttons: [
                { text: "确定", cls: "btn-primary", handle: _this.viewModel.rootviewmodelconfirm1 },
                { text: "取消", cls: "btn-secondary", handle: _this.viewModel.rootviewmodelcancel1}
            ]
        }
    */
    /*
            dialogOptions = {
                modalId: "ae011720-eb0f-4c9c-82b6-6844c89b2303"
                mapFields: {hDepartment: "Name"}
                title: "测试标题栏"
                width: 800
                height: 600
                showButtons: true
                buttons: [
                    { text: "确定", cls: "btn-primary", handle: _this.viewModel.rootviewmodelconfirm1 },
                    { text: "取消", cls: "btn-secondary", handle: _this.viewModel.rootviewmodelcancel1}
                ]
            }
        */
    /**
     * @param {?} event
     * @return {?}
     */
    SimpleInputGroupComponent.prototype.onClick = /*
            dialogOptions = {
                modalId: "ae011720-eb0f-4c9c-82b6-6844c89b2303"
                mapFields: {hDepartment: "Name"}
                title: "测试标题栏"
                width: 800
                height: 600
                showButtons: true
                buttons: [
                    { text: "确定", cls: "btn-primary", handle: _this.viewModel.rootviewmodelconfirm1 },
                    { text: "取消", cls: "btn-secondary", handle: _this.viewModel.rootviewmodelcancel1}
                ]
            }
        */
    /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        if (this.usageMode == 'text') {
            this.item.control.click();
        }
        else {
            /** @type {?} */
            var options = this.dialogOptions;
            options.handle = (/**
             * @param {?} selectedItem
             * @return {?}
             */
            function (selectedItem) {
                // let modalData = item[0];
                // this.item.value.value = modalData[this.targetField];
                /** @type {?} */
                var selectedItems = selectedItem.filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n; }));
                if (selectedItems && _this.textField) {
                    _this.item.value.value = selectedItems;
                    _this.item.value.textValue = _this.item.value.getTextValue(_this.textField);
                    _this.item.value.textField = _this.textField;
                    _this.item.value.isInputText = false;
                    _this.isTextFromDialog = true;
                    _this.textFormDialog = _this.item.value.textValue;
                }
            });
            this.item.control.click({ event: event, options: options });
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    SimpleInputGroupComponent.prototype.onBlur = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (this.disabled) {
            return;
        }
        if (this.usageMode == 'text') {
            this.item.value.isInputText = true;
        }
        if (this.usageMode == 'open-modal' || this.usageMode == 'open-remote-modal') {
            if (!this.isTextFromDialog) {
                this.item.value.isInputText = true;
            }
            if (this.item.value.textValue != this.textFormDialog) {
                this.isTextFromDialog = false;
                this.item.value.value = [];
                this.item.value.textField = undefined;
                this.item.value.isInputText = true;
            }
        }
        this.searchHandle.emit(event);
    };
    SimpleInputGroupComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-filter-inputgroup',
                    template: "<label class=\"col-form-label\" *ngIf=\"item && showlabel\" title=\"{{getConditionItemTitle(item)}}\">\r\n    <span class=\"farris-label-info text-danger\" *ngIf=\"item.control.required\">*</span>\r\n    <span class=\"farris-label-text\">{{item.fieldName}}</span>\r\n</label>\r\n<div class=\"farris-input-wrap\" *ngIf=\"item\">\r\n    <input-group \r\n        [(ngModel)]=\"item.value.textValue\" \r\n        name=\"{{item.fieldName}}\" \r\n        id=\"{{testId}}\"\r\n        [readonly]=\"disabled\"\r\n        [groupText]=\"item.control.groupText\"\r\n        [editable]=\"item.control.editable\"\r\n        [placeholder]=\"item.placeHolder\"\r\n        (clickHandle)=\"onClick($event)\"\r\n        (blurHandle)=\"onBlur($event)\"\r\n        (enterHandle)=\"onBlur($event)\"\r\n        >\r\n    </input-group>\r\n</div>\r\n"
                }] }
    ];
    /** @nocollapse */
    SimpleInputGroupComponent.ctorParameters = function () { return [
        { type: SolutionService }
    ]; };
    SimpleInputGroupComponent.propDecorators = {
        item: [{ type: Input }],
        autoLabel: [{ type: Input }],
        disabled: [{ type: Input }],
        isExtend: [{ type: HostBinding, args: ['class.filter-item-wrap',] }],
        hidenLabel: [{ type: HostBinding, args: ['class.filter-item-hiddenlabel',] }],
        searchHandle: [{ type: Output, args: ['searchHandle',] }]
    };
    return SimpleInputGroupComponent;
}());
export { SimpleInputGroupComponent };
if (false) {
    /**
     * QueryCondition类型
     * @type {?}
     */
    SimpleInputGroupComponent.prototype._item;
    /** @type {?} */
    SimpleInputGroupComponent.prototype.testId;
    /** @type {?} */
    SimpleInputGroupComponent.prototype.usageMode;
    /** @type {?} */
    SimpleInputGroupComponent.prototype.dialogOptions;
    /** @type {?} */
    SimpleInputGroupComponent.prototype.autoLabel;
    /** @type {?} */
    SimpleInputGroupComponent.prototype.disabled;
    /**
     * 判断是否是在扩展区域展示
     * @type {?}
     */
    SimpleInputGroupComponent.prototype.extend;
    /**
     * 判断是否显示label
     * @type {?}
     */
    SimpleInputGroupComponent.prototype.showlabel;
    /** @type {?} */
    SimpleInputGroupComponent.prototype.searchHandle;
    /** @type {?} */
    SimpleInputGroupComponent.prototype.textField;
    /** @type {?} */
    SimpleInputGroupComponent.prototype.isTextFromDialog;
    /** @type {?} */
    SimpleInputGroupComponent.prototype.textFormDialog;
    /**
     * @type {?}
     * @private
     */
    SimpleInputGroupComponent.prototype.solutionService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5wdXRncm91cC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLWZpbHRlci8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL2lucHV0Z3JvdXBjb21wb25lbnQvaW5wdXRncm91cC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFxQixZQUFZLEVBQUUsTUFBTSxFQUFFLFdBQVcsRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUV0RyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFLakU7SUFzREksbUNBQW9CLGVBQStCO1FBQS9CLG9CQUFlLEdBQWYsZUFBZSxDQUFnQjs7OztRQTFCbkQsV0FBTSxHQUFXLEtBQUssQ0FBQzs7OztRQUV2QixjQUFTLEdBQVcsSUFBSSxDQUFDO1FBV0QsaUJBQVksR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBRzFELHFCQUFnQixHQUFZLEtBQUssQ0FBQztJQVVtQixDQUFDO0lBckN0RCxzQkFDSSwyQ0FBSTs7OztRQUdSO1lBQ0ksT0FBTyxJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzlDLENBQUM7Ozs7O1FBTkQsVUFDUyxRQUFhO1lBQ2xCLElBQUksQ0FBQyxLQUFLLEdBQUcsUUFBUSxDQUFDO1FBQzFCLENBQUM7OztPQUFBO0lBWUQsc0JBQ0ksK0NBQVE7Ozs7UUFEWjtZQUVJLE9BQU8sQ0FBQyxJQUFJLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUM7UUFDMUMsQ0FBQzs7O09BQUE7SUFDRCxzQkFDSSxpREFBVTs7OztRQURkO1lBRUksT0FBTyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUM7UUFDM0IsQ0FBQzs7O09BQUE7Ozs7O0lBUUQscURBQWlCOzs7O0lBQWpCLFVBQWtCLFFBQXdCOztZQUNoQyxZQUFZLEdBQUcsbUJBQUEs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R0FBRyxJQUFJLENBQUM7YUFDdEM7U0FDSjtRQUNELElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2xDLENBQUM7O2dCQW5KSixTQUFTLFNBQUM7b0JBQ1AsUUFBUSxFQUFFLHVCQUF1QjtvQkFDakMsczBCQUEwQztpQkFDN0M7Ozs7Z0JBUlEsZUFBZTs7O3VCQXNCbkIsS0FBSzs0QkFPTCxLQUFLOzJCQUNMLEtBQUs7MkJBT0wsV0FBVyxTQUFDLHdCQUF3Qjs2QkFJcEMsV0FBVyxTQUFDLCtCQUErQjsrQkFLM0MsTUFBTSxTQUFDLGNBQWM7O0lBMkcxQixnQ0FBQztDQUFBLEFBcEpELElBb0pDO1NBL0lZLHlCQUF5Qjs7Ozs7O0lBSWxDLDBDQUFzQjs7SUFFdEIsMkNBQWU7O0lBRWYsOENBQWtCOztJQUVsQixrREFBbUI7O0lBU25CLDhDQUEyQjs7SUFDM0IsNkNBQTBCOzs7OztJQUcxQiwyQ0FBdUI7Ozs7O0lBRXZCLDhDQUF5Qjs7SUFXekIsaURBQTBEOztJQUUxRCw4Q0FBa0I7O0lBQ2xCLHFEQUFrQzs7SUFDbEMsbURBQXVCOzs7OztJQVNYLG9EQUF1QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE9uSW5pdCwgT25DaGFuZ2VzLCBFdmVudEVtaXR0ZXIsIE91dHB1dCwgSG9zdEJpbmRpbmd9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBRdWVyeUNvbmRpdGlvbiB9IGZyb20gJy4uLy4uL2VudGl0eS9xdWVyeWNvbmRpdGlvbic7XHJcbmltcG9ydCB7IFNvbHV0aW9uU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2Uvc29sdXRpb24uc2VydmljZSc7XHJcbmltcG9ydCB7IElucHV0R3JvdXBDb250cm9sIH0gZnJvbSAnLi4vLi4vZW50aXR5L2NvbnRyb2x0eXBlL2lucHV0LWdyb3VwL2lucHV0Z3JvdXBjb250cm9sJztcclxuaW1wb3J0IHsgSW5wdXRHcm91cFZhbHVlIH0gZnJvbSAnLi4vLi4vZW50aXR5L2NvbmRpdGlvbnZhbHVlL2lucHV0Z3JvdXAnO1xyXG5cclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdhcHAtZmlsdGVyLWlucHV0Z3JvdXAnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2lucHV0Z3JvdXAuY29tcG9uZW50Lmh0bWwnLFxyXG59KVxyXG5cclxuZXhwb3J0IGNsYXNzIFNpbXBsZUlucHV0R3JvdXBDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXR7XHJcbiAgICAvKipcclxuICAgICAqIFF1ZXJ5Q29uZGl0aW9u57G75Z6LXHJcbiAgICAgKi9cclxuICAgIF9pdGVtOiBRdWVyeUNvbmRpdGlvbjtcclxuXHJcbiAgICB0ZXN0SWQ6IHN0cmluZztcclxuXHJcbiAgICB1c2FnZU1vZGU6IHN0cmluZztcclxuXHJcbiAgICBkaWFsb2dPcHRpb25zOiBhbnk7XHJcblxyXG4gICAgQElucHV0KClcclxuICAgIHNldCBpdGVtKHRleHRJdGVtOiBhbnkpIHtcclxuICAgICAgICB0aGlzLl9pdGVtID0gdGV4dEl0ZW07XHJcbiAgICB9XHJcbiAgICBnZXQgaXRlbSgpOiBhbnl7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uc3RydWN0VGV4dEl0ZW0odGhpcy5faXRlbSk7XHJcbiAgICB9XHJcbiAgICBASW5wdXQoKSBhdXRvTGFiZWw6Ym9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGRpc2FibGVkOmJvb2xlYW47XHJcblxyXG4gICAgLyoq5Yik5pat5piv5ZCm5piv5Zyo5omp5bGV5Yy65Z+f5bGV56S6ICovXHJcbiAgICBleHRlbmQ6Ym9vbGVhbiA9IGZhbHNlO1xyXG4gICAgLyoq5Yik5pat5piv5ZCm5pi+56S6bGFiZWwgKi9cclxuICAgIHNob3dsYWJlbDpib29sZWFuID0gdHJ1ZTtcclxuICAgIFxyXG4gICAgQEhvc3RCaW5kaW5nKCdjbGFzcy5maWx0ZXItaXRlbS13cmFwJylcclxuICAgIGdldCBpc0V4dGVuZCgpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gIXRoaXMuZXh0ZW5kICYmIHRoaXMuYXV0b0xhYmVsO1xyXG4gICAgfVxyXG4gICAgQEhvc3RCaW5kaW5nKCdjbGFzcy5maWx0ZXItaXRlbS1oaWRkZW5sYWJlbCcpXHJcbiAgICBnZXQgaGlkZW5MYWJlbCgpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gIXRoaXMuc2hvd2xhYmVsO1xyXG4gICAgfVxyXG5cclxuICAgIEBPdXRwdXQoJ3NlYXJjaEhhbmRsZScpIHNlYXJjaEhhbmRsZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICB0ZXh0RmllbGQ6IHN0cmluZztcclxuICAgIGlzVGV4dEZyb21EaWFsb2c6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIHRleHRGb3JtRGlhbG9nOiBzdHJpbmc7XHJcblxyXG4gICAgY29uc3RydWN0VGV4dEl0ZW0odGV4dEl0ZW06IFF1ZXJ5Q29uZGl0aW9uKTogUXVlcnlDb25kaXRpb24ge1xyXG4gICAgICAgIGNvbnN0IHRleHRWYWx1ZU9iaiA9IHRleHRJdGVtLnZhbHVlIGFzIElucHV0R3JvdXBWYWx1ZTtcclxuICAgICAgICB0ZXh0VmFsdWVPYmoudGV4dFZhbHVlID0gdGV4dFZhbHVlT2JqLnRleHRWYWx1ZSAmJiB0ZXh0VmFsdWVPYmoudGV4dFZhbHVlLnRyaW0oKTtcclxuICAgICAgICB0ZXh0SXRlbS52YWx1ZSA9IHRleHRWYWx1ZU9iajtcclxuICAgICAgICByZXR1cm4gdGV4dEl0ZW07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBzb2x1dGlvblNlcnZpY2U6U29sdXRpb25TZXJ2aWNlKXt9XHJcblxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy50ZXN0SWQgPSB0aGlzLnNvbHV0aW9uU2VydmljZS5nZXRHdWlkKCk7XHJcbiAgICAgICAgdGhpcy5nZXRJbnB1dEdyb3VwQmluZGluZ0luZm8oKTtcclxuXHJcbiAgICAgICAgaWYodGhpcy5pdGVtICYmIHRoaXMuaXRlbS5jb250cm9sICYmIHRoaXMuaXRlbS5jb250cm9sLmhhc093blByb3BlcnR5KCdpc0V4dGVuZCcpKXtcclxuICAgICAgICAgICAgdGhpcy5leHRlbmQgPSB0aGlzLml0ZW0uY29udHJvbC5pc0V4dGVuZDtcclxuICAgICAgICAgICAgaWYoIXRoaXMuZXh0ZW5kKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2hvd2xhYmVsID0gdGhpcy5pdGVtLmNvbnRyb2wuc2hvd0xhYmVsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldElucHV0R3JvdXBCaW5kaW5nSW5mbygpIHtcclxuICAgICAgICBjb25zdCBpbnB1dEdyb3VwQ29udHJvbCA9ICh0aGlzLml0ZW0uY29udHJvbCBhcyBJbnB1dEdyb3VwQ29udHJvbCk7XHJcbiAgICAgICAgdGhpcy51c2FnZU1vZGUgPSBpbnB1dEdyb3VwQ29udHJvbC51c2FnZU1vZGU7XHJcbiAgICAgICAgaWYodGhpcy51c2FnZU1vZGUgPT0gJ29wZW4tbW9kYWwnIHx8IHRoaXMudXNhZ2VNb2RlID09ICdvcGVuLXJlbW90ZS1tb2RhbCcpIHtcclxuICAgICAgICAgICAgdGhpcy5kaWFsb2dPcHRpb25zID0gaW5wdXRHcm91cENvbnRyb2wuZGlhbG9nT3B0aW9ucztcclxuICAgICAgICAgICAgLypcclxuICAgICAgICAgICAgICAgIGV4YW1wbGUgb2YgZGlhbG9nT3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgICAgICAgIG1vZGFsSWQ6IFwiMWUwMTE3MjAtZWIwZi00YzljLTgyYjYtNjg0NGM4OWIyMzAzXCJcclxuICAgICAgICAgICAgICAgICAgIG1hcEZpZWxkczoge2hEZXBhcnRtZW50OiBcIk5hbWVcIn1cclxuICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIua1i+ivleagh+mimOagj1wiXHJcbiAgICAgICAgICAgICAgICAgICB3aWR0aDogODAwXHJcbiAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDYwMFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgaWYodGhpcy5kaWFsb2dPcHRpb25zLm1hcEZpZWxkcyl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRleHRGaWVsZCA9IEpTT04uc3RyaW5naWZ5KHRoaXMuZGlhbG9nT3B0aW9ucy5tYXBGaWVsZHMpLnNwbGl0KCdcIicpWzFdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldENvbmRpdGlvbkl0ZW1UaXRsZShmaWVsZDpRdWVyeUNvbmRpdGlvbil7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc29sdXRpb25TZXJ2aWNlLmdldENvbmRpdGlvbkl0ZW1UaXRsZShmaWVsZCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8qXHJcbiAgICAgICAgZGlhbG9nT3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgbW9kYWxJZDogXCJhZTAxMTcyMC1lYjBmLTRjOWMtODJiNi02ODQ0Yzg5YjIzMDNcIlxyXG4gICAgICAgICAgICBtYXBGaWVsZHM6IHtoRGVwYXJ0bWVudDogXCJOYW1lXCJ9XHJcbiAgICAgICAgICAgIHRpdGxlOiBcIua1i+ivleagh+mimOagj1wiXHJcbiAgICAgICAgICAgIHdpZHRoOiA4MDBcclxuICAgICAgICAgICAgaGVpZ2h0OiA2MDBcclxuICAgICAgICAgICAgc2hvd0J1dHRvbnM6IHRydWVcclxuICAgICAgICAgICAgYnV0dG9uczogW1xyXG4gICAgICAgICAgICAgICAgeyB0ZXh0OiBcIuehruWumlwiLCBjbHM6IFwiYnRuLXByaW1hcnlcIiwgaGFuZGxlOiBfdGhpcy52aWV3TW9kZWwucm9vdHZpZXdtb2RlbGNvbmZpcm0xIH0sXHJcbiAgICAgICAgICAgICAgICB7IHRleHQ6IFwi5Y+W5raIXCIsIGNsczogXCJidG4tc2Vjb25kYXJ5XCIsIGhhbmRsZTogX3RoaXMudmlld01vZGVsLnJvb3R2aWV3bW9kZWxjYW5jZWwxfVxyXG4gICAgICAgICAgICBdXHJcbiAgICAgICAgfVxyXG4gICAgKi9cclxuICAgb25DbGljayhldmVudDogYW55KXtcclxuICAgICAgICBpZih0aGlzLnVzYWdlTW9kZSA9PSAndGV4dCcpe1xyXG4gICAgICAgICAgICB0aGlzLml0ZW0uY29udHJvbC5jbGljaygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICBjb25zdCBvcHRpb25zID0gdGhpcy5kaWFsb2dPcHRpb25zO1xyXG4gICAgICAgICAgICBvcHRpb25zLmhhbmRsZSA9IChzZWxlY3RlZEl0ZW0pID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIGxldCBtb2RhbERhdGEgPSBpdGVtWzBdO1xyXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5pdGVtLnZhbHVlLnZhbHVlID0gbW9kYWxEYXRhW3RoaXMudGFyZ2V0RmllbGRdO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNlbGVjdGVkSXRlbXMgPSBzZWxlY3RlZEl0ZW0uZmlsdGVyKG4gPT4gbik7XHJcbiAgICAgICAgICAgICAgICBpZihzZWxlY3RlZEl0ZW1zICYmIHRoaXMudGV4dEZpZWxkKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLml0ZW0udmFsdWUudmFsdWUgPSBzZWxlY3RlZEl0ZW1zO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXRlbS52YWx1ZS50ZXh0VmFsdWUgPSB0aGlzLml0ZW0udmFsdWUuZ2V0VGV4dFZhbHVlKHRoaXMudGV4dEZpZWxkKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLml0ZW0udmFsdWUudGV4dEZpZWxkID0gdGhpcy50ZXh0RmllbGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtLnZhbHVlLmlzSW5wdXRUZXh0ID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNUZXh0RnJvbURpYWxvZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZXh0Rm9ybURpYWxvZyA9IHRoaXMuaXRlbS52YWx1ZS50ZXh0VmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5pdGVtLmNvbnRyb2wuY2xpY2soe2V2ZW50LCBvcHRpb25zfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uQmx1cihldmVudCl7XHJcbiAgICAgICAgaWYodGhpcy5kaXNhYmxlZCl7cmV0dXJuO31cclxuICAgICAgICBpZih0aGlzLnVzYWdlTW9kZSA9PSAndGV4dCcpIHtcclxuICAgICAgICAgICAgdGhpcy5pdGVtLnZhbHVlLmlzSW5wdXRUZXh0ID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy51c2FnZU1vZGUgPT0gJ29wZW4tbW9kYWwnIHx8IHRoaXMudXNhZ2VNb2RlID09ICdvcGVuLXJlbW90ZS1tb2RhbCcpIHtcclxuICAgICAgICAgICAgaWYoIXRoaXMuaXNUZXh0RnJvbURpYWxvZykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtLnZhbHVlLmlzSW5wdXRUZXh0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZih0aGlzLml0ZW0udmFsdWUudGV4dFZhbHVlICE9IHRoaXMudGV4dEZvcm1EaWFsb2cpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc1RleHRGcm9tRGlhbG9nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW0udmFsdWUudmFsdWUgPSBbXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXRlbS52YWx1ZS50ZXh0RmllbGQgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW0udmFsdWUuaXNJbnB1dFRleHQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2VhcmNoSGFuZGxlLmVtaXQoZXZlbnQpO1xyXG4gICAgfVxyXG59Il19