import { Subject } from 'rxjs';
import { ChangeSet } from '../changeset';
import { SchemaEntityField$Type } from '../schema/schema';
import { EntityList } from './entity_list';
import { entityPrototype } from './entity_prototype';
import { NG_FIELD, NG_LIST, NG_OBJECT } from './metadata';
import { PARENT_CLASS, PARENT_PATH } from './types';
import { Validator } from './validator';
import { ValidationUtils } from './validator/validation_utils';
/**
 * 实体类型工厂
 * 用来根据实体Schema描述信息创建实体类型
 */
var EntityTypeFactory = /** @class */ (function () {
    function EntityTypeFactory() {
    }
    /**
     * 由实体Schema结构创建实体类型
     * @param schema 实体Schema结构
     * @returns 实体类型
     */
    EntityTypeFactory.prototype.create = function (schema) {
        // 提取Schema定义中的第一个是实体描述
        var schemaType = schema.entities[0].type;
        // 创建实体类型
        var entityType = this.createClass(schemaType);
        return entityType;
    };
    /**
     * 由实体Schema类型描述创建实体类
     * @param schemaType Schema实体类型描述
     * @returns 实体类型
     */
    EntityTypeFactory.prototype.createClass = function (schemaType) {
        var attachEntityInstanceData = this.createEntityInstanceDataInitializer(schemaType);
        // 创建指定实体类型的初始化函数，用来在实体类型构造函数中为实体实例赋值
        var initialize = function (entityInstance, entityData, entityTypeConstructor) {
            entityInstance.isInitializing = true;
            attachEntityInstanceData(entityInstance, entityData, entityTypeConstructor);
            entityInstance.isInitializing = false;
        };
        // 声明实体类构造函数
        var ConcreteEntity = function (data) {
            var _this = this;
            // 创建实体变更集
            this.changeSet = new ChangeSet();
            // 初始化实体验证状态
            this.isValidating = false;
            // 初始化实体验证信息
            this.validErrors = {};
            // 初始化验证器
            this.validator = new Validator();
            // 初始化实体数据副本
            this.innerData = Object.assign({}, data);
            // 初始化子实体对象集合
            this.innerEntities = {};
            // 初始化实体值变化事件
            this.valueChanged = new Subject();
            this.onValueChanged = this.valueChanged;
            this.validateFromUtilSync = function (propertyName, value, cb, context) {
                this.validErrors = {};
                var result = this.validator.verify(this, propertyName, value, null, undefined, context && context.frameContext || null, true);
                if (result && !result.isValid) {
                    this.validErrors = ValidationUtils.convertErrorsToNormalObject(result.errors, {});
                }
                cb(result);
            };
            // 调用初始化方法，初始化实体数据
            initialize(this, data, ConcreteEntity);
            this.load = function (newData) {
                attachEntityInstanceData(_this, newData, ConcreteEntity);
            };
        };
        // 在实体类构造函数中记录视图类型名称
        ConcreteEntity.typeName = schemaType.name + "Entity";
        // 在实体类构造函数中记录其下直接引用的子类型
        ConcreteEntity.types = {};
        ConcreteEntity.__prop__metadata__ = {};
        // 构造实体类的原型对象
        var entityTypePrototype = Object.assign({ typeName: 'ConcreteEntityPrototype' }, entityPrototype);
        // 向实体类原型对象中定义预制属性
        this.definePresetProperty(entityTypePrototype, schemaType);
        // 向实体类原型对象中定义字段属性get/set方法
        this.defineFieldsToPrototype(entityTypePrototype, schemaType.fields, schemaType.primary, ConcreteEntity);
        // 向实体类原型对象中定义访问子实体的get/set方法
        this.defineEntitiesToPrototype(entityTypePrototype, schemaType.entities, ConcreteEntity);
        // 将实体类的原型对象指向新构造的原型对象。
        ConcreteEntity.prototype = entityTypePrototype;
        return ConcreteEntity;
    };
    /**
     * 向实体类原型对象中定义预制属性
     * @param prototypeObject 实体类原型对象
     * @param schemaType Schema类型描述
     */
    EntityTypeFactory.prototype.definePresetProperty = function (prototypeObject, schemaType) {
        /**
         * 实体数据
         */
        Object.defineProperty(prototypeObject, 'data', {
            get: function () {
                return this.innerData;
            }
        });
        /**
         * 实体验证信息
         */
        Object.defineProperty(prototypeObject, 'errors', {
            get: function () {
                return this.validErrors;
            },
            set: function (errors) {
                this.validErrors = errors;
            }
        });
        /**
         * 实体变更集
         */
        Object.defineProperty(prototypeObject, 'changes', {
            get: function () {
                return this.changeSet.changes;
            }
        });
        /**
         * 实体主键
         */
        Object.defineProperty(prototypeObject, 'primaryProperty', {
            // tslint:disable-next-line: only-arrow-functions
            get: function () {
                // return schemaType.primary;
                return prototypeObject.innerPrimaryProperty || { dataField: schemaType.primary };
            }
        });
        /**
         * 实体主键
         */
        Object.defineProperty(prototypeObject, 'primaryKey', {
            // tslint:disable-next-line: only-arrow-functions
            get: function () {
                return schemaType.primary || '';
            }
        });
        /**
         * 实体主键的值
         */
        Object.defineProperty(prototypeObject, 'primaryValue', {
            get: function () {
                if (this.primaryKey) {
                    // return this[this.primaryProperty.property].toString();
                    var primaryValue = this[this.primaryKey];
                    return primaryValue ? primaryValue : '';
                }
                else {
                    return '';
                }
            }
        });
    };
    /**
     * 向实体类定义字段属性
     * @param prototypeObject 实体类原型对象
     * @param fields 字段描述集合
     * @param parentEntityType 父类型
     */
    EntityTypeFactory.prototype.defineFieldsToPrototype = function (prototypeObject, fields, primary, parentEntityType) {
        var _this = this;
        if (fields && fields.length) {
            // 遍历Schema中描述的字段，在实体原型对象上定义字段访问函数
            fields.forEach(function (schemaEntityField) {
                switch (schemaEntityField.$type) {
                    // 定义简单类型字段
                    case SchemaEntityField$Type.SimpleField:
                        _this.defineSimpleFieldToPrototype(prototypeObject, schemaEntityField, primary, parentEntityType);
                        break;
                    // 定义复杂类型字段
                    case SchemaEntityField$Type.ComplexField:
                        _this.defineComplexFieldToPrototype(prototypeObject, schemaEntityField, parentEntityType);
                        break;
                }
            });
        }
    };
    /**
     * 向实体类定义简单类型字段
     * @param prototypeObject 实体类原型对象
     * @param schemaField 字段描述
     */
    EntityTypeFactory.prototype.defineSimpleFieldToPrototype = function (prototypeObject, schemaField, primary, parentEntityType) {
        var propertyName = schemaField.label;
        Object.defineProperty(prototypeObject, propertyName, {
            get: function () {
                return this.getFieldValue(schemaField);
            },
            set: function (newPropValue) {
                // 值相同时不触发变更。
                var oldPropValue = this.getFieldValue(schemaField);
                if (this.isFieldValueChanged(schemaField, newPropValue, oldPropValue) === false) {
                    return;
                }
                this.setFieldValue(schemaField, newPropValue);
                this.emitFieldValueChange(schemaField, newPropValue, oldPropValue);
            }
        });
        var fieldMetadata = {
            /** 字段名称 */
            dataField: schemaField.label,
            /** 原始字段名称 */
            originalDataField: schemaField.code,
            /** 原始字段类型 */
            originalDataFieldType: schemaField.type.name,
            /**
             * 原始字段
             * @description 对应到scheme的path属性
             */
            path: schemaField.path,
            primary: schemaField.label === primary,
            ngMetadataName: NG_FIELD
        };
        if (fieldMetadata.primary) {
            prototypeObject.innerPrimaryProperty = fieldMetadata;
        }
        if (!parentEntityType.__prop__metadata__[propertyName]) {
            parentEntityType.__prop__metadata__[propertyName] = [];
        }
        parentEntityType.__prop__metadata__[propertyName].push(fieldMetadata);
    };
    /**
     * 向实体类定义复杂类型字段
     * @param prototypeObject 实体类原型对象
     * @param schemaField 字段描述
     * @param parentEntityType 父类型
     */
    EntityTypeFactory.prototype.defineComplexFieldToPrototype = function (prototypeObject, schemaField, parentEntityType) {
        var complexFieldType = this.createClass(schemaField.type);
        parentEntityType.types[schemaField.type.name] = complexFieldType;
        var propertyName = schemaField.label;
        Object.defineProperty(prototypeObject, propertyName, {
            get: function () {
                var fieldValue = this.getComplexFieldValue(schemaField);
                return fieldValue;
            },
            set: function (value) {
                this.setComplexFieldValue(schemaField, complexFieldType, value);
            }
        });
        var fieldMetadata = {
            /** 映射字段 */
            dataField: schemaField.label,
            /** 原始字段名称 */
            originalDataField: schemaField.code,
            /** 引用实体类型 */
            type: complexFieldType,
            /**
             * 原始字段
             * @description 对应到scheme的path属性
             */
            path: schemaField.path,
            ngMetadataName: NG_OBJECT
        };
        if (!parentEntityType.__prop__metadata__[propertyName]) {
            parentEntityType.__prop__metadata__[propertyName] = [];
        }
        parentEntityType.__prop__metadata__[propertyName].push(fieldMetadata);
    };
    /**
     * 向实体类定义子实体
     * @param prototypeObject 实体类原型对象
     * @param entities 实体描述集合
     * @param parentEntityType 父类型
     */
    EntityTypeFactory.prototype.defineEntitiesToPrototype = function (prototypeObject, entities, parentEntityType) {
        var _this = this;
        if (entities && entities.length) {
            // 遍历Schema中描述的子实体，在实体对象上定义子实体列表
            entities.forEach(function (schemaEntity) {
                var complexFieldType = _this.createClass(schemaEntity.type);
                parentEntityType.types[schemaEntity.type.name] = complexFieldType;
                // 提取子实体在实体对象上的属性名
                var propertyName = schemaEntity.label;
                Object.defineProperty(prototypeObject, propertyName, {
                    get: function () {
                        var fieldValue = this.getEntities(schemaEntity);
                        return fieldValue;
                    },
                    set: function (value) {
                        this.setEntities(schemaEntity, value);
                    }
                });
                var entitMetadata = {
                    /** 字段名称 */
                    dataField: schemaEntity.label,
                    /** 原始字段名称 */
                    originalDataField: '',
                    /** 实体类型 */
                    type: complexFieldType,
                    ngMetadataName: NG_LIST
                };
                if (!parentEntityType.__prop__metadata__[propertyName]) {
                    parentEntityType.__prop__metadata__[propertyName] = [];
                }
                parentEntityType.__prop__metadata__[propertyName].push(entitMetadata);
            });
        }
    };
    /**
     * 创建初始化实体对象方法
     * @param schemaType 实体类型描述
     * @returns 初始化实体对象方法
     */
    EntityTypeFactory.prototype.createEntityInstanceDataInitializer = function (schemaType) {
        /**
         * 实体初始化函数，用来初始化实体的复杂类型数据和子实体数据
         * @param entityInstance 实体类型实例
         * @param data 实体原始数据
         * @param entityTypeConstructor 实体类型构造函数
         */
        var initializer = function (entityInstance, entityData, entityTypeConstructor) {
            // 初始化复杂类型字段
            schemaType.fields
                // 过滤复杂类型字段
                .filter(function (field) { return field.$type === SchemaEntityField$Type.ComplexField; })
                // 遍历复杂类型字段创建对应实体类型数据
                .forEach(function (field) {
                // 提取字段名
                var fieldName = field.label;
                // 提取实体类型下的所有子实体类型
                var includedEntityTypes = entityTypeConstructor.types;
                // 获取复杂类型字段对应的实体类型
                var ComplexField = includedEntityTypes[field.type.name];
                // 提取复杂类型字段原始数据
                var fieldData = entityData ? entityData[fieldName] : null;
                // 创建复杂类型字段对象路径
                var path = entityInstance.createPath(fieldName);
                var complexFieldValue = entityInstance[fieldName];
                if (complexFieldValue instanceof ComplexField) {
                    complexFieldValue.load(fieldData);
                }
                else {
                    // 创建复杂类型字段实体实例
                    complexFieldValue = new ComplexField(fieldData);
                    complexFieldValue.constructor = ComplexField;
                    complexFieldValue[PARENT_CLASS] = entityTypeConstructor;
                    complexFieldValue[PARENT_PATH] = path;
                    complexFieldValue.onValueChanged.subscribe(function (changes) {
                        if (changes) {
                            changes.path = (entityInstance[PARENT_PATH] || []).concat(changes.path);
                            entityInstance.setChanges(changes);
                        }
                    });
                    entityInstance[fieldName] = complexFieldValue;
                }
            });
            // 初始化子实体
            if (schemaType.entities) {
                // 遍历子实体创建对应实体类型的数据
                schemaType.entities.forEach(function (schemaEntity) {
                    // 提取子实体名
                    var subEntityName = schemaEntity.label;
                    // 提取实体类型下的所有子实体类型
                    var includedEntityTypes = entityTypeConstructor.types;
                    // 创建子实体对象路径
                    var path = entityInstance.createPath(subEntityName);
                    // 创建子实体对象集合
                    var entityList = entityInstance[subEntityName];
                    if (!(entityList instanceof EntityList)) {
                        entityList = new EntityList();
                        // 向子实体列表注册子实体变化事件
                        entityList.onListChanged.subscribe(function (value) {
                            if (value) {
                                if (entityList[PARENT_PATH][0] !== value.path[0]) {
                                    value.path = entityList[PARENT_PATH].concat(value.path);
                                }
                                entityInstance.setChanges(value);
                            }
                        });
                        // 向实体类型实例上直接存储子实体对象列表
                        entityInstance[subEntityName] = entityList;
                    }
                    entityList[PARENT_CLASS] = entityTypeConstructor;
                    entityList[PARENT_PATH] = path;
                    // 提取子实体类型名称
                    var schemaEntityTypeName = schemaEntity.type.name;
                    // 获取子实体类型
                    var ConcreteEntity = includedEntityTypes[schemaEntityTypeName];
                    var originalEntityDataArray = entityData ? entityData[subEntityName] : null;
                    // 构造子实体集合
                    if (originalEntityDataArray) {
                        // 遍历子实体原始数据，构造实体对象集合
                        var entities = originalEntityDataArray.map(function (originalEntityData) {
                            var concreteEntityInstance = new ConcreteEntity(originalEntityData);
                            concreteEntityInstance.constructor = ConcreteEntity;
                            return concreteEntityInstance;
                        });
                        // 向子实体列表中添加子实体对象
                        entityList.loadEntities(entities);
                    }
                });
            }
        };
        return initializer;
    };
    return EntityTypeFactory;
}());
export { EntityTypeFactory };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW50aXR5X3R5cGVfZmFjdG9yeS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvZGV2a2l0LyIsInNvdXJjZXMiOlsibGliL2VudGl0eS9lbnRpdHlfdHlwZV9mYWN0b3J5LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDL0IsT0FBTyxFQUFFLFNBQVMsRUFBZ0IsTUFBTSxjQUFjLENBQUM7QUFDdkQsT0FBTyxFQUEyQyxzQkFBc0IsRUFBYyxNQUFNLGtCQUFrQixDQUFDO0FBRS9HLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ3JELE9BQU8sRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLFlBQVksQ0FBQztBQUMxRCxPQUFPLEVBQUUsWUFBWSxFQUFFLFdBQVcsRUFBRSxNQUFNLFNBQVMsQ0FBQztBQUNwRCxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sYUFBYSxDQUFDO0FBQ3hDLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQztBQVEvRDs7O0dBR0c7QUFDSDtJQUVFO0lBQWdCLENBQUM7SUFDakI7Ozs7T0FJRztJQUNJLGtDQUFNLEdBQWIsVUFBYyxNQUFjO1FBQzFCLHVCQUF1QjtRQUN2QixJQUFNLFVBQVUsR0FBRyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztRQUMzQyxTQUFTO1FBQ1QsSUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNoRCxPQUFPLFVBQVUsQ0FBQztJQUNwQixDQUFDO0lBQ0Q7Ozs7T0FJRztJQUNLLHVDQUFXLEdBQW5CLFVBQW9CLFVBQXNCO1FBQ3hDLElBQU0sd0JBQXdCLEdBQUcsSUFBSSxDQUFDLG1DQUFtQyxDQUFDLFVB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b0IsQ0FBQyxDQUFDO29CQUNqRSxJQUFNLHVCQUF1QixHQUFHLFVBQVUsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7b0JBQzlFLFVBQVU7b0JBQ1YsSUFBSSx1QkFBdUIsRUFBRTt3QkFDM0IscUJBQXFCO3dCQUNyQixJQUFNLFFBQVEsR0FBRyx1QkFBdUIsQ0FBQyxHQUFHLENBQUMsVUFBQyxrQkFBdUI7NEJBQ25FLElBQU0sc0JBQXNCLEdBQUcsSUFBSSxjQUFjLENBQUMsa0JBQWtCLENBQUMsQ0FBQzs0QkFDdEUsc0JBQXNCLENBQUMsV0FBVyxHQUFHLGNBQWMsQ0FBQzs0QkFDcEQsT0FBTyxzQkFBc0IsQ0FBQzt3QkFDaEMsQ0FBQyxDQUFDLENBQUM7d0JBQ0gsaUJBQWlCO3dCQUNqQixVQUFVLENBQUMsWUFBWSxDQUFDLFFBQVEsQ0FBQyxDQUFDO3FCQUNuQztnQkFDSCxDQUFDLENBQUMsQ0FBQzthQUNKO1FBQ0gsQ0FBQyxDQUFDO1FBQ0YsT0FBTyxXQUFXLENBQUM7SUFDckIsQ0FBQztJQUNILHdCQUFDO0FBQUQsQ0FBQyxBQTFZRCxJQTBZQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgQ2hhbmdlU2V0LCBNb2RpZmljYXRpb24gfSBmcm9tICcuLi9jaGFuZ2VzZXQnO1xyXG5pbXBvcnQgeyBTY2hlbWEsIFNjaGVtYUVudGl0eSwgU2NoZW1hRW50aXR5RmllbGQsIFNjaGVtYUVudGl0eUZpZWxkJFR5cGUsIFNjaGVtYVR5cGUgfSBmcm9tICcuLi9zY2hlbWEvc2NoZW1hJztcclxuaW1wb3J0IHsgRW50aXR5IH0gZnJvbSAnLi9lbnRpdHknO1xyXG5pbXBvcnQgeyBFbnRpdHlMaXN0IH0gZnJvbSAnLi9lbnRpdHlfbGlzdCc7XHJcbmltcG9ydCB7IGVudGl0eVByb3RvdHlwZSB9IGZyb20gJy4vZW50aXR5X3Byb3RvdHlwZSc7XHJcbmltcG9ydCB7IE5HX0ZJRUxELCBOR19MSVNULCBOR19PQkpFQ1QgfSBmcm9tICcuL21ldGFkYXRhJztcclxuaW1wb3J0IHsgUEFSRU5UX0NMQVNTLCBQQVJFTlRfUEFUSCB9IGZyb20gJy4vdHlwZXMnO1xyXG5pbXBvcnQgeyBWYWxpZGF0b3IgfSBmcm9tICcuL3ZhbGlkYXRvcic7XHJcbmltcG9ydCB7IFZhbGlkYXRpb25VdGlscyB9IGZyb20gJy4vdmFsaWRhdG9yL3ZhbGlkYXRpb25fdXRpbHMnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBBYnN0cmFjdEVudGl0eVR5cGUge1xyXG4gIHR5cGVOYW1lOiBzdHJpbmc7XHJcbiAgdHlwZXM6IGFueTtcclxuICBfX3Byb3BfX21ldGFkYXRhX186IGFueTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOWunuS9k+exu+Wei+W3peWOglxyXG4gKiDnlKjmnaXmoLnmja7lrp7kvZNTY2hlbWHmj4/ov7Dkv6Hmga/liJvlu7rlrp7kvZPnsbvlnotcclxuICovXHJcbmV4cG9ydCBjbGFzcyBFbnRpdHlUeXBlRmFjdG9yeSB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkgeyB9XHJcbiAgLyoqXHJcbiAgICog55Sx5a6e5L2TU2NoZW1h57uT5p6E5Yib5bu65a6e5L2T57G75Z6LXHJcbiAgICogQHBhcmFtIHNjaGVtYSDlrp7kvZNTY2hlbWHnu5PmnoRcclxuICAgKiBAcmV0dXJucyDlrp7kvZPnsbvlnotcclxuICAgKi9cclxuICBwdWJsaWMgY3JlYXRlKHNjaGVtYTogU2NoZW1hKSB7XHJcbiAgICAvLyDmj5Dlj5ZTY2hlbWHlrprkuYnkuK3nmoTnrKzkuIDkuKrmmK/lrp7kvZPmj4/ov7BcclxuICAgIGNvbnN0IHNjaGVtYVR5cGUgPSBzY2hlbWEuZW50aXRpZXNbMF0udHlwZTtcclxuICAgIC8vIOWIm+W7uuWunuS9k+exu+Wei1xyXG4gICAgY29uc3QgZW50aXR5VHlwZSA9IHRoaXMuY3JlYXRlQ2xhc3Moc2NoZW1hVHlwZSk7XHJcbiAgICByZXR1cm4gZW50aXR5VHlwZTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog55Sx5a6e5L2TU2NoZW1h57G75Z6L5o+P6L+w5Yib5bu65a6e5L2T57G7XHJcbiAgICogQHBhcmFtIHNjaGVtYVR5cGUgU2NoZW1h5a6e5L2T57G75Z6L5o+P6L+wXHJcbiAgICogQHJldHVybnMg5a6e5L2T57G75Z6LXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBjcmVhdGVDbGFzcyhzY2hlbWFUeXBlOiBTY2hlbWFUeXBlKSB7XHJcbiAgICBjb25zdCBhdHRhY2hFbnRpdHlJbnN0YW5jZURhdGEgPSB0aGlzLmNyZWF0ZUVudGl0eUluc3RhbmNlRGF0YUluaXRpYWxpemVyKHNjaGVtYVR5cGUpO1xyXG4gICAgLy8g5Yib5bu65oyH5a6a5a6e5L2T57G75Z6L55qE5Yid5aeL5YyW5Ye95pWw77yM55So5p2l5Zyo5a6e5L2T57G75Z6L5p6E6YCg5Ye95pWw5Lit5Li65a6e5L2T5a6e5L6L6LWL5YC8XHJcbiAgICBjb25zdCBpbml0aWFsaXplID0gKGVudGl0eUluc3RhbmNlOiBhbnksIGVudGl0eURhdGE6IGFueSwgZW50aXR5VHlwZUNvbnN0cnVjdG9yOiBhbnkpID0+IHtcclxuICAgICAgZW50aXR5SW5zdGFuY2UuaXNJbml0aWFsaXppbmcgPSB0cnVlO1xyXG4gICAgICBhdHRhY2hFbnRpdHlJbnN0YW5jZURhdGEoZW50aXR5SW5zdGFuY2UsIGVudGl0eURhdGEsIGVudGl0eVR5cGVDb25zdHJ1Y3Rvcik7XHJcbiAgICAgIGVudGl0eUluc3RhbmNlLmlzSW5pdGlhbGl6aW5nID0gZmFsc2U7XHJcbiAgICB9O1xyXG4gICAgLy8g5aOw5piO5a6e5L2T57G75p6E6YCg5Ye95pWwXHJcbiAgICBjb25zdCBDb25jcmV0ZUVudGl0eSA9IGZ1bmN0aW9uIChkYXRhOiBhbnkpIHtcclxuICAgICAgLy8g5Yib5bu65a6e5L2T5Y+Y5pu06ZuGXHJcbiAgICAgIHRoaXMuY2hhbmdlU2V0ID0gbmV3IENoYW5nZVNldCgpO1xyXG4gICAgICAvLyDliJ3lp4vljJblrp7kvZPpqozor4HnirbmgIFcclxuICAgICAgdGhpcy5pc1ZhbGlkYXRpbmcgPSBmYWxzZTtcclxuICAgICAgLy8g5Yid5aeL5YyW5a6e5L2T6aqM6K+B5L+h5oGvXHJcbiAgICAgIHRoaXMudmFsaWRFcnJvcnMgPSB7fTtcclxuICAgICAgLy8g5Yid5aeL5YyW6aqM6K+B5ZmoXHJcbiAgICAgIHRoaXMudmFsaWRhdG9yID0gbmV3IFZhbGlkYXRvcigpO1xyXG4gICAgICAvLyDliJ3lp4vljJblrp7kvZPmlbDmja7lia/mnKxcclxuICAgICAgdGhpcy5pbm5lckRhdGEgPSBPYmplY3QuYXNzaWduKHt9LCBkYXRhKTtcclxuICAgICAgLy8g5Yid5aeL5YyW5a2Q5a6e5L2T5a+56LGh6ZuG5ZCIXHJcbiAgICAgIHRoaXMuaW5uZXJFbnRpdGllcyA9IHt9O1xyXG4gICAgICAvLyDliJ3lp4vljJblrp7kvZPlgLzlj5jljJbkuovku7ZcclxuICAgICAgdGhpcy52YWx1ZUNoYW5nZWQgPSBuZXcgU3ViamVjdDxNb2RpZmljYXRpb24+KCk7XHJcbiAgICAgIHRoaXMub25WYWx1ZUNoYW5nZWQgPSB0aGlzLnZhbHVlQ2hhbmdlZDtcclxuICAgICAgdGhpcy52YWxpZGF0ZUZyb21VdGlsU3luYyA9IGZ1bmN0aW9uIChwcm9wZXJ0eU5hbWUsIHZhbHVlLCBjYiwgY29udGV4dCkge1xyXG4gICAgICAgIHRoaXMudmFsaWRFcnJvcnMgPSB7fTtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy52YWxpZGF0b3IudmVyaWZ5KHRoaXMsIHByb3BlcnR5TmFtZSwgdmFsdWUsIG51bGwsIHVuZGVmaW5lZCwgY29udGV4dCAmJiBjb250ZXh0LmZyYW1lQ29udGV4dCB8fCBudWxsLCB0cnVlKTtcclxuICAgICAgICBpZiAocmVzdWx0ICYmICFyZXN1bHQuaXNWYWxpZCkge1xyXG4gICAgICAgICAgdGhpcy52YWxpZEVycm9ycyA9IFZhbGlkYXRpb25VdGlscy5jb252ZXJ0RXJyb3JzVG9Ob3JtYWxPYmplY3QocmVzdWx0LmVycm9ycywge30pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYihyZXN1bHQpO1xyXG4gICAgICB9O1xyXG4gICAgICAvLyDosIPnlKjliJ3lp4vljJbmlrnms5XvvIzliJ3lp4vljJblrp7kvZPmlbDmja5cclxuICAgICAgaW5pdGlhbGl6ZSh0aGlzLCBkYXRhLCBDb25jcmV0ZUVudGl0eSk7XHJcbiAgICAgIHRoaXMubG9hZCA9IChuZXdEYXRhOiBhbnkpID0+IHtcclxuICAgICAgICBhdHRhY2hFbnRpdHlJbnN0YW5jZURhdGEodGhpcywgbmV3RGF0YSwgQ29uY3JldGVFbnRpdHkpO1xyXG4gICAgICB9O1xyXG4gICAgfTtcclxuICAgIC8vIOWcqOWunuS9k+exu+aehOmAoOWHveaVsOS4reiusOW9leinhuWbvuexu+Wei+WQjeensFxyXG4gICAgQ29uY3JldGVFbnRpdHkudHlwZU5hbWUgPSBgJHtzY2hlbWFUeXBlLm5hbWV9RW50aXR5YDtcclxuICAgIC8vIOWcqOWunuS9k+exu+aehOmAoOWHveaVsOS4reiusOW9leWFtuS4i+ebtOaOpeW8leeUqOeahOWtkOexu+Wei1xyXG4gICAgQ29uY3JldGVFbnRpdHkudHlwZXMgPSB7fTtcclxuICAgIENvbmNyZXRlRW50aXR5Ll9fcHJvcF9fbWV0YWRhdGFfXyA9IHt9O1xyXG4gICAgLy8g5p6E6YCg5a6e5L2T57G755qE5Y6f5Z6L5a+56LGhXHJcbiAgICBjb25zdCBlbnRpdHlUeXBlUHJvdG90eXBlID0gT2JqZWN0LmFzc2lnbih7IHR5cGVOYW1lOiAnQ29uY3JldGVFbnRpdHlQcm90b3R5cGUnIH0sIGVudGl0eVByb3RvdHlwZSk7XHJcbiAgICAvLyDlkJHlrp7kvZPnsbvljp/lnovlr7nosaHkuK3lrprkuYnpooTliLblsZ7mgKdcclxuICAgIHRoaXMuZGVmaW5lUHJlc2V0UHJvcGVydHkoZW50aXR5VHlwZVByb3RvdHlwZSwgc2NoZW1hVHlwZSk7XHJcbiAgICAvLyDlkJHlrp7kvZPnsbvljp/lnovlr7nosaHkuK3lrprkuYnlrZfmrrXlsZ7mgKdnZXQvc2V05pa55rOVXHJcbiAgICB0aGlzLmRlZmluZUZpZWxkc1RvUHJvdG90eXBlKGVudGl0eVR5cGVQcm90b3R5cGUsIHNjaGVtYVR5cGUuZmllbGRzLCBzY2hlbWFUeXBlLnByaW1hcnksIENvbmNyZXRlRW50aXR5KTtcclxuICAgIC8vIOWQkeWunuS9k+exu+WOn+Wei+WvueixoeS4reWumuS5ieiuv+mXruWtkOWunuS9k+eahGdldC9zZXTmlrnms5VcclxuICAgIHRoaXMuZGVmaW5lRW50aXRpZXNUb1Byb3RvdHlwZShlbnRpdHlUeXBlUHJvdG90eXBlLCBzY2hlbWFUeXBlLmVudGl0aWVzLCBDb25jcmV0ZUVudGl0eSk7XHJcbiAgICAvLyDlsIblrp7kvZPnsbvnmoTljp/lnovlr7nosaHmjIflkJHmlrDmnoTpgKDnmoTljp/lnovlr7nosaHjgIJcclxuICAgIENvbmNyZXRlRW50aXR5LnByb3RvdHlwZSA9IGVudGl0eVR5cGVQcm90b3R5cGU7XHJcblxyXG4gICAgcmV0dXJuIENvbmNyZXRlRW50aXR5O1xyXG4gIH1cclxuICAvKipcclxuICAgKiDlkJHlrp7kvZPnsbvljp/lnovlr7nosaHkuK3lrprkuYnpooTliLblsZ7mgKdcclxuICAgKiBAcGFyYW0gcHJvdG90eXBlT2JqZWN0IOWunuS9k+exu+WOn+Wei+WvueixoVxyXG4gICAqIEBwYXJhbSBzY2hlbWFUeXBlIFNjaGVtYeexu+Wei+aPj+i/sFxyXG4gICAqL1xyXG4gIHByaXZhdGUgZGVmaW5lUHJlc2V0UHJvcGVydHkocHJvdG90eXBlT2JqZWN0OiBhbnksIHNjaGVtYVR5cGU6IFNjaGVtYVR5cGUpIHtcclxuICAgIC8qKlxyXG4gICAgICog5a6e5L2T5pWw5o2uXHJcbiAgICAgKi9cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwcm90b3R5cGVPYmplY3QsICdkYXRhJywge1xyXG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5pbm5lckRhdGE7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiDlrp7kvZPpqozor4Hkv6Hmga9cclxuICAgICAqL1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHByb3RvdHlwZU9iamVjdCwgJ2Vycm9ycycsIHtcclxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudmFsaWRFcnJvcnM7XHJcbiAgICAgIH0sXHJcbiAgICAgIHNldDogZnVuY3Rpb24gKGVycm9yczogYW55KSB7XHJcbiAgICAgICAgdGhpcy52YWxpZEVycm9ycyA9IGVycm9ycztcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIOWunuS9k+WPmOabtOmbhlxyXG4gICAgICovXHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocHJvdG90eXBlT2JqZWN0LCAnY2hhbmdlcycsIHtcclxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hhbmdlU2V0LmNoYW5nZXM7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiDlrp7kvZPkuLvplK5cclxuICAgICAqL1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHByb3RvdHlwZU9iamVjdCwgJ3ByaW1hcnlQcm9wZXJ0eScsIHtcclxuICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOiBvbmx5LWFycm93LWZ1bmN0aW9uc1xyXG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyByZXR1cm4gc2NoZW1hVHlwZS5wcmltYXJ5O1xyXG4gICAgICAgIHJldHVybiBwcm90b3R5cGVPYmplY3QuaW5uZXJQcmltYXJ5UHJvcGVydHkgfHwgeyBkYXRhRmllbGQ6IHNjaGVtYVR5cGUucHJpbWFyeSB9O1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICog5a6e5L2T5Li76ZSuXHJcbiAgICAgKi9cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwcm90b3R5cGVPYmplY3QsICdwcmltYXJ5S2V5Jywge1xyXG4gICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6IG9ubHktYXJyb3ctZnVuY3Rpb25zXHJcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBzY2hlbWFUeXBlLnByaW1hcnkgfHwgJyc7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiDlrp7kvZPkuLvplK7nmoTlgLxcclxuICAgICAqL1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHByb3RvdHlwZU9iamVjdCwgJ3ByaW1hcnlWYWx1ZScsIHtcclxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMucHJpbWFyeUtleSkge1xyXG4gICAgICAgICAgLy8gcmV0dXJuIHRoaXNbdGhpcy5wcmltYXJ5UHJvcGVydHkucHJvcGVydHldLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgICBjb25zdCBwcmltYXJ5VmFsdWUgPSB0aGlzW3RoaXMucHJpbWFyeUtleV07XHJcbiAgICAgICAgICByZXR1cm4gcHJpbWFyeVZhbHVlID8gcHJpbWFyeVZhbHVlIDogJyc7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDlkJHlrp7kvZPnsbvlrprkuYnlrZfmrrXlsZ7mgKdcclxuICAgKiBAcGFyYW0gcHJvdG90eXBlT2JqZWN0IOWunuS9k+exu+WOn+Wei+WvueixoVxyXG4gICAqIEBwYXJhbSBmaWVsZHMg5a2X5q615o+P6L+w6ZuG5ZCIXHJcbiAgICogQHBhcmFtIHBhcmVudEVudGl0eVR5cGUg54i257G75Z6LXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBkZWZpbmVGaWVsZHNUb1Byb3RvdHlwZShcclxuICAgIHByb3RvdHlwZU9iamVjdDogYW55LFxyXG4gICAgZmllbGRzOiBTY2hlbWFFbnRpdHlGaWVsZFtdLFxyXG4gICAgcHJpbWFyeTogc3RyaW5nLFxyXG4gICAgcGFyZW50RW50aXR5VHlwZTogQWJzdHJhY3RFbnRpdHlUeXBlXHJcbiAgKTogdm9pZCB7XHJcbiAgICBpZiAoZmllbGRzICYmIGZpZWxkcy5sZW5ndGgpIHtcclxuICAgICAgLy8g6YGN5Y6GU2NoZW1h5Lit5o+P6L+w55qE5a2X5q6177yM5Zyo5a6e5L2T5Y6f5Z6L5a+56LGh5LiK5a6a5LmJ5a2X5q616K6/6Zeu5Ye95pWwXHJcbiAgICAgIGZpZWxkcy5mb3JFYWNoKHNjaGVtYUVudGl0eUZpZWxkID0+IHtcclxuICAgICAgICBzd2l0Y2ggKHNjaGVtYUVudGl0eUZpZWxkLiR0eXBlKSB7XHJcbiAgICAgICAgICAvLyDlrprkuYnnroDljZXnsbvlnovlrZfmrrVcclxuICAgICAgICAgIGNhc2UgU2NoZW1hRW50aXR5RmllbGQkVHlwZS5TaW1wbGVGaWVsZDpcclxuICAgICAgICAgICAgdGhpcy5kZWZpbmVTaW1wbGVGaWVsZFRvUHJvdG90eXBlKHByb3RvdHlwZU9iamVjdCwgc2NoZW1hRW50aXR5RmllbGQsIHByaW1hcnksIHBhcmVudEVudGl0eVR5cGUpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIC8vIOWumuS5ieWkjeadguexu+Wei+Wtl+autVxyXG4gICAgICAgICAgY2FzZSBTY2hlbWFFbnRpdHlGaWVsZCRUeXBlLkNvbXBsZXhGaWVsZDpcclxuICAgICAgICAgICAgdGhpcy5kZWZpbmVDb21wbGV4RmllbGRUb1Byb3RvdHlwZShwcm90b3R5cGVPYmplY3QsIHNjaGVtYUVudGl0eUZpZWxkLCBwYXJlbnRFbnRpdHlUeXBlKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICog5ZCR5a6e5L2T57G75a6a5LmJ566A5Y2V57G75Z6L5a2X5q61XHJcbiAgICogQHBhcmFtIHByb3RvdHlwZU9iamVjdCDlrp7kvZPnsbvljp/lnovlr7nosaFcclxuICAgKiBAcGFyYW0gc2NoZW1hRmllbGQg5a2X5q615o+P6L+wXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBkZWZpbmVTaW1wbGVGaWVsZFRvUHJvdG90eXBlKFxyXG4gICAgcHJvdG90eXBlT2JqZWN0OiBhbnksXHJcbiAgICBzY2hlbWFGaWVsZDogU2NoZW1hRW50aXR5RmllbGQsXHJcbiAgICBwcmltYXJ5OiBzdHJpbmcsXHJcbiAgICBwYXJlbnRFbnRpdHlUeXBlOiBBYnN0cmFjdEVudGl0eVR5cGVcclxuICApIHtcclxuICAgIGNvbnN0IHByb3BlcnR5TmFtZSA9IHNjaGVtYUZpZWxkLmxhYmVsO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHByb3RvdHlwZU9iamVjdCwgcHJvcGVydHlOYW1lLCB7XHJcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldEZpZWxkVmFsdWUoc2NoZW1hRmllbGQpO1xyXG4gICAgICB9LFxyXG4gICAgICBzZXQ6IGZ1bmN0aW9uIChuZXdQcm9wVmFsdWUpIHtcclxuICAgICAgICAvLyDlgLznm7jlkIzml7bkuI3op6blj5Hlj5jmm7TjgIJcclxuICAgICAgICBjb25zdCBvbGRQcm9wVmFsdWUgPSB0aGlzLmdldEZpZWxkVmFsdWUoc2NoZW1hRmllbGQpO1xyXG4gICAgICAgIGlmICh0aGlzLmlzRmllbGRWYWx1ZUNoYW5nZWQoc2NoZW1hRmllbGQsIG5ld1Byb3BWYWx1ZSwgb2xkUHJvcFZhbHVlKSA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZXRGaWVsZFZhbHVlKHNjaGVtYUZpZWxkLCBuZXdQcm9wVmFsdWUpO1xyXG4gICAgICAgIHRoaXMuZW1pdEZpZWxkVmFsdWVDaGFuZ2Uoc2NoZW1hRmllbGQsIG5ld1Byb3BWYWx1ZSwgb2xkUHJvcFZhbHVlKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBjb25zdCBmaWVsZE1ldGFkYXRhID0ge1xyXG4gICAgICAvKiog5a2X5q615ZCN56ewICovXHJcbiAgICAgIGRhdGFGaWVsZDogc2NoZW1hRmllbGQubGFiZWwsXHJcbiAgICAgIC8qKiDljp/lp4vlrZfmrrXlkI3np7AgKi9cclxuICAgICAgb3JpZ2luYWxEYXRhRmllbGQ6IHNjaGVtYUZpZWxkLmNvZGUsXHJcbiAgICAgIC8qKiDljp/lp4vlrZfmrrXnsbvlnosgKi9cclxuICAgICAgb3JpZ2luYWxEYXRhRmllbGRUeXBlOiBzY2hlbWFGaWVsZC50eXBlLm5hbWUsXHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiDljp/lp4vlrZfmrrVcclxuICAgICAgICogQGRlc2NyaXB0aW9uIOWvueW6lOWIsHNjaGVtZeeahHBhdGjlsZ7mgKdcclxuICAgICAgICovXHJcbiAgICAgIHBhdGg6IHNjaGVtYUZpZWxkLnBhdGgsXHJcbiAgICAgIHByaW1hcnk6IHNjaGVtYUZpZWxkLmxhYmVsID09PSBwcmltYXJ5LFxyXG4gICAgICBuZ01ldGFkYXRhTmFtZTogTkdfRklFTERcclxuICAgIH07XHJcbiAgICBpZiAoZmllbGRNZXRhZGF0YS5wcmltYXJ5KSB7XHJcbiAgICAgIHByb3RvdHlwZU9iamVjdC5pbm5lclByaW1hcnlQcm9wZXJ0eSA9IGZpZWxkTWV0YWRhdGE7XHJcbiAgICB9XHJcbiAgICBpZiAoIXBhcmVudEVudGl0eVR5cGUuX19wcm9wX19tZXRhZGF0YV9fW3Byb3BlcnR5TmFtZV0pIHtcclxuICAgICAgcGFyZW50RW50aXR5VHlwZS5fX3Byb3BfX21ldGFkYXRhX19bcHJvcGVydHlOYW1lXSA9IFtdO1xyXG4gICAgfVxyXG4gICAgcGFyZW50RW50aXR5VHlwZS5fX3Byb3BfX21ldGFkYXRhX19bcHJvcGVydHlOYW1lXS5wdXNoKGZpZWxkTWV0YWRhdGEpO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDlkJHlrp7kvZPnsbvlrprkuYnlpI3mnYLnsbvlnovlrZfmrrVcclxuICAgKiBAcGFyYW0gcHJvdG90eXBlT2JqZWN0IOWunuS9k+exu+WOn+Wei+WvueixoVxyXG4gICAqIEBwYXJhbSBzY2hlbWFGaWVsZCDlrZfmrrXmj4/ov7BcclxuICAgKiBAcGFyYW0gcGFyZW50RW50aXR5VHlwZSDniLbnsbvlnotcclxuICAgKi9cclxuICBwcml2YXRlIGRlZmluZUNvbXBsZXhGaWVsZFRvUHJvdG90eXBlKHByb3RvdHlwZU9iamVjdDogYW55LCBzY2hlbWFGaWVsZDogU2NoZW1hRW50aXR5RmllbGQsIHBhcmVudEVudGl0eVR5cGU6IEFic3RyYWN0RW50aXR5VHlwZSkge1xyXG4gICAgY29uc3QgY29tcGxleEZpZWxkVHlwZSA9IHRoaXMuY3JlYXRlQ2xhc3Moc2NoZW1hRmllbGQudHlwZSk7XHJcbiAgICBwYXJlbnRFbnRpdHlUeXBlLnR5cGVzW3NjaGVtYUZpZWxkLnR5cGUubmFtZV0gPSBjb21wbGV4RmllbGRUeXBlO1xyXG4gICAgY29uc3QgcHJvcGVydHlOYW1lID0gc2NoZW1hRmllbGQubGFiZWw7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocHJvdG90eXBlT2JqZWN0LCBwcm9wZXJ0eU5hbWUsIHtcclxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29uc3QgZmllbGRWYWx1ZSA9IHRoaXMuZ2V0Q29tcGxleEZpZWxkVmFsdWUoc2NoZW1hRmllbGQpO1xyXG4gICAgICAgIHJldHVybiBmaWVsZFZhbHVlO1xyXG4gICAgICB9LFxyXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZTogYW55KSB7XHJcbiAgICAgICAgdGhpcy5zZXRDb21wbGV4RmllbGRWYWx1ZShzY2hlbWFGaWVsZCwgY29tcGxleEZpZWxkVHlwZSwgdmFsdWUpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIGNvbnN0IGZpZWxkTWV0YWRhdGEgPSB7XHJcbiAgICAgIC8qKiDmmKDlsITlrZfmrrUgKi9cclxuICAgICAgZGF0YUZpZWxkOiBzY2hlbWFGaWVsZC5sYWJlbCxcclxuICAgICAgLyoqIOWOn+Wni+Wtl+auteWQjeensCAqL1xyXG4gICAgICBvcmlnaW5hbERhdGFGaWVsZDogc2NoZW1hRmllbGQuY29kZSxcclxuICAgICAgLyoqIOW8leeUqOWunuS9k+exu+WeiyAqL1xyXG4gICAgICB0eXBlOiBjb21wbGV4RmllbGRUeXBlLFxyXG4gICAgICAvKipcclxuICAgICAgICog5Y6f5aeL5a2X5q61XHJcbiAgICAgICAqIEBkZXNjcmlwdGlvbiDlr7nlupTliLBzY2hlbWXnmoRwYXRo5bGe5oCnXHJcbiAgICAgICAqL1xyXG4gICAgICBwYXRoOiBzY2hlbWFGaWVsZC5wYXRoLFxyXG4gICAgICBuZ01ldGFkYXRhTmFtZTogTkdfT0JKRUNUXHJcbiAgICB9O1xyXG4gICAgaWYgKCFwYXJlbnRFbnRpdHlUeXBlLl9fcHJvcF9fbWV0YWRhdGFfX1twcm9wZXJ0eU5hbWVdKSB7XHJcbiAgICAgIHBhcmVudEVudGl0eVR5cGUuX19wcm9wX19tZXRhZGF0YV9fW3Byb3BlcnR5TmFtZV0gPSBbXTtcclxuICAgIH1cclxuICAgIHBhcmVudEVudGl0eVR5cGUuX19wcm9wX19tZXRhZGF0YV9fW3Byb3BlcnR5TmFtZV0ucHVzaChmaWVsZE1ldGFkYXRhKTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog5ZCR5a6e5L2T57G75a6a5LmJ5a2Q5a6e5L2TXHJcbiAgICogQHBhcmFtIHByb3RvdHlwZU9iamVjdCDlrp7kvZPnsbvljp/lnovlr7nosaFcclxuICAgKiBAcGFyYW0gZW50aXRpZXMg5a6e5L2T5o+P6L+w6ZuG5ZCIXHJcbiAgICogQHBhcmFtIHBhcmVudEVudGl0eVR5cGUg54i257G75Z6LXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBkZWZpbmVFbnRpdGllc1RvUHJvdG90eXBlKHByb3RvdHlwZU9iamVjdDogYW55LCBlbnRpdGllczogU2NoZW1hRW50aXR5W10sIHBhcmVudEVudGl0eVR5cGU6IEFic3RyYWN0RW50aXR5VHlwZSkge1xyXG4gICAgaWYgKGVudGl0aWVzICYmIGVudGl0aWVzLmxlbmd0aCkge1xyXG4gICAgICAvLyDpgY3ljoZTY2hlbWHkuK3mj4/ov7DnmoTlrZDlrp7kvZPvvIzlnKjlrp7kvZPlr7nosaHkuIrlrprkuYnlrZDlrp7kvZPliJfooahcclxuICAgICAgZW50aXRpZXMuZm9yRWFjaChzY2hlbWFFbnRpdHkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNvbXBsZXhGaWVsZFR5cGUgPSB0aGlzLmNyZWF0ZUNsYXNzKHNjaGVtYUVudGl0eS50eXBlKTtcclxuICAgICAgICBwYXJlbnRFbnRpdHlUeXBlLnR5cGVzW3NjaGVtYUVudGl0eS50eXBlLm5hbWVdID0gY29tcGxleEZpZWxkVHlwZTtcclxuICAgICAgICAvLyDmj5Dlj5blrZDlrp7kvZPlnKjlrp7kvZPlr7nosaHkuIrnmoTlsZ7mgKflkI1cclxuICAgICAgICBjb25zdCBwcm9wZXJ0eU5hbWUgPSBzY2hlbWFFbnRpdHkubGFiZWw7XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHByb3RvdHlwZU9iamVjdCwgcHJvcGVydHlOYW1lLCB7XHJcbiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc3QgZmllbGRWYWx1ZSA9IHRoaXMuZ2V0RW50aXRpZXMoc2NoZW1hRW50aXR5KTtcclxuICAgICAgICAgICAgcmV0dXJuIGZpZWxkVmFsdWU7XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWU6IGFueSkge1xyXG4gICAgICAgICAgICB0aGlzLnNldEVudGl0aWVzKHNjaGVtYUVudGl0eSwgdmFsdWUpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbnN0IGVudGl0TWV0YWRhdGEgPSB7XHJcbiAgICAgICAgICAvKiog5a2X5q615ZCN56ewICovXHJcbiAgICAgICAgICBkYXRhRmllbGQ6IHNjaGVtYUVudGl0eS5sYWJlbCxcclxuICAgICAgICAgIC8qKiDljp/lp4vlrZfmrrXlkI3np7AgKi9cclxuICAgICAgICAgIG9yaWdpbmFsRGF0YUZpZWxkOiAnJyxcclxuICAgICAgICAgIC8qKiDlrp7kvZPnsbvlnosgKi9cclxuICAgICAgICAgIHR5cGU6IGNvbXBsZXhGaWVsZFR5cGUsXHJcbiAgICAgICAgICBuZ01ldGFkYXRhTmFtZTogTkdfTElTVFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKCFwYXJlbnRFbnRpdHlUeXBlLl9fcHJvcF9fbWV0YWRhdGFfX1twcm9wZXJ0eU5hbWVdKSB7XHJcbiAgICAgICAgICBwYXJlbnRFbnRpdHlUeXBlLl9fcHJvcF9fbWV0YWRhdGFfX1twcm9wZXJ0eU5hbWVdID0gW107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHBhcmVudEVudGl0eVR5cGUuX19wcm9wX19tZXRhZGF0YV9fW3Byb3BlcnR5TmFtZV0ucHVzaChlbnRpdE1ldGFkYXRhKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIOWIm+W7uuWIneWni+WMluWunuS9k+WvueixoeaWueazlVxyXG4gICAqIEBwYXJhbSBzY2hlbWFUeXBlIOWunuS9k+exu+Wei+aPj+i/sFxyXG4gICAqIEByZXR1cm5zIOWIneWni+WMluWunuS9k+WvueixoeaWueazlVxyXG4gICAqL1xyXG4gIHByaXZhdGUgY3JlYXRlRW50aXR5SW5zdGFuY2VEYXRhSW5pdGlhbGl6ZXIoc2NoZW1hVHlwZTogU2NoZW1hVHlwZSkge1xyXG4gICAgLyoqXHJcbiAgICAgKiDlrp7kvZPliJ3lp4vljJblh73mlbDvvIznlKjmnaXliJ3lp4vljJblrp7kvZPnmoTlpI3mnYLnsbvlnovmlbDmja7lkozlrZDlrp7kvZPmlbDmja5cclxuICAgICAqIEBwYXJhbSBlbnRpdHlJbnN0YW5jZSDlrp7kvZPnsbvlnovlrp7kvotcclxuICAgICAqIEBwYXJhbSBkYXRhIOWunuS9k+WOn+Wni+aVsOaNrlxyXG4gICAgICogQHBhcmFtIGVudGl0eVR5cGVDb25zdHJ1Y3RvciDlrp7kvZPnsbvlnovmnoTpgKDlh73mlbBcclxuICAgICAqL1xyXG4gICAgY29uc3QgaW5pdGlhbGl6ZXIgPSAoZW50aXR5SW5zdGFuY2U6IGFueSwgZW50aXR5RGF0YTogYW55LCBlbnRpdHlUeXBlQ29uc3RydWN0b3I6IGFueSkgPT4ge1xyXG4gICAgICAvLyDliJ3lp4vljJblpI3mnYLnsbvlnovlrZfmrrVcclxuICAgICAgc2NoZW1hVHlwZS5maWVsZHNcclxuICAgICAgICAvLyDov4fmu6TlpI3mnYLnsbvlnovlrZfmrrVcclxuICAgICAgICAuZmlsdGVyKGZpZWxkID0+IGZpZWxkLiR0eXBlID09PSBTY2hlbWFFbnRpdHlGaWVsZCRUeXBlLkNvbXBsZXhGaWVsZClcclxuICAgICAgICAvLyDpgY3ljoblpI3mnYLnsbvlnovlrZfmrrXliJvlu7rlr7nlupTlrp7kvZPnsbvlnovmlbDmja5cclxuICAgICAgICAuZm9yRWFjaChmaWVsZCA9PiB7XHJcbiAgICAgICAgICAvLyDmj5Dlj5blrZfmrrXlkI1cclxuICAgICAgICAgIGNvbnN0IGZpZWxkTmFtZSA9IGZpZWxkLmxhYmVsO1xyXG4gICAgICAgICAgLy8g5o+Q5Y+W5a6e5L2T57G75Z6L5LiL55qE5omA5pyJ5a2Q5a6e5L2T57G75Z6LXHJcbiAgICAgICAgICBjb25zdCBpbmNsdWRlZEVudGl0eVR5cGVzID0gZW50aXR5VHlwZUNvbnN0cnVjdG9yLnR5cGVzO1xyXG4gICAgICAgICAgLy8g6I635Y+W5aSN5p2C57G75Z6L5a2X5q615a+55bqU55qE5a6e5L2T57G75Z6LXHJcbiAgICAgICAgICBjb25zdCBDb21wbGV4RmllbGQgPSBpbmNsdWRlZEVudGl0eVR5cGVzW2ZpZWxkLnR5cGUubmFtZV07XHJcbiAgICAgICAgICAvLyDmj5Dlj5blpI3mnYLnsbvlnovlrZfmrrXljp/lp4vmlbDmja5cclxuICAgICAgICAgIGNvbnN0IGZpZWxkRGF0YSA9IGVudGl0eURhdGEgPyBlbnRpdHlEYXRhW2ZpZWxkTmFtZV0gOiBudWxsO1xyXG4gICAgICAgICAgLy8g5Yib5bu65aSN5p2C57G75Z6L5a2X5q615a+56LGh6Lev5b6EXHJcbiAgICAgICAgICBjb25zdCBwYXRoID0gZW50aXR5SW5zdGFuY2UuY3JlYXRlUGF0aChmaWVsZE5hbWUpO1xyXG4gICAgICAgICAgbGV0IGNvbXBsZXhGaWVsZFZhbHVlID0gZW50aXR5SW5zdGFuY2VbZmllbGROYW1lXTtcclxuICAgICAgICAgIGlmIChjb21wbGV4RmllbGRWYWx1ZSBpbnN0YW5jZW9mIENvbXBsZXhGaWVsZCkge1xyXG4gICAgICAgICAgICBjb21wbGV4RmllbGRWYWx1ZS5sb2FkKGZpZWxkRGF0YSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyDliJvlu7rlpI3mnYLnsbvlnovlrZfmrrXlrp7kvZPlrp7kvotcclxuICAgICAgICAgICAgY29tcGxleEZpZWxkVmFsdWUgPSBuZXcgQ29tcGxleEZpZWxkKGZpZWxkRGF0YSk7XHJcbiAgICAgICAgICAgIGNvbXBsZXhGaWVsZFZhbHVlLmNvbnN0cnVjdG9yID0gQ29tcGxleEZpZWxkO1xyXG4gICAgICAgICAgICBjb21wbGV4RmllbGRWYWx1ZVtQQVJFTlRfQ0xBU1NdID0gZW50aXR5VHlwZUNvbnN0cnVjdG9yO1xyXG4gICAgICAgICAgICBjb21wbGV4RmllbGRWYWx1ZVtQQVJFTlRfUEFUSF0gPSBwYXRoO1xyXG4gICAgICAgICAgICBjb21wbGV4RmllbGRWYWx1ZS5vblZhbHVlQ2hhbmdlZC5zdWJzY3JpYmUoY2hhbmdlcyA9PiB7XHJcbiAgICAgICAgICAgICAgaWYgKGNoYW5nZXMpIHtcclxuICAgICAgICAgICAgICAgIGNoYW5nZXMucGF0aCA9IChlbnRpdHlJbnN0YW5jZVtQQVJFTlRfUEFUSF0gfHwgW10pLmNvbmNhdChjaGFuZ2VzLnBhdGgpO1xyXG4gICAgICAgICAgICAgICAgZW50aXR5SW5zdGFuY2Uuc2V0Q2hhbmdlcyhjaGFuZ2VzKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBlbnRpdHlJbnN0YW5jZVtmaWVsZE5hbWVdID0gY29tcGxleEZpZWxkVmFsdWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIC8vIOWIneWni+WMluWtkOWunuS9k1xyXG4gICAgICBpZiAoc2NoZW1hVHlwZS5lbnRpdGllcykge1xyXG4gICAgICAgIC8vIOmBjeWOhuWtkOWunuS9k+WIm+W7uuWvueW6lOWunuS9k+exu+Wei+eahOaVsOaNrlxyXG4gICAgICAgIHNjaGVtYVR5cGUuZW50aXRpZXMuZm9yRWFjaChzY2hlbWFFbnRpdHkgPT4ge1xyXG4gICAgICAgICAgLy8g5o+Q5Y+W5a2Q5a6e5L2T5ZCNXHJcbiAgICAgICAgICBjb25zdCBzdWJFbnRpdHlOYW1lID0gc2NoZW1hRW50aXR5LmxhYmVsO1xyXG4gICAgICAgICAgLy8g5o+Q5Y+W5a6e5L2T57G75Z6L5LiL55qE5omA5pyJ5a2Q5a6e5L2T57G75Z6LXHJcbiAgICAgICAgICBjb25zdCBpbmNsdWRlZEVudGl0eVR5cGVzID0gZW50aXR5VHlwZUNvbnN0cnVjdG9yLnR5cGVzO1xyXG4gICAgICAgICAgLy8g5Yib5bu65a2Q5a6e5L2T5a+56LGh6Lev5b6EXHJcbiAgICAgICAgICBjb25zdCBwYXRoID0gZW50aXR5SW5zdGFuY2UuY3JlYXRlUGF0aChzdWJFbnRpdHlOYW1lKTtcclxuICAgICAgICAgIC8vIOWIm+W7uuWtkOWunuS9k+WvueixoembhuWQiFxyXG4gICAgICAgICAgbGV0IGVudGl0eUxpc3QgPSBlbnRpdHlJbnN0YW5jZVtzdWJFbnRpdHlOYW1lXTtcclxuICAgICAgICAgIGlmICghKGVudGl0eUxpc3QgaW5zdGFuY2VvZiBFbnRpdHlMaXN0KSkge1xyXG4gICAgICAgICAgICBlbnRpdHlMaXN0ID0gbmV3IEVudGl0eUxpc3Q8RW50aXR5PigpO1xyXG4gICAgICAgICAgICAvLyDlkJHlrZDlrp7kvZPliJfooajms6jlhozlrZDlrp7kvZPlj5jljJbkuovku7ZcclxuICAgICAgICAgICAgZW50aXR5TGlzdC5vbkxpc3RDaGFuZ2VkLnN1YnNjcmliZSh2YWx1ZSA9PiB7XHJcbiAgICAgICAgICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZW50aXR5TGlzdFtQQVJFTlRfUEFUSF1bMF0gIT09IHZhbHVlLnBhdGhbMF0pIHtcclxuICAgICAgICAgICAgICAgICAgdmFsdWUucGF0aCA9IGVudGl0eUxpc3RbUEFSRU5UX1BBVEhdLmNvbmNhdCh2YWx1ZS5wYXRoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVudGl0eUluc3RhbmNlLnNldENoYW5nZXModmFsdWUpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vIOWQkeWunuS9k+exu+Wei+WunuS+i+S4iuebtOaOpeWtmOWCqOWtkOWunuS9k+WvueixoeWIl+ihqFxyXG4gICAgICAgICAgICBlbnRpdHlJbnN0YW5jZVtzdWJFbnRpdHlOYW1lXSA9IGVudGl0eUxpc3Q7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbnRpdHlMaXN0W1BBUkVOVF9DTEFTU10gPSBlbnRpdHlUeXBlQ29uc3RydWN0b3I7XHJcbiAgICAgICAgICBlbnRpdHlMaXN0W1BBUkVOVF9QQVRIXSA9IHBhdGg7XHJcbiAgICAgICAgICAvLyDmj5Dlj5blrZDlrp7kvZPnsbvlnovlkI3np7BcclxuICAgICAgICAgIGNvbnN0IHNjaGVtYUVudGl0eVR5cGVOYW1lID0gc2NoZW1hRW50aXR5LnR5cGUubmFtZTtcclxuICAgICAgICAgIC8vIOiOt+WPluWtkOWunuS9k+exu+Wei1xyXG4gICAgICAgICAgY29uc3QgQ29uY3JldGVFbnRpdHkgPSBpbmNsdWRlZEVudGl0eVR5cGVzW3NjaGVtYUVudGl0eVR5cGVOYW1lXTtcclxuICAgICAgICAgIGNvbnN0IG9yaWdpbmFsRW50aXR5RGF0YUFycmF5ID0gZW50aXR5RGF0YSA/IGVudGl0eURhdGFbc3ViRW50aXR5TmFtZV0gOiBudWxsO1xyXG4gICAgICAgICAgLy8g5p6E6YCg5a2Q5a6e5L2T6ZuG5ZCIXHJcbiAgICAgICAgICBpZiAob3JpZ2luYWxFbnRpdHlEYXRhQXJyYXkpIHtcclxuICAgICAgICAgICAgLy8g6YGN5Y6G5a2Q5a6e5L2T5Y6f5aeL5pWw5o2u77yM5p6E6YCg5a6e5L2T5a+56LGh6ZuG5ZCIXHJcbiAgICAgICAgICAgIGNvbnN0IGVudGl0aWVzID0gb3JpZ2luYWxFbnRpdHlEYXRhQXJyYXkubWFwKChvcmlnaW5hbEVudGl0eURhdGE6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgIGNvbnN0IGNvbmNyZXRlRW50aXR5SW5zdGFuY2UgPSBuZXcgQ29uY3JldGVFbnRpdHkob3JpZ2luYWxFbnRpdHlEYXRhKTtcclxuICAgICAgICAgICAgICBjb25jcmV0ZUVudGl0eUluc3RhbmNlLmNvbnN0cnVjdG9yID0gQ29uY3JldGVFbnRpdHk7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGNvbmNyZXRlRW50aXR5SW5zdGFuY2U7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvLyDlkJHlrZDlrp7kvZPliJfooajkuK3mt7vliqDlrZDlrp7kvZPlr7nosaFcclxuICAgICAgICAgICAgZW50aXR5TGlzdC5sb2FkRW50aXRpZXMoZW50aXRpZXMpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGluaXRpYWxpemVyO1xyXG4gIH1cclxufVxyXG4iXX0=