/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, ElementRef, TemplateRef, ContentChild, Output, EventEmitter, Input, Renderer2, ViewChild, HostBinding, ChangeDetectorRef } from '@angular/core';
import { ListViewHeaderTemplateDirective, ListViewTemplateDirective, ListViewFooterTemplateDirective, ListViewEmptyTemplateDirective, } from './template.directive';
import { PaginationControlsComponent } from '@farris/ui-pagination';
var ListViewComponent = /** @class */ (function () {
    function ListViewComponent(el, renderer, cdr) {
        this.el = el;
        this.renderer = renderer;
        this.cdr = cdr;
        // @Input() height:number;
        /**
         * 列表数据
         */
        this.data = [];
        /**
         * 数据为空是否展示默认
         */
        this.showEmpty = true;
        /**
         * 是否自定义空数据模板
         */
        this.emptyTemplate = false;
        /**
         * 是否支持多选 默认为false
         */
        this.multipleSelect = false;
        /**
         * 是否支持分页 默认false
         */
        this.supportPaging = false;
        // 默认分页
        this.pagerOnServer = true;
        this.pageSize = 10;
        this.pageIndex = 1;
        /**
         * 启用跨页多选
         */
        this.enableMorePageSelect = false;
        this.showSelectedList = false;
        this.selectedItemFormat = null;
        // 是否平铺
        this.fill = false;
        // 是否横向排列
        this.cardLayout = false;
        /**
         * 勾选值
         */
        this.checkValues = [];
        this.checkValuesChange = new EventEmitter();
        this.checkItems = [];
        this.checkItemsChange = new EventEmitter();
        // @Input() borderBottom:boolean = true;
        this._pageList = [10, 20, 30, 50];
        this.total = 0;
        /**
         * 作为唯一标识的数据key值 如果没传 唯一标识为index值
         */
        this.listidName = 'id';
        /**
         * 点击某一行后
         */
        this.listClick = new EventEmitter();
        /**
         * 多选框 选中状态变化
         */
        this.checkChange = new EventEmitter();
        // 分页事件
        this.pageChanged = new EventEmitter();
        this.pageSizeChanged = new EventEmitter();
        /**
         * 当前展示列表数据
         */
        this.currentData = [];
        /**
         * 选中的列表数组
         */
        this.selectDataList = [];
        /**
         * 跨页多选记录
         */
        this.selectDataListWithOtherPager = [];
        this.maxSize = 7;
        this.directionLinks = true;
        this.autoHide = false;
        this.responsive = true;
        this.paginationOptions = {
            id: 'Farris-listView-Pagination',
            itemsPerPage: this.pageSize,
            currentPage: this.pageIndex,
            pageList: this.pageList,
            totalItems: this.total
        };
        this.labels = {
            previousLabel: ' ',
            nextLabel: ' ',
            screenReaderPaginationLabel: 'Pagination',
            screenReaderPageLabel: 'page',
            screenReaderCurrentLabel: "You're on page"
        };
        this.mouseInSelectedList = false;
        this.openSelectedList = false;
        this.differenceBy = (/**
         * @param {?} a
         * @param {?} b
         * @param {?} fn
         * @return {?}
         */
        function (a, b, fn) {
            /** @type {?} */
            var s = new Set(b.map(fn));
            return a.map(fn).filter((/**
             * @param {?} el
             * @return {?}
             */
            function (el) { return !s.has(el); }));
        });
        this.sameBy = (/**
         * @param {?} a
         * @param {?} b
         * @param {?} fn
         * @return {?}
         */
        function (a, b, fn) {
            /** @type {?} */
            var s = new Set(b.map(fn));
            return a.map(fn).filter((/**
             * @param {?} el
             * @return {?}
             */
            function (el) { return s.has(el); }));
        });
    }
    Object.defineProperty(ListViewComponent.prototype, "activeIndex", {
        get: /**
         * @return {?}
         */
        function () {
            return this._activeIndex;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._activeIndex = val;
            this.dataInit();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ListViewComponent.prototype, "pageList", {
        get: /**
         * @return {?}
         */
        function () {
            return this._pageList;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._pageList = val;
            if (this.pager) {
                this.pager.setPageList(val);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ListViewComponent.prototype, "listviewFill", {
        get: /**
         * @return {?}
         */
        function () { return this.fill; },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ListViewComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.currentData = this.data;
        this.dataInit();
        this.paginationOptions = {
            id: 'Farris-listView-Pagination',
            itemsPerPage: this.pageSize,
            currentPage: this.pageIndex,
            pageList: this.pageList,
            totalItems: this.total,
            remote: this.pagerOnServer
        };
        if (this.id) {
            this.paginationOptions.id = this.paginationOptions.id + this.id;
        }
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    ListViewComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        var _this = this;
        if (changes.data && !changes.data.isFirstChange()) {
            this.currentData = this.data;
            this.dataInit();
        }
        if (changes['total'] && this.total && this.paginationOptions) {
            this.paginationOptions['totalItems'] = this.total;
        }
        if (changes['pageIndex'] && this.pageIndex && this.paginationOptions) {
            this.paginationOptions['currentPage'] = this.pageIndex;
        }
        if (changes && changes.checkValues !== undefined && !changes.checkValues.isFirstChange()) {
            /** @type {?} */
            var change = this.differenceBy(changes.checkValues.currentValue || [], changes.checkValues.previousValue || [], (/**
             * @param {?} v
             * @return {?}
             */
            function (v) {
                return v;
            }));
            if (change) {
                if (!this.enableMorePageSelect) {
                    this.checkRows(this.checkValues);
                }
            }
        }
        if (changes.checkItems && !changes.checkItems.isFirstChange()) {
            this.selectDataListWithOtherPager = tslib_1.__spread(this.checkItems);
            /** @type {?} */
            var ids = this.checkItems.map((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n[_this.listidName]; }));
            this.checkedItems(ids, false);
        }
    };
    /**
     * @return {?}
     */
    ListViewComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    ListViewComponent.prototype.ngAfterContentInit = /**
     * @return {?}
     */
    function () {
    };
    /** 默认搜索模板 点击搜索 */
    /**
     * 默认搜索模板 点击搜索
     * @param {?} searchField
     * @return {?}
     */
    ListViewComponent.prototype.searchList = /**
     * 默认搜索模板 点击搜索
     * @param {?} searchField
     * @return {?}
     */
    function (searchField) {
        if (searchField !== '' && this.data && this.data.length) {
            this.currentData = this.data.filter((/**
             * @param {?} list
             * @return {?}
             */
            function (list) {
                /** @type {?} */
                var result;
                /** @type {?} */
                var listValue = Object.values(list);
                for (var i = 0; i < listValue.length; i++) {
                    if (typeof listValue[i] == 'string') {
                        if (listValue[i].toString().includes(searchField)) {
                            result = listValue[i].toString().includes(searchField);
                            break;
                        }
                    }
                }
                return result;
            }));
        }
        else {
            this.currentData = this.data;
        }
        return { listdata: this.currentData, searchValue: searchField, length: this.currentData.length };
    };
    /** 点击某一列事件 */
    /**
     * 点击某一列事件
     * @param {?} event
     * @param {?} listItem
     * @param {?} index
     * @param {?=} checkChangeEvent
     * @return {?}
     */
    ListViewComponent.prototype.listSelect = /**
     * 点击某一列事件
     * @param {?} event
     * @param {?} listItem
     * @param {?} index
     * @param {?=} checkChangeEvent
     * @return {?}
     */
    function (event, listItem, index, checkChangeEvent) {
        var _this = this;
        if (checkChangeEvent === void 0) { checkChangeEvent = false; }
        if (listItem['unClick'] || listItem['selectDisable']) {
            return;
        }
        else {
            this.checkChange.emit({ listdata: listItem, index: index });
            if (this.multipleSelect) {
                if (listItem['checked']) {
                    // 支持多选 删除该选中行
                    /** @type {?} */
                    var selectItemIndex = this.selectDataList.findIndex((/**
                     * @param {?} item
                     * @param {?} i
                     * @return {?}
                     */
                    function (item, i) {
                        return _this.getKey(item, i) === _this.getKey(listItem, index);
                    }));
                    this.selectDataList.splice(selectItemIndex, 1);
                    this.updateDataListForMorePager('remove', listItem);
                }
                else {
                    // 支持多选 插入该选中行
                    /** @type {?} */
                    var result = this.selectDataList.find((/**
                     * @param {?} value
                     * @param {?} i
                     * @return {?}
                     */
                    function (value, i) {
                        return _this.getKey(value, i) === _this.getKey(listItem, index);
                    }));
                    if (!result) {
                        this.selectDataList.unshift(listItem);
                        this.updateDataListForMorePager('append', listItem);
                    }
                }
                listItem['checked'] = !listItem['checked'];
            }
            else {
                // 不支持多选 替换当前选中行
                this.selectDataList = [];
                this.selectDataList.push(listItem);
            }
            if (!checkChangeEvent) {
                this.clickItem = listItem;
            }
            this.listClick.emit({ data: this.selectDataList, index: index, checkChangeEvent: checkChangeEvent });
        }
        if (this.multipleSelect) {
            /** @type {?} */
            var ids = this.data.filter((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return !!item.checked; })).map((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item[_this.listidName]; }));
            if (this.enableMorePageSelect) {
                ids = this.selectDataListWithOtherPager.map((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return item[_this.listidName]; }));
            }
            this.onCheckValuesChange(ids);
        }
    };
    /** 获得每一行list 唯一标识 */
    /**
     * 获得每一行list 唯一标识
     * @param {?} list
     * @param {?} index
     * @return {?}
     */
    ListViewComponent.prototype.getKey = /**
     * 获得每一行list 唯一标识
     * @param {?} list
     * @param {?} index
     * @return {?}
     */
    function (list, index) {
        if (this.listidName && list.hasOwnProperty(this.listidName)) {
            return list[this.listidName];
        }
        else {
            return index;
        }
    };
    /** checkbox状态变化 */
    /**
     * checkbox状态变化
     * @param {?} event
     * @param {?} changeData
     * @param {?} i
     * @return {?}
     */
    ListViewComponent.prototype.getSelect = /**
     * checkbox状态变化
     * @param {?} event
     * @param {?} changeData
     * @param {?} i
     * @return {?}
     */
    function (event, changeData, i) {
        /** @type {?} */
        var state = event.checked;
        this.listSelect(state, changeData, i, true);
    };
    /** 排序事件 */
    /**
     * 排序事件
     * @param {?} sortkeyName
     * @param {?=} sortType
     * @return {?}
     */
    ListViewComponent.prototype.sort = /**
     * 排序事件
     * @param {?} sortkeyName
     * @param {?=} sortType
     * @return {?}
     */
    function (sortkeyName, sortType) {
        if (sortType === void 0) { sortType = 'asc'; }
        this.currentData.sort(this.compare(sortkeyName, sortType));
        return { sortResult: { listdata: this.currentData, sortkeyName: sortkeyName, sortType: sortType } };
    };
    /**
     * @param {?} primaryValue
     * @return {?}
     */
    ListViewComponent.prototype.selectRow = /**
     * @param {?} primaryValue
     * @return {?}
     */
    function (primaryValue) {
        var _this = this;
        if (this.currentData && this.currentData.length > 0) {
            /** @type {?} */
            var row = this.currentData.find((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item[_this.listidName] === primaryValue; }));
            if (row) {
                this.clickItem = row;
                this.cdr.markForCheck();
            }
        }
    };
    /**
     * @private
     * @param {?} KeyName
     * @param {?} type
     * @return {?}
     */
    ListViewComponent.prototype.compare = /**
     * @private
     * @param {?} KeyName
     * @param {?} type
     * @return {?}
     */
    function (KeyName, type) {
        if (type === 'desc') {
            return (/**
             * @param {?} obj1
             * @param {?} obj2
             * @return {?}
             */
            function (obj1, obj2) {
                /** @type {?} */
                var val1 = obj1[KeyName];
                /** @type {?} */
                var val2 = obj2[KeyName];
                if (val2 < val1) {
                    return 1;
                }
                else if (val2 > val1) {
                    return -1;
                }
                else {
                    return 0;
                }
            });
        }
        if (type === 'asc') {
            return (/**
             * @param {?} obj1
             * @param {?} obj2
             * @return {?}
             */
            function (obj1, obj2) {
                /** @type {?} */
                var val1 = obj1[KeyName];
                /** @type {?} */
                var val2 = obj2[KeyName];
                if (val2 > val1) {
                    return 1;
                }
                else if (val2 < val1) {
                    return -1;
                }
                else {
                    return 0;
                }
            });
        }
    };
    /**
     * @param {?} item
     * @return {?}
     */
    ListViewComponent.prototype.getItemActive = /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        // 不管是否开启多选，当前行只有一行
        if (this.listidName && this.clickItem) {
            return item[this.listidName] === this.clickItem[this.listidName];
        }
        else {
            return false;
        }
    };
    /**
     * @param {?} page
     * @return {?}
     */
    ListViewComponent.prototype.onPageChange = /**
     * @param {?} page
     * @return {?}
     */
    function (page) {
        if (this.pageIndex !== page.pageIndex) {
            this.pageIndex = page.pageIndex;
            this.paginationOptions.currentPage = page.pageIndex;
            this.pageChanged.emit({ pageInfo: page });
        }
    };
    /**
     * @param {?} pageSize
     * @return {?}
     */
    ListViewComponent.prototype.onPageSizeChange = /**
     * @param {?} pageSize
     * @return {?}
     */
    function (pageSize) {
        // console.log(this.pageSize !== pageSize && this.total);
        if (this.pageSize !== pageSize && this.total) {
            this.paginationOptions.itemsPerPage = pageSize;
            this.pageSize = pageSize;
            /** @type {?} */
            var total = this.total;
            /** @type {?} */
            var pageLength = Math.floor(total / pageSize);
            if (total % pageSize > 0) {
                pageLength += 1;
            }
            if (pageLength && this.pageIndex > pageLength) {
                this.pageIndex = pageLength;
                this.paginationOptions.currentPage = this.pageIndex;
            }
            this.pageSizeChanged.emit({ pageInfo: { pageIndex: this.pageIndex, pageSize: pageSize } });
        }
    };
    /**
     * @return {?}
     */
    ListViewComponent.prototype.getCurrentData = /**
     * @return {?}
     */
    function () {
        return this.currentData;
    };
    /**
     * @return {?}
     */
    ListViewComponent.prototype.getSelectData = /**
     * @return {?}
     */
    function () {
        return this.selectDataList;
    };
    /** 支持重新设置listview数据 */
    /**
     * 支持重新设置listview数据
     * @param {?} listviewData
     * @return {?}
     */
    ListViewComponent.prototype.setData = /**
     * 支持重新设置listview数据
     * @param {?} listviewData
     * @return {?}
     */
    function (listviewData) {
        this.currentData = listviewData;
        this.data = listviewData;
        this.dataInit();
    };
    /**
     * @return {?}
     */
    ListViewComponent.prototype.dataInit = /**
     * @return {?}
     */
    function () {
        if (this.data && this.data.length) {
            this.selectDataList = this.data.filter((/**
             * @param {?} list
             * @return {?}
             */
            function (list) {
                return list['checked'];
            }));
            if (this.activeIndex >= 0 && this.activeIndex <= (this.data.length - 1)) {
                /** @type {?} */
                var dataItem = this.data[this.activeIndex];
                if (dataItem) {
                    this.clickItem = dataItem;
                    this.selectDataList.push(this.clickItem);
                }
            }
            else if (this.activeIndex < 0) {
                return;
            }
            else {
                if (!this.selectDataList.length && !this.multipleSelect) {
                    this.selectDataList.push(this.data[0]);
                }
                this.clickItem = this.data[0];
            }
        }
        this.updateDataListForMorePager();
        if (this.cdr) {
            this.cdr.detectChanges();
        }
    };
    /**
     * @private
     * @param {?=} active
     * @param {?=} listItem
     * @param {?=} emit
     * @return {?}
     */
    ListViewComponent.prototype.updateDataListForMorePager = /**
     * @private
     * @param {?=} active
     * @param {?=} listItem
     * @param {?=} emit
     * @return {?}
     */
    function (active, listItem, emit) {
        var _this = this;
        if (active === void 0) { active = ''; }
        if (emit === void 0) { emit = true; }
        if (this.multipleSelect && this.enableMorePageSelect) {
            if (active === 'remove' && listItem) {
                if (!Array.isArray(listItem)) {
                    this.selectDataListWithOtherPager =
                        this.selectDataListWithOtherPager.filter((/**
                         * @param {?} n
                         * @return {?}
                         */
                        function (n) {
                            if (typeof listItem === 'object') {
                                return n[_this.listidName] != listItem[_this.listidName];
                            }
                            else {
                                return n[_this.listidName] != listItem;
                            }
                        }));
                }
                else {
                    this.selectDataListWithOtherPager =
                        this.selectDataListWithOtherPager.filter((/**
                         * @param {?} n
                         * @return {?}
                         */
                        function (n) {
                            return listItem.indexOf((/**
                             * @param {?} a
                             * @return {?}
                             */
                            function (a) { return a[_this.listidName] === n[_this.listidName]; })) === -1;
                        }));
                }
                if (emit) {
                    this.checkItemsChange.emit({ items: tslib_1.__spread(this.selectDataListWithOtherPager), instance: this });
                }
            }
            else if (active === 'append') {
                if (!Array.isArray(listItem)) {
                    this.selectDataListWithOtherPager = tslib_1.__spread(this.selectDataListWithOtherPager, [listItem]);
                }
                else {
                    this.selectDataListWithOtherPager = tslib_1.__spread(this.selectDataListWithOtherPager, listItem);
                }
                if (emit) {
                    this.checkItemsChange.emit({ items: tslib_1.__spread(this.selectDataListWithOtherPager), instance: this });
                }
            }
            else {
                if (!this.selectDataListWithOtherPager.length) {
                    this.selectDataListWithOtherPager = tslib_1.__spread(this.selectDataList);
                }
                else {
                    /** @type {?} */
                    var newCheckeds_1 = this.sameBy(this.currentData, this.selectDataListWithOtherPager, (/**
                     * @param {?} v
                     * @return {?}
                     */
                    function (v) { return v[_this.listidName]; }));
                    if (newCheckeds_1 && newCheckeds_1.length) {
                        this.data.forEach((/**
                         * @param {?} item
                         * @return {?}
                         */
                        function (item) {
                            item.checked = newCheckeds_1.includes(item[_this.listidName]);
                        }));
                    }
                }
            }
        }
    };
    /** 全选 */
    /**
     * 全选
     * @return {?}
     */
    ListViewComponent.prototype.listCheckAll = /**
     * 全选
     * @return {?}
     */
    function () {
        if (this.multipleSelect) {
            this.currentData.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                item.checked = true;
            }));
            this.selectDataList = this.currentData.filter((/**
             * @param {?} list
             * @return {?}
             */
            function (list) {
                return list['checked'];
            }));
            this.updateDataListForMorePager('append', this.currentData);
            this.cdr.markForCheck();
        }
    };
    /** 取消全选 */
    /**
     * 取消全选
     * @return {?}
     */
    ListViewComponent.prototype.listCheckAllCancel = /**
     * 取消全选
     * @return {?}
     */
    function () {
        if (this.multipleSelect) {
            this.currentData.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                item.checked = false;
            }));
            this.selectDataList = [];
            this.updateDataListForMorePager('remove', this.currentData);
            this.cdr.markForCheck();
        }
    };
    /**
     * 勾选行
     * @param ids ids
     */
    /**
     * 勾选行
     * @param {?} ids ids
     * @return {?}
     */
    ListViewComponent.prototype.checkRows = /**
     * 勾选行
     * @param {?} ids ids
     * @return {?}
     */
    function (ids) {
        var _this = this;
        if (this.multipleSelect) {
            if (!ids || ids.length < 1) {
                this.listCheckAllCancel();
                return;
            }
            this.data.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                if (ids.includes(item[_this.listidName])) {
                    item.checked = true;
                }
                else {
                    item.checked = false;
                }
            }));
            // this.onCheckValuesChange(ids);
            this.cdr.markForCheck();
        }
    };
    /**
     * @private
     * @param {?} ids
     * @return {?}
     */
    ListViewComponent.prototype.onCheckValuesChange = /**
     * @private
     * @param {?} ids
     * @return {?}
     */
    function (ids) {
        this.checkValuesChange.emit(ids);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ListViewComponent.prototype.onMouseEnter = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        $event.stopPropagation();
        this.mouseInSelectedList = true;
        if (this.selectDataListWithOtherPager && this.selectDataListWithOtherPager.length) {
            this.openSelectedList = !this.openSelectedList;
        }
        else {
            this.openSelectedList = false;
        }
    };
    /**
     * @return {?}
     */
    ListViewComponent.prototype.closeSelectedList = /**
     * @return {?}
     */
    function () {
        this.openSelectedList = false;
        this.mouseInSelectedList = false;
        if (!this.cdr['destroyed']) {
            this.cdr.detectChanges();
        }
    };
    /**
     * @param {?} id
     * @return {?}
     */
    ListViewComponent.prototype.onDelSelectedItem = /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        var _this = this;
        this.currentData.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            if (item[_this.listidName] == id) {
                item.checked = false;
            }
        }));
        this.selectDataList = this.selectDataList.filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n[_this.listidName] != id; }));
        this.updateDataListForMorePager('remove', id);
        this.updateCheckedValues();
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ListViewComponent.prototype.onClearSelected = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        // this.clearSelectedItem.emit();
        this.closeSelectedList();
        this.listCheckAllCancel();
        this.selectDataListWithOtherPager = [];
        this.checkValues = [];
        this.onCheckValuesChange([]);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ListViewComponent.prototype.onSelectListPanelClose = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.closeSelectedList();
    };
    /**
     * @private
     * @param {?=} emit
     * @return {?}
     */
    ListViewComponent.prototype.updateCheckedValues = /**
     * @private
     * @param {?=} emit
     * @return {?}
     */
    function (emit) {
        var _this = this;
        if (emit === void 0) { emit = true; }
        if (this.multipleSelect) {
            if (!this.enableMorePageSelect) {
                this.checkValues = this.selectDataList.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n[_this.listidName]; }));
            }
            else {
                this.checkValues = this.selectDataListWithOtherPager.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n[_this.listidName]; }));
            }
            if (emit) {
                this.onCheckValuesChange(this.checkValues);
                this.checkItemsChange.emit({ items: this.selectDataListWithOtherPager, instance: this });
            }
        }
    };
    /**
     * @param {?=} clearAll
     * @param {?=} emit
     * @return {?}
     */
    ListViewComponent.prototype.clearCheckeds = /**
     * @param {?=} clearAll
     * @param {?=} emit
     * @return {?}
     */
    function (clearAll, emit) {
        if (clearAll === void 0) { clearAll = true; }
        if (emit === void 0) { emit = true; }
        if (this.multipleSelect) {
            this.currentData.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                item.checked = false;
            }));
            this.selectDataList = [];
            if (clearAll) {
                this.selectDataListWithOtherPager = [];
            }
            else {
                this.updateDataListForMorePager('remove', this.currentData);
            }
            if (emit) {
                this.updateCheckedValues(emit);
            }
            this.cdr.markForCheck();
        }
    };
    /**
     * @private
     * @param {?} ids
     * @param {?} checked
     * @param {?} emit
     * @return {?}
     */
    ListViewComponent.prototype._setItemsCheckedStatus = /**
     * @private
     * @param {?} ids
     * @param {?} checked
     * @param {?} emit
     * @return {?}
     */
    function (ids, checked, emit) {
        var _this = this;
        if (ids && ids.length) {
            /** @type {?} */
            var action = checked ? 'append' : 'remove';
            ids.forEach((/**
             * @param {?} i
             * @return {?}
             */
            function (i) {
                /** @type {?} */
                var id = i;
                if (typeof i === 'object') {
                    id = i[_this.listidName];
                }
                /** @type {?} */
                var item = _this.data.find((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n[_this.listidName] === id; }));
                if (item) {
                    item.checked = checked;
                }
                if (checked) {
                    _this.updateDataListForMorePager('append', i, false);
                }
                else {
                    _this.updateDataListForMorePager('remove', id, false);
                }
            }));
            this.updateCheckedValues(emit);
            this.cdr.markForCheck();
        }
    };
    /**
     * @param {?} ids
     * @param {?=} emit
     * @return {?}
     */
    ListViewComponent.prototype.unCheckItems = /**
     * @param {?} ids
     * @param {?=} emit
     * @return {?}
     */
    function (ids, emit) {
        if (emit === void 0) { emit = false; }
        this._setItemsCheckedStatus(ids, false, emit);
    };
    /**
     * @param {?} ids
     * @param {?=} emit
     * @return {?}
     */
    ListViewComponent.prototype.checkedItems = /**
     * @param {?} ids
     * @param {?=} emit
     * @return {?}
     */
    function (ids, emit) {
        if (emit === void 0) { emit = false; }
        this._setItemsCheckedStatus(ids, true, emit);
    };
    ListViewComponent.decorators = [
        { type: Component, args: [{
                    selector: 'farris-list-view',
                    template: "<div class=\"f-list-view\" [ngClass]=\"{'f-list-view-multiple': multipleSelect}\">\r\n    <div class=\"f-list-view-header\" *ngIf=\"headerTemplate\">\r\n        <ng-container [ngTemplateOutlet]=\"headerTemplate\"></ng-container>\r\n    </div>\r\n    <div class=\"f-list-view-content\">\r\n        <ul class=\"f-list-view-group\" [ngClass]=\"{'d-flex flex-wrap': cardLayout}\">\r\n            <ng-container *ngIf=\"currentData&&currentData.length;else emptyData\">\r\n                <li class=\"f-list-view-group-item {{listClassName}}\"\r\n                    *ngFor=\"let list of (supportPaging ? (currentData | paginate: paginationOptions) : currentData); let i = index;let first = first; let last = last\"\r\n                    [id]=\"getKey(list,i)\" (click)=\"listSelect($event,list,i)\"\r\n                    [ngClass]=\"{'f-un-click': list['unClick'],'f-un-select':list['selectDisable'],'f-listview-active':getItemActive(list)}\">\r\n                    <div class=\"f-list-select\" *ngIf=\"multipleSelect\" (click)=\"$event.stopPropagation()\">\r\n                        <list-view-checkout [id]=\"'list-'+getKey(list,i)\"\r\n                            [disabled]=\"list['selectDisable']||list['unClick']\" [checked]=\"list['checked']\"\r\n                            (checkedChange)=\"getSelect($event,list,i)\"></list-view-checkout>\r\n                    </div>\r\n                    <div class=\"f-list-content\">\r\n                        <ng-container [ngTemplateOutlet]=\"listTemplate\"\r\n                            [ngTemplateOutletContext]=\"{ item: list , index:i, selectedItem: clickItem, first:first,last:last }\">\r\n                        </ng-container>\r\n                    </div>\r\n                </li>\r\n            </ng-container>\r\n\r\n            <ng-template #emptyData>\r\n                <!-- \u7A7A\u6570\u636E\u9ED8\u8BA4\u6A21\u677F -->\r\n                <div class=\"f-list-view-emptydata\" *ngIf=\"showEmpty&&!emptyTemplate;else customEmpty\">\r\n                    <p class=\"f-empty-title\">{{ 'listview.emptyMessage' | locale }}</p>\r\n                </div>\r\n                <!-- \u81EA\u5B9A\u4E49\u7A7A\u6570\u636E\u6A21\u677F -->\r\n                <ng-template #customEmpty>\r\n                    <ng-container [ngTemplateOutlet]=\"emptyDataTemplate\"></ng-container>\r\n                </ng-template>\r\n\r\n            </ng-template>\r\n        </ul>\r\n    </div>\r\n    <div class=\"f-list-view-footer\" *ngIf=\"footerTemplate || supportPaging\">\r\n        <ng-container [ngTemplateOutlet]=\"footerTemplate\">\r\n            <div class=\"f-paging-wrapper\" *ngIf=\"supportPaging&&currentData&&currentData.length\">\r\n                <pagination-controls #pager [id]=\"paginationOptions.id\" [maxSize]=\"maxSize\"\r\n                    [directionLinks]=\"directionLinks\" [autoHide]=\"autoHide\" [responsive]=\"responsive\"\r\n                    [previousLabel]=\"labels.previousLabel\" [nextLabel]=\"labels.nextLabel\"\r\n                    [screenReaderPaginationLabel]=\"labels.screenReaderPaginationLabel\"\r\n                    [screenReaderPageLabel]=\"labels.screenReaderPageLabel\"\r\n                    [screenReaderCurrentLabel]=\"labels.screenReaderCurrentLabel\" (pageChange)=\"onPageChange($event)\"\r\n                    (pageSizeChange)=\"onPageSizeChange($event)\" [showSelectedList]=\"showSelectedList && enableMorePageSelect\">\r\n\r\n                    <div class=\"flex-fill\" >\r\n                        <div>\r\n                            <span class=\"badge badge-pill badge-light\" *ngIf=\"showSelectedList\"\r\n                                style=\"cursor:pointer\" [attr.title]=\"'datagrid.selectionData.tooltip' | locale\"\r\n                                [class.badge-primary]=\"mouseInSelectedList\"\r\n                                [innerHTML]=\"'datagrid.selectionData.currentLenth' | locale | replaceX: selectDataListWithOtherPager.length\"\r\n                                (click)=\"onMouseEnter($event)\">\r\n                            </span>\r\n                            <pagination-selected-list *ngIf=\"openSelectedList\"\r\n                                [data]=\"selectDataListWithOtherPager | formatItems: selectedItemFormat\"\r\n                                (close)=\"onSelectListPanelClose($event)\"\r\n                                (remove)=\"onDelSelectedItem($event)\"\r\n                                (clear)=\"onClearSelected($event)\"\r\n                            ></pagination-selected-list>\r\n                        </div>\r\n                    </div>\r\n\r\n                </pagination-controls>\r\n            </div>\r\n        </ng-container>\r\n    </div>\r\n</div>",
                    styles: [":host{height:100%}:host.f-listview-fill{-webkit-box-flex:1;flex-grow:1;flex-shrink:1;flex-basis:0;overflow:hidden}:host.f-listview-fill .f-list-view{height:100%}:host.f-listview-fill .f-list-view .f-list-view-header{flex-shrink:0}:host.f-listview-fill .f-list-view .f-list-view-footer{flex-shrink:0}:host.f-listview-fill .f-list-view .f-list-view-content{overflow-y:auto;-webkit-box-flex:1;flex-grow:1;flex-shrink:1;flex-basis:0}:host .f-list-view{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}:host .f-list-view .f-paging-wrapper{padding:14px 0}:host .f-list-view-group-item{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}:host .f-list-view-group-item.f-none-border{border-bottom:0}:host .f-list-view-group-item .f-list-content{-webkit-box-flex:1;flex:1 1 auto;width:100%}:host .f-list-select{padding:0 14px}:host .f-list-view-emptydata .f-empty-title{font-size:14px;line-height:22px;color:#999;padding:20px 0;text-align:center}"]
                }] }
    ];
    /** @nocollapse */
    ListViewComponent.ctorParameters = function () { return [
        { type: ElementRef },
        { type: Renderer2 },
        { type: ChangeDetectorRef }
    ]; };
    ListViewComponent.propDecorators = {
        headerTemplate: [{ type: ContentChild, args: [ListViewHeaderTemplateDirective, { read: TemplateRef },] }],
        listTemplate: [{ type: ContentChild, args: [ListViewTemplateDirective, { read: TemplateRef },] }],
        footerTemplate: [{ type: ContentChild, args: [ListViewFooterTemplateDirective, { read: TemplateRef },] }],
        emptyDataTemplate: [{ type: ContentChild, args: [ListViewEmptyTemplateDirective, { read: TemplateRef },] }],
        listGroup: [{ type: ViewChild, args: ['listGroup',] }],
        pager: [{ type: ViewChild, args: ['pager',] }],
        data: [{ type: Input }],
        id: [{ type: Input }],
        showEmpty: [{ type: Input }],
        emptyTemplate: [{ type: Input }],
        multipleSelect: [{ type: Input }],
        supportPaging: [{ type: Input }],
        pagerOnServer: [{ type: Input }],
        pageSize: [{ type: Input }],
        pageIndex: [{ type: Input }],
        enableMorePageSelect: [{ type: Input }],
        showSelectedList: [{ type: Input }],
        selectedItemFormat: [{ type: Input }],
        fill: [{ type: Input }],
        cardLayout: [{ type: Input }],
        activeIndex: [{ type: Input }],
        listClassName: [{ type: Input }],
        checkValues: [{ type: Input }],
        checkValuesChange: [{ type: Output }],
        checkItems: [{ type: Input }],
        checkItemsChange: [{ type: Input }],
        pageList: [{ type: Input }],
        total: [{ type: Input }],
        listidName: [{ type: Input }],
        listviewFill: [{ type: HostBinding, args: ['class.f-listview-fill',] }],
        listClick: [{ type: Output }],
        checkChange: [{ type: Output }],
        pageChanged: [{ type: Output }],
        pageSizeChanged: [{ type: Output }]
    };
    return ListViewComponent;
}());
export { ListViewComponent };
if (false) {
    /** @type {?} */
    ListViewComponent.prototype.headerTemplate;
    /** @type {?} */
    ListViewComponent.prototype.listTemplate;
    /** @type {?} */
    ListViewComponent.prototype.footerTemplate;
    /** @type {?} */
    ListViewComponent.prototype.emptyDataTemplate;
    /** @type {?} */
    ListViewComponent.prototype.listGroup;
    /** @type {?} */
    ListViewComponent.prototype.pager;
    /**
     * 列表数据
     * @type {?}
     */
    ListViewComponent.prototype.data;
    /** @type {?} */
    ListViewComponent.prototype.id;
    /**
     * 数据为空是否展示默认
     * @type {?}
     */
    ListViewComponent.prototype.showEmpty;
    /**
     * 是否自定义空数据模板
     * @type {?}
     */
    ListViewComponent.prototype.emptyTemplate;
    /**
     * 是否支持多选 默认为false
     * @type {?}
     */
    ListViewComponent.prototype.multipleSelect;
    /**
     * 是否支持分页 默认false
     * @type {?}
     */
    ListViewComponent.prototype.supportPaging;
    /** @type {?} */
    ListViewComponent.prototype.pagerOnServer;
    /** @type {?} */
    ListViewComponent.prototype.pageSize;
    /** @type {?} */
    ListViewComponent.prototype.pageIndex;
    /**
     * 启用跨页多选
     * @type {?}
     */
    ListViewComponent.prototype.enableMorePageSelect;
    /** @type {?} */
    ListViewComponent.prototype.showSelectedList;
    /** @type {?} */
    ListViewComponent.prototype.selectedItemFormat;
    /** @type {?} */
    ListViewComponent.prototype.fill;
    /** @type {?} */
    ListViewComponent.prototype.cardLayout;
    /** @type {?} */
    ListViewComponent.prototype._activeIndex;
    /** @type {?} */
    ListViewComponent.prototype.listClassName;
    /**
     * 勾选值
     * @type {?}
     */
    ListViewComponent.prototype.checkValues;
    /** @type {?} */
    ListViewComponent.prototype.checkValuesChange;
    /** @type {?} */
    ListViewComponent.prototype.checkItems;
    /** @type {?} */
    ListViewComponent.prototype.checkItemsChange;
    /**
     * @type {?}
     * @private
     */
    ListViewComponent.prototype._pageList;
    /** @type {?} */
    ListViewComponent.prototype.total;
    /**
     * 作为唯一标识的数据key值 如果没传 唯一标识为index值
     * @type {?}
     */
    ListViewComponent.prototype.listidName;
    /**
     * 点击某一行后
     * @type {?}
     */
    ListViewComponent.prototype.listClick;
    /**
     * 多选框 选中状态变化
     * @type {?}
     */
    ListViewComponent.prototype.checkChange;
    /** @type {?} */
    ListViewComponent.prototype.pageChanged;
    /** @type {?} */
    ListViewComponent.prototype.pageSizeChanged;
    /**
     * 当前展示列表数据
     * @type {?}
     */
    ListViewComponent.prototype.currentData;
    /**
     * 选中的列表数组
     * @type {?}
     */
    ListViewComponent.prototype.selectDataList;
    /**
     * 跨页多选记录
     * @type {?}
     */
    ListViewComponent.prototype.selectDataListWithOtherPager;
    /** @type {?} */
    ListViewComponent.prototype.clickItem;
    /** @type {?} */
    ListViewComponent.prototype.maxSize;
    /** @type {?} */
    ListViewComponent.prototype.directionLinks;
    /** @type {?} */
    ListViewComponent.prototype.autoHide;
    /** @type {?} */
    ListViewComponent.prototype.responsive;
    /** @type {?} */
    ListViewComponent.prototype.paginationOptions;
    /** @type {?} */
    ListViewComponent.prototype.labels;
    /** @type {?} */
    ListViewComponent.prototype.mouseInSelectedList;
    /** @type {?} */
    ListViewComponent.prototype.openSelectedList;
    /**
     * @type {?}
     * @private
     */
    ListViewComponent.prototype.differenceBy;
    /**
     * @type {?}
     * @private
     */
    ListViewComponent.prototype.sameBy;
    /**
     * @type {?}
     * @private
     */
    ListViewComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    ListViewComponent.prototype.renderer;
    /**
     * @type {?}
     * @private
     */
    ListViewComponent.prototype.cdr;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGlzdC12aWV3LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktbGlzdC12aWV3LyIsInNvdXJjZXMiOlsibGliL2xpc3Qtdmlldy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQ0gsU0FBUyxFQUE0QixVQUFVLEVBQUUsV0FBVyxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUM5RyxXQUFXLEVBQTRCLGlCQUFpQixFQUMxRSxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQ0gsK0JBQStCLEVBQy9CLHlCQUF5QixFQUN6QiwrQkFBK0IsRUFDL0IsOEJBQThCLEdBQ2pDLE1BQU0sc0JBQXNCLENBQUM7QUFFOUIsT0FBTyxFQUFzQiwyQkFBMkIsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBR3hGO0lBaUlJLDJCQUFvQixFQUFjLEVBQVUsUUFBbUIsRUFBVSxHQUFzQjtRQUEzRSxPQUFFLEdBQUYsRUFBRSxDQUFZO1FBQVUsYUFBUSxHQUFSLFFBQVEsQ0FBVztRQUFVLFFBQUcsR0FBSCxHQUFHLENBQW1COzs7OztRQTlHdEYsU0FBSSxHQUFHLEVBQUUsQ0FBQzs7OztRQUtWLGNBQVMsR0FBRyxJQUFJLENBQUM7Ozs7UUFFakIsa0JBQWEsR0FBRyxLQUFLLENBQUM7Ozs7UUFFdEIsbUJBQWMsR0FBRyxLQUFLLENBQUM7Ozs7UUFHdkIsa0JBQWEsR0FBRyxLQUFLLENBQUM7O1FBR3RCLGtCQUFhLEdBQUcsSUFBSSxDQUFDO1FBQ3JCLGFBQVEsR0FBRyxFQUFFLENBQUM7UUFDZCxjQUFTLEdBQUcsQ0FBQyxDQUFDOzs7O1FBRWQseUJBQW9CLEdBQUcsS0FBSyxDQUFDO1FBQzdCLHFCQUFnQixHQUFHLEtBQUssQ0FBQztRQUN6Qix1QkFBa0IsR0FBMEIsSUFBSSxDQUFDOztRQUdqRCxTQUFJLEdBQUcsS0FBSyxDQUFDOztR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SUFHOUMsa0NBQXVEOzs7OztJQUl2RCxpQ0FBbUI7O0lBRW5CLCtCQUFvQjs7Ozs7SUFHcEIsc0NBQTBCOzs7OztJQUUxQiwwQ0FBK0I7Ozs7O0lBRS9CLDJDQUFnQzs7Ozs7SUFHaEMsMENBQStCOztJQUcvQiwwQ0FBOEI7O0lBQzlCLHFDQUF1Qjs7SUFDdkIsc0NBQXVCOzs7OztJQUV2QixpREFBc0M7O0lBQ3RDLDZDQUFrQzs7SUFDbEMsK0NBQTBEOztJQUcxRCxpQ0FBc0I7O0lBRXRCLHVDQUE0Qjs7SUFFNUIseUNBQXFCOztJQVNyQiwwQ0FBK0I7Ozs7O0lBSS9CLHdDQUFpQzs7SUFDakMsOENBQTZFOztJQUU3RSx1Q0FBeUI7O0lBQ3pCLDZDQUF3SDs7Ozs7SUFJeEgsc0NBQXFDOztJQVdyQyxrQ0FBbUI7Ozs7O0lBR25CLHVDQUEyQjs7Ozs7SUFNM0Isc0NBQXlDOzs7OztJQUV6Qyx3Q0FBMkM7O0lBRzNDLHdDQUEyQzs7SUFDM0MsNENBQStDOzs7OztJQUcvQyx3Q0FBaUI7Ozs7O0lBR2pCLDJDQUFvQjs7Ozs7SUFFcEIseURBQWtDOztJQUdsQyxzQ0FBc0I7O0lBRXRCLG9DQUFtQjs7SUFDbkIsMkNBQTZCOztJQUM3QixxQ0FBd0I7O0lBQ3hCLHVDQUF5Qjs7SUFDekIsOENBTUU7O0lBRUYsbUNBTUU7O0lBRUYsZ0RBQTRCOztJQUM1Qiw2Q0FBeUI7Ozs7O0lBK1d6Qix5Q0FHQzs7Ozs7SUFFRCxtQ0FHQzs7Ozs7SUF0WFcsK0JBQXNCOzs7OztJQUFFLHFDQUEyQjs7Ozs7SUFBRSxnQ0FBOEIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gICAgQ29tcG9uZW50LCBPbkluaXQsIEFmdGVyQ29udGVudEluaXQsIEVsZW1lbnRSZWYsIFRlbXBsYXRlUmVmLCBDb250ZW50Q2hpbGQsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBJbnB1dCwgUmVuZGVyZXIyLCBWaWV3Q2hpbGQsXHJcbiAgICBBZnRlclZpZXdJbml0LCBIb3N0QmluZGluZywgU2ltcGxlQ2hhbmdlcywgT25DaGFuZ2VzLCBDaGFuZ2VEZXRlY3RvclJlZiwgRG9DaGVja1xyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQge1xyXG4gICAgTGlzdFZpZXdIZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZSxcclxuICAgIExpc3RWaWV3VGVtcGxhdGVEaXJlY3RpdmUsXHJcbiAgICBMaXN0Vmlld0Zvb3RlclRlbXBsYXRlRGlyZWN0aXZlLFxyXG4gICAgTGlzdFZpZXdFbXB0eVRlbXBsYXRlRGlyZWN0aXZlLFxyXG59IGZyb20gJy4vdGVtcGxhdGUuZGlyZWN0aXZlJztcclxuXHJcbmltcG9ydCB7IFBhZ2luYXRpb25JbnN0YW5jZSwgUGFnaW5hdGlvbkNvbnRyb2xzQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1wYWdpbmF0aW9uJztcclxuXHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnZmFycmlzLWxpc3QtdmlldycsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vbGlzdC12aWV3LmNvbXBvbmVudC5odG1sJyxcclxuICAgIHN0eWxlVXJsczogWycuL2xpc3Qtdmlldy5jb21wb25lbnQuc2NzcyddXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBMaXN0Vmlld0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzLCBBZnRlckNvbnRlbnRJbml0LCBBZnRlclZpZXdJbml0IHtcclxuXHJcbiAgICBAQ29udGVudENoaWxkKExpc3RWaWV3SGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUsIHsgcmVhZDogVGVtcGxhdGVSZWYgfSkgaGVhZGVyVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgICBAQ29udGVudENoaWxkKExpc3RWaWV3VGVtcGxhdGVEaXJlY3RpdmUsIHsgcmVhZDogVGVtcGxhdGVSZWYgfSkgbGlzdFRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gICAgQENvbnRlbnRDaGlsZChMaXN0Vmlld0Zvb3RlclRlbXBsYXRlRGlyZWN0aXZlLCB7IHJlYWQ6IFRlbXBsYXRlUmVmIH0pIGZvb3RlclRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gICAgQENvbnRlbnRDaGlsZChMaXN0Vmlld0VtcHR5VGVtcGxhdGVEaXJlY3RpdmUsIHsgcmVhZDogVGVtcGxhdGVSZWYgfSkgZW1wdHlEYXRhVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XHJcblxyXG4gICAgQFZpZXdDaGlsZCgnbGlzdEdyb3VwJykgbGlzdEdyb3VwOiBFbGVtZW50UmVmO1xyXG5cclxuXHJcbiAgICBAVmlld0NoaWxkKCdwYWdlcicpIHBhZ2VyOiBQYWdpbmF0aW9uQ29udHJvbHNDb21wb25lbnQ7XHJcblxyXG4gICAgLy8gQElucHV0KCkgaGVpZ2h0Om51bWJlcjtcclxuICAgIC8qKiDliJfooajmlbDmja4gKi9cclxuICAgIEBJbnB1dCgpIGRhdGEgPSBbXTtcclxuXHJcbiAgICBASW5wdXQoKSBpZDogc3RyaW5nO1xyXG5cclxuICAgIC8qKiDmlbDmja7kuLrnqbrmmK/lkKblsZXnpLrpu5jorqQgKi9cclxuICAgIEBJbnB1dCgpIHNob3dFbXB0eSA9IHRydWU7XHJcbiAgICAvKiog5piv5ZCm6Ieq5a6a5LmJ56m65pWw5o2u5qih5p2/ICovXHJcbiAgICBASW5wdXQoKSBlbXB0eVRlbXBsYXRlID0gZmFsc2U7XHJcbiAgICAvKiog5piv5ZCm5pSv5oyB5aSa6YCJIOm7mOiupOS4umZhbHNlICovXHJcbiAgICBASW5wdXQoKSBtdWx0aXBsZVNlbGVjdCA9IGZhbHNlO1xyXG5cclxuICAgIC8qKiDmmK/lkKbmlK/mjIHliIbpobUg6buY6K6kZmFsc2UgKi9cclxuICAgIEBJbnB1dCgpIHN1cHBvcnRQYWdpbmcgPSBmYWxzZTtcclxuXHJcbiAgICAvLyDpu5jorqTliIbpobVcclxuICAgIEBJbnB1dCgpIHBhZ2VyT25TZXJ2ZXIgPSB0cnVlO1xyXG4gICAgQElucHV0KCkgcGFnZVNpemUgPSAxMDtcclxuICAgIEBJbnB1dCgpIHBhZ2VJbmRleCA9IDE7XHJcbiAgICAvKiog5ZCv55So6Leo6aG15aSa6YCJICovXHJcbiAgICBASW5wdXQoKSBlbmFibGVNb3JlUGFnZVNlbGVjdCA9IGZhbHNlO1xyXG4gICAgQElucHV0KCkgc2hvd1NlbGVjdGVkTGlzdCA9IGZhbHNlO1xyXG4gICAgQElucHV0KCkgc2VsZWN0ZWRJdGVtRm9ybWF0OiAoaXRlbTogYW55KSA9PiBzdHJpbmcgPSBudWxsO1xyXG5cclxuICAgIC8vIOaYr+WQpuW5s+mTulxyXG4gICAgQElucHV0KCkgZmlsbCA9IGZhbHNlO1xyXG4gICAgLy8g5piv5ZCm5qiq5ZCR5o6S5YiXXHJcbiAgICBASW5wdXQoKSBjYXJkTGF5b3V0ID0gZmFsc2U7XHJcblxyXG4gICAgX2FjdGl2ZUluZGV4OiBudW1iZXI7XHJcbiAgICBnZXQgYWN0aXZlSW5kZXgoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FjdGl2ZUluZGV4O1xyXG4gICAgfVxyXG4gICAgQElucHV0KCkgc2V0IGFjdGl2ZUluZGV4KHZhbCkge1xyXG4gICAgICAgIHRoaXMuX2FjdGl2ZUluZGV4ID0gdmFsO1xyXG4gICAgICAgIHRoaXMuZGF0YUluaXQoKTtcclxuICAgIH1cclxuXHJcbiAgICBASW5wdXQoKSBsaXN0Q2xhc3NOYW1lOiBzdHJpbmc7XHJcbiAgICAvKipcclxuICAgICAqIOWLvumAieWAvFxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBjaGVja1ZhbHVlczogYW55W10gPSBbXTtcclxuICAgIEBPdXRwdXQoKSBjaGVja1ZhbHVlc0NoYW5nZTogRXZlbnRFbWl0dGVyPGFueVtdPiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55W10+KCk7XHJcblxyXG4gICAgQElucHV0KCkgY2hlY2tJdGVtcyA9IFtdO1xyXG4gICAgQElucHV0KCkgY2hlY2tJdGVtc0NoYW5nZTogRXZlbnRFbWl0dGVyPHtpdGVtczogYW55W10sIGluc3RhbmNlOiBhbnl9PiA9IG5ldyBFdmVudEVtaXR0ZXI8e2l0ZW1zOiBbXSwgaW5zdGFuY2U6IGFueX0+KCk7XHJcblxyXG4gICAgLy8gQElucHV0KCkgYm9yZGVyQm90dG9tOmJvb2xlYW4gPSB0cnVlO1xyXG5cclxuICAgIHByaXZhdGUgX3BhZ2VMaXN0ID0gWzEwLCAyMCwgMzAsIDUwXTtcclxuXHJcbiAgICBnZXQgcGFnZUxpc3QoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BhZ2VMaXN0O1xyXG4gICAgfVxyXG4gICAgQElucHV0KCkgc2V0IHBhZ2VMaXN0KHZhbCkge1xyXG4gICAgICAgIHRoaXMuX3BhZ2VMaXN0ID0gdmFsO1xyXG4gICAgICAgIGlmICh0aGlzLnBhZ2VyKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFnZXIuc2V0UGFnZUxpc3QodmFsKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBASW5wdXQoKSB0b3RhbCA9IDA7XHJcblxyXG4gICAgLyoqIOS9nOS4uuWUr+S4gOagh+ivhueahOaVsOaNrmtleeWAvCDlpoLmnpzmsqHkvKAg5ZSv5LiA5qCH6K+G5Li6aW5kZXjlgLwgKi9cclxuICAgIEBJbnB1dCgpIGxpc3RpZE5hbWUgPSAnaWQnO1xyXG5cclxuICAgIEBIb3N0QmluZGluZygnY2xhc3MuZi1saXN0dmlldy1maWxsJykgZ2V0IGxpc3R2aWV3RmlsbCgpIHsgcmV0dXJuIHRoaXMuZmlsbDsgfVxyXG5cclxuXHJcbiAgICAvKiog54K55Ye75p+Q5LiA6KGM5ZCOICovXHJcbiAgICBAT3V0cHV0KCkgbGlzdENsaWNrID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgLyoqIOWkmumAieahhiDpgInkuK3nirbmgIHlj5jljJYgKi9cclxuICAgIEBPdXRwdXQoKSBjaGVja0NoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICAvLyDliIbpobXkuovku7ZcclxuICAgIEBPdXRwdXQoKSBwYWdlQ2hhbmdlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBwYWdlU2l6ZUNoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgLyoqIOW9k+WJjeWxleekuuWIl+ihqOaVsOaNriAqL1xyXG4gICAgY3VycmVudERhdGEgPSBbXTtcclxuXHJcbiAgICAvKiog6YCJ5Lit55qE5YiX6KGo5pWw57uEICovXHJcbiAgICBzZWxlY3REYXRhTGlzdCA9IFtdO1xyXG4gICAgLyoqIOi3qOmhteWkmumAieiusOW9lSAqL1xyXG4gICAgc2VsZWN0RGF0YUxpc3RXaXRoT3RoZXJQYWdlciA9IFtdO1xyXG5cclxuICAgIC8vIOW9k+WJjeeCueWHu1xyXG4gICAgcHVibGljIGNsaWNrSXRlbTogYW55O1xyXG5cclxuICAgIHB1YmxpYyBtYXhTaXplID0gNztcclxuICAgIHB1YmxpYyBkaXJlY3Rpb25MaW5rcyA9IHRydWU7XHJcbiAgICBwdWJsaWMgYXV0b0hpZGUgPSBmYWxzZTtcclxuICAgIHB1YmxpYyByZXNwb25zaXZlID0gdHJ1ZTtcclxuICAgIHB1YmxpYyBwYWdpbmF0aW9uT3B0aW9uczogUGFnaW5hdGlvbkluc3RhbmNlID0ge1xyXG4gICAgICAgIGlkOiAnRmFycmlzLWxpc3RWaWV3LVBhZ2luYXRpb24nLFxyXG4gICAgICAgIGl0ZW1zUGVyUGFnZTogdGhpcy5wYWdlU2l6ZSxcclxuICAgICAgICBjdXJyZW50UGFnZTogdGhpcy5wYWdlSW5kZXgsXHJcbiAgICAgICAgcGFnZUxpc3Q6IHRoaXMucGFnZUxpc3QsXHJcbiAgICAgICAgdG90YWxJdGVtczogdGhpcy50b3RhbFxyXG4gICAgfTtcclxuXHJcbiAgICBwdWJsaWMgbGFiZWxzOiBhbnkgPSB7XHJcbiAgICAgICAgcHJldmlvdXNMYWJlbDogJyAnLFxyXG4gICAgICAgIG5leHRMYWJlbDogJyAnLFxyXG4gICAgICAgIHNjcmVlblJlYWRlclBhZ2luYXRpb25MYWJlbDogJ1BhZ2luYXRpb24nLFxyXG4gICAgICAgIHNjcmVlblJlYWRlclBhZ2VMYWJlbDogJ3BhZ2UnLFxyXG4gICAgICAgIHNjcmVlblJlYWRlckN1cnJlbnRMYWJlbDogYFlvdSdyZSBvbiBwYWdlYFxyXG4gICAgfTtcclxuXHJcbiAgICBtb3VzZUluU2VsZWN0ZWRMaXN0ID0gZmFsc2U7XHJcbiAgICBvcGVuU2VsZWN0ZWRMaXN0ID0gZmFsc2U7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGVsOiBFbGVtZW50UmVmLCBwcml2YXRlIHJlbmRlcmVyOiBSZW5kZXJlcjIsIHByaXZhdGUgY2RyOiBDaGFuZ2VEZXRlY3RvclJlZikgeyB9XHJcblxyXG4gICAgbmdPbkluaXQoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY3VycmVudERhdGEgPSB0aGlzLmRhdGE7XHJcbiAgICAgICAgdGhpcy5kYXRhSW5pdCgpO1xyXG4gICAgICAgIHRoaXMucGFnaW5hdGlvbk9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIGlkOiAnRmFycmlzLWxpc3RWaWV3LVBhZ2luYXRpb24nLFxyXG4gICAgICAgICAgICBpdGVtc1BlclBhZ2U6IHRoaXMucGFnZVNpemUsXHJcbiAgICAgICAgICAgIGN1cnJlbnRQYWdlOiB0aGlzLnBhZ2VJbmRleCxcclxuICAgICAgICAgICAgcGFnZUxpc3Q6IHRoaXMucGFnZUxpc3QsXHJcbiAgICAgICAgICAgIHRvdGFsSXRlbXM6IHRoaXMudG90YWwsXHJcbiAgICAgICAgICAgIHJlbW90ZTogdGhpcy5wYWdlck9uU2VydmVyXHJcbiAgICAgICAgfTtcclxuICAgICAgICBpZiAodGhpcy5pZCkge1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2luYXRpb25PcHRpb25zLmlkID0gdGhpcy5wYWdpbmF0aW9uT3B0aW9ucy5pZCArIHRoaXMuaWQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XHJcbiAgICAgICAgaWYgKGNoYW5nZXMuZGF0YSAmJiAhY2hhbmdlcy5kYXRhLmlzRmlyc3RDaGFuZ2UoKSkge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnREYXRhID0gdGhpcy5kYXRhO1xyXG4gICAgICAgICAgICB0aGlzLmRhdGFJbml0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjaGFuZ2VzWyd0b3RhbCddICYmIHRoaXMudG90YWwgJiYgdGhpcy5wYWdpbmF0aW9uT3B0aW9ucykge1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2luYXRpb25PcHRpb25zWyd0b3RhbEl0ZW1zJ10gPSB0aGlzLnRvdGFsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY2hhbmdlc1sncGFnZUluZGV4J10gJiYgdGhpcy5wYWdlSW5kZXggJiYgdGhpcy5wYWdpbmF0aW9uT3B0aW9ucykge1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2luYXRpb25PcHRpb25zWydjdXJyZW50UGFnZSddID0gdGhpcy5wYWdlSW5kZXg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjaGFuZ2VzICYmIGNoYW5nZXMuY2hlY2tWYWx1ZXMgIT09IHVuZGVmaW5lZCAmJiAhY2hhbmdlcy5jaGVja1ZhbHVlcy5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gdGhpcy5kaWZmZXJlbmNlQnkoY2hhbmdlcy5jaGVja1ZhbHVlcy5jdXJyZW50VmFsdWUgfHwgW10sIGNoYW5nZXMuY2hlY2tWYWx1ZXMucHJldmlvdXNWYWx1ZSB8fCBbXSwgdiA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdjtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmIChjaGFuZ2UpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5lbmFibGVNb3JlUGFnZVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tSb3dzKHRoaXMuY2hlY2tWYWx1ZXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY2hhbmdlcy5jaGVja0l0ZW1zICYmICFjaGFuZ2VzLmNoZWNrSXRlbXMuaXNGaXJzdENoYW5nZSgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0RGF0YUxpc3RXaXRoT3RoZXJQYWdlciA9IFsuLi50aGlzLmNoZWNrSXRlbXNdO1xyXG4gICAgICAgICAgICBjb25zdCBpZHMgPSB0aGlzLmNoZWNrSXRlbXMubWFwKG4gPT4gblt0aGlzLmxpc3RpZE5hbWVdKTtcclxuICAgICAgICAgICAgdGhpcy5jaGVja2VkSXRlbXMoaWRzLCBmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcclxuICAgIH1cclxuICAgIG5nQWZ0ZXJDb250ZW50SW5pdCgpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLyoqIOm7mOiupOaQnOe0ouaooeadvyDngrnlh7vmkJzntKIgKi9cclxuICAgIHNlYXJjaExpc3Qoc2VhcmNoRmllbGQpIHtcclxuICAgICAgICBpZiAoc2VhcmNoRmllbGQgIT09ICcnICYmIHRoaXMuZGF0YSAmJiB0aGlzLmRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudERhdGEgPSB0aGlzLmRhdGEuZmlsdGVyKChsaXN0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbGlzdFZhbHVlID0gT2JqZWN0LnZhbHVlcyhsaXN0KTtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdFZhbHVlLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBsaXN0VmFsdWVbaV0gPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpc3RWYWx1ZVtpXS50b1N0cmluZygpLmluY2x1ZGVzKHNlYXJjaEZpZWxkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gbGlzdFZhbHVlW2ldLnRvU3RyaW5nKCkuaW5jbHVkZXMoc2VhcmNoRmllbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnREYXRhID0gdGhpcy5kYXRhO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4geyBsaXN0ZGF0YTogdGhpcy5jdXJyZW50RGF0YSwgc2VhcmNoVmFsdWU6IHNlYXJjaEZpZWxkLCBsZW5ndGg6IHRoaXMuY3VycmVudERhdGEubGVuZ3RoIH1cclxuICAgIH1cclxuXHJcbiAgICAvKiog54K55Ye75p+Q5LiA5YiX5LqL5Lu2ICovXHJcbiAgICBsaXN0U2VsZWN0KGV2ZW50LCBsaXN0SXRlbSwgaW5kZXgsIGNoZWNrQ2hhbmdlRXZlbnQ6IGJvb2xlYW4gPSBmYWxzZSkge1xyXG4gICAgICAgIGlmIChsaXN0SXRlbVsndW5DbGljayddIHx8IGxpc3RJdGVtWydzZWxlY3REaXNhYmxlJ10pIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tDaGFuZ2UuZW1pdCh7IGxpc3RkYXRhOiBsaXN0SXRlbSwgaW5kZXggfSk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm11bHRpcGxlU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobGlzdEl0ZW1bJ2NoZWNrZWQnXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOaUr+aMgeWkmumAiSDliKDpmaTor6XpgInkuK3ooYxcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RJdGVtSW5kZXggPSB0aGlzLnNlbGVjdERhdGFMaXN0LmZpbmRJbmRleCgoaXRlbSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRLZXkoaXRlbSwgaSkgPT09IHRoaXMuZ2V0S2V5KGxpc3RJdGVtLCBpbmRleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdC5zcGxpY2Uoc2VsZWN0SXRlbUluZGV4LCAxKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZURhdGFMaXN0Rm9yTW9yZVBhZ2VyKCdyZW1vdmUnLCBsaXN0SXRlbSk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDmlK/mjIHlpJrpgIkg5o+S5YWl6K+l6YCJ5Lit6KGMXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5zZWxlY3REYXRhTGlzdC5maW5kKCh2YWx1ZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRLZXkodmFsdWUsIGkpID09PSB0aGlzLmdldEtleShsaXN0SXRlbSwgaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghcmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0RGF0YUxpc3QudW5zaGlmdChsaXN0SXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRGF0YUxpc3RGb3JNb3JlUGFnZXIoJ2FwcGVuZCcsIGxpc3RJdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsaXN0SXRlbVsnY2hlY2tlZCddID0gIWxpc3RJdGVtWydjaGVja2VkJ107XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8g5LiN5pSv5oyB5aSa6YCJIOabv+aNouW9k+WJjemAieS4reihjFxyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdC5wdXNoKGxpc3RJdGVtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIWNoZWNrQ2hhbmdlRXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xpY2tJdGVtID0gbGlzdEl0ZW07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5saXN0Q2xpY2suZW1pdCh7IGRhdGE6IHRoaXMuc2VsZWN0RGF0YUxpc3QsIGluZGV4LCBjaGVja0NoYW5nZUV2ZW50IH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5tdWx0aXBsZVNlbGVjdCkge1xyXG4gICAgICAgICAgICBsZXQgaWRzID0gdGhpcy5kYXRhLmZpbHRlcihpdGVtID0+ICEhaXRlbS5jaGVja2VkKS5tYXAoaXRlbSA9PiBpdGVtW3RoaXMubGlzdGlkTmFtZV0pO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5lbmFibGVNb3JlUGFnZVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgaWRzID0gdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyLm1hcChpdGVtID0+IGl0ZW1bdGhpcy5saXN0aWROYW1lXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5vbkNoZWNrVmFsdWVzQ2hhbmdlKGlkcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKiDojrflvpfmr4/kuIDooYxsaXN0IOWUr+S4gOagh+ivhiAqL1xyXG4gICAgZ2V0S2V5KGxpc3QsIGluZGV4KSB7XHJcbiAgICAgICAgaWYgKHRoaXMubGlzdGlkTmFtZSAmJiBsaXN0Lmhhc093blByb3BlcnR5KHRoaXMubGlzdGlkTmFtZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGxpc3RbdGhpcy5saXN0aWROYW1lXTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gaW5kZXg7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKiBjaGVja2JveOeKtuaAgeWPmOWMliAqL1xyXG4gICAgZ2V0U2VsZWN0KGV2ZW50LCBjaGFuZ2VEYXRhLCBpKSB7XHJcbiAgICAgICAgY29uc3Qgc3RhdGUgPSBldmVudC5jaGVja2VkO1xyXG4gICAgICAgIHRoaXMubGlzdFNlbGVjdChzdGF0ZSwgY2hhbmdlRGF0YSwgaSwgdHJ1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIOaOkuW6j+S6i+S7tiAqL1xyXG4gICAgc29ydChzb3J0a2V5TmFtZSwgc29ydFR5cGUgPSAnYXNjJykge1xyXG4gICAgICAgIHRoaXMuY3VycmVudERhdGEuc29ydCh0aGlzLmNvbXBhcmUoc29ydGtleU5hbWUsIHNvcnRUeXBlKSk7XHJcbiAgICAgICAgcmV0dXJuIHsgc29ydFJlc3VsdDogeyBsaXN0ZGF0YTogdGhpcy5jdXJyZW50RGF0YSwgc29ydGtleU5hbWUsIHNvcnRUeXBlIH0gfTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgcHVibGljIHNlbGVjdFJvdyhwcmltYXJ5VmFsdWU6IGFueSkge1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnREYXRhICYmIHRoaXMuY3VycmVudERhdGEubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBjb25zdCByb3cgPSB0aGlzLmN1cnJlbnREYXRhLmZpbmQoaXRlbSA9PiBpdGVtW3RoaXMubGlzdGlkTmFtZV0gPT09IHByaW1hcnlWYWx1ZSk7XHJcbiAgICAgICAgICAgIGlmIChyb3cpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xpY2tJdGVtID0gcm93O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jZHIubWFya0ZvckNoZWNrKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSBjb21wYXJlKEtleU5hbWUsIHR5cGUpIHtcclxuICAgICAgICBpZiAodHlwZSA9PT0gJ2Rlc2MnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAob2JqMSwgb2JqMikgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdmFsMSA9IG9iajFbS2V5TmFtZV07XHJcbiAgICAgICAgICAgICAgICBjb25zdCB2YWwyID0gb2JqMltLZXlOYW1lXTtcclxuICAgICAgICAgICAgICAgIGlmICh2YWwyIDwgdmFsMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAxO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWwyID4gdmFsMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlID09PSAnYXNjJykge1xyXG4gICAgICAgICAgICByZXR1cm4gKG9iajEsIG9iajIpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHZhbDEgPSBvYmoxW0tleU5hbWVdO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdmFsMiA9IG9iajJbS2V5TmFtZV07XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsMiA+IHZhbDEpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsMiA8IHZhbDEpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgeyByZXR1cm4gMDsgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXRJdGVtQWN0aXZlKGl0ZW0pIHtcclxuICAgICAgICAvLyDkuI3nrqHmmK/lkKblvIDlkK/lpJrpgInvvIzlvZPliY3ooYzlj6rmnInkuIDooYxcclxuICAgICAgICBpZiAodGhpcy5saXN0aWROYW1lICYmIHRoaXMuY2xpY2tJdGVtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpdGVtW3RoaXMubGlzdGlkTmFtZV0gPT09IHRoaXMuY2xpY2tJdGVtW3RoaXMubGlzdGlkTmFtZV07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgb25QYWdlQ2hhbmdlKHBhZ2U6IHsgcGFnZUluZGV4OiBudW1iZXIsIHBhZ2VTaXplOiBudW1iZXIgfSkge1xyXG4gICAgICAgIGlmICh0aGlzLnBhZ2VJbmRleCAhPT0gcGFnZS5wYWdlSW5kZXgpIHtcclxuICAgICAgICAgICAgdGhpcy5wYWdlSW5kZXggPSBwYWdlLnBhZ2VJbmRleDtcclxuICAgICAgICAgICAgdGhpcy5wYWdpbmF0aW9uT3B0aW9ucy5jdXJyZW50UGFnZSA9IHBhZ2UucGFnZUluZGV4O1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2VDaGFuZ2VkLmVtaXQoeyBwYWdlSW5mbzogcGFnZSB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25QYWdlU2l6ZUNoYW5nZShwYWdlU2l6ZTogbnVtYmVyKSB7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5wYWdlU2l6ZSAhPT0gcGFnZVNpemUgJiYgdGhpcy50b3RhbCk7XHJcbiAgICAgICAgaWYgKHRoaXMucGFnZVNpemUgIT09IHBhZ2VTaXplICYmIHRoaXMudG90YWwpIHtcclxuICAgICAgICAgICAgdGhpcy5wYWdpbmF0aW9uT3B0aW9ucy5pdGVtc1BlclBhZ2UgPSBwYWdlU2l6ZTtcclxuICAgICAgICAgICAgdGhpcy5wYWdlU2l6ZSA9IHBhZ2VTaXplO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgdG90YWwgPSB0aGlzLnRvdGFsO1xyXG4gICAgICAgICAgICBsZXQgcGFnZUxlbmd0aCA9IE1hdGguZmxvb3IodG90YWwgLyBwYWdlU2l6ZSk7XHJcbiAgICAgICAgICAgIGlmICh0b3RhbCAlIHBhZ2VTaXplID4gMCkge1xyXG4gICAgICAgICAgICAgICAgcGFnZUxlbmd0aCArPSAxO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAocGFnZUxlbmd0aCAmJiB0aGlzLnBhZ2VJbmRleCA+IHBhZ2VMZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFnZUluZGV4ID0gcGFnZUxlbmd0aDtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFnaW5hdGlvbk9wdGlvbnMuY3VycmVudFBhZ2UgPSB0aGlzLnBhZ2VJbmRleDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5wYWdlU2l6ZUNoYW5nZWQuZW1pdCh7IHBhZ2VJbmZvOiB7IHBhZ2VJbmRleDogdGhpcy5wYWdlSW5kZXgsIHBhZ2VTaXplIH0gfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldEN1cnJlbnREYXRhKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnREYXRhO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFNlbGVjdERhdGEoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0RGF0YUxpc3Q7XHJcbiAgICB9XHJcbiAgICAvKiog5pSv5oyB6YeN5paw6K6+572ubGlzdHZpZXfmlbDmja4gKi9cclxuICAgIHNldERhdGEobGlzdHZpZXdEYXRhKSB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50RGF0YSA9IGxpc3R2aWV3RGF0YTtcclxuICAgICAgICB0aGlzLmRhdGEgPSBsaXN0dmlld0RhdGE7XHJcbiAgICAgICAgdGhpcy5kYXRhSW5pdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGRhdGFJbml0KCkge1xyXG4gICAgICAgIGlmICh0aGlzLmRhdGEgJiYgdGhpcy5kYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdERhdGFMaXN0ID0gdGhpcy5kYXRhLmZpbHRlcigobGlzdCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGxpc3RbJ2NoZWNrZWQnXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZUluZGV4ID49IDAgJiYgdGhpcy5hY3RpdmVJbmRleCA8PSAodGhpcy5kYXRhLmxlbmd0aCAtIDEpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhSXRlbSA9IHRoaXMuZGF0YVt0aGlzLmFjdGl2ZUluZGV4XTtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhSXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xpY2tJdGVtID0gZGF0YUl0ZW07XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdC5wdXNoKHRoaXMuY2xpY2tJdGVtKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFjdGl2ZUluZGV4IDwgMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNlbGVjdERhdGFMaXN0Lmxlbmd0aCAmJiAhdGhpcy5tdWx0aXBsZVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0RGF0YUxpc3QucHVzaCh0aGlzLmRhdGFbMF0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGlja0l0ZW0gPSB0aGlzLmRhdGFbMF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMudXBkYXRlRGF0YUxpc3RGb3JNb3JlUGFnZXIoKTtcclxuXHJcblxyXG4gICAgICAgIGlmICh0aGlzLmNkcikge1xyXG4gICAgICAgICAgICB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgdXBkYXRlRGF0YUxpc3RGb3JNb3JlUGFnZXIoYWN0aXZlOiAncmVtb3ZlJ3wnYXBwZW5kJ3wnJyA9ICcnLCBsaXN0SXRlbT86IGFueSwgZW1pdCA9IHRydWUpIHtcclxuICAgICAgICBpZiAodGhpcy5tdWx0aXBsZVNlbGVjdCAmJiB0aGlzLmVuYWJsZU1vcmVQYWdlU2VsZWN0KSB7XHJcblxyXG4gICAgICAgICAgICBpZiAoYWN0aXZlID09PSAncmVtb3ZlJyAmJiBsaXN0SXRlbSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGxpc3RJdGVtKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0RGF0YUxpc3RXaXRoT3RoZXJQYWdlciA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0RGF0YUxpc3RXaXRoT3RoZXJQYWdlci5maWx0ZXIobiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGxpc3RJdGVtID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuW3RoaXMubGlzdGlkTmFtZV0gIT0gbGlzdEl0ZW1bdGhpcy5saXN0aWROYW1lXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5bdGhpcy5saXN0aWROYW1lXSAhPSBsaXN0SXRlbTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0RGF0YUxpc3RXaXRoT3RoZXJQYWdlciA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0RGF0YUxpc3RXaXRoT3RoZXJQYWdlci5maWx0ZXIobiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGlzdEl0ZW0uaW5kZXhPZihhID0+IGFbdGhpcy5saXN0aWROYW1lXSA9PT0gblt0aGlzLmxpc3RpZE5hbWVdKSA9PT0gLTE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChlbWl0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja0l0ZW1zQ2hhbmdlLmVtaXQoe2l0ZW1zOiBbLi4udGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyXSwgaW5zdGFuY2U6IHRoaXN9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aXZlID09PSAnYXBwZW5kJykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGxpc3RJdGVtKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0RGF0YUxpc3RXaXRoT3RoZXJQYWdlciA9IFsuLi50aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXIsIGxpc3RJdGVtXTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyID0gWy4uLnRoaXMuc2VsZWN0RGF0YUxpc3RXaXRoT3RoZXJQYWdlciwgLi4ubGlzdEl0ZW1dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChlbWl0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja0l0ZW1zQ2hhbmdlLmVtaXQoe2l0ZW1zOiBbLi4udGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyXSwgaW5zdGFuY2U6IHRoaXN9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0RGF0YUxpc3RXaXRoT3RoZXJQYWdlciA9IFsuLi50aGlzLnNlbGVjdERhdGFMaXN0XTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0NoZWNrZWRzID0gdGhpcy5zYW1lQnkodGhpcy5jdXJyZW50RGF0YSwgdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyLCAodikgPT4gdlt0aGlzLmxpc3RpZE5hbWVdKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobmV3Q2hlY2tlZHMgJiYgbmV3Q2hlY2tlZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gbmV3Q2hlY2tlZHMuaW5jbHVkZXMoaXRlbVt0aGlzLmxpc3RpZE5hbWVdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKiDlhajpgIkgKi9cclxuICAgIGxpc3RDaGVja0FsbCgpIHtcclxuICAgICAgICBpZiAodGhpcy5tdWx0aXBsZVNlbGVjdCkge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnREYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdCA9IHRoaXMuY3VycmVudERhdGEuZmlsdGVyKChsaXN0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbGlzdFsnY2hlY2tlZCddO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlRGF0YUxpc3RGb3JNb3JlUGFnZXIoJ2FwcGVuZCcsIHRoaXMuY3VycmVudERhdGEpO1xyXG4gICAgICAgICAgICB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKiog5Y+W5raI5YWo6YCJICovXHJcbiAgICBsaXN0Q2hlY2tBbGxDYW5jZWwoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubXVsdGlwbGVTZWxlY3QpIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50RGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdERhdGFMaXN0ID0gW107XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlRGF0YUxpc3RGb3JNb3JlUGFnZXIoJ3JlbW92ZScsIHRoaXMuY3VycmVudERhdGEpO1xyXG4gICAgICAgICAgICB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWLvumAieihjFxyXG4gICAgICogQHBhcmFtIGlkcyBpZHNcclxuICAgICAqL1xyXG4gICAgcHVibGljIGNoZWNrUm93cyhpZHM6IGFueVtdKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMubXVsdGlwbGVTZWxlY3QpIHtcclxuICAgICAgICAgICAgaWYgKCFpZHMgfHwgaWRzLmxlbmd0aCA8IDEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdENoZWNrQWxsQ2FuY2VsKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5kYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaWRzLmluY2x1ZGVzKGl0ZW1bdGhpcy5saXN0aWROYW1lXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyB0aGlzLm9uQ2hlY2tWYWx1ZXNDaGFuZ2UoaWRzKTtcclxuICAgICAgICAgICAgdGhpcy5jZHIubWFya0ZvckNoZWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgb25DaGVja1ZhbHVlc0NoYW5nZShpZHM6IGFueVtdKSB7XHJcbiAgICAgICAgdGhpcy5jaGVja1ZhbHVlc0NoYW5nZS5lbWl0KGlkcyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBkaWZmZXJlbmNlQnkgPSAoYSwgYiwgZm4pID0+IHtcclxuICAgICAgICBjb25zdCBzID0gbmV3IFNldChiLm1hcChmbikpO1xyXG4gICAgICAgIHJldHVybiBhLm1hcChmbikuZmlsdGVyKGVsID0+ICFzLmhhcyhlbCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2FtZUJ5ID0gKGEsIGIsIGZuKSA9PiB7XHJcbiAgICAgICAgY29uc3QgcyA9IG5ldyBTZXQoYi5tYXAoZm4pKTtcclxuICAgICAgICByZXR1cm4gYS5tYXAoZm4pLmZpbHRlcihlbCA9PiBzLmhhcyhlbCkpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBvbk1vdXNlRW50ZXIoJGV2ZW50KSB7XHJcbiAgICAgICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cclxuICAgICAgICB0aGlzLm1vdXNlSW5TZWxlY3RlZExpc3QgPSB0cnVlO1xyXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXIgJiYgdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLm9wZW5TZWxlY3RlZExpc3QgPSAhdGhpcy5vcGVuU2VsZWN0ZWRMaXN0O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMub3BlblNlbGVjdGVkTGlzdCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgY2xvc2VTZWxlY3RlZExpc3QoKSB7XHJcbiAgICAgICAgdGhpcy5vcGVuU2VsZWN0ZWRMaXN0ID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5tb3VzZUluU2VsZWN0ZWRMaXN0ID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKCF0aGlzLmNkclsnZGVzdHJveWVkJ10pIHtcclxuICAgICAgICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvbkRlbFNlbGVjdGVkSXRlbShpZDogYW55KSB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50RGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBpZiAoaXRlbVt0aGlzLmxpc3RpZE5hbWVdID09IGlkKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLnNlbGVjdERhdGFMaXN0ID0gdGhpcy5zZWxlY3REYXRhTGlzdC5maWx0ZXIobiA9PiBuW3RoaXMubGlzdGlkTmFtZV0gIT0gaWQpO1xyXG4gICAgICAgIHRoaXMudXBkYXRlRGF0YUxpc3RGb3JNb3JlUGFnZXIoJ3JlbW92ZScsIGlkKTtcclxuXHJcbiAgICAgICAgdGhpcy51cGRhdGVDaGVja2VkVmFsdWVzKCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG9uQ2xlYXJTZWxlY3RlZCgkZXZlbnQpIHtcclxuICAgICAgICAvLyB0aGlzLmNsZWFyU2VsZWN0ZWRJdGVtLmVtaXQoKTtcclxuICAgICAgICB0aGlzLmNsb3NlU2VsZWN0ZWRMaXN0KCk7XHJcbiAgICAgICAgdGhpcy5saXN0Q2hlY2tBbGxDYW5jZWwoKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyID0gW107XHJcbiAgICAgICAgdGhpcy5jaGVja1ZhbHVlcyA9IFtdO1xyXG4gICAgICAgIHRoaXMub25DaGVja1ZhbHVlc0NoYW5nZShbXSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25TZWxlY3RMaXN0UGFuZWxDbG9zZSgkZXZlbnQpIHtcclxuICAgICAgICB0aGlzLmNsb3NlU2VsZWN0ZWRMaXN0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB1cGRhdGVDaGVja2VkVmFsdWVzKGVtaXQgPSB0cnVlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubXVsdGlwbGVTZWxlY3QpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmVuYWJsZU1vcmVQYWdlU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrVmFsdWVzID0gdGhpcy5zZWxlY3REYXRhTGlzdC5tYXAobiA9PiBuW3RoaXMubGlzdGlkTmFtZV0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja1ZhbHVlcyA9IHRoaXMuc2VsZWN0RGF0YUxpc3RXaXRoT3RoZXJQYWdlci5tYXAobiA9PiBuW3RoaXMubGlzdGlkTmFtZV0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoZW1pdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbkNoZWNrVmFsdWVzQ2hhbmdlKHRoaXMuY2hlY2tWYWx1ZXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja0l0ZW1zQ2hhbmdlLmVtaXQoeyBpdGVtczogdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyLCBpbnN0YW5jZTogdGhpcyB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjbGVhckNoZWNrZWRzKGNsZWFyQWxsID0gdHJ1ZSwgZW1pdCA9IHRydWUpIHtcclxuICAgICAgICBpZiAodGhpcy5tdWx0aXBsZVNlbGVjdCkge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnREYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0RGF0YUxpc3QgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjbGVhckFsbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyID0gW107XHJcbiAgICAgICAgICAgIH0gZWxzZSAge1xyXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVEYXRhTGlzdEZvck1vcmVQYWdlcigncmVtb3ZlJywgdGhpcy5jdXJyZW50RGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChlbWl0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUNoZWNrZWRWYWx1ZXMoZW1pdCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9zZXRJdGVtc0NoZWNrZWRTdGF0dXMoIGlkczogYW55LCBjaGVja2VkOiBib29sZWFuLCBlbWl0OiBib29sZWFuKSB7XHJcbiAgICAgICAgaWYgKGlkcyAmJiBpZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFjdGlvbiA9IGNoZWNrZWQgPyAnYXBwZW5kJzogJ3JlbW92ZSc7XHJcbiAgICAgICAgICAgIGlkcy5mb3JFYWNoKGkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IGlkID0gaTtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgaSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZCA9IGlbdGhpcy5saXN0aWROYW1lXTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5kYXRhLmZpbmQobiA9PiBuW3RoaXMubGlzdGlkTmFtZV0gPT09IGlkKTtcclxuICAgICAgICAgICAgICAgIGlmIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gY2hlY2tlZDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoY2hlY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRGF0YUxpc3RGb3JNb3JlUGFnZXIoJ2FwcGVuZCcsIGksIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVEYXRhTGlzdEZvck1vcmVQYWdlcigncmVtb3ZlJywgaWQsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUNoZWNrZWRWYWx1ZXMoZW1pdCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB1bkNoZWNrSXRlbXMoaWRzOiBudW1iZXJbXSB8IHN0cmluZ1tdIHwgb2JqZWN0W10sIGVtaXQgPSBmYWxzZSkge1xyXG4gICAgICAgIHRoaXMuX3NldEl0ZW1zQ2hlY2tlZFN0YXR1cyhpZHMsIGZhbHNlLCBlbWl0KTtcclxuICAgIH1cclxuXHJcbiAgICBjaGVja2VkSXRlbXMoaWRzOiBvYmplY3RbXSwgZW1pdCA9IGZhbHNlKSB7XHJcbiAgICAgICAgdGhpcy5fc2V0SXRlbXNDaGVja2VkU3RhdHVzKGlkcywgdHJ1ZSwgZW1pdCk7XHJcbiAgICB9XHJcblxyXG59XHJcblxyXG5cclxuXHJcbiJdfQ==