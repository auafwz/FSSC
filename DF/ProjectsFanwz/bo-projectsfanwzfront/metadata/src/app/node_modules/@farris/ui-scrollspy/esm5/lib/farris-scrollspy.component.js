/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, ElementRef, Directive, TemplateRef, ContentChild, ViewChild, ChangeDetectorRef } from '@angular/core';
import { FarrisScrollSpyService } from './farris-scrollspy.service';
import { getUuid } from './utils';
var ScrollspyItemTemplateDirective = /** @class */ (function () {
    function ScrollspyItemTemplateDirective(template) {
        this.template = template;
    }
    ScrollspyItemTemplateDirective.decorators = [
        { type: Directive, args: [{
                    selector: '[scrollspyItem]'
                },] }
    ];
    /** @nocollapse */
    ScrollspyItemTemplateDirective.ctorParameters = function () { return [
        { type: TemplateRef }
    ]; };
    return ScrollspyItemTemplateDirective;
}());
export { ScrollspyItemTemplateDirective };
if (false) {
    /** @type {?} */
    ScrollspyItemTemplateDirective.prototype.template;
}
/**
 * @record
 */
export function scrollspyData() { }
if (false) {
    /** @type {?} */
    scrollspyData.prototype.id;
    /** @type {?} */
    scrollspyData.prototype.title;
    /** @type {?|undefined} */
    scrollspyData.prototype.visible;
}
/**
 * @record
 */
function SpyListFollowTypeChange() { }
if (false) {
    /** @type {?} */
    SpyListFollowTypeChange.prototype.prev;
    /** @type {?} */
    SpyListFollowTypeChange.prototype.next;
}
var ScrollspyComponent = /** @class */ (function () {
    function ScrollspyComponent(elementRef, scrollSpy, changeDetector) {
        this.elementRef = elementRef;
        this.scrollSpy = scrollSpy;
        this.changeDetector = changeDetector;
        /**
         * 当前滚动所有group
         */
        this.scrollGroupId = getUuid();
        /**
         * 当前滚动显示样式，默认 side 可选参数 tab、fixedTab
         */
        this._followType = 'side';
        // 记录状态改变
        this._emitFollowType = null;
        this.sidetabWidth = 145;
    }
    Object.defineProperty(ScrollspyComponent.prototype, "fFollowType", {
        get: /**
         * @return {?}
         */
        function () {
            return this._followType;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (value !== this._followType) {
                this._emitFollowType = {
                    prev: this._followType,
                    next: value
                };
                this.changeFollowType();
                this._followType = value;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ScrollspyComponent.prototype, "scrollspyData", {
        get: /**
         * @return {?}
         */
        function () {
            return this._scrollspyData;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (value) {
                this._scrollspyData = value.filter((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    if (item.hasOwnProperty('visible') && !item.visible) {
                        return false;
                    }
                    else {
                        return true;
                    }
                }));
                if (this._scrollspyData && this._scrollspyData.length && !this.currentSectionId) {
                    this.currentSectionId = this._scrollspyData[0].id;
                }
                this.scrollSpy.setCurrentSectionIdObj(this.scrollGroupId, this.currentSectionId);
                // console.log(this._scrollspyData);
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ScrollspyComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        // if(this.scrollspyData && this.scrollspyData.length && !this.currentSectionId ){
        //   this.currentSectionId = this.scrollspyData[0].id;
        // }
        // this.scrollSpy.setCurrentSectionIdObj(this.scrollGroupId, this.currentSectionId);
        // console.log(this.scrollGroupId);
        this.scrollSpy.setGroupId(this.scrollGroupId);
        this.changeFollowType();
        // 获取当前Section的Id
        this.scrollSpy.getCurrentSectionId(this.scrollGroupId).subscribe((/**
         * @param {?} currentId
         * @return {?}
         */
        function (currentId) {
            _this.currentSectionId = currentId;
            _this.scrollSpy.updateScrollSpiesActiveClsName(_this.scrollGroupId, currentId);
            //console.log(this.scrollGroupId,this.currentSectionId);
        }));
        // 获取对应Container区域，在滚动时的当前Section的变化
        this.scrollSpy.updateScrollGroup(this.scrollGroupId).subscribe((/**
         * @param {?} currentSection
         * @return {?}
         */
        function (currentSection) {
            //console.log('111',currentSection);
            _this.scrollSpy.setCurrentSectionId(_this.scrollGroupId, currentSection);
            //this.changeDetector.markForCheck();
        }));
    };
    // 改变FollowType时
    // 改变FollowType时
    /**
     * @return {?}
     */
    ScrollspyComponent.prototype.changeFollowType = 
    // 改变FollowType时
    /**
     * @return {?}
     */
    function () {
        if (this.scrollGroupId && this._emitFollowType) {
            this.scrollSpy.changeGroupIdFollowType(this.scrollGroupId, this._emitFollowType);
            this._emitFollowType = null;
        }
    };
    /**
     * @return {?}
     */
    ScrollspyComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        /**
         * 当滚动位置为side时，该组件最近父节点添加relative定位
         * @type {?}
         */
        var parent = this.elementRef.nativeElement.parentElement;
        if (!parent.style.position && parent.style.position !== 'relative' && this.fFollowType === 'side') {
            parent.style.position = 'relative';
        }
        // if(this.scrollspyData && this.scrollspyData.length && this.currentSectionId){
        //   if(this.currentSectionId !== this.scrollspyData[0].id){
        //     console.log(222);
        //     const element = this.scrollyspyListEl.nativeElement.querySelector("#scrollspy-"+this.currentSectionId);
        //     const follow = {
        //       element: element,
        //       id: this.currentSectionId
        //     };
        //     const groupId = this.scrollGroupId ? this.scrollGroupId: 'default';
        //     this.scrollSpy.fScrollFollowClick(groupId,follow);
        //   }
        // }
    };
    ScrollspyComponent.decorators = [
        { type: Component, args: [{
                    selector: 'farris-scrollspy',
                    template: "<div class=\"f-scrollspy\" [ngClass]=\"{'f-scrollspy-sidetabs': fFollowType === 'side' && !scrollspyTemplate,'f-scrollspy-tabs': fFollowType === 'tab' ||fFollowType === 'fixedTab' && !scrollspyTemplate,'f-scrollspy-fixedTab':fFollowType === 'fixedTab'}\">\r\n    <ng-container *ngIf=\"fFollowType === 'side' && !scrollspyTemplate\">\r\n        <div class=\"f-scrollspy-sidetabs-inner\" [ngStyle]=\"{'width': (fFollowType === 'side' && !scrollspyTemplate)? sidetabWidth/16 + 'rem': '','transform': (fFollowType === 'side' && !scrollspyTemplate)? 'translateX('+(sidetabWidth/16 + 'rem') +')' : ''}\">\r\n            <ng-container [ngTemplateOutlet]=\"scrollspyListTemplate\"></ng-container>\r\n        </div>\r\n        <div class=\"f-scrollspy-monitor-tip\">\r\n            <div class=\"f-scrollspy-monitor-tip-inner\">\r\n                <span class=\"f-icon f-icon-navigation\"></span>\r\n                <span class=\"f-scrollspy-monitor-tip-text\">{{ 'scrollspy.guide' | locale }}</span>\r\n                <span class=\"f-scrollspy-monitor-tip-img\">\r\n                </span>\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-container *ngIf=\"fFollowType === 'tab'||fFollowType === 'fixedTab' || scrollspyTemplate\">\r\n        <ng-container [ngTemplateOutlet]=\"scrollspyListTemplate\"></ng-container>\r\n    </ng-container>\r\n</div>\r\n\r\n\r\n<ng-template #scrollspyListTemplate>\r\n    <ul #scrollyspyList class=\"f-scrollspy-monitor-list\">\r\n        <li class=\"f-scrollspy-monitor-btn\" \r\n        *ngFor=\"let tab of scrollspyData;let i = index;let first = first;let last = last;\"\r\n        [class.active]=\"tab['id'] === currentSectionId\" \r\n        [fScrollFollowElement]=\"tab['id']\"\r\n        [fScrollElement]=\"scrollGroupId\"\r\n        [id]=\"'scrollspy-'+tab['id']\"\r\n        [title]=\"tab.title\">\r\n            <ng-container *ngIf=\"!scrollspyTemplate;else scrollElement\">\r\n                <span class=\"f-scrollspy-monitor-title\">{{tab.title}}</span>\r\n            </ng-container>\r\n            <ng-template #scrollElement>\r\n                <ng-container [ngTemplateOutlet]=\"scrollspyTemplate\" [ngTemplateOutletContext]=\"{scrollItem:tab,first:first,last:last,index:i}\"></ng-container>\r\n            </ng-template>\r\n        </li>\r\n    </ul>\r\n</ng-template>",
                    styles: [".f-scrollspy .f-scrollspy-monitor-btn{display:inline-block}.f-scrollspy-sidetabs{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-align:center;align-items:center;position:absolute;top:0;right:0;z-index:999;overflow:hidden;width:1.75rem;-webkit-transition:width .5s;transition:width .5s}.f-scrollspy-sidetabs .f-scrollspy-sidetabs-inner{-webkit-transition:.5s;transition:.5s;min-height:115px;background:#fff;box-shadow:0 2px 6px 0 rgba(57,66,100,.14);border-radius:4px 0 0 4px;overflow:hidden}.f-scrollspy-sidetabs:hover{width:auto}.f-scrollspy-sidetabs:hover .f-scrollspy-sidetabs-inner{-webkit-transform:translateX(0)!important;transform:translateX(0)!important}.f-scrollspy-sidetabs:hover .f-scrollspy-monitor-tip{border-radius:0}.f-scrollspy-sidetabs .f-scrollspy-monitor-btn{position:relative;width:100%;height:1.3125rem;padding-left:1.1875rem;margin-bottom:.75rem}.f-scrollspy-sidetabs .f-scrollspy-monitor-btn::before{content:\"\";position:absolute;left:0;top:1rem;height:2rem;width:1px;border-left:1px dashed #e9e9e9;background-color:transparent;border-radius:.5px;z-index:8}.f-scrollspy-sidetabs .f-scrollspy-monitor-btn:last-child{margin-bottom:0}.f-scrollspy-sidetabs .f-scrollspy-monitor-btn:last-child::before{display:none}.f-scrollspy-sidetabs .f-scrollspy-monitor-btn::after{content:\"\";position:absolute;left:-.4375rem;top:.1875rem;width:.9375rem;height:.9375rem;border-radius:100%;z-index:9}.f-scrollspy-sidetabs .f-scrollspy-monitor-btn .f-scrollspy-monitor-title{display:inline-block;font-size:.875rem;color:rgba(0,0,0,.55);line-height:1.3125rem;cursor:pointer;width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.f-scrollspy-sidetabs .f-scrollspy-monitor-btn.active .f-scrollspy-monitor-title{color:rgba(0,0,0,.65);font-weight:600}.f-scrollspy-sidetabs .f-scrollspy-monitor-tip{position:absolute;right:0;top:0;bottom:0;width:1.75rem;border-radius:4px 0 0 4px}.f-scrollspy-sidetabs .f-scrollspy-monitor-tip-inner{position:relative;width:100%;height:100%;padding-top:.625rem}.f-scrollspy-sidetabs .f-scrollspy-monitor-tip-inner .f-scrollspy-monitor-tip-img{position:absolute;left:0;bottom:0;width:1.75rem;height:2.9375rem;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAABeCAYAAAB2K9dZAAAABGdBTUEAALGPC/xhBQAABC5JREFUeAHtm2tT1DAUhlnviooiIKDAAjri+NH//3tERERQRBTX99lpdnZLgZLTNOlOzsyZtKXJnidvm2uZGQwGs/JbM1Nqd8S1A5sgT5WcyH/Kj3q9HuedNwCdPdABPs8FAZ8pOZZ/xwX8T2nnbBywHPw9XXhR+LmAD3V8ID8W7EBpJ+wqwHGA2zpxsGeC3dP5vkDPx29K8binYD96BsYjuy/fE+hvzzKCZ6urYFUgtLxL8kVV0helnwT6t+rGmNcsgC7ung4AXRDortLPAk2mQWqy/6OsVfkHgc4pTcKaBHRAtL5vBLkpv+suxkpDADoW+lPUfOYuxEhDAsJD97ItyDV56N+qrL+2fpRG6J0g71dGEfBiW4AgPJK/F+STgDwXim4TkB/nkX0rSEZFrVjbgEDRb/YFSZcS3GIAOqgVQa65k1BpTECYlkJDxgZ0kOvTqqDjYsAe5J1MQUEHyTvZeOuaEiCgG4J86oibSFMDpAvZEmRjI57UABGNwQAzEWDNliIgULPy12Y6FZAqIGz0keaJc8qAQG4IkkfW21IHZEXglTedMqYOCBuDgMe+kF0AhG1dkF6talcAHwrSa5TTxLqo79Nz03yrUvGgzpqr7kO45/K5LgHS4LC2w+JypRVgC/rjsny4ZNklQKCWBcFeyMTKeQG2WIBNME2cUELiRp+IQuxuDU1wvJ9bcvY2L1hXGpnxwBnhDFtUpcDuyCvhyISCK3K2q38VqZKkjZnGvOCYVg13o6+KFkDGe27Mx84toPixPNV9+r5iq2XldxDpWaDF6XfY2PwmP5JPvNg674SVActB8zjQ5L6UA/lVzscJnbHrAB0IyrpHmQ8R2LruhKI+rSgv9nYBrCRt8wGEiP6I1rcvj77JqRguNV9AVyD9z6acJYYkzQoIFGWwx3Btn8TNbVsTgC5mBsLMvmmQkrEmAYFic7OR1bCmaqhpQOLifTStozQFRzkhACkXJRkgRLdQgIDx+QjvZVQLCQgYLav3ilgTNRMakBgZEJgWby2gbQC6UY8lTu+8bQASHI+pm3N6B+uTse5swqfsch6mXEyi68xCUJ2P+khdjHxdzPeo+B95LXOZa91svImnhUaHqVaVMa6le6EfvXSNpcgI5I/C+S+BS78hbxOQ2ABkPjmuIqtiLB7dZMBO3HRDOLBU2qH8grUNOK4ixwwGrHvyMFAOlbcrP5GPrK1GZvSDOiAQVOvLrXAqYmS8s+tyVB1ZDEB+c0NOQCEMNUfDxBiAIaDKZaLiELLtd7AcSMhzIE+nVUFXccvTDhhsPuhqMHqaFYwugTGArKCxAqNnzwpGl8AYQFbQWIHRs2cFo0tgDCAraKzA6NmzgtElMAaQFTRWYPTsWcHoEhgDyAoaKzB69qxgdAmMAWQFjRUYPXtWMLoExgCygsYKjJ596hX8D3/gzAAeM1fWAAAAAElFTkSuQmCC);background-size:100%}.f-scrollspy-sidetabs .f-scrollspy-monitor-tip-inner .f-icon{display:block;margin:0 auto .625rem;font-size:.875rem;color:#fff}.f-scrollspy-sidetabs .f-scrollspy-monitor-tip-inner .f-scrollspy-monitor-tip-text{display:block;width:.75rem;margin:0 auto;font-size:.875rem;line-height:1.25rem;color:#fff;text-align:center;text-shadow:0 1px 4px rgba(0,0,0,.06);word-wrap:break-word}.f-scrollspy-sidetabs .f-scrollspy-sidetabs-inner .f-scrollspy-monitor-list{padding:.75rem 3rem .875rem 1.25rem;-webkit-transition:.5s;transition:.5s}.f-scrollspy-tabs{flex-shrink:0;background-color:#fff;box-shadow:0 1px 5px 0 rgba(0,28,64,.06);border-radius:2px;padding:0 .125rem}.f-scrollspy-tabs .f-scrollspy-monitor-btn{position:relative;display:-webkit-inline-box;display:inline-flex;height:2.75rem;line-height:2.75rem;padding:0 .875rem;cursor:pointer;min-width:5.75rem;white-space:nowrap;-webkit-box-pack:center;justify-content:center}.f-scrollspy-tabs .f-scrollspy-monitor-btn .f-scrollspy-monitor-title{white-space:nowrap;font-size:1rem}.f-scrollspy-tabs .f-scrollspy-monitor-btn::after{content:\"\";position:absolute;left:50%;margin-left:-.625rem;bottom:.3125rem;width:1.25rem;height:.1875rem;border-radius:7.125rem}"]
                }] }
    ];
    /** @nocollapse */
    ScrollspyComponent.ctorParameters = function () { return [
        { type: ElementRef },
        { type: FarrisScrollSpyService },
        { type: ChangeDetectorRef }
    ]; };
    ScrollspyComponent.propDecorators = {
        scrollspyTemplate: [{ type: ContentChild, args: [ScrollspyItemTemplateDirective, { read: TemplateRef },] }],
        currentSectionId: [{ type: Input }],
        scrollGroupId: [{ type: Input }],
        fFollowType: [{ type: Input }],
        sidetabWidth: [{ type: Input }],
        scrollyspyListEl: [{ type: ViewChild, args: ["scrollyspyList",] }],
        scrollspyData: [{ type: Input }]
    };
    return ScrollspyComponent;
}());
export { ScrollspyComponent };
if (false) {
    /** @type {?} */
    ScrollspyComponent.prototype.scrollspyTemplate;
    /**
     * 当前active部分id
     * @type {?}
     */
    ScrollspyComponent.prototype.currentSectionId;
    /**
     * 当前滚动所有group
     * @type {?}
     */
    ScrollspyComponent.prototype.scrollGroupId;
    /**
     * 当前滚动显示样式，默认 side 可选参数 tab、fixedTab
     * @type {?}
     * @private
     */
    ScrollspyComponent.prototype._followType;
    /**
     * @type {?}
     * @private
     */
    ScrollspyComponent.prototype._emitFollowType;
    /** @type {?} */
    ScrollspyComponent.prototype.sidetabWidth;
    /** @type {?} */
    ScrollspyComponent.prototype.scrollyspyListEl;
    /** @type {?} */
    ScrollspyComponent.prototype._scrollspyData;
    /**
     * @type {?}
     * @private
     */
    ScrollspyComponent.prototype.elementRef;
    /**
     * @type {?}
     * @private
     */
    ScrollspyComponent.prototype.scrollSpy;
    /**
     * @type {?}
     * @private
     */
    ScrollspyComponent.prototype.changeDetector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmFycmlzLXNjcm9sbHNweS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLXNjcm9sbHNweS8iLCJzb3VyY2VzIjpbImxpYi9mYXJyaXMtc2Nyb2xsc3B5LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxLQUFLLEVBQUUsVUFBVSxFQUE0QixTQUFTLEVBQUUsV0FBVyxFQUFFLFlBQVksRUFBRSxTQUFTLEVBQUUsaUJBQWlCLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDbEssT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFFcEUsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLFNBQVMsQ0FBQztBQUVsQztJQUlJLHdDQUFtQixRQUEwQjtRQUExQixhQUFRLEdBQVIsUUFBUSxDQUFrQjtJQUFHLENBQUM7O2dCQUpwRCxTQUFTLFNBQUM7b0JBQ1AsUUFBUSxFQUFFLGlCQUFpQjtpQkFDNUI7Ozs7Z0JBUGlGLFdBQVc7O0lBVTdGLHFDQUFDO0NBQUEsQUFMSCxJQUtHO1NBRlksOEJBQThCOzs7SUFDN0Isa0RBQWlDOzs7OztBQUdqRCxtQ0FJRzs7O0lBSEMsMkJBQWE7O0lBQ2IsOEJBQWdCOztJQUNoQixnQ0FBbUI7Ozs7O0FBR3ZCLHNDQUdDOzs7SUFGQyx1Q0FBWTs7SUFDWix1Q0FBVzs7QUFHYjtJQWdFSSw0QkFBcUIsVUFBc0IsRUFBVSxTQUFpQyxFQUFTLGNBQWlDO1FBQTNHLGVBQVUsR0FBVixVQUFVLENBQVk7UUFBVSxjQUFTLEdBQVQsU0FBUyxDQUF3QjtRQUFTLG1CQUFjLEdBQWQsY0FBYyxDQUFtQjs7OztRQWpEdkgsa0JBQWEsR0FBVSxPQUFPLEVBQUUsQ0FBQzs7OztRQUVsQyxnQkFBVyxHQUFDLE1BQU0sQ0FBQzs7UUFFbkIsb0JBQWUsR0FBeUIsSUFBSSxDQUFDO1FBZ0I1QyxpQkFBWSxHQUFVLEdBQUcsQ0FBQztJQTZCbUcs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dCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIEVsZW1lbnRSZWYsIEFmdGVyVmlld0luaXQsIE9uRGVzdHJveSwgRGlyZWN0aXZlLCBUZW1wbGF0ZVJlZiwgQ29udGVudENoaWxkLCBWaWV3Q2hpbGQsIENoYW5nZURldGVjdG9yUmVmfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgRmFycmlzU2Nyb2xsU3B5U2VydmljZSB9IGZyb20gJy4vZmFycmlzLXNjcm9sbHNweS5zZXJ2aWNlJztcclxuaW1wb3J0IHsgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBnZXRVdWlkIH0gZnJvbSAnLi91dGlscyc7XHJcblxyXG5ARGlyZWN0aXZlKHtcclxuICAgIHNlbGVjdG9yOiAnW3Njcm9sbHNweUl0ZW1dJ1xyXG4gIH0pXHJcbiAgZXhwb3J0IGNsYXNzIFNjcm9sbHNweUl0ZW1UZW1wbGF0ZURpcmVjdGl2ZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgdGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT4pIHt9XHJcbiAgfVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBzY3JvbGxzcHlEYXRhIHtcclxuICAgIFwiaWRcIjogc3RyaW5nLFxyXG4gICAgXCJ0aXRsZVwiOiBzdHJpbmcsXHJcbiAgICBcInZpc2libGVcIj86IGJvb2xlYW5cclxuICB9XHJcbi8vIOa7muWKqOebkeWQrOWIl+ihqO+8jOaYvuekuuaooeW8j+aUueWPmO+8jOaKm+WHuuS6i+S7tue7k+aehFxyXG5pbnRlcmZhY2UgU3B5TGlzdEZvbGxvd1R5cGVDaGFuZ2V7XHJcbiAgcHJldjpzdHJpbmcsXHJcbiAgbmV4dDpzdHJpbmdcclxufVxyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdmYXJyaXMtc2Nyb2xsc3B5JyxcclxuICB0ZW1wbGF0ZVVybDonLi9mYXJyaXMtc2Nyb2xsc3B5LmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6W1xyXG4gICAgJy4vZmFycmlzLXNjcm9sbHNweS5jb21wb25lbnQuc2NzcydcclxuICBdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBTY3JvbGxzcHlDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsQWZ0ZXJWaWV3SW5pdCB7XHJcblxyXG4gICAgQENvbnRlbnRDaGlsZChTY3JvbGxzcHlJdGVtVGVtcGxhdGVEaXJlY3RpdmUsIHtyZWFkOiBUZW1wbGF0ZVJlZn0pIHNjcm9sbHNweVRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gICAgLyoq5rua5Yqo5pWw5o2u5YiX6KGoICovXHJcbiAgICAvLyBASW5wdXQoKSBzY3JvbGxzcHlEYXRhOnNjcm9sbHNweURhdGFbXTtcclxuICAgIC8qKuW9k+WJjWFjdGl2ZemDqOWIhmlkICovXHJcbiAgICBASW5wdXQoKSBjdXJyZW50U2VjdGlvbklkOnN0cmluZztcclxuICAgIC8qKuW9k+WJjea7muWKqOaJgOaciWdyb3VwICovXHJcbiAgICBASW5wdXQoKSBzY3JvbGxHcm91cElkOnN0cmluZyA9IGdldFV1aWQoKTtcclxuICAgIC8qKuW9k+WJjea7muWKqOaYvuekuuagt+W8j++8jOm7mOiupCBzaWRlIOWPr+mAieWPguaVsCB0YWLjgIFmaXhlZFRhYiAqL1xyXG4gICAgcHJpdmF0ZSBfZm9sbG93VHlwZT0nc2lkZSc7XHJcbiAgICAvLyDorrDlvZXnirbmgIHmlLnlj5hcclxuICAgIHByaXZhdGUgX2VtaXRGb2xsb3dUeXBlOlNweUxpc3RGb2xsb3dUeXBlQ2hhbmdlPW51bGw7XHJcbiAgICBASW5wdXQoKSBcclxuICAgIHNldCBmRm9sbG93VHlwZSh2YWx1ZTpzdHJpbmcpe1xyXG4gICAgICBpZih2YWx1ZSE9PXRoaXMuX2ZvbGxvd1R5cGUpe1xyXG4gICAgICAgIHRoaXMuX2VtaXRGb2xsb3dUeXBlPXtcclxuICAgICAgICAgIHByZXY6dGhpcy5fZm9sbG93VHlwZSxcclxuICAgICAgICAgIG5leHQ6dmFsdWVcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuY2hhbmdlRm9sbG93VHlwZSgpO1xyXG4gICAgICAgIHRoaXMuX2ZvbGxvd1R5cGU9dmFsdWU7XHJcbiAgICAgIH1cclxuICAgIH0gICAgXHJcbiAgICBnZXQgZkZvbGxvd1R5cGUoKTpzdHJpbmd7XHJcbiAgICAgIHJldHVybiB0aGlzLl9mb2xsb3dUeXBlO1xyXG4gICAgfVxyXG5cclxuICAgIEBJbnB1dCgpIHNpZGV0YWJXaWR0aDpudW1iZXIgPSAxNDU7XHJcblxyXG4gICAgQFZpZXdDaGlsZChcInNjcm9sbHlzcHlMaXN0XCIpIHNjcm9sbHlzcHlMaXN0RWw7XHJcblxyXG4gICAgX3Njcm9sbHNweURhdGE6c2Nyb2xsc3B5RGF0YVtdO1xyXG5cclxuICAgIEBJbnB1dCgpXHJcbiAgICBzZXQgc2Nyb2xsc3B5RGF0YSh2YWx1ZSl7XHJcbiAgICAgIGlmKHZhbHVlKXtcclxuICAgICAgICB0aGlzLl9zY3JvbGxzcHlEYXRhID0gdmFsdWUuZmlsdGVyKChpdGVtKSA9PntcclxuICAgICAgICAgIGlmKGl0ZW0uaGFzT3duUHJvcGVydHkoJ3Zpc2libGUnKSAmJiAhaXRlbS52aXNpYmxlKXtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBpZih0aGlzLl9zY3JvbGxzcHlEYXRhICYmIHRoaXMuX3Njcm9sbHNweURhdGEubGVuZ3RoICYmICF0aGlzLmN1cnJlbnRTZWN0aW9uSWQgKXtcclxuICAgICAgICAgIHRoaXMuY3VycmVudFNlY3Rpb25JZCA9IHRoaXMuX3Njcm9sbHNweURhdGFbMF0uaWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2Nyb2xsU3B5LnNldEN1cnJlbnRTZWN0aW9uSWRPYmoodGhpcy5zY3JvbGxHcm91cElkLCB0aGlzLmN1cnJlbnRTZWN0aW9uSWQpO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuX3Njcm9sbHNweURhdGEpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXQgc2Nyb2xsc3B5RGF0YSgpe1xyXG4gICAgICByZXR1cm4gdGhpcy5fc2Nyb2xsc3B5RGF0YTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgY29uc3RydWN0b3IoIHByaXZhdGUgZWxlbWVudFJlZjogRWxlbWVudFJlZiwgcHJpdmF0ZSBzY3JvbGxTcHk6IEZhcnJpc1Njcm9sbFNweVNlcnZpY2UscHJpdmF0ZSBjaGFuZ2VEZXRlY3RvcjogQ2hhbmdlRGV0ZWN0b3JSZWYsICkgeyB9XHJcblxyXG4gICAgbmdPbkluaXQoKSB7XHJcbiAgICAgIC8vIGlmKHRoaXMuc2Nyb2xsc3B5RGF0YSAmJiB0aGlzLnNjcm9sbHNweURhdGEubGVuZ3RoICYmICF0aGlzLmN1cnJlbnRTZWN0aW9uSWQgKXtcclxuICAgICAgLy8gICB0aGlzLmN1cnJlbnRTZWN0aW9uSWQgPSB0aGlzLnNjcm9sbHNweURhdGFbMF0uaWQ7XHJcbiAgICAgIC8vIH1cclxuICAgICAgLy8gdGhpcy5zY3JvbGxTcHkuc2V0Q3VycmVudFNlY3Rpb25JZE9iaih0aGlzLnNjcm9sbEdyb3VwSWQsIHRoaXMuY3VycmVudFNlY3Rpb25JZCk7XHJcbiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuc2Nyb2xsR3JvdXBJZCk7XHJcbiAgICAgIHRoaXMuc2Nyb2xsU3B5LnNldEdyb3VwSWQodGhpcy5zY3JvbGxHcm91cElkKTtcclxuICAgICAgdGhpcy5jaGFuZ2VGb2xsb3dUeXBlKCk7XHJcbiAgICAgIC8vIOiOt+WPluW9k+WJjVNlY3Rpb27nmoRJZFxyXG4gICAgICB0aGlzLnNjcm9sbFNweS5nZXRDdXJyZW50U2VjdGlvbklkKHRoaXMuc2Nyb2xsR3JvdXBJZCkuc3Vic2NyaWJlKChjdXJyZW50SWQpPT57XHJcbiAgICAgICAgdGhpcy5jdXJyZW50U2VjdGlvbklkID0gY3VycmVudElkO1xyXG4gICAgICAgIHRoaXMuc2Nyb2xsU3B5LnVwZGF0ZVNjcm9sbFNwaWVzQWN0aXZlQ2xzTmFtZSh0aGlzLnNjcm9sbEdyb3VwSWQsY3VycmVudElkKTtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMuc2Nyb2xsR3JvdXBJZCx0aGlzLmN1cnJlbnRTZWN0aW9uSWQpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIOiOt+WPluWvueW6lENvbnRhaW5lcuWMuuWfn++8jOWcqOa7muWKqOaXtueahOW9k+WJjVNlY3Rpb27nmoTlj5jljJZcclxuICAgICAgdGhpcy5zY3JvbGxTcHkudXBkYXRlU2Nyb2xsR3JvdXAodGhpcy5zY3JvbGxHcm91cElkKS5zdWJzY3JpYmUoKGN1cnJlbnRTZWN0aW9uOiBzdHJpbmcpOiB2b2lkID0+IHtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKCcxMTEnLGN1cnJlbnRTZWN0aW9uKTtcclxuICAgICAgICAgIHRoaXMuc2Nyb2xsU3B5LnNldEN1cnJlbnRTZWN0aW9uSWQodGhpcy5zY3JvbGxHcm91cElkLGN1cnJlbnRTZWN0aW9uKTtcclxuXHJcbiAgICAgICAgICAvL3RoaXMuY2hhbmdlRGV0ZWN0b3IubWFya0ZvckNoZWNrKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvLyDmlLnlj5hGb2xsb3dUeXBl5pe2XHJcbiAgICBjaGFuZ2VGb2xsb3dUeXBlKCl7XHJcbiAgICAgIGlmKHRoaXMuc2Nyb2xsR3JvdXBJZCYmdGhpcy5fZW1pdEZvbGxvd1R5cGUpe1xyXG4gICAgICAgIHRoaXMuc2Nyb2xsU3B5LmNoYW5nZUdyb3VwSWRGb2xsb3dUeXBlKHRoaXMuc2Nyb2xsR3JvdXBJZCx0aGlzLl9lbWl0Rm9sbG93VHlwZSk7XHJcbiAgICAgICAgdGhpcy5fZW1pdEZvbGxvd1R5cGU9bnVsbDtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xyXG4gICAgICAgIC8qKuW9k+a7muWKqOS9jee9ruS4unNpZGXml7bvvIzor6Xnu4Tku7bmnIDov5HniLboioLngrnmt7vliqByZWxhdGl2ZeWumuS9jSAqL1xyXG4gICAgICAgIGNvbnN0IHBhcmVudCA9IHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnBhcmVudEVsZW1lbnQ7XHJcbiAgICAgICAgaWYoIXBhcmVudC5zdHlsZS5wb3NpdGlvbiAmJiBwYXJlbnQuc3R5bGUucG9zaXRpb24gIT09ICdyZWxhdGl2ZScgJiYgdGhpcy5mRm9sbG93VHlwZSA9PT0gJ3NpZGUnKXtcclxuICAgICAgICAgICAgcGFyZW50LnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gaWYodGhpcy5zY3JvbGxzcHlEYXRhICYmIHRoaXMuc2Nyb2xsc3B5RGF0YS5sZW5ndGggJiYgdGhpcy5jdXJyZW50U2VjdGlvbklkKXtcclxuICAgICAgICAvLyAgIGlmKHRoaXMuY3VycmVudFNlY3Rpb25JZCAhPT0gdGhpcy5zY3JvbGxzcHlEYXRhWzBdLmlkKXtcclxuICAgICAgICAvLyAgICAgY29uc29sZS5sb2coMjIyKTtcclxuICAgICAgICAvLyAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMuc2Nyb2xseXNweUxpc3RFbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjc2Nyb2xsc3B5LVwiK3RoaXMuY3VycmVudFNlY3Rpb25JZCk7XHJcbiAgICAgICAgLy8gICAgIGNvbnN0IGZvbGxvdyA9IHtcclxuICAgICAgICAvLyAgICAgICBlbGVtZW50OiBlbGVtZW50LFxyXG4gICAgICAgIC8vICAgICAgIGlkOiB0aGlzLmN1cnJlbnRTZWN0aW9uSWRcclxuICAgICAgICAvLyAgICAgfTtcclxuICAgICAgICAvLyAgICAgY29uc3QgZ3JvdXBJZCA9IHRoaXMuc2Nyb2xsR3JvdXBJZCA/IHRoaXMuc2Nyb2xsR3JvdXBJZDogJ2RlZmF1bHQnO1xyXG4gICAgICAgIC8vICAgICB0aGlzLnNjcm9sbFNweS5mU2Nyb2xsRm9sbG93Q2xpY2soZ3JvdXBJZCxmb2xsb3cpO1xyXG4gICAgICAgIC8vICAgfVxyXG4gICAgICAgIC8vIH1cclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbn0iXX0=