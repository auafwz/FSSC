/**
 * @fileoverview added by tsickle
 * Generated from: lib/component/external-integration/external-integration.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ComponentFactoryResolver, ElementRef, EventEmitter, forwardRef, Injector, Input, Optional, Output, ViewChild, ViewContainerRef } from "@angular/core";
import { DialogComponent } from "@farris/ui-dialog";
import { VariableParseService, ViewModel } from "@farris/devkit";
import { ExternalIntegrationService } from "./external-integration-service";
import { NgControl, NG_VALUE_ACCESSOR } from "@angular/forms";
import { Observable, of } from "rxjs";
import { ListViewComponent } from "@farris/ui-list-view";
export class ExternalIntegrationComponent {
    /**
     * @param {?} vm
     * @param {?} el
     * @param {?} extIntgrtnSrvc
     * @param {?} variableParseService
     * @param {?} resolver
     * @param {?} inj
     */
    constructor(vm, el, extIntgrtnSrvc, variableParseService, resolver, inj) {
        this.vm = vm;
        this.el = el;
        this.extIntgrtnSrvc = extIntgrtnSrvc;
        this.variableParseService = variableParseService;
        this.resolver = resolver;
        this.inj = inj;
        /**
         * 模态框宽
         */
        this.width = 960;
        /**
         * 模态框高
         */
        this.height = 577;
        this.fieldText = "";
        this.placeholder = "请选择";
        // 是否只读
        this.readonly = false;
        /**
         * 内容中留白边距
         */
        this.containerMargin = { top: 0, bottom: 5, left: 10, right: 10 };
        /**
         * 指令回填sap数据
         */
        this.selectSapData = new EventEmitter();
        this.afterOnblur = new EventEmitter();
        /**
         * 多表数据集合
         */
        this.tableData = [];
        /**
         * 模态框导航栏当前选中项
         */
        this.currentLink = {};
        /**
         * 模态框确定按钮是否可用
         */
        this.ensureFlag = true;
        this.containerStyle = {
            marginLeft: this.containerMargin.left + "px",
            marginRight: this.containerMargin.right + "px",
            marginTop: this.containerMargin.top + "px",
            marginBottom: this.containerMargin.bottom + "px"
        };
        this.beforeClose = (/**
         * @return {?}
         */
        () => {
            this.tableData = [];
            this.ensureFlag = true;
            this.sendSapData();
            return of(true);
        });
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) { }
    /**
     * @return {?}
     */
    fieldTextChange() {
        /** @type {?} */
        const pathArr = this.getBindingPathArray();
        this.vm.bindingData.setValue(pathArr.concat(this.ngControl.name), this.fieldText, true, true);
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() { }
    /**
     * @return {?}
     */
    ngOnDestroy() { }
    /**
     * @param {?} obj
     * @return {?}
     */
    writeValue(obj) {
        this.fieldText = obj;
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnChange(fn) { }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnTouched(fn) { }
    /**
     * @param {?} isDisabled
     * @return {?}
     */
    setDisabledState(isDisabled) { }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.ngControl = this.inj.get(NgControl);
        // 卡片绑定onblur事件，表格再grid-external-integration中绑定onblur事件
        if (this.mappingType != "grid") {
            this.input.nativeElement.onblur = (/**
             * @return {?}
             */
            () => {
                this.callSapService();
            });
        }
        this.extIntgrtnSrvc.sapData.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            this.sapDataHandle(data);
        }));
    }
    /**
     * 打开模态框
     * @return {?}
     */
    showDialog() {
        this.farrisListView.listClick.emit({
            data: [this.tableData[0]],
            index: 0,
            checkChangeEvent: false
        });
        this.farrisListView.clickItem = this.tableData[0];
        this.dialog.show();
        return false;
    }
    /**
     * 调用sap外部服务，出参在ngOninit监听
     * @return {?}
     */
    callSapService() {
        this.fieldTextChange();
        this.extIntgrtnSrvc.queryExtIntegrationService(this.externalParams, this.serviceCode);
    }
    /**
     * 处理sap出参
     * @param {?} data sap出参
     * @return {?}
     */
    sapDataHandle(data) {
        if (!data) {
            return;
        }
        /** @type {?} */
        let tableNameList = Object.keys(data);
        /** @type {?} */
        let mapTableList = this.getTableListFromMapFields();
        // 取交集
        tableNameList = tableNameList.filter((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            return mapTableList.indexOf(item) != -1;
        }));
        // 多表场景
        if (tableNameList.length > 1) {
            // 校验是否弹出模态框
            /** @type {?} */
            let openDialogFlag = this.checkMultiTableData(data, tableNameList);
            if (openDialogFlag == "open") {
                // 组装模态框数据
                this.assembleTableData(data);
                this.showDialog();
            }
            else if (openDialogFlag == "backfill") {
                // 多表，每个表只有一条数据
                /** @type {?} */
                let backfillData = {};
                tableNameList.forEach((/**
                 * @param {?} tableName
                 * @return {?}
                 */
                tableName => {
                    Object.assign(backfillData, this.assembleSapData(tableName, data[tableName][0]));
                }));
                this.sendSapData(backfillData);
            }
            else {
                // 多表无数据
                this.sendSapData();
            }
        }
        else if (tableNameList.length == 1) {
            /** @type {?} */
            let tableName = tableNameList[0];
            /** @type {?} */
            let sapDataLength = (data[tableName] || []).length;
            if (sapDataLength > 0) {
                if (sapDataLength == 1) {
                    // 一个表只有一条数据
                    /** @type {?} */
                    let sapData = this.assembleSapData(tableName, data[tableName][0]);
                    this.sendSapData(sapData);
                }
                else if (sapDataLength > 1) {
                    // 一个表有多条数据
                    this.assembleTableData(data);
                    this.showDialog();
                    return;
                }
            }
        }
        else {
            // 处理查询异常，editor没有endPending
            this.sendSapData();
        }
    }
    /**
     * @param {?} data
     * @param {?} tableNameList
     * @return {?}
     */
    checkMultiTableData(data, tableNameList) {
        /** @type {?} */
        let openDialogFlag = "";
        for (let index = 0; index < tableNameList.length; index++) {
            /** @type {?} */
            let tableName = tableNameList[index];
            if (data[tableName].length > 1) {
                openDialogFlag = "open";
                break;
            }
            else if (data[tableName].length == 0 && openDialogFlag != "backfill") {
                openDialogFlag = "none";
                continue;
            }
            openDialogFlag = "backfill";
        }
        return openDialogFlag;
    }
    /**
     * 组装模态框数据
     * @param {?} data sap出参
     * @return {?}
     */
    assembleTableData(data) {
        /** @type {?} */
        let tableNameList = Object.keys(data);
        /** @type {?} */
        let mapTableList = this.getTableListFromMapFields();
        // 取交集
        mapTableList = mapTableList.filter((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            return tableNameList.indexOf(item) != -1;
        }));
        if (mapTableList.length > 0) {
            // 遍历sap映射表，组装表及对应数据
            mapTableList.forEach((/**
             * @param {?} mapTable
             * @return {?}
             */
            mapTable => {
                // 组装模态框中单表数据
                /** @type {?} */
                let tableInfo = this.assembleTableInfo(mapTable, data);
                if (tableInfo &&
                    Object.keys(tableInfo).length > 0 &&
                    (tableInfo.data || []).length > 0) {
                    this.tableData.push(tableInfo);
                }
            }));
        }
    }
    /**
     * @return {?}
     */
    getTableListFromMapFields() {
        // 获取需要回填的表
        /** @type {?} */
        let mapKeyList = Object.keys(this.myField);
        // 定义sap映射表集合
        /** @type {?} */
        let mapTableList = [];
        (mapKeyList || []).forEach((/**
         * @param {?} mapKey
         * @return {?}
         */
        mapKey => {
            // 在映射关系中获取sap出参中的表集合
            mapTableList.push(mapKey.split(".")[0]);
        }));
        // 去重
        mapTableList = Array.from(new Set(mapTableList));
        return mapTableList;
    }
    /**
     * 组装模态框中单表数据
     * @param {?} mapTable 表名
     * @param {?} data sap出参
     * @return {?} 模态框单表数据对象
     */
    assembleTableInfo(mapTable, data) {
        // 模态框单表数据对象
        /** @type {?} */
        let tableInfo = {};
        // 表头集合
        /** @type {?} */
        let tableColumnList = [];
        // 遍历sap出参表信息，获取表头中文、表名
        (this.extTableSchemas || []).forEach((/**
         * @param {?} tableSchema
         * @return {?}
         */
        tableSchema => {
            if (tableSchema.code == mapTable) {
                tableInfo.name = tableSchema.name;
                // 模拟主键，保证farris-grid组件【单选】功能正常
                /** @type {?} */
                let idColumn = {};
                idColumn.field = "id";
                idColumn.title = "序号";
                tableColumnList.push(idColumn);
                // 组装表头
                tableSchema.columns.forEach((/**
                 * @param {?} column
                 * @return {?}
                 */
                column => {
                    /** @type {?} */
                    let tableColumn = {};
                    tableColumn.field = column.code;
                    tableColumn.title = column.name;
                    tableColumnList.push(tableColumn);
                }));
                tableInfo.columns = tableColumnList;
                tableInfo.code = mapTable;
                // 给表数据增加模拟主键
                (data[mapTable] || []).forEach((/**
                 * @param {?} item
                 * @param {?} index
                 * @return {?}
                 */
                (item, index) => {
                    item["id"] = index + 1;
                }));
                tableInfo.data = data[mapTable];
            }
        }));
        return tableInfo;
    }
    /**
     * 导航栏点击事件
     * @param {?} event 导航栏信息
     * @return {?}
     */
    listClick(event) {
        /** @type {?} */
        let clickData = event.data;
        if (event.data.disable) {
            return false;
        }
        else {
            if (typeof this.currentLink["data"] !== "undefined") {
                if (clickData[0].code === this.currentLink["data"][0].code) {
                    return false;
                }
                else {
                    this.currentLink = event;
                }
            }
            else {
                this.currentLink = event;
            }
        }
    }
    /**
     * 模态框，确定，取消按钮
     * @param {?} flag ensure:确定按钮，cancel：取消按钮
     * @return {?}
     */
    confirm(flag) {
        // 点击确定按钮
        if (flag == "ensure") {
            /** @type {?} */
            let sapData = {};
            // 遍历模态框表数据，组装回填数据
            for (let index = 0; index < this.tableData.length; index++) {
                /** @type {?} */
                let tableInfo = this.tableData[index];
                Object.assign(sapData, this.assembleSapData(tableInfo.code, tableInfo.selectedData.data));
            }
            this.sendSapData(sapData);
        }
        // 清空模态框数据
        this.tableData = [];
        // 关闭模态框
        this.dialog.close();
    }
    /**
     * 选中一行事件
     * @param {?} selectedRow 选中行数据
     * @param {?} tableName 当前表格对应表名
     * @return {?}
     */
    selectRowChange(selectedRow, tableName) {
        this.tableData.forEach((/**
         * @param {?} tableInfo
         * @return {?}
         */
        tableInfo => {
            if (tableInfo.code == tableName) {
                tableInfo.selectedData = selectedRow;
            }
        }));
        this.setEnsureButtonFlag();
    }
    /**
     * 取消一行事件
     * @param {?} selectedRow 被取消行数据
     * @param {?} tableName 当前表格对应表名
     * @return {?}
     */
    unSelect(selectedRow, tableName) {
        this.tableData.forEach((/**
         * @param {?} tableInfo
         * @return {?}
         */
        tableInfo => {
            if (tableInfo.code == tableName) {
                tableInfo.selectedData = null;
                tableInfo.selectedValue = "";
            }
        }));
        selectedRow = null;
        this.setEnsureButtonFlag();
    }
    /**
     * 设置模态框确定按钮是否可用
     * @return {?}
     */
    setEnsureButtonFlag() {
        /** @type {?} */
        let flag = false;
        for (let index = 0; index < this.tableData.length; index++) {
            /** @type {?} */
            let tableInfo = this.tableData[index];
            if (!tableInfo.selectedData) {
                flag = true;
                break;
            }
        }
        this.ensureFlag = flag;
    }
    /**
     * 组装sap回填数据
     * @param {?} tableName 表名
     * @param {?} tableData 表数据
     * @return {?} (表名.表字段名:表数据):Object
     */
    assembleSapData(tableName, tableData) {
        if (!tableName || !tableData) {
            return;
        }
        // sap回填数据
        /** @type {?} */
        let sapData = {};
        // 表字段名集合
        /** @type {?} */
        let tableDataItemKeys = Object.keys(tableData);
        for (let index = 0; index < tableDataItemKeys.length; index++) {
            /** @type {?} */
            let itemKey = tableDataItemKeys[index];
            // sap回填数据key= 表名.表字段名
            /** @type {?} */
            let key = tableName + "." + itemKey;
            sapData[key] = tableData[itemKey];
        }
        return sapData;
    }
    /**
     * 回填sap数据
     * @private
     * @param {?=} sapData 将要回填的sap数据
     * @return {?}
     */
    sendSapData(sapData) {
        if (sapData) {
            this.selectSapData.emit(sapData);
        }
        // 子表关闭editor状态
        if (this.mappingType == "grid") {
            this.afterOnblur.emit();
        }
    }
    /**
     * @private
     * @return {?}
     */
    getBindingPathArray() {
        /** @type {?} */
        const path = this.vm.bindingPath;
        if (path) {
            return path.split("/").filter((/**
             * @param {?} n
             * @return {?}
             */
            n => n !== ""));
        }
        return [];
    }
}
ExternalIntegrationComponent.decorators = [
    { type: Component, args: [{
                selector: "web-external-integration",
                template: "<input [(ngModel)]=\"fieldText\" #input  class=\"form-control\" input-end-edit [readonly]=\"false\"\n  tabindex=\"0\" maxlength=\"36\" />\n\n<farris-dialog #dialog [title]=\"'\u9009\u62E9\u6570\u636E'\" [beforeClose]=\"beforeClose\"  [width]=\"1000\" [height]=\"834\" [showButtons]=\"true\" [showMaxButton]=\"true\"\n  [showCloseButton]=\"true\" [enableScroll]=\"false\" [dialogHeaderHeight]=\"50\" [buttons]=\"defaultButtonRef\">\n  <div [ngStyle]=\"containerStyle\" style=\"height: 100%;\">\n    <div class=\"listnav-example-wrapper\">\n      <div class=\"example-side-nav\">\n        <farris-list-nav  [listNavWidth]=\"240\" (listClick)=\"listClick($event)\">\n          <ng-template listNavContent>\n            <farris-list-view #farrisListView [showEmpty]=\"true\" [data]=\"tableData\" [activeIndex]=\"3\" listidName=\"code\" (listClick)=\"listClick($event)\">\n              <ng-template #navView listTemplate let-item=\"item\" let-selected=\"selectedItem\">\n                <div class=\"f-template-listnav-row\">\n                  <!-- routerLinkActive=\"active\" -->\n                  <a class=\"list-nav-link\" [ngStyle]=\"{'pointer-events': item.disable ?'none' : '','width':240 +'px'}\"\n                     [title]=\"item.name\">\n                    <span class=\"nav-item-name\">\n                      {{ item.name }}\n                    </span>\n                  </a>\n                </div>\n              </ng-template>\n            </farris-list-view>\n          </ng-template>\n\n          <!-- <ng-template listNavFooter>\n                \u5E95\u90E8\u90E8\u5206\n            </ng-template> -->\n\n        </farris-list-nav>\n      </div>\n      <div class=\"example-content\" >\n        <ng-container #girdView *ngFor=\"let item of tableData;let i = index\">\n          <div style=\"height:100%\" [hidden]=\"! (currentLink && item.code == ((currentLink['data'] || [])[0] || {})['code'])\" >\n            <farris-datagrid \n              [autoFitColumns]=\"true\" \n              [columns]=\"item.columns\" \n              [data]=\"item.data\" \n              [fitColumns]=\"true\"\n              [fit]=\"true\" \n              [showBorder]=\"true\" \n              [(selectValue)]=\"item.selectedValue\"\n              [keepSelect]=\"false\"\n              [pagination]=\"false\"\n              (selectChanged)=\"selectRowChange($event, item.code)\"\n              (unSelect)=\"unSelect(null, item.code)\">\n            </farris-datagrid>\n          </div>\n        </ng-container>\n      </div>\n    </div>\n  </div>\n</farris-dialog>\n\n<ng-template #defaultButtonRef>\n  <button #okbtn type=\"button\" [disabled]=\"ensureFlag\" (click)=\"confirm('ensure')\"  class=\"btn btn-primary btn-lg\">\n    {{ 'lookup.okText' | locale: '\u786E\u5B9A' }}\n  </button>\n  <button type=\"button\" class=\"btn btn-secondary btn-lg\" (click)=\"confirm('cancel')\" [disabled]=\"false\">\n    {{ 'lookup.cancelText' | locale: '\u53D6\u6D88' }}\n  </button>\n</ng-template>",
                providers: [
                    ExternalIntegrationService,
                    {
                        provide: NG_VALUE_ACCESSOR,
                        useExisting: forwardRef((/**
                         * @return {?}
                         */
                        () => ExternalIntegrationComponent)),
                        multi: true
                    }
                ],
                styles: [".listnav-example-wrapper{background-color:#e7ebef;display:flex;height:100%}.listnav-example-wrapper .example-side-nav{flex:0 0 auto}.listnav-example-wrapper .example-content{flex:1 1 0;width:726px;overflow-y:auto;padding:10px 10px 10px 4px}.listnav-example-wrapper .example-content .listnav-content{height:100%;width:100%;background-color:#fff}.listnav-example-wrapper .example-content.example-content-right{padding:10px 4px 10px 10px}"]
            }] }
];
/** @nocollapse */
ExternalIntegrationComponent.ctorParameters = () => [
    { type: ViewModel, decorators: [{ type: Optional }] },
    { type: ElementRef },
    { type: ExternalIntegrationService },
    { type: VariableParseService },
    { type: ComponentFactoryResolver },
    { type: Injector }
];
ExternalIntegrationComponent.propDecorators = {
    width: [{ type: Input }],
    height: [{ type: Input }],
    serviceCode: [{ type: Input, args: ["serviceCode",] }],
    externalParams: [{ type: Input, args: ["externalParams",] }],
    mappingType: [{ type: Input, args: ["mappingType",] }],
    myField: [{ type: Input, args: ["mapFields",] }],
    fieldText: [{ type: Input }],
    extTableSchemas: [{ type: Input, args: ["extTableSchemas",] }],
    placeholder: [{ type: Input }],
    readonly: [{ type: Input }],
    beforeSapSrvc: [{ type: Input }],
    customData: [{ type: Input }],
    selectSapData: [{ type: Output }],
    afterOnblur: [{ type: Output }],
    dialog: [{ type: ViewChild, args: ["dialog",] }],
    input: [{ type: ViewChild, args: ["input",] }],
    girdView: [{ type: ViewChild, args: ["girdView", { read: ViewContainerRef },] }],
    farrisListView: [{ type: ViewChild, args: ["farrisListView",] }]
};
if (false) {
    /**
     * 模态框宽
     * @type {?}
     */
    ExternalIntegrationComponent.prototype.width;
    /**
     * 模态框高
     * @type {?}
     */
    ExternalIntegrationComponent.prototype.height;
    /**
     * 服务名
     * @type {?}
     */
    ExternalIntegrationComponent.prototype.serviceCode;
    /**
     * 外部服务请求入参,表达式
     * @type {?}
     */
    ExternalIntegrationComponent.prototype.externalParams;
    /**
     * form:主表回填形式,grid：子表回填形式
     * @type {?}
     */
    ExternalIntegrationComponent.prototype.mappingType;
    /**
     * 映射关系
     * @type {?}
     */
    ExternalIntegrationComponent.prototype.myField;
    /** @type {?} */
    ExternalIntegrationComponent.prototype.fieldText;
    /**
     * sap出参表信息描述
     * @type {?}
     */
    ExternalIntegrationComponent.prototype.extTableSchemas;
    /** @type {?} */
    ExternalIntegrationComponent.prototype.placeholder;
    /** @type {?} */
    ExternalIntegrationComponent.prototype.readonly;
    /** @type {?} */
    ExternalIntegrationComponent.prototype.beforeSapSrvc;
    /**
     * 内容中留白边距
     * @type {?}
     */
    ExternalIntegrationComponent.prototype.containerMargin;
    /**
     * 自定义数据
     * @type {?}
     */
    ExternalIntegrationComponent.prototype.customData;
    /**
     * 指令回填sap数据
     * @type {?}
     */
    ExternalIntegrationComponent.prototype.selectSapData;
    /** @type {?} */
    ExternalIntegrationComponent.prototype.afterOnblur;
    /** @type {?} */
    ExternalIntegrationComponent.prototype.dialog;
    /** @type {?} */
    ExternalIntegrationComponent.prototype.input;
    /** @type {?} */
    ExternalIntegrationComponent.prototype.girdView;
    /** @type {?} */
    ExternalIntegrationComponent.prototype.farrisListView;
    /** @type {?} */
    ExternalIntegrationComponent.prototype.componentRef;
    /**
     * 多表数据集合
     * @type {?}
     */
    ExternalIntegrationComponent.prototype.tableData;
    /**
     * 模态框导航栏当前选中项
     * @type {?}
     */
    ExternalIntegrationComponent.prototype.currentLink;
    /**
     * 模态框确定按钮是否可用
     * @type {?}
     */
    ExternalIntegrationComponent.prototype.ensureFlag;
    /** @type {?} */
    ExternalIntegrationComponent.prototype.ngControl;
    /** @type {?} */
    ExternalIntegrationComponent.prototype.containerStyle;
    /** @type {?} */
    ExternalIntegrationComponent.prototype.beforeClose;
    /**
     * @type {?}
     * @private
     */
    ExternalIntegrationComponent.prototype.vm;
    /** @type {?} */
    ExternalIntegrationComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    ExternalIntegrationComponent.prototype.extIntgrtnSrvc;
    /**
     * @type {?}
     * @private
     */
    ExternalIntegrationComponent.prototype.variableParseService;
    /**
     * @type {?}
     * @private
     */
    ExternalIntegrationComponent.prototype.resolver;
    /**
     * @type {?}
     * @private
     */
    ExternalIntegrationComponent.prototype.inj;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXh0ZXJuYWwtaW50ZWdyYXRpb24uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9leHRlcm5hbC1pbnRlZ3JhdGlvbi8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnQvZXh0ZXJuYWwtaW50ZWdyYXRpb24vZXh0ZXJuYWwtaW50ZWdyYXRpb24uY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUVMLFNBQVMsRUFDVCx3QkFBd0IsRUFFeEIsVUFBVSxFQUNWLFlBQVksRUFDWixVQUFVLEVBQ1YsUUFBUSxFQUNSLEtBQUssRUFJTCxRQUFRLEVBQ1IsTUFBTSxFQUVOLFNBQVMsRUFDVCxnQkFBZ0IsRUFDakIsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ3BELE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxTQUFTLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUNqRSxPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUU1RSxPQUFPLEVBRUwsU0FBUyxFQUNULGlCQUFpQixFQUNsQixNQUFNLGdCQUFnQixDQUFDO0FBRXhCLE9BQU8sRUFBRSxVQUFVLEVBQUUsRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3RDLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBZXpELE1BQU0sT0FBTyw0QkFBNEI7Ozs7Ozs7OztJQXFEdkMsWUFDc0IsRUFBYSxFQUMxQixFQUFjLEVBQ2IsY0FBMEMsRUFDMUMsb0JBQTBDLEVBQzFDLFFBQWtDLEVBQ2xDLEdBQWE7UUFMRCxPQUFFLEdBQUYsRUFBRSxDQUFXO1FBQzFCLE9BQUUsR0FBRixFQUFFLENBQVk7UUFDYixtQkFBYyxHQUFkLGNBQWMsQ0FBNEI7UUFDMUMseUJBQW9CLEdBQXBCLG9CQUFvQixDQUFzQjtRQUMxQyxhQUFRLEdBQVIsUUFBUSxDQUEw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Ozs7SUFDbEQsZ0RBQTBDOzs7OztJQUMxQywyQ0FBcUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBBZnRlclZpZXdJbml0LFxuICBDb21wb25lbnQsXG4gIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcixcbiAgQ29tcG9uZW50UmVmLFxuICBFbGVtZW50UmVmLFxuICBFdmVudEVtaXR0ZXIsXG4gIGZvcndhcmRSZWYsXG4gIEluamVjdG9yLFxuICBJbnB1dCxcbiAgT25DaGFuZ2VzLFxuICBPbkRlc3Ryb3ksXG4gIE9uSW5pdCxcbiAgT3B0aW9uYWwsXG4gIE91dHB1dCxcbiAgU2ltcGxlQ2hhbmdlcyxcbiAgVmlld0NoaWxkLFxuICBWaWV3Q29udGFpbmVyUmVmXG59IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5pbXBvcnQgeyBEaWFsb2dDb21wb25lbnQgfSBmcm9tIFwiQGZhcnJpcy91aS1kaWFsb2dcIjtcbmltcG9ydCB7IFZhcmlhYmxlUGFyc2VTZXJ2aWNlLCBWaWV3TW9kZWwgfSBmcm9tIFwiQGZhcnJpcy9kZXZraXRcIjtcbmltcG9ydCB7IEV4dGVybmFsSW50ZWdyYXRpb25TZXJ2aWNlIH0gZnJvbSBcIi4vZXh0ZXJuYWwtaW50ZWdyYXRpb24tc2VydmljZVwiO1xuaW1wb3J0IHsgRGF0YWdyaWRDb21wb25lbnQgfSBmcm9tIFwiQGZhcnJpcy91aS1kYXRhZ3JpZFwiO1xuaW1wb3J0IHtcbiAgQ29udHJvbFZhbHVlQWNjZXNzb3IsXG4gIE5nQ29udHJvbCxcbiAgTkdfVkFMVUVfQUNDRVNTT1Jcbn0gZnJvbSBcIkBhbmd1bGFyL2Zvcm1zXCI7XG5pbXBvcnQgeyBUYWJsZUNvbHVtbiwgVGFibGVJbmZvIH0gZnJvbSBcIi4vZXh0ZXJuYWwtaW50ZWdyYXRpb24tZGlzcGxheXR5cGVcIjtcbmltcG9ydCB7IE9ic2VydmFibGUsIG9mIH0gZnJvbSBcInJ4anNcIjtcbmltcG9ydCB7IExpc3RWaWV3Q29tcG9uZW50IH0gZnJvbSBcIkBmYXJyaXMvdWktbGlzdC12aWV3XCI7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogXCJ3ZWItZXh0ZXJuYWwtaW50ZWdyYXRpb25cIixcbiAgdGVtcGxhdGVVcmw6IFwiLi9leHRlcm5hbC1pbnRlZ3JhdGlvbi5jb21wb25lbnQuaHRtbFwiLFxuICBzdHlsZVVybHM6IFtcIi4vZXh0ZXJuYWwtaW50ZWdyYXRpb24uY29tcG9uZW50LnNjc3NcIl0sXG4gIHByb3ZpZGVyczogW1xuICAgIEV4dGVybmFsSW50ZWdyYXRpb25TZXJ2aWNlLFxuICAgIHtcbiAgICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxuICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gRXh0ZXJuYWxJbnRlZ3JhdGlvbkNvbXBvbmVudCksXG4gICAgICBtdWx0aTogdHJ1ZVxuICAgIH1cbiAgXVxufSlcbmV4cG9ydCBjbGFzcyBFeHRlcm5hbEludGVncmF0aW9uQ29tcG9uZW50XG4gIGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMsIEFmdGVyVmlld0luaXQsIE9uRGVzdHJveSwgQ29udHJvbFZhbHVlQWNjZXNzb3Ige1xuICAvKiog5qih5oCB5qGG5a69ICovXG4gIEBJbnB1dCgpIHdpZHRoOiBudW1iZXIgPSA5NjA7XG4gIC8qKiDmqKHmgIHmoYbpq5ggKi9cbiAgQElucHV0KCkgaGVpZ2h0OiBudW1iZXIgPSA1Nzc7XG4gIC8qKiDmnI3liqHlkI0gKi9cbiAgQElucHV0KFwic2VydmljZUNvZGVcIikgc2VydmljZUNvZGU6IHN0cmluZztcbiAgLyoqIOWklumDqOacjeWKoeivt+axguWFpeWPgizooajovr7lvI8gKi9cbiAgQElucHV0KFwiZXh0ZXJuYWxQYXJhbXNcIikgZXh0ZXJuYWxQYXJhbXM6IGFueTtcbiAgLyoqIGZvcm065Li76KGo5Zue5aGr5b2i5byPLGdyaWTvvJrlrZDooajlm57loavlvaLlvI8gKi9cbiAgQElucHV0KFwibWFwcGluZ1R5cGVcIikgbWFwcGluZ1R5cGU6IHN0cmluZztcbiAgLyoqIOaYoOWwhOWFs+ezuyAqL1xuICBASW5wdXQoXCJtYXBGaWVsZHNcIikgbXlGaWVsZDogYW55O1xuICBASW5wdXQoKSBmaWVsZFRleHQ6IHN0cmluZyA9IFwiXCI7XG4gIC8qKiBzYXDlh7rlj4Looajkv6Hmga/mj4/ov7AgKi9cbiAgQElucHV0KFwiZXh0VGFibGVTY2hlbWFzXCIpIGV4dFRhYmxlU2NoZW1hczogYW55O1xuXG4gIEBJbnB1dCgpIHBsYWNlaG9sZGVyID0gXCLor7fpgInmi6lcIjtcbiAgLy8g5piv5ZCm5Y+q6K+7XG4gIEBJbnB1dCgpIHJlYWRvbmx5ID0gZmFsc2U7XG4gIC8vIOivt+axguWJjeS6i+S7tlxuICBASW5wdXQoKSBiZWZvcmVTYXBTcnZjOiBPYnNlcnZhYmxlPGFueT47XG5cbiAgLyoqIOWGheWuueS4reeVmeeZvei+uei3nSAqL1xuICBjb250YWluZXJNYXJnaW4gPSB7IHRvcDogMCwgYm90dG9tOiA1LCBsZWZ0OiAxMCwgcmlnaHQ6IDEwIH07XG4gIC8qKiDoh6rlrprkuYnmlbDmja4gKi9cbiAgQElucHV0KCkgY3VzdG9tRGF0YTogYW55O1xuICAvKiog5oyH5Luk5Zue5aGrc2Fw5pWw5o2uICovXG4gIEBPdXRwdXQoKSBzZWxlY3RTYXBEYXRhID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICBAT3V0cHV0KCkgYWZ0ZXJPbmJsdXIgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIEBWaWV3Q2hpbGQoXCJkaWFsb2dcIikgZGlhbG9nOiBEaWFsb2dDb21wb25lbnQ7XG4gIEBWaWV3Q2hpbGQoXCJpbnB1dFwiKSBpbnB1dDogRWxlbWVudFJlZjxhbnk+O1xuICBAVmlld0NoaWxkKFwiZ2lyZFZpZXdcIiwgeyByZWFkOiBWaWV3Q29udGFpbmVyUmVmIH0pIGdpcmRWaWV3OiBWaWV3Q29udGFpbmVyUmVmO1xuICBAVmlld0NoaWxkKFwiZmFycmlzTGlzdFZpZXdcIikgZmFycmlzTGlzdFZpZXc6IExpc3RWaWV3Q29tcG9uZW50O1xuICBjb21wb25lbnRSZWY6IENvbXBvbmVudFJlZjxEYXRhZ3JpZENvbXBvbmVudD47XG5cbiAgLyoqIOWkmuihqOaVsOaNrumbhuWQiCAqL1xuICB0YWJsZURhdGE6IFRhYmxlSW5mb1tdID0gW107XG4gIC8qKiDmqKHmgIHmoYblr7zoiKrmoI/lvZPliY3pgInkuK3pobkgKi9cbiAgY3VycmVudExpbms6IGFueSA9IHt9O1xuICAvKiog5qih5oCB5qGG56Gu5a6a5oyJ6ZKu5piv5ZCm5Y+v55SoICovXG4gIGVuc3VyZUZsYWc6IGJvb2xlYW4gPSB0cnVlO1xuXG4gIG5nQ29udHJvbDogTmdDb250cm9sO1xuXG4gIGNvbnRhaW5lclN0eWxlID0ge1xuICAgIG1hcmdpbkxlZnQ6IHRoaXMuY29udGFpbmVyTWFyZ2luLmxlZnQgKyBcInB4XCIsXG4gICAgbWFyZ2luUmlnaHQ6IHRoaXMuY29udGFpbmVyTWFyZ2luLnJpZ2h0ICsgXCJweFwiLFxuICAgIG1hcmdpblRvcDogdGhpcy5jb250YWluZXJNYXJnaW4udG9wICsgXCJweFwiLFxuICAgIG1hcmdpbkJvdHRvbTogdGhpcy5jb250YWluZXJNYXJnaW4uYm90dG9tICsgXCJweFwiXG4gIH07XG5cbiAgY29uc3RydWN0b3IoXG4gICAgQE9wdGlvbmFsKCkgcHJpdmF0ZSB2bTogVmlld01vZGVsLFxuICAgIHB1YmxpYyBlbDogRWxlbWVudFJlZixcbiAgICBwcml2YXRlIGV4dEludGdydG5TcnZjOiBFeHRlcm5hbEludGVncmF0aW9uU2VydmljZSxcbiAgICBwcml2YXRlIHZhcmlhYmxlUGFyc2VTZXJ2aWNlOiBWYXJpYWJsZVBhcnNlU2VydmljZSxcbiAgICBwcml2YXRlIHJlc29sdmVyOiBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsXG4gICAgcHJpdmF0ZSBpbmo6IEluamVjdG9yXG4gICkge31cblxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7fVxuXG4gIGZpZWxkVGV4dENoYW5nZSgpIHtcbiAgICBjb25zdCBwYXRoQXJyID0gdGhpcy5nZXRCaW5kaW5nUGF0aEFycmF5KCk7XG4gICAgdGhpcy52bS5iaW5kaW5nRGF0YS5zZXRWYWx1ZShcbiAgICAgIHBhdGhBcnIuY29uY2F0KHRoaXMubmdDb250cm9sLm5hbWUpLFxuICAgICAgdGhpcy5maWVsZFRleHQsXG4gICAgICB0cnVlLFxuICAgICAgdHJ1ZVxuICAgICk7XG4gIH1cblxuICBuZ0FmdGVyVmlld0luaXQoKTogdm9pZCB7fVxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHt9XG4gIHdyaXRlVmFsdWUob2JqOiBhbnkpOiB2b2lkIHtcbiAgICB0aGlzLmZpZWxkVGV4dCA9IG9iajtcbiAgfVxuICByZWdpc3Rlck9uQ2hhbmdlKGZuOiBhbnkpOiB2b2lkIHt9XG4gIHJlZ2lzdGVyT25Ub3VjaGVkKGZuOiBhbnkpOiB2b2lkIHt9XG4gIHNldERpc2FibGVkU3RhdGU/KGlzRGlzYWJsZWQ6IGJvb2xlYW4pOiB2b2lkIHt9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy5uZ0NvbnRyb2wgPSB0aGlzLmluai5nZXQoTmdDb250cm9sKTtcbiAgICAvLyDljaHniYfnu5HlrppvbmJsdXLkuovku7bvvIzooajmoLzlho1ncmlkLWV4dGVybmFsLWludGVncmF0aW9u5Lit57uR5a6ab25ibHVy5LqL5Lu2XG4gICAgaWYgKHRoaXMubWFwcGluZ1R5cGUgIT0gXCJncmlkXCIpIHtcbiAgICAgIHRoaXMuaW5wdXQubmF0aXZlRWxlbWVudC5vbmJsdXIgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuY2FsbFNhcFNlcnZpY2UoKTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgdGhpcy5leHRJbnRncnRuU3J2Yy5zYXBEYXRhLnN1YnNjcmliZSgoZGF0YTogYW55KSA9PiB7XG4gICAgICB0aGlzLnNhcERhdGFIYW5kbGUoZGF0YSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5omT5byA5qih5oCB5qGGXG4gICAqIEByZXR1cm5zXG4gICAqL1xuICBzaG93RGlhbG9nKCk6IGFueSB7XG4gICAgdGhpcy5mYXJyaXNMaXN0Vmlldy5saXN0Q2xpY2suZW1pdCh7XG4gICAgICBkYXRhOiBbdGhpcy50YWJsZURhdGFbMF1dLFxuICAgICAgaW5kZXg6IDAsXG4gICAgICBjaGVja0NoYW5nZUV2ZW50OiBmYWxzZVxuICAgIH0pO1xuICAgIHRoaXMuZmFycmlzTGlzdFZpZXcuY2xpY2tJdGVtID0gdGhpcy50YWJsZURhdGFbMF07XG4gICAgdGhpcy5kaWFsb2cuc2hvdygpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiDosIPnlKhzYXDlpJbpg6jmnI3liqHvvIzlh7rlj4LlnKhuZ09uaW5pdOebkeWQrFxuICAgKi9cbiAgY2FsbFNhcFNlcnZpY2UoKSB7XG4gICAgdGhpcy5maWVsZFRleHRDaGFuZ2UoKTtcbiAgICB0aGlzLmV4dEludGdydG5TcnZjLnF1ZXJ5RXh0SW50ZWdyYXRpb25TZXJ2aWNlKFxuICAgICAgdGhpcy5leHRlcm5hbFBhcmFtcyxcbiAgICAgIHRoaXMuc2VydmljZUNvZGVcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhnNhcOWHuuWPglxuICAgKiBAcGFyYW0gZGF0YSBzYXDlh7rlj4JcbiAgICovXG4gIHNhcERhdGFIYW5kbGUoZGF0YSkge1xuICAgIGlmICghZGF0YSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBsZXQgdGFibGVOYW1lTGlzdCA9IE9iamVjdC5rZXlzKGRhdGEpO1xuICAgIGxldCBtYXBUYWJsZUxpc3QgPSB0aGlzLmdldFRhYmxlTGlzdEZyb21NYXBGaWVsZHMoKTtcbiAgICAvLyDlj5bkuqTpm4ZcbiAgICB0YWJsZU5hbWVMaXN0ID0gdGFibGVOYW1lTGlzdC5maWx0ZXIoaXRlbSA9PiB7XG4gICAgICByZXR1cm4gbWFwVGFibGVMaXN0LmluZGV4T2YoaXRlbSkgIT0gLTE7XG4gICAgfSk7XG4gICAgLy8g5aSa6KGo5Zy65pmvXG4gICAgaWYgKHRhYmxlTmFtZUxpc3QubGVuZ3RoID4gMSkge1xuICAgICAgLy8g5qCh6aqM5piv5ZCm5by55Ye65qih5oCB5qGGXG4gICAgICBsZXQgb3BlbkRpYWxvZ0ZsYWcgPSB0aGlzLmNoZWNrTXVsdGlUYWJsZURhdGEoZGF0YSwgdGFibGVOYW1lTGlzdCk7XG4gICAgICBpZiAob3BlbkRpYWxvZ0ZsYWcgPT0gXCJvcGVuXCIpIHtcbiAgICAgICAgLy8g57uE6KOF5qih5oCB5qGG5pWw5o2uXG4gICAgICAgIHRoaXMuYXNzZW1ibGVUYWJsZURhdGEoZGF0YSk7XG4gICAgICAgIHRoaXMuc2hvd0RpYWxvZygpO1xuICAgICAgfSBlbHNlIGlmIChvcGVuRGlhbG9nRmxhZyA9PSBcImJhY2tmaWxsXCIpIHtcbiAgICAgICAgLy8g5aSa6KGo77yM5q+P5Liq6KGo5Y+q5pyJ5LiA5p2h5pWw5o2uXG4gICAgICAgIGxldCBiYWNrZmlsbERhdGE6IGFueSA9IHt9O1xuICAgICAgICB0YWJsZU5hbWVMaXN0LmZvckVhY2godGFibGVOYW1lID0+IHtcbiAgICAgICAgICBPYmplY3QuYXNzaWduKFxuICAgICAgICAgICAgYmFja2ZpbGxEYXRhLFxuICAgICAgICAgICAgdGhpcy5hc3NlbWJsZVNhcERhdGEodGFibGVOYW1lLCBkYXRhW3RhYmxlTmFtZV1bMF0pXG4gICAgICAgICAgKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2VuZFNhcERhdGEoYmFja2ZpbGxEYXRhKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIOWkmuihqOaXoOaVsOaNrlxuICAgICAgICB0aGlzLnNlbmRTYXBEYXRhKCk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0YWJsZU5hbWVMaXN0Lmxlbmd0aCA9PSAxKSB7XG4gICAgICBsZXQgdGFibGVOYW1lID0gdGFibGVOYW1lTGlzdFswXTtcbiAgICAgIGxldCBzYXBEYXRhTGVuZ3RoID0gKGRhdGFbdGFibGVOYW1lXSB8fCBbXSkubGVuZ3RoO1xuICAgICAgaWYgKHNhcERhdGFMZW5ndGggPiAwKSB7XG4gICAgICAgIGlmIChzYXBEYXRhTGVuZ3RoID09IDEpIHtcbiAgICAgICAgICAvLyDkuIDkuKrooajlj6rmnInkuIDmnaHmlbDmja5cbiAgICAgICAgICBsZXQgc2FwRGF0YSA9IHRoaXMuYXNzZW1ibGVTYXBEYXRhKHRhYmxlTmFtZSwgZGF0YVt0YWJsZU5hbWVdWzBdKTtcbiAgICAgICAgICB0aGlzLnNlbmRTYXBEYXRhKHNhcERhdGEpO1xuICAgICAgICB9IGVsc2UgaWYgKHNhcERhdGFMZW5ndGggPiAxKSB7XG4gICAgICAgICAgLy8g5LiA5Liq6KGo5pyJ5aSa5p2h5pWw5o2uXG4gICAgICAgICAgdGhpcy5hc3NlbWJsZVRhYmxlRGF0YShkYXRhKTtcbiAgICAgICAgICB0aGlzLnNob3dEaWFsb2coKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8g5aSE55CG5p+l6K+i5byC5bi477yMZWRpdG9y5rKh5pyJZW5kUGVuZGluZ1xuICAgICAgdGhpcy5zZW5kU2FwRGF0YSgpO1xuICAgIH1cbiAgfVxuXG4gIGNoZWNrTXVsdGlUYWJsZURhdGEoZGF0YSwgdGFibGVOYW1lTGlzdCkge1xuICAgIGxldCBvcGVuRGlhbG9nRmxhZyA9IFwiXCI7XG4gICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHRhYmxlTmFtZUxpc3QubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICBsZXQgdGFibGVOYW1lID0gdGFibGVOYW1lTGlzdFtpbmRleF07XG4gICAgICBpZiAoZGF0YVt0YWJsZU5hbWVdLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgb3BlbkRpYWxvZ0ZsYWcgPSBcIm9wZW5cIjtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9IGVsc2UgaWYgKGRhdGFbdGFibGVOYW1lXS5sZW5ndGggPT0gMCAmJiBvcGVuRGlhbG9nRmxhZyAhPSBcImJhY2tmaWxsXCIpIHtcbiAgICAgICAgb3BlbkRpYWxvZ0ZsYWcgPSBcIm5vbmVcIjtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBvcGVuRGlhbG9nRmxhZyA9IFwiYmFja2ZpbGxcIjtcbiAgICB9XG4gICAgcmV0dXJuIG9wZW5EaWFsb2dGbGFnO1xuICB9XG5cbiAgLyoqXG4gICAqIOe7hOijheaooeaAgeahhuaVsOaNrlxuICAgKiBAcGFyYW0gZGF0YSBzYXDlh7rlj4JcbiAgICovXG4gIGFzc2VtYmxlVGFibGVEYXRhKGRhdGEpIHtcbiAgICBsZXQgdGFibGVOYW1lTGlzdCA9IE9iamVjdC5rZXlzKGRhdGEpO1xuICAgIGxldCBtYXBUYWJsZUxpc3QgPSB0aGlzLmdldFRhYmxlTGlzdEZyb21NYXBGaWVsZHMoKTtcbiAgICAvLyDlj5bkuqTpm4ZcbiAgICBtYXBUYWJsZUxpc3QgPSBtYXBUYWJsZUxpc3QuZmlsdGVyKGl0ZW0gPT4ge1xuICAgICAgcmV0dXJuIHRhYmxlTmFtZUxpc3QuaW5kZXhPZihpdGVtKSAhPSAtMTtcbiAgICB9KTtcbiAgICBpZiAobWFwVGFibGVMaXN0Lmxlbmd0aCA+IDApIHtcbiAgICAgIC8vIOmBjeWOhnNhcOaYoOWwhOihqO+8jOe7hOijheihqOWPiuWvueW6lOaVsOaNrlxuICAgICAgbWFwVGFibGVMaXN0LmZvckVhY2gobWFwVGFibGUgPT4ge1xuICAgICAgICAvLyDnu4Too4XmqKHmgIHmoYbkuK3ljZXooajmlbDmja5cbiAgICAgICAgbGV0IHRhYmxlSW5mbyA9IHRoaXMuYXNzZW1ibGVUYWJsZUluZm8obWFwVGFibGUsIGRhdGEpO1xuICAgICAgICBpZiAoXG4gICAgICAgICAgdGFibGVJbmZvICYmXG4gICAgICAgICAgT2JqZWN0LmtleXModGFibGVJbmZvKS5sZW5ndGggPiAwICYmXG4gICAgICAgICAgKHRhYmxlSW5mby5kYXRhIHx8IFtdKS5sZW5ndGggPiAwXG4gICAgICAgICkge1xuICAgICAgICAgIHRoaXMudGFibGVEYXRhLnB1c2godGFibGVJbmZvKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgZ2V0VGFibGVMaXN0RnJvbU1hcEZpZWxkcygpIHtcbiAgICAvLyDojrflj5bpnIDopoHlm57loavnmoTooahcbiAgICBsZXQgbWFwS2V5TGlzdCA9IE9iamVjdC5rZXlzKHRoaXMubXlGaWVsZCk7XG4gICAgLy8g5a6a5LmJc2Fw5pig5bCE6KGo6ZuG5ZCIXG4gICAgbGV0IG1hcFRhYmxlTGlzdCA9IFtdO1xuICAgIChtYXBLZXlMaXN0IHx8IFtdKS5mb3JFYWNoKG1hcEtleSA9PiB7XG4gICAgICAvLyDlnKjmmKDlsITlhbPns7vkuK3ojrflj5ZzYXDlh7rlj4LkuK3nmoTooajpm4blkIhcbiAgICAgIG1hcFRhYmxlTGlzdC5wdXNoKG1hcEtleS5zcGxpdChcIi5cIilbMF0pO1xuICAgIH0pO1xuICAgIC8vIOWOu+mHjVxuICAgIG1hcFRhYmxlTGlzdCA9IEFycmF5LmZyb20obmV3IFNldChtYXBUYWJsZUxpc3QpKTtcbiAgICByZXR1cm4gbWFwVGFibGVMaXN0O1xuICB9XG5cbiAgLyoqXG4gICAqIOe7hOijheaooeaAgeahhuS4reWNleihqOaVsOaNrlxuICAgKiBAcGFyYW0gbWFwVGFibGUg6KGo5ZCNXG4gICAqIEBwYXJhbSBkYXRhIHNhcOWHuuWPglxuICAgKiBAcmV0dXJucyDmqKHmgIHmoYbljZXooajmlbDmja7lr7nosaFcbiAgICovXG4gIGFzc2VtYmxlVGFibGVJbmZvKG1hcFRhYmxlLCBkYXRhKSB7XG4gICAgLy8g5qih5oCB5qGG5Y2V6KGo5pWw5o2u5a+56LGhXG4gICAgbGV0IHRhYmxlSW5mbzogVGFibGVJbmZvID0ge1xuXG4gICAgfTtcbiAgICAvLyDooajlpLTpm4blkIhcbiAgICBsZXQgdGFibGVDb2x1bW5MaXN0ID0gW107XG4gICAgLy8g6YGN5Y6Gc2Fw5Ye65Y+C6KGo5L+h5oGv77yM6I635Y+W6KGo5aS05Lit5paH44CB6KGo5ZCNXG4gICAgKHRoaXMuZXh0VGFibGVTY2hlbWFzIHx8IFtdKS5mb3JFYWNoKHRhYmxlU2NoZW1hID0+IHtcbiAgICAgIGlmICh0YWJsZVNjaGVtYS5jb2RlID09IG1hcFRhYmxlKSB7XG4gICAgICAgIHRhYmxlSW5mby5uYW1lID0gdGFibGVTY2hlbWEubmFtZTtcbiAgICAgICAgLy8g5qih5ouf5Li76ZSu77yM5L+d6K+BZmFycmlzLWdyaWTnu4Tku7bjgJDljZXpgInjgJHlip/og73mraPluLhcbiAgICAgICAgbGV0IGlkQ29sdW1uOiBUYWJsZUNvbHVtbiA9IHt9O1xuICAgICAgICBpZENvbHVtbi5maWVsZCA9IFwiaWRcIjtcbiAgICAgICAgaWRDb2x1bW4udGl0bGUgPSBcIuW6j+WPt1wiO1xuICAgICAgICB0YWJsZUNvbHVtbkxpc3QucHVzaChpZENvbHVtbik7XG4gICAgICAgIC8vIOe7hOijheihqOWktFxuICAgICAgICB0YWJsZVNjaGVtYS5jb2x1bW5zLmZvckVhY2goY29sdW1uID0+IHtcbiAgICAgICAgICBsZXQgdGFibGVDb2x1bW46IFRhYmxlQ29sdW1uID0ge307XG4gICAgICAgICAgdGFibGVDb2x1bW4uZmllbGQgPSBjb2x1bW4uY29kZTtcbiAgICAgICAgICB0YWJsZUNvbHVtbi50aXRsZSA9IGNvbHVtbi5uYW1lO1xuICAgICAgICAgIHRhYmxlQ29sdW1uTGlzdC5wdXNoKHRhYmxlQ29sdW1uKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRhYmxlSW5mby5jb2x1bW5zID0gdGFibGVDb2x1bW5MaXN0O1xuICAgICAgICB0YWJsZUluZm8uY29kZSA9IG1hcFRhYmxlO1xuICAgICAgICAvLyDnu5nooajmlbDmja7lop7liqDmqKHmi5/kuLvplK5cbiAgICAgICAgKGRhdGFbbWFwVGFibGVdIHx8IFtdKS5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xuICAgICAgICAgIGl0ZW1bXCJpZFwiXSA9IGluZGV4ICsgMTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRhYmxlSW5mby5kYXRhID0gZGF0YVttYXBUYWJsZV07XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHRhYmxlSW5mbztcbiAgfVxuXG4gIC8qKlxuICAgKiDlr7zoiKrmoI/ngrnlh7vkuovku7ZcbiAgICogQHBhcmFtIGV2ZW50IOWvvOiIquagj+S/oeaBr1xuICAgKiBAcmV0dXJuc1xuICAgKi9cbiAgbGlzdENsaWNrKGV2ZW50KSB7XG4gICAgbGV0IGNsaWNrRGF0YSA9IGV2ZW50LmRhdGE7XG4gICAgaWYgKGV2ZW50LmRhdGEuZGlzYWJsZSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodHlwZW9mIHRoaXMuY3VycmVudExpbmtbXCJkYXRhXCJdICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIGlmIChjbGlja0RhdGFbMF0uY29kZSA9PT0gdGhpcy5jdXJyZW50TGlua1tcImRhdGFcIl1bMF0uY29kZSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmN1cnJlbnRMaW5rID0gZXZlbnQ7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuY3VycmVudExpbmsgPSBldmVudDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5qih5oCB5qGG77yM56Gu5a6a77yM5Y+W5raI5oyJ6ZKuXG4gICAqIEBwYXJhbSBmbGFnIGVuc3VyZTrnoa7lrprmjInpkq7vvIxjYW5jZWzvvJrlj5bmtojmjInpkq5cbiAgICovXG5cbiAgY29uZmlybShmbGFnKSB7XG4gICAgLy8g54K55Ye756Gu5a6a5oyJ6ZKuXG4gICAgaWYgKGZsYWcgPT0gXCJlbnN1cmVcIikge1xuICAgICAgbGV0IHNhcERhdGE6IGFueSA9IHt9O1xuICAgICAgLy8g6YGN5Y6G5qih5oCB5qGG6KGo5pWw5o2u77yM57uE6KOF5Zue5aGr5pWw5o2uXG4gICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgdGhpcy50YWJsZURhdGEubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgIGxldCB0YWJsZUluZm8gPSB0aGlzLnRhYmxlRGF0YVtpbmRleF07XG4gICAgICAgIE9iamVjdC5hc3NpZ24oXG4gICAgICAgICAgc2FwRGF0YSxcbiAgICAgICAgICB0aGlzLmFzc2VtYmxlU2FwRGF0YSh0YWJsZUluZm8uY29kZSwgdGFibGVJbmZvLnNlbGVjdGVkRGF0YS5kYXRhKVxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgdGhpcy5zZW5kU2FwRGF0YShzYXBEYXRhKTtcbiAgICB9XG4gICAgLy8g5riF56m65qih5oCB5qGG5pWw5o2uXG4gICAgdGhpcy50YWJsZURhdGEgPSBbXTtcbiAgICAvLyDlhbPpl63mqKHmgIHmoYZcbiAgICB0aGlzLmRpYWxvZy5jbG9zZSgpO1xuICB9XG5cbiAgYmVmb3JlQ2xvc2UgPSAoKSA9PiB7XG4gICAgdGhpcy50YWJsZURhdGEgPSBbXTtcbiAgICB0aGlzLmVuc3VyZUZsYWcgPSB0cnVlO1xuICAgIHRoaXMuc2VuZFNhcERhdGEoKTtcbiAgICByZXR1cm4gb2YodHJ1ZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIOmAieS4reS4gOihjOS6i+S7tlxuICAgKiBAcGFyYW0gc2VsZWN0ZWRSb3cg6YCJ5Lit6KGM5pWw5o2uXG4gICAqIEBwYXJhbSB0YWJsZU5hbWUg5b2T5YmN6KGo5qC85a+55bqU6KGo5ZCNXG4gICAqL1xuICBzZWxlY3RSb3dDaGFuZ2Uoc2VsZWN0ZWRSb3csIHRhYmxlTmFtZSkge1xuICAgIHRoaXMudGFibGVEYXRhLmZvckVhY2godGFibGVJbmZvID0+IHtcbiAgICAgIGlmICh0YWJsZUluZm8uY29kZSA9PSB0YWJsZU5hbWUpIHtcbiAgICAgICAgdGFibGVJbmZvLnNlbGVjdGVkRGF0YSA9IHNlbGVjdGVkUm93O1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuc2V0RW5zdXJlQnV0dG9uRmxhZygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWPlua2iOS4gOihjOS6i+S7tlxuICAgKiBAcGFyYW0gc2VsZWN0ZWRSb3cg6KKr5Y+W5raI6KGM5pWw5o2uXG4gICAqIEBwYXJhbSB0YWJsZU5hbWUg5b2T5YmN6KGo5qC85a+55bqU6KGo5ZCNXG4gICAqL1xuICB1blNlbGVjdChzZWxlY3RlZFJvdywgdGFibGVOYW1lKSB7XG4gICAgdGhpcy50YWJsZURhdGEuZm9yRWFjaCh0YWJsZUluZm8gPT4ge1xuICAgICAgaWYgKHRhYmxlSW5mby5jb2RlID09IHRhYmxlTmFtZSkge1xuICAgICAgICB0YWJsZUluZm8uc2VsZWN0ZWREYXRhID0gbnVsbDtcbiAgICAgICAgdGFibGVJbmZvLnNlbGVjdGVkVmFsdWUgPSBcIlwiO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHNlbGVjdGVkUm93ID0gbnVsbDtcbiAgICB0aGlzLnNldEVuc3VyZUJ1dHRvbkZsYWcoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDorr7nva7mqKHmgIHmoYbnoa7lrprmjInpkq7mmK/lkKblj6/nlKhcbiAgICovXG4gIHNldEVuc3VyZUJ1dHRvbkZsYWcoKSB7XG4gICAgbGV0IGZsYWcgPSBmYWxzZTtcbiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgdGhpcy50YWJsZURhdGEubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICBsZXQgdGFibGVJbmZvID0gdGhpcy50YWJsZURhdGFbaW5kZXhdO1xuICAgICAgaWYgKCF0YWJsZUluZm8uc2VsZWN0ZWREYXRhKSB7XG4gICAgICAgIGZsYWcgPSB0cnVlO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5lbnN1cmVGbGFnID0gZmxhZztcbiAgfVxuXG4gIC8qKlxuICAgKiDnu4Too4VzYXDlm57loavmlbDmja5cbiAgICogQHBhcmFtIHRhYmxlTmFtZSDooajlkI1cbiAgICogQHBhcmFtIHRhYmxlRGF0YSDooajmlbDmja5cbiAgICogQHJldHVybnMgKOihqOWQjS7ooajlrZfmrrXlkI066KGo5pWw5o2uKTpPYmplY3RcbiAgICovXG4gIGFzc2VtYmxlU2FwRGF0YSh0YWJsZU5hbWUsIHRhYmxlRGF0YSkge1xuICAgIGlmICghdGFibGVOYW1lIHx8ICF0YWJsZURhdGEpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gc2Fw5Zue5aGr5pWw5o2uXG4gICAgbGV0IHNhcERhdGE6IGFueSA9IHt9O1xuICAgIC8vIOihqOWtl+auteWQjembhuWQiFxuICAgIGxldCB0YWJsZURhdGFJdGVtS2V5cyA9IE9iamVjdC5rZXlzKHRhYmxlRGF0YSk7XG4gICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHRhYmxlRGF0YUl0ZW1LZXlzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgbGV0IGl0ZW1LZXkgPSB0YWJsZURhdGFJdGVtS2V5c1tpbmRleF07XG4gICAgICAvLyBzYXDlm57loavmlbDmja5rZXk9IOihqOWQjS7ooajlrZfmrrXlkI1cbiAgICAgIGxldCBrZXkgPSB0YWJsZU5hbWUgKyBcIi5cIiArIGl0ZW1LZXk7XG4gICAgICBzYXBEYXRhW2tleV0gPSB0YWJsZURhdGFbaXRlbUtleV07XG4gICAgfVxuICAgIHJldHVybiBzYXBEYXRhO1xuICB9XG5cbiAgLyoqXG4gICAqIOWbnuWhq3NhcOaVsOaNrlxuICAgKiBAcGFyYW0gc2FwRGF0YSDlsIbopoHlm57loavnmoRzYXDmlbDmja5cbiAgICovXG4gIHByaXZhdGUgc2VuZFNhcERhdGEoc2FwRGF0YT8pIHtcbiAgICBpZiAoc2FwRGF0YSkge1xuICAgICAgdGhpcy5zZWxlY3RTYXBEYXRhLmVtaXQoc2FwRGF0YSk7XG4gICAgfVxuICAgIC8vIOWtkOihqOWFs+mXrWVkaXRvcueKtuaAgVxuICAgIGlmICh0aGlzLm1hcHBpbmdUeXBlID09IFwiZ3JpZFwiKSB7XG4gICAgICB0aGlzLmFmdGVyT25ibHVyLmVtaXQoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldEJpbmRpbmdQYXRoQXJyYXkoKTogYW55W10ge1xuICAgIGNvbnN0IHBhdGggPSB0aGlzLnZtLmJpbmRpbmdQYXRoO1xuICAgIGlmIChwYXRoKSB7XG4gICAgICByZXR1cm4gcGF0aC5zcGxpdChcIi9cIikuZmlsdGVyKG4gPT4gbiAhPT0gXCJcIik7XG4gICAgfVxuICAgIHJldHVybiBbXTtcbiAgfVxufVxuIl19