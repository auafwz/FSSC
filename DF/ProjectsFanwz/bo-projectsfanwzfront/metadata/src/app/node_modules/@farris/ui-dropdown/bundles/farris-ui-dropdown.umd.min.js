!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("rxjs"),require("@angular/core"),require("@angular/common")):"function"==typeof define&&define.amd?define("@farris/ui-dropdown",["exports","rxjs","@angular/core","@angular/common"],t):t((e.farris=e.farris||{},e.farris["ui-dropdown"]={}),e.rxjs,e.ng.core,e.ng.common)}(this,function(e,i,o,t){"use strict";var n=(Object.defineProperty(s.prototype,"forceState",{set:function(e){e&&e.length&&this.close()},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"openState",{set:function(e){this._internalOpen=e[0],this.isOpenState.next(e[0])},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"placement",{get:function(){return this._placement},set:function(e){if(e&&e!==this._placement){var t=this._getClsName(e),n=this._getClsName(this._placement);this.render.removeClass(this._seflEl,n),this.render.addClass(this._seflEl,t),this._placement=e}},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isOpen",{get:function(){return this._internalOpen},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"submenuCls",{get:function(){return this.isSubDP},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"dropdownCls",{get:function(){return!this.isSubDP},enumerable:!0,configurable:!0}),s.prototype.ngOnInit=function(){},s.prototype.getNativeElement=function(){return this._seflEl},s.prototype.bindDocumentEvents=function(){this.documentClickEventListener=this.onDocumentClick.bind(this),document.addEventListener("click",this.documentClickEventListener),this.selfDefineEventListener=this.onSelfDefineHandler.bind(this),this._seflEl.addEventListener("selfClose",this.selfDefineEventListener)},s.prototype.onSelfDefineHandler=function(){this.close()},s.prototype.unbindDocumentEvents=function(){this.documentClickEventListener&&(document.removeEventListener("click",this.documentClickEventListener),this.documentClickEventListener=null),this.selfDefineEventListener&&(this._seflEl.removeEventListener("selfClose",this.selfDefineEventListener),this.selfDefineEventListener=null)},s.prototype.onDocumentClick=function(e){this._internalOpen&&(2===e.button||this.isEventFromToggle(e)||this.close())},s.prototype.needToCalculate=function(){return this.autoRectify&&this._calculateMenu},s.prototype.resetCalculate=function(e){this._calculateMenu=e},s.prototype.open=function(){this._internalOpen||(this.closeSiblingDropdowns(),this._calculateMenu=!0,this.render.addClass(this._seflEl,"show"),this.isOpenState.next(!0),this.dpChangeEvent.emit(!0),this.bindDocumentEvents())},s.prototype.close=function(){this._internalOpen&&(this._calculateMenu=!1,this.render.removeClass(this._seflEl,"show"),this.isOpenState.next(!1),this.dpChangeEvent.emit(!1),this.unbindDocumentEvents())},s.prototype.toggle=function(){this._internalOpen?this.close():this.open()},s.prototype.getOpenState=function(){return this.isOpenState},s.prototype.ngOnDestroy=function(){this.isOpenState.unsubscribe(),this.unbindDocumentEvents()},s.prototype.closeSiblingDropdowns=function(){var e=this._seflEl.parentNode;if(e&&-1<e.className.indexOf("dropdown-menu")){var t=e.querySelectorAll("[fDropdown]");if(t&&1<t.length)for(var n=0;n<t.length;n++)t[n].className.indexOf("show")&&this.compatibleDispatchEvent(t[n],"selfClose")}},s.prototype.compatibleDispatchEvent=function(e,t){var n;"function"==typeof Event?n=new Event(t):(n=document.createEvent("Event")).initEvent(t,!1,!1),e.dispatchEvent(n)},s.prototype._getClsName=function(e){var t="";switch(e){case"top-right":case"top":t="dropup";break;case"top-left":t="dropup-left";break;case"left-bottom":case"left":t="dropleft";break;case"left-top":t="dropleft-up";break;case"right-bottom":case"right":t="dropright";break;case"right-top":t="dropright-up";break;case"bottom-left":t="dropdown-left";break;case"bottom-right":t="dropdown";break;default:t="dropdown"}return t},s.prototype.isEventFromToggle=function(e){return this.toggleElement&&this.toggleElement.contains(e.target)},s.prototype.getRectifyReferenceEl=function(){var e=window.innerWidth,t=window.innerHeight;return this.rectifyReference&&(e=this.rectifyReference.getBoundingClientRect().right),this.rectifyReferenceV&&(e=this.rectifyReference.getBoundingClientRect().bottom),{width:e,height:t}},s.decorators=[{type:o.Directive,args:[{selector:"[fDropdown]",exportAs:"fDropdown"}]}],s.ctorParameters=function(){return[{type:o.ElementRef},{type:o.Renderer2}]},s.propDecorators={rectifyReference:[{type:o.Input}],rectifyReferenceV:[{type:o.Input}],autoRectify:[{type:o.Input}],forceState:[{type:o.Input,args:["forceState"]}],openState:[{type:o.Input,args:["open"]}],dpChangeEvent:[{type:o.Output}],isSubDP:[{type:o.Input}],placement:[{type:o.Input,args:["placement"]}],submenuCls:[{type:o.HostBinding,args:["class.dropdown-submenu"]}],dropdownCls:[{type:o.HostBinding,args:["class.dropdown"]}]},s);function s(e,t){var n=this;this.render=t,this._internalOpen=!1,this._calculateMenu=!1,this.autoRectify=!1,this.dpChangeEvent=new o.EventEmitter,this._placement="bottom",this.isSubDP=!1,this.isOpenState=new i.Subject,this._seflEl=e.nativeElement,this.isOpenState.subscribe(function(e){n._internalOpen!==e&&(n._internalOpen=e,n._internalOpen?n.render.addClass(n._seflEl,"show"):n.render.removeClass(n._seflEl,"show"))})}var r=(p.prototype.ngAfterViewChecked=function(){},p.prototype.getRealPlacement=function(e){var t="bottom-right";switch(e){case"top":t="top-right";break;case"left":t="left-bottom";break;case"right":t="right-bottom";break;case"bottom":t="bottom-right";break;default:t=e}return t},p.prototype.openStateChange=function(){var e=this;this.dpIsOpen?this.elementRef.nativeElement.className.indexOf("show")<0&&(this.elementRef.nativeElement.className+=" show",this.dropdown.needToCalculate()&&(this._docRect=this.dropdown.getRectifyReferenceEl()),setTimeout(function(){e.changeDirection()},0)):-1<this.elementRef.nativeElement.className.indexOf("show")&&(this.elementRef.nativeElement.className=this.elementRef.nativeElement.className.replace(" show"," "))},p.prototype.changeDirection=function(){if(this.dropdown.needToCalculate()){var e=this.elementRef.nativeElement.getBoundingClientRect(),t=this.dropdown.placement,n=this.getRealPlacement(t);-1<(t=n).indexOf("right")&&e.right>this._docRect.width&&(t=t.replace("right","left")),-1<n.indexOf("left")&&e.left-e.width<0&&(t=t.replace("left","right")),-1<n.indexOf("bottom")&&e.bottom>this._docRect.height&&(t=t.replace("down","up")),-1<n.indexOf("up")&&e.bottom-e.height<0&&(t=t.replace("up","bottom")),n!==this.dropdown.placement&&(this.dropdown.placement=n),t!==n&&(this.dropdown.placement=t),this.dropdown.resetCalculate(!1)}},p.decorators=[{type:o.Directive,args:[{selector:"[fDropdownMenu]"}]}],p.ctorParameters=function(){return[{type:o.ElementRef},{type:n}]},p.propDecorators={showDropdownMenu:[{type:o.HostBinding,args:["class.dropdown-menu"]}],dpIsOpen:[{type:o.Input}]},p);function p(e,t){this.elementRef=e,this.dropdown=t,this._docRect={width:0,height:0},this.showDropdownMenu=!0,this.dpIsOpen=!1;var n=this;this.dropdown.getOpenState().subscribe(function(e){n.dpIsOpen=n.dropdown.isOpen,n.openStateChange()})}var l=(Object.defineProperty(a.prototype,"dpDisabled",{set:function(e){this._disabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"disableCls",{get:function(){return this._disabled},enumerable:!0,configurable:!0}),a.prototype.onclick=function(e){this._disabled||(this.dropdown.isSubDP&&e.stopImmediatePropagation(),this.dropdown.toggle())},a.decorators=[{type:o.Directive,args:[{selector:"[fDropdownToggle]"}]}],a.ctorParameters=function(){return[{type:n},{type:o.ElementRef}]},a.propDecorators={dpDisabled:[{type:o.Input}],disableCls:[{type:o.HostBinding,args:["class.disabled"]}],haspopup:[{type:o.HostBinding,args:["attr.aria-haspopup"]}],onclick:[{type:o.HostListener,args:["click",["$event"]]}]},a);function a(e,t){var n=this;this.dropdown=e,this.elementRef=t,this._disabled=!1,this.haspopup=!0,this.nativeEle=null,e.toggleElement=t.nativeElement,this.nativeEle=t.nativeElement,this.dropdown.getOpenState().subscribe(function(e){n.dropdown.isSubDP&&n.dropdown.isOpen?n.nativeEle.className.indexOf("active")<0&&(n.nativeEle.className+=" active"):-1<n.nativeEle.className.indexOf("active")&&(n.nativeEle.className=n.nativeEle.className.replace(" active"," "))})}var c=[n,r,l],d=(u.decorators=[{type:o.NgModule,args:[{declarations:c,exports:c}]}],u);function u(){}var h=(Object.defineProperty(f.prototype,"width",{get:function(){return this._width},set:function(e){this._width=this.resolveSize(e)},enumerable:!0,configurable:!0}),f.prototype.ngOnInit=function(){this.menu=this.el.nativeElement.querySelector(".dropdown-menu")},f.prototype.ngAfterViewInit=function(){},f.prototype.ngOnDestroy=function(){this.globalListenFunc&&this.globalListenFunc()},f.prototype.showDropMenu=function(e){var t=this;this.hover||(e&&e.stopPropagation(),this.show=!this.show,this.visibleChange.emit(),this.globalListenFunc=this.renderer.listen("document","click",function(){t.closeDropMenu()}),this.hideOnClick||(this.menuListenFunc=this.renderer.listen(this.menu,"click",function(e){e.stopPropagation()})))},f.prototype.closeDropMenu=function(){this.hover||(this.show=!1,this.visibleChange.emit(),this.globalListenFunc&&this.globalListenFunc(),this.menuListenFunc&&this.menuListenFunc())},f.prototype.hoverDropdown=function(){this.hover&&(this.show=!this.show,this.visibleChange.emit())},f.prototype.selectItem=function(e){this.select.emit(e)},f.prototype.leftButtonClick=function(){this.leftClick.emit()},f.prototype.resolveSize=function(e){var t=/px|em|rem|pt|%/;return t.test(e)?""+parseInt(e,10)+e.match(t)[0]:e+"px"},f.decorators=[{type:o.Component,args:[{selector:"farris-dropdown",template:'\n        <div\n            class="farris-dropdown btn-group"\n            [class.dropup]="position === \'top\'"\n            [class.dropdown]="position === \'bottom\'"\n            [class.dropleft]="position === \'left\'"\n            [class.dropright]="position === \'right\'"\n            [style.width]="width"\n        >\n            <span\n                [class.btn]="!nest"\n                [class.dropdown-item]="nest"\n                [class.btn-lg]="size === \'large\'"\n                [class.btn-sm]="size === \'small\'"\n                [class.btn-primary]="type === \'primary\'"\n                [class.btn-success]="type === \'success\'"\n                [class.btn-warning]="type === \'warning\'"\n                [class.btn-danger]="type === \'danger\'"\n                [class.btn-info]="type === \'info\'"\n                (click)="leftButtonClick()"\n                style="width:100%"\n                *ngIf="splitButton"\n                >{{ title }}</span\n            >\n            <span\n                class="dropdown-toggle"\n                [class.btn]="!nest"\n                [class.dropdown-item]="nest"\n                [class.dropdown-toggle-split]="splitButton"\n                [class.btn-lg]="size === \'large\'"\n                [class.btn-sm]="size === \'small\'"\n                [class.btn-primary]="type === \'primary\'"\n                [class.btn-success]="type === \'success\'"\n                [class.btn-warning]="type === \'warning\'"\n                [class.btn-danger]="type === \'danger\'"\n                [class.btn-info]="type === \'info\'"\n                [class.btn-secondary]="type === \'secondary\'"\n                (click)="showDropMenu($event)"\n                (mouseenter)="hoverDropdown()"\n                (mouseleave)="hoverDropdown()"\n                style="width:100%"\n            >\n                <span class="sr-only" *ngIf="splitButton"></span>\n                {{ splitButton ? \'\' : title }}\n            </span>\n            <div class="dropdown-menu" [class.show]="show">\n                <ng-template [ngTemplateOutlet]="dropdownTempl"></ng-template>\n                <farris-dropdown-item\n                    *ngFor="let item of model"\n                    [model]="item"\n                    (select)="selectItem($event)"\n                >\n                </farris-dropdown-item>\n            </div>\n        </div>\n    '}]}],f.ctorParameters=function(){return[{type:o.ElementRef},{type:o.Renderer2}]},f.propDecorators={nest:[{type:o.Input}],width:[{type:o.Input}],title:[{type:o.Input}],hover:[{type:o.Input}],size:[{type:o.Input}],type:[{type:o.Input}],hideOnClick:[{type:o.Input,args:["hide-on-click"]}],splitButton:[{type:o.Input,args:["split-button"]}],position:[{type:o.Input}],model:[{type:o.Input}],dropdownTempl:[{type:o.ContentChild,args:["dropdownTempl"]}],leftClick:[{type:o.Output,args:["left-click"]}],select:[{type:o.Output}],visibleChange:[{type:o.Output,args:["visible-change"]}]},f);function f(e,t){this.el=e,this.renderer=t,this.type="primary",this.hideOnClick=!0,this.splitButton=!1,this.position="bottom",this.model=[{label:"项目一",value:"asdasd"},{label:"项目二",value:"asdasd"},{label:"项目三",value:"asdasd"}],this.leftClick=new o.EventEmitter,this.select=new o.EventEmitter,this.visibleChange=new o.EventEmitter,this.show=!1}var m=(g.prototype.selectItem=function(){this.model.disabled||this.select.emit(this.model)},g.decorators=[{type:o.Component,args:[{selector:"farris-dropdown-item",template:'\n        <div class="dropdown-divider" *ngIf="model.divide"></div>\n        <a\n            class="dropdown-item"\n            [class.active]="model.active"\n            [class.disabled]="model.disabled"\n            href="javascript:void(0)"\n            (click)="selectItem()"\n            >{{ model.label }}</a\n        >\n    '}]}],g.propDecorators={model:[{type:o.Input}],select:[{type:o.Output}]},g);function g(){this.select=new o.EventEmitter}var y=(b.decorators=[{type:o.NgModule,args:[{imports:[t.CommonModule],declarations:[h,m],exports:[h,m]}]}],b);function b(){}e.FDropdownDirectiveTypeModule=d,e.FDropdownMenuDirective=r,e.FDropdownToggleDirective=l,e.FDropdownDirective=n,e.FarrisDropdownComponent=h,e.FarrisDropdownItemComponent=m,e.FarrisDropdownModule=y,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=farris-ui-dropdown.umd.min.js.map