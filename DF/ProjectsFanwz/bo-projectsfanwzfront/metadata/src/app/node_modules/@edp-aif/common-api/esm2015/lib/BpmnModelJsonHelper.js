/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
export class BpmnModelJsonHelper {
    /**
     * @param {?} obj
     * @param {?} attributeName
     * @return {?}
     */
    static GetAttributeValue(obj, attributeName) {
        if (obj == null) {
            return null;
        }
        if (obj.hasOwnProperty(attributeName)) {
            return obj[attributeName];
        }
        else {
            return null;
        }
    }
    /**
     * @template T
     * @param {?} obj
     * @param {?} attributeName
     * @param {?} value
     * @return {?}
     */
    static SetAttributeValue(obj, attributeName, value) {
        if (obj == null || value == null)
            return;
        /** @type {?} */
        let jsonArray = [];
        if (value instanceof Array) {
            //判断是否为IJsonSerializable实现类的数组，是则全部调用ConvertToJsonObject序列化，否则直接赋值
            for (let item of value) {
                if (item.hasOwnProperty("ConvertToJsonObject") && item.hasOwnProperty("LoadFromJsonObject")) {
                    jsonArray.push(item.ConvertToJsonObject());
                }
                else {
                    break;
                }
            }
            if (jsonArray.length == value.length) {
                obj[attributeName] = jsonArray;
            }
            else {
                obj[attributeName] = value;
            }
        }
        else if (value.hasOwnProperty("ConvertToJsonObject") && value.hasOwnProperty("LoadFromJsonObject")) {
            //判断是否为IJsonSerializable实现类的对象，是则调用ConvertToJsonObject序列化
            obj[attributeName] = ((/** @type {?} */ (value))).ConvertToJsonObject();
        }
        else if (value instanceof Date) {
            //判断是否为日期类型，是日期类型则转为字符串UTC的yyyyMMDDhhmmssSSS格式字符串
            /** @type {?} */
            const str = BpmnModelJsonHelper.DateTimeToString(value);
            BpmnModelJsonHelper.SetAttributeValue(obj, attributeName, str);
        }
        else {
            obj[attributeName] = value;
        }
    }
    /**
     * @param {?} obj
     * @param {?} attributeName
     * @return {?}
     */
    static GetAttributeValueAsString(obj, attributeName) {
        if (obj == null) {
            return null;
        }
        if (obj.hasOwnProperty(attributeName) == true && typeof (obj[attributeName]) == "string") {
            return obj[attributeName];
        }
        return null;
    }
    /**
     * @param {?} obj
     * @param {?} attributeName
     * @return {?}
     */
    static GetAttributeValueAsBoolean(obj, attributeName) {
        if (obj == null) {
            return null;
        }
        if (obj.hasOwnProperty(attributeName) == true && typeof (obj[attributeName]) == "boolean") {
            return obj[attributeName];
        }
        return null;
    }
    /**
     * @param {?} obj
     * @param {?} attributeName
     * @return {?}
     */
    static GetAttributeValueAsNumber(obj, attributeName) {
        if (obj == null) {
            return null;
        }
        if (obj.hasOwnProperty(attributeName) == true && typeof (obj[attributeName]) == "number") {
            return obj[attributeName];
        }
        return null;
    }
    /**
     * @template ReturnT, ClassOfT
     * @param {?} obj
     * @param {?} attributeName
     * @param {?} classOfT
     * @return {?}
     */
    static GetAttributeValueAsList(obj, attributeName, classOfT) {
        /** @type {?} */
        let jsonArray = BpmnModelJsonHelper.GetAttributeValue(obj, attributeName);
        if (jsonArray == null) {
            return null;
        }
        /** @type {?} */
        let list = [];
        for (let item of jsonArray) {
            /** @type {?} */
            let instance = null;
            try {
                instance = (/** @type {?} */ (new classOfT()));
            }
            catch (e) {
                throw e;
            }
            instance.LoadFromJsonObject(item);
            list.push(instance);
        }
        return list;
    }
    /**
     * @param {?} obj
     * @param {?} attributeName
     * @return {?}
     */
    static GetAttributeValueAsDateTime(obj, attributeName) {
        return BpmnModelJsonHelper.DateTimeFromString(BpmnModelJsonHelper.GetAttributeValueAsString(obj, attributeName));
    }
    /**
     * @template ReturnT, ClassOfT
     * @param {?} obj
     * @param {?} attributeName
     * @param {?} classOfT
     * @return {?}
     */
    static GetAttributeValueAsJsonSerializable(obj, attributeName, classOfT) {
        /** @type {?} */
        let jsonObject = BpmnModelJsonHelper.GetAttributeValue(obj, attributeName);
        if (jsonObject == null) {
            return null;
        }
        /** @type {?} */
        let instance = null;
        try {
            instance = (/** @type {?} */ (new classOfT()));
        }
        catch (e) {
            throw e;
        }
        instance.LoadFromJsonObject(jsonObject);
        return instance;
    }
    /**
     * @param {?} dt
     * @return {?}
     */
    static DateTimeToString(dt) {
        if (dt == null)
            return null;
        /** @type {?} */
        const time = dt.getTime();
        if (time < BpmnModelJsonHelper.MIN_OFFSETDATETIME.getTime() || time > BpmnModelJsonHelper.MAX_OFFSETDATETIME.getTime()) {
            throw `给定的日期时间值 ${dt.toISOString()} 超出支持范围(0001-01-01T12:00:00.000Z - 9999-12-31T23:59:59.000Z):`;
        }
        return BpmnModelJsonHelper.dateFormat(dt, "yyyyMMddHHmmssSSS");
    }
    /**
     *
     * @param {?} str 格式为：yyyyMMddHHmmssSSS
     * @return {?}
     */
    static DateTimeFromString(str) {
        if (str == null)
            return null;
        // const s = `${str.substring(0, 4)}/${str.substring(4, 6)}/${str.substring(6, 8)} ${str.substring(8, 10)}:${str.substring(10, 12)}:${str.substring(12, 14)}.${str.substring(14)}`;
        /** @type {?} */
        const date = new Date();
        date.setUTCFullYear(parseInt(str.substring(0, 4)));
        date.setUTCMonth(parseInt(str.substring(4, 6)) - 1);
        date.setUTCDate(parseInt(str.substring(6, 8)));
        date.setUTCHours(parseInt(str.substring(8, 10)));
        date.setUTCMinutes(parseInt(str.substring(10, 12)));
        date.setUTCSeconds(parseInt(str.substring(12, 14)));
        date.setUTCMilliseconds(parseInt(str.substring(14)));
        return date;
    }
    /**
     * @template T
     * @param {?} value
     * @return {?}
     */
    static ToJson(value) {
        if (value === undefined || value === null) {
            return null;
        }
        /** @type {?} */
        let list = [];
        for (let item of value) {
            list.push(item.ConvertToJsonObject());
        }
        return JSON.stringify(list);
    }
    /**
     * @template ReturnT, ClassOfT
     * @param {?} json
     * @param {?} classOfT
     * @return {?}
     */
    static FromJson(json, classOfT) {
        if (BpmnModelJsonHelper.IsNullOrWhiteSpace(json)) {
            return null;
        }
        /** @type {?} */
        let list = new Array();
        /** @type {?} */
        let jsonArr = JSON.parse(json);
        if (jsonArr == null || Array.isArray(jsonArr) === false) {
            return list;
        }
        jsonArr.forEach((/**
         * @param {?} elt
         * @return {?}
         */
        elt => {
            /** @type {?} */
            let newInstance = (/** @type {?} */ (new classOfT()));
            newInstance.LoadFromJsonObject(elt);
            list.push(newInstance);
        }));
        return list;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    static StringListToJsonArray(value) {
        if (value == null)
            return null;
        /** @type {?} */
        let jsonArray = new Array();
        for (let item of value) {
            jsonArray.push(item);
        }
        return jsonArray;
    }
    /**
     * @param {?} jsonArray
     * @return {?}
     */
    static StringListFromJsonArray(jsonArray) {
        if (jsonArray == null) {
            return null;
        }
        /** @type {?} */
        let list = new Array();
        for (let item of jsonArray) {
            if (typeof item == "object") {
                list.push(JSON.stringify(item));
            }
            else {
                list.push(String(item));
            }
        }
        return list;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    static StringListToJson(value) {
        /** @type {?} */
        let jsonArray = BpmnModelJsonHelper.StringListToJsonArray(value);
        if (jsonArray == null)
            return null;
        return JSON.stringify(jsonArray);
    }
    /**
     * @param {?} json
     * @return {?}
     */
    static StringListFromJson(json) {
        if (BpmnModelJsonHelper.IsNullOrWhiteSpace(json)) {
            return null;
        }
        /** @type {?} */
        let jsonArray = (/** @type {?} */ (JSON.parse(json)));
        if (jsonArray == null) {
            return null;
        }
        return BpmnModelJsonHelper.StringListFromJsonArray(jsonArray);
    }
    /**
     * @param {?} string
     * @return {?}
     */
    static IsNullOrWhiteSpace(string) {
        if (string == null) {
            return true;
        }
        else {
            return string.replace(/(^s*)|(s*$)/g, "").length == 0;
        }
    }
    /**
     * @private
     * @param {?} value
     * @return {?}
     */
    static GetDateFromISO(value) {
        /** @type {?} */
        let a = /^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(value);
        if (a) {
            return new Date(Date.UTC(+a[1], +a[2] - 1, +a[3], +a[4], +a[5], +a[6]));
        }
        else {
            return null;
        }
    }
    /**
     * @private
     * @param {?} date
     * @param {?} fmt
     * @return {?}
     */
    static dateFormat(date, fmt) {
        /** @type {?} */
        let ret;
        /** @type {?} */
        const opt = {
            "y+": date.getUTCFullYear().toString(),
            // 年
            "M+": (date.getUTCMonth() + 1).toString(),
            // 月
            "d+": date.getUTCDate().toString(),
            // 日
            "H+": date.getUTCHours().toString(),
            // 时
            "m+": date.getUTCMinutes().toString(),
            // 分
            "s+": date.getUTCSeconds().toString(),
            // 秒
            "S+": date.getUTCMilliseconds().toString(),
        };
        for (let k in opt) {
            ret = new RegExp("(" + k + ")").exec(fmt);
            if (ret) {
                if (!String.prototype.padStart) {
                    fmt = fmt.replace(ret[1], (ret[1].length == 1) ? (opt[k]) : (BpmnModelJsonHelper.myPadStart(opt[k], ret[1].length, "0")));
                }
                else {
                    fmt = fmt.replace(ret[1], (ret[1].length == 1) ? (opt[k]) : (opt[k].padStart(ret[1].length, "0")));
                }
            }
        }
        return fmt;
    }
    /**
     * @private
     * @param {?} src
     * @param {?} targetLength
     * @param {?} padString
     * @return {?}
     */
    static myPadStart(src, targetLength, padString) {
        targetLength = targetLength >> 0; //floor if number or convert non-number to 0;
        padString = String(typeof padString !== 'undefined' ? padString : ' ');
        if (src.length > targetLength) {
            return String(src);
        }
        else {
            targetLength = targetLength - src.length;
            if (targetLength > padString.length) {
                padString += padString.repeat(targetLength / padString.length); //append to original to ensure we are longer than needed
            }
            return padString.slice(0, targetLength) + String(src);
        }
    }
}
BpmnModelJsonHelper.MIN_OFFSETDATETIME = BpmnModelJsonHelper.GetDateFromISO("0001-01-01T12:00:00.000Z");
BpmnModelJsonHelper.MAX_OFFSETDATETIME = BpmnModelJsonHelper.GetDateFromISO("9999-12-31T23:59:59.000Z");
if (false) {
    /** @type {?} */
    BpmnModelJsonHelper.MIN_OFFSETDATETIME;
    /** @type {?} */
    BpmnModelJsonHelper.MAX_OFFSETDATETIME;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQnBtbk1vZGVsSnNvbkhlbHBlci5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BlZHAtYWlmL2NvbW1vbi1hcGkvIiwic291cmNlcyI6WyJsaWIvQnBtbk1vZGVsSnNvbkhlbHBlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBRUEsTUFBTSxPQUFPLG1CQUFtQjs7Ozs7O0lBSXJCLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxHQUFPLEVBQUUsYUFBcUI7UUFDMUQsSUFBSSxHQUFHLElBQUksSUFBSSxFQUFFO1lBQ2IsT0FBTyxJQUFJLENBQUM7U0FDZjtRQUNELElBQUksR0FBRyxDQUFDLGNBQWMsQ0FBQyxhQUFhLENBQUMsRUFBRTtZQUNuQyxPQUFPLEdBQUcsQ0FBQyxhQUFhLENBQUMsQ0FBQztTQUM3QjthQUFNO1lBQ0gsT0FBTyxJQUFJLENBQUM7U0FDZjtJQUNMLENBQUM7Ozs7Ozs7O0lBRU0sTUFBTSxDQUFDLGlCQUFpQixDQUE4QixHQUFPLEVBQUUsYUFBcUIsRUFBRSxLQUErRDtRQUN4SixJQUFJLEdBQUcsSUFBSSxJQUFJLElBQUksS0FBSyxJQUFJLElBQUk7WUFDNUIsT0FBTzs7WUFFUCxTQUFTLEdBQWEsRUFBRTtRQUM1QixJQUFJLEtBQUssWUFBWSxLQUFLLEVBQUU7WUFDeEIsa0VBQWtFO1lBQ2xFLEtBQUssSUFBSSxJQUFJLElBQUksS0FBSyxFQUFFO2dCQUNwQixJQUFJLElBQUksQ0FBQyxjQUFjLENBQUMscUJBQXFCLENBQUMsSUFBSSxJQUFJLENBQUMsY0FBYyxDQUFDLG9CQUFvQixDQUFDLEVBQUU7b0JBQ3pGLFNBQVMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLG1CQUFtQixFQUFFLENBQUMsQ0FBQztpQkFDOUM7cUJBQU07b0JBQ0gsTUFBTTtpQkFDVDthQUNKO1lBQ0QsSUFBSSxTQUFTLENBQUMsTUFBTSxJQUFJLEtBQUssQ0FBQyxNQUFNLEVBQUU7Z0JBQ2xDLEdBQUcsQ0FBQyxhQUFhLENBQUMsR0FBRyxTQUFTLENBQUM7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LEdBQUcsQ0FBQztJQUNmLENBQUM7Ozs7Ozs7O0lBRU8sTUFBTSxDQUFDLFVBQVUsQ0FBQyxHQUFXLEVBQUUsWUFBb0IsRUFBRSxTQUFpQjtRQUMxRSxZQUFZLEdBQUcsWUFBWSxJQUFJLENBQUMsQ0FBQyxDQUFDLDZDQUE2QztRQUMvRSxTQUFTLEdBQUcsTUFBTSxDQUFDLE9BQU8sU0FBUyxLQUFLLFdBQVcsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUN2RSxJQUFJLEdBQUcsQ0FBQyxNQUFNLEdBQUcsWUFBWSxFQUFFO1lBQzNCLE9BQU8sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQ3RCO2FBQU07WUFDSCxZQUFZLEdBQUcsWUFBWSxHQUFHLEdBQUcsQ0FBQyxNQUFNLENBQUM7WUFDekMsSUFBSSxZQUFZLEdBQUcsU0FBUyxDQUFDLE1BQU0sRUFBRTtnQkFDakMsU0FBUyxJQUFJLFNBQVMsQ0FBQyxNQUFNLENBQUMsWUFBWSxHQUFHLFNBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLHdEQUF3RDthQUMzSDtZQUNELE9BQU8sU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsWUFBWSxDQUFDLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQ3pEO0lBQ0wsQ0FBQzs7QUExU3NCLHNDQUFrQixHQUFTLG1CQUFtQixDQUFDLGNBQWMsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO0FBQzFGLHNDQUFrQixHQUFTLG1CQUFtQixDQUFDLGNBQWMsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDOzs7SUFEakgsdUNBQWlIOztJQUNqSCx1Q0FBaUgiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJSnNvblNlcmlhbGl6YWJsZSB9IGZyb20gJy4vSUpzb25TZXJpYWxpemFibGUnO1xyXG5cclxuZXhwb3J0IGNsYXNzIEJwbW5Nb2RlbEpzb25IZWxwZXIge1xyXG4gICAgcHVibGljIHN0YXRpYyByZWFkb25seSBNSU5fT0ZGU0VUREFURVRJTUU6IERhdGUgPSBCcG1uTW9kZWxKc29uSGVscGVyLkdldERhdGVGcm9tSVNPKFwiMDAwMS0wMS0wMVQxMjowMDowMC4wMDBaXCIpO1xyXG4gICAgcHVibGljIHN0YXRpYyByZWFkb25seSBNQVhfT0ZGU0VUREFURVRJTUU6IERhdGUgPSBCcG1uTW9kZWxKc29uSGVscGVyLkdldERhdGVGcm9tSVNPKFwiOTk5OS0xMi0zMVQyMzo1OTo1OS4wMDBaXCIpO1xyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgR2V0QXR0cmlidXRlVmFsdWUob2JqOiB7fSwgYXR0cmlidXRlTmFtZTogc3RyaW5nKTogYW55IHtcclxuICAgICAgICBpZiAob2JqID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoYXR0cmlidXRlTmFtZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG9ialthdHRyaWJ1dGVOYW1lXTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBTZXRBdHRyaWJ1dGVWYWx1ZTxUIGV4dGVuZHMgSUpzb25TZXJpYWxpemFibGU+KG9iajoge30sIGF0dHJpYnV0ZU5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZyB8IGJvb2xlYW4gfCBudW1iZXIgfCBEYXRlIHwgQXJyYXk8VD4gfCBUIHwgb2JqZWN0KTogdm9pZCB7XHJcbiAgICAgICAgaWYgKG9iaiA9PSBudWxsIHx8IHZhbHVlID09IG51bGwpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuXHJcbiAgICAgICAgbGV0IGpzb25BcnJheTogT2JqZWN0W10gPSBbXTtcclxuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgICAgICAvL+WIpOaWreaYr+WQpuS4uklKc29uU2VyaWFsaXphYmxl5a6e546w57G755qE5pWw57uE77yM5piv5YiZ5YWo6YOo6LCD55SoQ29udmVydFRvSnNvbk9iamVjdOW6j+WIl+WMlu+8jOWQpuWImeebtOaOpei1i+WAvFxyXG4gICAgICAgICAgICBmb3IgKGxldCBpdGVtIG9mIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS5oYXNPd25Qcm9wZXJ0eShcIkNvbnZlcnRUb0pzb25PYmplY3RcIikgJiYgaXRlbS5oYXNPd25Qcm9wZXJ0eShcIkxvYWRGcm9tSnNvbk9iamVjdFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGpzb25BcnJheS5wdXNoKGl0ZW0uQ29udmVydFRvSnNvbk9iamVjdCgpKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGpzb25BcnJheS5sZW5ndGggPT0gdmFsdWUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBvYmpbYXR0cmlidXRlTmFtZV0gPSBqc29uQXJyYXk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBvYmpbYXR0cmlidXRlTmFtZV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAodmFsdWUuaGFzT3duUHJvcGVydHkoXCJDb252ZXJ0VG9Kc29uT2JqZWN0XCIpICYmIHZhbHVlLmhhc093blByb3BlcnR5KFwiTG9hZEZyb21Kc29uT2JqZWN0XCIpKSB7XHJcbiAgICAgICAgICAgIC8v5Yik5pat5piv5ZCm5Li6SUpzb25TZXJpYWxpemFibGXlrp7njrDnsbvnmoTlr7nosaHvvIzmmK/liJnosIPnlKhDb252ZXJ0VG9Kc29uT2JqZWN05bqP5YiX5YyWXHJcbiAgICAgICAgICAgIG9ialthdHRyaWJ1dGVOYW1lXSA9ICh2YWx1ZSBhcyBUKS5Db252ZXJ0VG9Kc29uT2JqZWN0KCk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIERhdGUpIHtcclxuICAgICAgICAgICAgLy/liKTmlq3mmK/lkKbkuLrml6XmnJ/nsbvlnovvvIzmmK/ml6XmnJ/nsbvlnovliJnovazkuLrlrZfnrKbkuLJVVEPnmoR5eXl5TU1ERGhobW1zc1NTU+agvOW8j+Wtl+espuS4slxyXG4gICAgICAgICAgICBjb25zdCBzdHIgPSBCcG1uTW9kZWxKc29uSGVscGVyLkRhdGVUaW1lVG9TdHJpbmcodmFsdWUpO1xyXG4gICAgICAgICAgICBCcG1uTW9kZWxKc29uSGVscGVyLlNldEF0dHJpYnV0ZVZhbHVlKG9iaiwgYXR0cmlidXRlTmFtZSwgc3RyKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBvYmpbYXR0cmlidXRlTmFtZV0gPSB2YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBHZXRBdHRyaWJ1dGVWYWx1ZUFzU3RyaW5nKG9iajoge30sIGF0dHJpYnV0ZU5hbWU6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgaWYgKG9iaiA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShhdHRyaWJ1dGVOYW1lKSA9PSB0cnVlICYmIHR5cGVvZiAob2JqW2F0dHJpYnV0ZU5hbWVdKSA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBvYmpbYXR0cmlidXRlTmFtZV07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIEdldEF0dHJpYnV0ZVZhbHVlQXNCb29sZWFuKG9iajoge30sIGF0dHJpYnV0ZU5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGlmIChvYmogPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoYXR0cmlidXRlTmFtZSkgPT0gdHJ1ZSAmJiB0eXBlb2YgKG9ialthdHRyaWJ1dGVOYW1lXSkgPT0gXCJib29sZWFuXCIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG9ialthdHRyaWJ1dGVOYW1lXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgR2V0QXR0cmlidXRlVmFsdWVBc051bWJlcihvYmo6IHt9LCBhdHRyaWJ1dGVOYW1lOiBzdHJpbmcpOiBudW1iZXIge1xyXG4gICAgICAgIGlmIChvYmogPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoYXR0cmlidXRlTmFtZSkgPT0gdHJ1ZSAmJiB0eXBlb2YgKG9ialthdHRyaWJ1dGVOYW1lXSkgPT0gXCJudW1iZXJcIikge1xyXG4gICAgICAgICAgICByZXR1cm4gb2JqW2F0dHJpYnV0ZU5hbWVdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBHZXRBdHRyaWJ1dGVWYWx1ZUFzTGlzdDxSZXR1cm5UIGV4dGVuZHMgSUpzb25TZXJpYWxpemFibGUsIENsYXNzT2ZUIGV4dGVuZHMgUmV0dXJuVD4ob2JqOiBPYmplY3QsIGF0dHJpYnV0ZU5hbWU6IHN0cmluZywgY2xhc3NPZlQ6IG5ldyAoKSA9PiBDbGFzc09mVCk6IEFycmF5PFJldHVyblQ+IHtcclxuICAgICAgICBsZXQganNvbkFycmF5OiBBcnJheTxhbnk+ID0gQnBtbk1vZGVsSnNvbkhlbHBlci5HZXRBdHRyaWJ1dGVWYWx1ZShvYmosIGF0dHJpYnV0ZU5hbWUpO1xyXG5cclxuICAgICAgICBpZiAoanNvbkFycmF5ID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgbGlzdDogQXJyYXk8UmV0dXJuVD4gPSBbXTtcclxuICAgICAgICBmb3IgKGxldCBpdGVtIG9mIGpzb25BcnJheSkge1xyXG4gICAgICAgICAgICBsZXQgaW5zdGFuY2U6IFJldHVyblQgPSBudWxsO1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UgPSBuZXcgY2xhc3NPZlQoKSBhcyBDbGFzc09mVDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW5zdGFuY2UuTG9hZEZyb21Kc29uT2JqZWN0KGl0ZW0pO1xyXG4gICAgICAgICAgICBsaXN0LnB1c2goaW5zdGFuY2UpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGxpc3Q7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBHZXRBdHRyaWJ1dGVWYWx1ZUFzRGF0ZVRpbWUob2JqOiBPYmplY3QsIGF0dHJpYnV0ZU5hbWU6IHN0cmluZyk6IERhdGUge1xyXG4gICAgICAgIHJldHVybiBCcG1uTW9kZWxKc29uSGVscGVyLkRhdGVUaW1lRnJvbVN0cmluZyhCcG1uTW9kZWxKc29uSGVscGVyLkdldEF0dHJpYnV0ZVZhbHVlQXNTdHJpbmcob2JqLCBhdHRyaWJ1dGVOYW1lKSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBHZXRBdHRyaWJ1dGVWYWx1ZUFzSnNvblNlcmlhbGl6YWJsZTxSZXR1cm5UIGV4dGVuZHMgSUpzb25TZXJpYWxpemFibGUsIENsYXNzT2ZUIGV4dGVuZHMgUmV0dXJuVD4ob2JqOiBPYmplY3QsIGF0dHJpYnV0ZU5hbWU6IHN0cmluZywgY2xhc3NPZlQ6IG5ldyAoKSA9PiBDbGFzc09mVCk6IFJldHVyblQge1xyXG4gICAgICAgIGxldCBqc29uT2JqZWN0OiBPYmplY3QgPSBCcG1uTW9kZWxKc29uSGVscGVyLkdldEF0dHJpYnV0ZVZhbHVlKG9iaiwgYXR0cmlidXRlTmFtZSk7XHJcblxyXG4gICAgICAgIGlmIChqc29uT2JqZWN0ID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgaW5zdGFuY2U6IFJldHVyblQgPSBudWxsO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlID0gbmV3IGNsYXNzT2ZUKCkgYXMgUmV0dXJuVDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgdGhyb3cgZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGluc3RhbmNlLkxvYWRGcm9tSnNvbk9iamVjdChqc29uT2JqZWN0KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgRGF0ZVRpbWVUb1N0cmluZyhkdDogRGF0ZSk6IHN0cmluZyB7XHJcbiAgICAgICAgaWYgKGR0ID09IG51bGwpXHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG5cclxuICAgICAgICBjb25zdCB0aW1lID0gZHQuZ2V0VGltZSgpO1xyXG4gICAgICAgIGlmICh0aW1lIDwgQnBtbk1vZGVsSnNvbkhlbHBlci5NSU5fT0ZGU0VUREFURVRJTUUuZ2V0VGltZSgpIHx8IHRpbWUgPiBCcG1uTW9kZWxKc29uSGVscGVyLk1BWF9PRkZTRVREQVRFVElNRS5nZXRUaW1lKCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgYOe7meWumueahOaXpeacn+aXtumXtOWAvCAke2R0LnRvSVNPU3RyaW5nKCl9IOi2heWHuuaUr+aMgeiMg+WbtCgwMDAxLTAxLTAxVDEyOjAwOjAwLjAwMFogLSA5OTk5LTEyLTMxVDIzOjU5OjU5LjAwMFopOmA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gQnBtbk1vZGVsSnNvbkhlbHBlci5kYXRlRm9ybWF0KGR0LCBcInl5eXlNTWRkSEhtbXNzU1NTXCIpXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBcclxuICAgICAqIEBwYXJhbSBzdHIg5qC85byP5Li677yaeXl5eU1NZGRISG1tc3NTU1NcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBEYXRlVGltZUZyb21TdHJpbmcoc3RyOiBzdHJpbmcpOiBEYXRlIHtcclxuICAgICAgICBpZiAoc3RyID09IG51bGwpXHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG5cclxuICAgICAgICAvLyBjb25zdCBzID0gYCR7c3RyLnN1YnN0cmluZygwLCA0KX0vJHtzdHIuc3Vic3RyaW5nKDQsIDYpfS8ke3N0ci5zdWJzdHJpbmcoNiwgOCl9ICR7c3RyLnN1YnN0cmluZyg4LCAxMCl9OiR7c3RyLnN1YnN0cmluZygxMCwgMTIpfToke3N0ci5zdWJzdHJpbmcoMTIsIDE0KX0uJHtzdHIuc3Vic3RyaW5nKDE0KX1gO1xyXG4gICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgIGRhdGUuc2V0VVRDRnVsbFllYXIocGFyc2VJbnQoc3RyLnN1YnN0cmluZygwLCA0KSkpO1xyXG4gICAgICAgIGRhdGUuc2V0VVRDTW9udGgocGFyc2VJbnQoc3RyLnN1YnN0cmluZyg0LCA2KSkgLSAxKTtcclxuICAgICAgICBkYXRlLnNldFVUQ0RhdGUocGFyc2VJbnQoc3RyLnN1YnN0cmluZyg2LCA4KSkpO1xyXG4gICAgICAgIGRhdGUuc2V0VVRDSG91cnMocGFyc2VJbnQoc3RyLnN1YnN0cmluZyg4LCAxMCkpKTtcclxuICAgICAgICBkYXRlLnNldFVUQ01pbnV0ZXMocGFyc2VJbnQoc3RyLnN1YnN0cmluZygxMCwgMTIpKSk7XHJcbiAgICAgICAgZGF0ZS5zZXRVVENTZWNvbmRzKHBhcnNlSW50KHN0ci5zdWJzdHJpbmcoMTIsIDE0KSkpO1xyXG4gICAgICAgIGRhdGUuc2V0VVRDTWlsbGlzZWNvbmRzKHBhcnNlSW50KHN0ci5zdWJzdHJpbmcoMTQpKSk7XHJcbiAgICAgICAgcmV0dXJuIGRhdGU7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBUb0pzb248VCBleHRlbmRzIElKc29uU2VyaWFsaXphYmxlPih2YWx1ZTogQXJyYXk8VD4pOiBzdHJpbmcge1xyXG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgbGlzdDogT2JqZWN0W10gPSBbXTtcclxuICAgICAgICBmb3IgKGxldCBpdGVtIG9mIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGxpc3QucHVzaChpdGVtLkNvbnZlcnRUb0pzb25PYmplY3QoKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkobGlzdCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBGcm9tSnNvbjxSZXR1cm5UIGV4dGVuZHMgSUpzb25TZXJpYWxpemFibGUsIENsYXNzT2ZUIGV4dGVuZHMgUmV0dXJuVD4oanNvbjogc3RyaW5nLCBjbGFzc09mVDogbmV3ICgpID0+IENsYXNzT2ZUKTogQXJyYXk8UmV0dXJuVD4ge1xyXG4gICAgICAgIGlmIChCcG1uTW9kZWxKc29uSGVscGVyLklzTnVsbE9yV2hpdGVTcGFjZShqc29uKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBsaXN0ID0gbmV3IEFycmF5PFJldHVyblQ+KCk7XHJcbiAgICAgICAgbGV0IGpzb25BcnI6IEFycmF5PHt9PiA9IEpTT04ucGFyc2UoanNvbik7XHJcblxyXG4gICAgICAgIGlmIChqc29uQXJyID09IG51bGwgfHwgQXJyYXkuaXNBcnJheShqc29uQXJyKSA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGxpc3Q7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBqc29uQXJyLmZvckVhY2goZWx0ID0+IHtcclxuICAgICAgICAgICAgbGV0IG5ld0luc3RhbmNlID0gbmV3IGNsYXNzT2ZUKCkgYXMgQ2xhc3NPZlQ7XHJcbiAgICAgICAgICAgIG5ld0luc3RhbmNlLkxvYWRGcm9tSnNvbk9iamVjdChlbHQpO1xyXG4gICAgICAgICAgICBsaXN0LnB1c2gobmV3SW5zdGFuY2UpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gbGlzdDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIFN0cmluZ0xpc3RUb0pzb25BcnJheSh2YWx1ZTogQXJyYXk8c3RyaW5nPik6IEFycmF5PHN0cmluZz4ge1xyXG4gICAgICAgIGlmICh2YWx1ZSA9PSBudWxsKVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgbGV0IGpzb25BcnJheTogQXJyYXk8c3RyaW5nPiA9IG5ldyBBcnJheSgpO1xyXG4gICAgICAgIGZvciAobGV0IGl0ZW0gb2YgdmFsdWUpIHtcclxuICAgICAgICAgICAganNvbkFycmF5LnB1c2goaXRlbSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ganNvbkFycmF5O1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgU3RyaW5nTGlzdEZyb21Kc29uQXJyYXkoanNvbkFycmF5OiBBcnJheTxPYmplY3Q+KTogQXJyYXk8c3RyaW5nPiB7XHJcbiAgICAgICAgaWYgKGpzb25BcnJheSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGxpc3Q6IEFycmF5PHN0cmluZz4gPSBuZXcgQXJyYXkoKTtcclxuICAgICAgICBmb3IgKGxldCBpdGVtIG9mIGpzb25BcnJheSkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGl0ZW0gPT0gXCJvYmplY3RcIikge1xyXG4gICAgICAgICAgICAgICAgbGlzdC5wdXNoKEpTT04uc3RyaW5naWZ5KGl0ZW0pKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGxpc3QucHVzaChTdHJpbmcoaXRlbSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbGlzdDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIFN0cmluZ0xpc3RUb0pzb24odmFsdWU6IEFycmF5PHN0cmluZz4pOiBzdHJpbmcge1xyXG4gICAgICAgIGxldCBqc29uQXJyYXkgPSBCcG1uTW9kZWxKc29uSGVscGVyLlN0cmluZ0xpc3RUb0pzb25BcnJheSh2YWx1ZSk7XHJcbiAgICAgICAgaWYgKGpzb25BcnJheSA9PSBudWxsKVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGpzb25BcnJheSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBTdHJpbmdMaXN0RnJvbUpzb24oanNvbjogc3RyaW5nKTogQXJyYXk8c3RyaW5nPiB7XHJcbiAgICAgICAgaWYgKEJwbW5Nb2RlbEpzb25IZWxwZXIuSXNOdWxsT3JXaGl0ZVNwYWNlKGpzb24pKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGpzb25BcnJheSA9IEpTT04ucGFyc2UoanNvbikgYXMgQXJyYXk8T2JqZWN0PjtcclxuICAgICAgICBpZiAoanNvbkFycmF5ID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gQnBtbk1vZGVsSnNvbkhlbHBlci5TdHJpbmdMaXN0RnJvbUpzb25BcnJheShqc29uQXJyYXkpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgSXNOdWxsT3JXaGl0ZVNwYWNlKHN0cmluZzogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAgICAgaWYgKHN0cmluZyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgvKF5zKil8KHMqJCkvZywgXCJcIikubGVuZ3RoID09IDA7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc3RhdGljIEdldERhdGVGcm9tSVNPKHZhbHVlOiBzdHJpbmcpIHtcclxuICAgICAgICBsZXQgYSA9IC9eKFxcZHs0fSktKFxcZHsyfSktKFxcZHsyfSlUKFxcZHsyfSk6KFxcZHsyfSk6KFxcZHsyfSg/OlxcLlxcZCopPylaJC8uZXhlYyh2YWx1ZSk7XHJcbiAgICAgICAgaWYgKGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKERhdGUuVVRDKCthWzFdLCArYVsyXSAtIDEsICthWzNdLCArYVs0XSwgK2FbNV0sICthWzZdKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc3RhdGljIGRhdGVGb3JtYXQoZGF0ZTogRGF0ZSwgZm10OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgICAgIGxldCByZXQ7XHJcbiAgICAgICAgY29uc3Qgb3B0ID0ge1xyXG4gICAgICAgICAgICBcInkrXCI6IGRhdGUuZ2V0VVRDRnVsbFllYXIoKS50b1N0cmluZygpLCAgICAgICAgLy8g5bm0XHJcbiAgICAgICAgICAgIFwiTStcIjogKGRhdGUuZ2V0VVRDTW9udGgoKSArIDEpLnRvU3RyaW5nKCksICAgICAvLyDmnIhcclxuICAgICAgICAgICAgXCJkK1wiOiBkYXRlLmdldFVUQ0RhdGUoKS50b1N0cmluZygpLCAgICAgICAgICAgIC8vIOaXpVxyXG4gICAgICAgICAgICBcIkgrXCI6IGRhdGUuZ2V0VVRDSG91cnMoKS50b1N0cmluZygpLCAgICAgICAgICAgLy8g5pe2XHJcbiAgICAgICAgICAgIFwibStcIjogZGF0ZS5nZXRVVENNaW51dGVzKCkudG9TdHJpbmcoKSwgICAgICAgICAvLyDliIZcclxuICAgICAgICAgICAgXCJzK1wiOiBkYXRlLmdldFVUQ1NlY29uZHMoKS50b1N0cmluZygpLCAgICAgICAgIC8vIOenklxyXG4gICAgICAgICAgICBcIlMrXCI6IGRhdGUuZ2V0VVRDTWlsbGlzZWNvbmRzKCkudG9TdHJpbmcoKSwgICAgLy8g56eSXHJcbiAgICAgICAgICAgIC8vIOacieWFtuS7luagvOW8j+WMluWtl+espumcgOaxguWPr+S7pee7p+e7rea3u+WKoO+8jOW/hemhu+i9rOWMluaIkOWtl+espuS4slxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZm9yIChsZXQgayBpbiBvcHQpIHtcclxuICAgICAgICAgICAgcmV0ID0gbmV3IFJlZ0V4cChcIihcIiArIGsgKyBcIilcIikuZXhlYyhmbXQpO1xyXG4gICAgICAgICAgICBpZiAocmV0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIVN0cmluZy5wcm90b3R5cGUucGFkU3RhcnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBmbXQgPSBmbXQucmVwbGFjZShyZXRbMV0sIChyZXRbMV0ubGVuZ3RoID09IDEpID8gKG9wdFtrXSkgOiAoQnBtbk1vZGVsSnNvbkhlbHBlci5teVBhZFN0YXJ0KG9wdFtrXSwgcmV0WzFdLmxlbmd0aCwgXCIwXCIpKSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGZtdCA9IGZtdC5yZXBsYWNlKHJldFsxXSwgKHJldFsxXS5sZW5ndGggPT0gMSkgPyAob3B0W2tdKSA6IChvcHRba10ucGFkU3RhcnQocmV0WzFdLmxlbmd0aCwgXCIwXCIpKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZtdDtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHN0YXRpYyBteVBhZFN0YXJ0KHNyYzogc3RyaW5nLCB0YXJnZXRMZW5ndGg6IG51bWJlciwgcGFkU3RyaW5nOiBzdHJpbmcpIHtcclxuICAgICAgICB0YXJnZXRMZW5ndGggPSB0YXJnZXRMZW5ndGggPj4gMDsgLy9mbG9vciBpZiBudW1iZXIgb3IgY29udmVydCBub24tbnVtYmVyIHRvIDA7XHJcbiAgICAgICAgcGFkU3RyaW5nID0gU3RyaW5nKHR5cGVvZiBwYWRTdHJpbmcgIT09ICd1bmRlZmluZWQnID8gcGFkU3RyaW5nIDogJyAnKTtcclxuICAgICAgICBpZiAoc3JjLmxlbmd0aCA+IHRhcmdldExlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gU3RyaW5nKHNyYyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGFyZ2V0TGVuZ3RoID0gdGFyZ2V0TGVuZ3RoIC0gc3JjLmxlbmd0aDtcclxuICAgICAgICAgICAgaWYgKHRhcmdldExlbmd0aCA+IHBhZFN0cmluZy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHBhZFN0cmluZyArPSBwYWRTdHJpbmcucmVwZWF0KHRhcmdldExlbmd0aCAvIHBhZFN0cmluZy5sZW5ndGgpOyAvL2FwcGVuZCB0byBvcmlnaW5hbCB0byBlbnN1cmUgd2UgYXJlIGxvbmdlciB0aGFuIG5lZWRlZFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBwYWRTdHJpbmcuc2xpY2UoMCwgdGFyZ2V0TGVuZ3RoKSArIFN0cmluZyhzcmMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSJdfQ==